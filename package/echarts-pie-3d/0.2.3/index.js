// env=undefined => env=publish 
Cube("datav:/com/echarts-pie-3d/0.2.3/customRuleStyle",["datav:/npm/lodash/4.6.1/get","datav:/npm/lodash/4.6.1/set","datav:/npm/lodash/4.6.1/map","datav:/npm/lodash/4.6.1/filter","datav:/npm/alibabacloud-datav-tool-gui-utils/1.0.0"],function(t,a,o,e,n,r){function u(t){return function(t){if(Array.isArray(t))return l(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,a){var o;if(t)return"string"==typeof t?l(t,a):"Map"===(o="Object"===(o=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:o)||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?l(t,a):void 0}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function l(t,a){(null==a||a>t.length)&&(a=t.length);for(var o=0,e=new Array(a);o<a;o++)e[o]=t[o];return e}var c=o("datav:/npm/lodash/4.6.1/get"),s=o("datav:/npm/lodash/4.6.1/set"),d=o("datav:/npm/lodash/4.6.1/map"),m=o("datav:/npm/lodash/4.6.1/filter"),o=o("datav:/npm/alibabacloud-datav-tool-gui-utils/1.0.0"),p=o.scale,f=o.validateCustomStyle;return t.exports=function(){var a,n,r,l,t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},o=t.props,e=t.guiConfig,t=t.data,e=(void 0===e?{}:e).options,i=e.chart.fill,e=e.condition.customStyle;a=(o={props:void 0===o?{}:o,customStyle:e,fill:i,data:t}).props,n=o.customStyle,e=o.fill,r=o.data,l=c(p,"color.g2plot")({config:e,data:r,field:"name"}),s(a,"color",function(a){return l.apply(void 0,u(m(r,function(t){return t.name===a.seriesName})))}),d(a.series,function(e,t){s(a,"series[".concat(t,"].itemStyle.color"),function(a){var t=m(r,function(t){return t.name===("pie2d"===e.name?a.name:a.seriesName)}),o={color:l.apply(void 0,u(t))};return f({config:n,data:t[0],ruleKey:"rules"}).forEach(function(t){t={color:t.fill.value};Object.assign(o,t)}),o.color})})},t.exports});;
Cube("datav:/com/echarts-pie-3d/0.2.3/utils",["datav:/npm/lodash/4.6.1"],function(t,e,i,l,n,s){var d=i("datav:/npm/lodash/4.6.1"),a="linear",c=function(t){return d.includes(t+="",".")||(t+="."),d.replace(d.replace(t,/(\d)(?=(\d{3})+\.)/g,"$1,"),/\.$/,"")};return t.exports={transNumberFormatterTooltip:function(t){var e,i,l,n,s=t.v,r=t.type,o=t.format,u=t.prefix,t=t.suffix;return("d"===o||/.[0-9]f/.test(o)||/.[0-9]%/.test(o)||"th"===o||/.[0-9]t/.test(o))&&r===a?(e=d.toNumber(s),l=u,n=t,(i=o)?i.includes(".")&&i.includes("t")?l+c((+e).toFixed(i.split(".")[1].split("t")[0]))+n:i.includes("th")?l+c(d.floor(e))+n:i.includes(".")&&i.includes("f")?l+(+e).toFixed(i.split(".")[1].split("f")[0])+n:i.includes("%")?l+"".concat((100*e).toFixed(+i.split("%")[0].split(".")[1]),"%")+n:i.includes("d")?l+d.floor(e)+n:e:e):r===a&&"null"===o?u+d.toNumber(s)+t:r===TIME_TYPE&&"null"!==o?u+moment(s).format(o)+t:u+s+t},isValid:function(t){return!d.isUndefined(t)&&!d.isNull(t)&&!d.isNaN(t)}},t.exports});;
Cube("datav:/com/echarts-pie-3d/0.2.3",["datav:/npm/bcore/0.0.18/event","datav:/npm/jquery/2.1.4","datav:/npm/lodash/4.6.1/get","datav:/npm/lodash/4.6.1/set","datav:/npm/lodash/4.6.1/maxBy","datav:/npm/lodash/4.6.1/omit","datav:/npm/lodash/4.6.1/filter","datav:/npm/lodash/4.6.1/map","datav:/npm/lodash/4.6.1/cloneDeep","datav:/npm/lodash/4.6.1/orderBy","datav:/npm/lodash/4.6.1/chunk","datav:/npm/lodash/4.6.1/sumBy","datav:/npm/lodash/4.6.1/toNumber","datav:/npm/lodash/4.6.1/isNumber","datav:/npm/lodash/4.6.1/isArray","datav:/npm/lodash/4.6.1/floor","datav:/npm/lodash/4.6.1/defaultsDeep","datav:/npm/lodash/4.6.1/find","datav:/npm/echarts/4.9.0","datav:/npm/echarts-gl/1.1.1"],function(e,t,a,i,n,o){function s(t,e){var a,i=Object.keys(t);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(t),e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,a)),i}function ve(i){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?s(Object(n),!0).forEach(function(e){var t,a;t=i,a=n[e=e],e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(n,e))})}return i}var r=a("datav:/npm/bcore/0.0.18/event"),l=a("datav:/npm/jquery/2.1.4"),be=a("datav:/npm/lodash/4.6.1/get"),m=a("datav:/npm/lodash/4.6.1/set"),f=a("datav:/npm/lodash/4.6.1/maxBy"),g=a("datav:/npm/lodash/4.6.1/omit"),v=a("datav:/npm/lodash/4.6.1/filter"),b=a("datav:/npm/lodash/4.6.1/map"),c=a("datav:/npm/lodash/4.6.1/cloneDeep"),h=a("datav:/npm/lodash/4.6.1/orderBy"),p=a("datav:/npm/lodash/4.6.1/chunk"),d=a("datav:/npm/lodash/4.6.1/sumBy"),y=a("datav:/npm/lodash/4.6.1/toNumber"),u=a("datav:/npm/lodash/4.6.1/isNumber"),x=a("datav:/npm/lodash/4.6.1/isArray"),S=a("datav:/npm/lodash/4.6.1/floor"),D=a("datav:/npm/lodash/4.6.1/defaultsDeep"),w=a("datav:/npm/lodash/4.6.1/find"),M=a("datav:/npm/echarts/4.9.0"),I=(a("datav:/npm/echarts-gl/1.1.1"),a("datav:/com/echarts-pie-3d/0.2.3/utils")),P=I.transNumberFormatterTooltip,C=I.isValid,R=a("datav:/com/echarts-pie-3d/0.2.3/customRuleStyle");return e.exports=r.extend(function(e,t){this.config={options:{chart:{projection:"orthographic",isCombine:{show:!0,piecesCount:50,defineType:"其他"},isHeightMapping:!0},special:{shading:"lambert",light:{show:!0,main:{show:!0,intensity:1,color:"#fff",beta:42,alpha:20,isShadow:!0,shadowQuality:"ultra"},ambient:{show:!0,intensity:.7,color:"#fff"}},postEffect:{show:!1,bloom:{show:!0,bloomIntensity:.1},depthOfField:{show:!0,fstop:10,blurRadius:1}}}}},this.container=l(e),this.apis=t.apis,this._data=null,this.chart=null,this.maxValue=0,this.maxValueDigit=0,this.init(t)},{init:function(e){e=this.mergeConfig(e),this.chart=M.init(this.container[0])},render:function(e,t){var s=this,t=(e=this.data(e),this.mergeConfig(t)),a=be(t,"options.chart.isCombine"),i=a.show,a=a.piecesCount,i=(i&&a<e.length-1&&(e=this.combineData(e)),t.options),a=i.chart,n=(a.fill,a.radiusRate),a=a.label,o=a.show,r=a.labelForm,r=(r.labelMode,r.markForm),l=(a.labelContent,a.describe,a.decimal,a.textStyle),c=(a.valueFormat,a.lineHeight),a=a.spiderSet,i=i.tooltip.mouseAction.mouseoverAction;if(this.maxValue=be(f(e,"value"),"value"),this.maxValueDigit=0,1<=this.maxValue)for(var h=this.maxValue;1<=h;)h/=10,this.maxValueDigit++;else for(var p=this.maxValue;p<1;)p*=10,this.maxValueDigit++;var d=this.getPie3D(e,n),u=(d.series.push({name:"pie2d",type:"pie",labelLine:{show:o&&"spider"===r,length:a.length1,length2:a.length2,lineStyle:{width:a.lineWidth}},startAngle:-a.rotate,clockwise:!1,radius:"".concat(a.size,"%"),center:["".concat(a.horizontal,"%"),"".concat(a.vertical,"%")],data:e,itemStyle:{opacity:0},silent:!0,label:{show:o&&"spider"===r,textStyle:ve(ve({},l),{},{lineHeight:c}),formatter:function(e){var t=be(e,"value"),e=be(e,"name");return s.getLabelFormatter(e,t)}}}),R({props:d,guiConfig:t,data:e}),this.chart&&this.chart.clear(),this.chart=M.init(this.container[0]),this.chart.setOption(d,!0),"");this.chart.off(),this.chart.on("click",function(t){var e=v(s._data,function(e){return e.name===be(t,"seriesName")}),e=g(e&&e[0],"startRatio","endRatio");0<Object.keys(e).length&&s.emit("itemSelect",e)}),i&&this.chart.on("mouseover",function(e){var t,a,i,n,o;u!==e.seriesIndex&&(""!==u&&(t=d.series[u].pieStatus&&d.series[u].pieStatus.selected,i=d.series[u].pieData&&d.series[u].pieData.startRatio,n=d.series[u].pieData&&d.series[u].pieData.endRatio,o=d.series[u].pieStatus&&d.series[u].pieStatus.k,d.series[u].parametricEquation=s.getParametricEquation(i,n,t,a=!1,o,d.series[u].pieData&&d.series[u].pieData.value),d.series[u].pieStatus&&(d.series[u].pieStatus.hovered=a),u=""),"mouseoutSeries"!==e.seriesName&&(t=d.series[e.seriesIndex].pieStatus&&d.series[e.seriesIndex].pieStatus.selected,i=d.series[e.seriesIndex].pieData&&d.series[e.seriesIndex].pieData.startRatio,n=d.series[e.seriesIndex].pieData&&d.series[e.seriesIndex].pieData.endRatio,o=d.series[e.seriesIndex].pieStatus&&d.series[e.seriesIndex].pieStatus.k,d.series[e.seriesIndex].parametricEquation=s.getParametricEquation(i,n,t,a=!0,o,d.series[e.seriesIndex].pieData&&d.series[e.seriesIndex].pieData.value),d.series[e.seriesIndex].pieStatus&&(d.series[e.seriesIndex].pieStatus.hovered=a),u=e.seriesIndex),s.chart.setOption(d))}),this.chart.on("globalout",function(){""!==u&&(isSelected=d.series[u].pieStatus&&d.series[u].pieStatus.selected,isHovered=!1,k=d.series[u].pieStatus&&d.series[u].pieStatus.k,startRatio=d.series[u].pieData&&d.series[u].pieData.startRatio,endRatio=d.series[u].pieData&&d.series[u].pieData.endRatio,d.series[u].parametricEquation=s.getParametricEquation(startRatio,endRatio,isSelected,isHovered,k,d.series[u].pieData&&d.series[u].pieData.value),d.series[u].pieStatus&&(d.series[u].pieStatus.hovered=isHovered),u=""),s.chart.setOption(d)}),this.chart.on("legendselectchanged",function(i){for(var e=d.series.length,t=0;t<d.series[e-1].data.length;t++)d.series[e-1].data[t].name==i.name&&(i.selected[i.name]?m(d,"series[".concat(e-1,"].data[").concat(t,"].label.textStyle.opacity"),1):m(d,"series[".concat(e-1,"].data[").concat(t,"].label.textStyle.opacity"),0));b(d.series,function(e,t){if("labelSeries"===e.id)for(var a=0;a<d.series[t].data.length;a++)d.series[t].data[a].name==i.name&&(i.selected[i.name]?m(d,"series[".concat(t,"].data[").concat(a,"].label.textStyle.opacity"),1):m(d,"series[".concat(t,"].data[").concat(a,"].label.textStyle.opacity"),0))}),s.chart.setOption(d);var a={name:(a=g(i,"type")).name,selected:a.selected[a.name]};0<Object.keys(a).length&&s.emit("legendSelect",a)})},combineData:function(e){var t=be(this.config,"options.chart.isCombine"),a=t.piecesCount,t=t.defineType,e=c(e),e=h(e,["value"],["desc"]),e=p(e,a),a=e[0],e=e[1],t={name:t,value:d(e,"value")};return a.push(t),a},handleMakeUpType:function(e,a){var i=[],n=a.length;return i.length<e.length&&b(e,function(e,t){i.push(a[t%n])}),i},getPiePercent:function(e){var t=0;return b(this._data,function(e){t+=e.value}),e/t},getParametricEquation:function(e,t,a,i,n,o){var s=this.config.options.chart.isHeightMapping,r=e*Math.PI*2,l=t*Math.PI*2,c=(e+t)/2*Math.PI*2,h=(n=void 0!==n?n:1/3,(a=0===e&&1===t?!1:a)?.1*Math.cos(c):0),p=a?.1*Math.sin(c):0,d=i?1.05:1,e=o,e=1<=this.maxValue?e/y("1".padEnd(this.maxValueDigit,"0"))*10:e*y("1".padEnd(this.maxValueDigit+1,"0"))*10,u=s?e:30;return{u:{min:-Math.PI,max:3*Math.PI,step:Math.PI/32},v:{min:0,max:2*Math.PI,step:Math.PI/20},x:function(e,t){return e<r?h+Math.cos(r)*(1+Math.cos(t)*n)*d:l<e?h+Math.cos(l)*(1+Math.cos(t)*n)*d:h+Math.cos(e)*(1+Math.cos(t)*n)*d},y:function(e,t){return e<r?p+Math.sin(r)*(1+Math.cos(t)*n)*d:l<e?p+Math.sin(l)*(1+Math.cos(t)*n)*d:p+Math.sin(e)*(1+Math.cos(t)*n)*d},z:function(e,t){return e<.5*-Math.PI||e>2.5*Math.PI?Math.sin(e):0<Math.sin(t)?u:-1}}},getPie3D:function(e,t){for(var a,i=this,n=[],o=0,s=0,r=[],l=void 0!==t?(1-t)/(1+t):1/3,t=this.config.options,c=t.chart,h=c.distance,p=c.pieHeight,d=c.projection,u=c.rotate,m=u.rotateX,f=u.rotateY,u=u.show,c=c.label,g=c.show,v=c.labelForm,v=(v.labelMode,v.markForm),b=(c.labelContent,c.describe,c.decimal,c.textStyle),y=(c.valueFormat,c.lineHeight),c=c.normalSpace,x=t.animation,V=x.autoRotate,q=x.autoRotateDirection,x=x.autoRotateSpeed,S=t.legend,_=S.isShow,A=S.textStyle,T=S.orient,B=S.horAlignment,N=S.verAlignment,S=S.cateLegend,D=S.markerSpace,L=D.spacing,D=D.itemHeight,w=S.marker,W=w.shape,w=w.size,S=S.flip,Q=S.show,G=S.textStyle,S=S.pageMarker,X=S.pageSize,Y=S.flipColor,S=S.inactiveFill,M=t.tooltip,I=M.tooltipSet,U=I.show,J=I.trigger,K=I.position,Z=I.titleSpace,P=I.titleTextStyle,C=I.contentTextStyle,I=I.bgBox,R=I.padding,$=R.paddingX,R=R.paddingY,ee=I.backgroundColor,I=I.border,M=M.mouseAction,te=M.rotateSensitivity,M=M.zoomSensitivity,t=t.special,ae=t.shading,k=t.postEffect,ie=k.show,O=k.bloom,ne=O.show,O=O.bloomIntensity,k=k.depthOfField,oe=k.show,se=k.fstop,k=k.blurRadius,t=t.light,re=t.show,j=t.main,le=j.show,ce=j.color,he=j.intensity,pe=j.isShadow,de=j.shadowQuality,ue=j.beta,j=j.alpha,t=t.ambient,me=t.show,fe=t.color,t=t.intensity,z={id:"labelSeries",type:"bar3D",barSize:[.1,.1],data:[],label:{show:g&&"normal"===v,textStyle:ve(ve({},b),{},{backgroundColor:"transparent",lineHeight:y}),distance:c,formatter:function(e){var t=be(e,"value[3]"),e=be(e,"name");return i.getLabelFormatter(e,t)}}},F=0;F<e.length;F++){o+=e[F].value;var ge={name:void 0===e[F].name?"series".concat(F):e[F].name,type:"surface",parametric:!0,wireframe:{show:!1},pieData:e[F],pieStatus:{selected:!1,hovered:!1,k:l},itemStyle:{opacity:1}};n.push(ge)}for(var E=0;E<n.length;E++)a=s+n[E].pieData.value,n[E].pieData.startRatio=s/o,n[E].pieData.endRatio=a/o,n[E].parametricEquation=this.getParametricEquation(n[E].pieData.startRatio,n[E].pieData.endRatio,!1,!1,l,n[E].pieData.value),s=a,r.push(n[E].name),labelRadian=(n[E].pieData.startRatio+n[E].pieData.endRatio)*Math.PI,z.data.push({name:n[E].name,value:[Math.cos(labelRadian),Math.sin(labelRadian),1.2,n[E].pieData.value]});var g=me?{ambient:{color:fe,intensity:t}}:{},v="color"!==ae&&re?{light:ve(ve({},le?{main:{color:ce,intensity:he,shadow:pe,shadowQuality:de,alpha:j,beta:ue}}:{}),g)}:{},b=(n.push({name:"mouseoutSeries",type:"surface",parametric:!0,wireframe:{show:!1},itemStyle:{opacity:0,backgroundColor:"transparent"},backgroundColor:"transparent",parametricEquation:{u:{min:0,max:2*Math.PI,step:Math.PI/20},v:{min:0,max:Math.PI,step:Math.PI/20},x:function(e,t){return Math.sin(t)*Math.sin(e)+Math.sin(e)},y:function(e,t){return Math.sin(t)*Math.cos(e)+Math.cos(e)},z:function(e,t){return 0<Math.cos(t)?.1:-.1}}}),n.push(z),u?{alpha:f,beta:m}:{}),H={legend:{show:_,type:Q?"scroll":"plain",pageIconSize:X,pageIconColor:Y,pageIconInactiveColor:S,pageTextStyle:ve({},G),data:r,icon:W,itemGap:L,pageButtonGap:20,itemHeight:w,padding:8,orient:T,left:B,top:N,textStyle:ve(ve({},A),{},{fontStyle:"normal",lineHeight:D})},tooltip:{show:U,triggerOn:J,position:K,backgroundColor:ee,borderColor:I.borderColor,borderWidth:I.borderWidth,padding:[R,$],formatter:function(e){var t,a=be(H,"series[".concat(e.seriesIndex,"].pieData.value"));if("mouseoutSeries"!==e.seriesName&&a)return t=e.seriesName,e=e.color,'\n                <div>\n                  <div\n                    style="\n                      font-size: '.concat(P.fontSize,"px;\n                      line-height: ").concat(P.fontSize,"px;\n                      color: ").concat(P.color,";\n                      font-weight: ").concat(P.fontWeight,";\n                      font-family: ").concat(P.fontFamily,";\n                      margin-bottom: ").concat(Z,'px;\n                    "\n                  >').concat(t,'</div>\n                  <div>\n                    <span style="\n                      display: inline-block; margin-right: 5px; border-radius: 10px; width: 10px; height: 10px; background-color: ').concat(e,';\n                    "></span>\n                    <span\n                      style="\n                        font-size: ').concat(C.fontSize,"px;\n                        line-height: ").concat(C.fontSize,"px;\n                        color: ").concat(C.color,";\n                        font-weight: ").concat(C.fontWeight,";\n                        font-family: ").concat(C.fontFamily,';\n                      "\n                    >').concat(a,"</span>\n                  </div>\n                </div>\n              ")}},xAxis3D:{min:-1,max:1},yAxis3D:{min:-1,max:1},zAxis3D:{min:-1,max:1},grid3D:ve(ve({show:!1,boxHeight:p,postEffect:{enable:ie,bloom:{enable:ne,bloomIntensity:O},depthOfField:{enable:oe,fstop:se,blurRadius:k}}},v),{},{viewControl:ve({projection:d,autoRotate:V,autoRotateDirection:q,autoRotateSpeed:x,rotateSensitivity:te?1:0,zoomSensitivity:M?1:0,distance:h},b)}),series:n};return H},getLabelFormatter:function(e,t){var a=this.config.options.chart.label,i=a.labelForm.labelMode,n=a.labelContent,o=a.describe,s=a.decimal,a=a.valueFormat,s=(100*this.getPiePercent(t)).toFixed(s);return"init"===i?(i=P({v:t,type:"linear",format:a,prefix:"",suffix:""}),"name"===n?e:"value"===n?i:"name + value"===n?("br"===o?"".concat(e,"\n"):"".concat(e).concat(o)).concat(i):be(w(this._data,{name:e}),n,"")):"name"===n?e:("value"===n?"":"br"===o?"".concat(e,"\n"):"".concat(e).concat(o)).concat(s,"%")},resize:function(e,t){this.chart.resize({width:e,height:t})},data:function(e){return e&&(this.__data=e),this._data=c(this.__data),!(d(this._data,"value")<=0)&&(x(this._data)&&this._data.filter(function(e){return C(e.name)&&C(e.value)}).map(function(e){return e.value&&(e.value=y(e.value)),u(e.name)&&(e.name=e.name+""),e}))},mergeConfig:function(e){return e&&(0===Object.keys(this.config).length?this.config=e:(this.config.theme=D(e.theme||{},this.config.theme),be(e,"options.chart.series")&&m(this.config,"options.chart.series",be(e,"options.chart.series")),be(e,"options.chart.fill.scale.range")&&m(this.config,"options.chart.fill.scale.range",be(e,"options.chart.fill.scale.range")),this.config=D(e||{},this.config))),this.config},getThemableConfig:function(e){var t,a,i,n,o;return e?(t=e.textColor,a=e.axisColor,i=e.palette,e=e.bgColor,n="",o={label:{textStyle:{color:a}},title:{textStyle:{color:a}},axisLine:{line:{lineColor:a}},tickLine:{line:{lineColor:a}},grid:{line:{lineColor:a}}},{options:{chart:{fill:{fixed:{type:"flat",value:n=i&&0<i.length?i[S(i.length/2)]:n},scale:{range:b(be(this.config,"options.chart.fill.scale.range"),function(e,t){return i[t]||i[t%i.length]})}},label:{textStyle:{color:t}}},axis:{xaxis:o,yaxis:o},tooltip:{titleTextStyle:{color:t},contentTextStyle:{color:t},bgBox:{backgroundColor:e,border:{borderColor:e}}},legend:{textStyle:{color:a}}}}):null},updateStyle:function(){this.config},clear:function(){this.chart&&this.chart.clear&&this.chart.clear()},destroy:function(){this.chart&&this.chart.dispose&&this.chart.dispose(),this.chart=null,this.container&&(this.container.innerHTML="")}}),e.exports});