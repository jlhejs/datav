// env=undefined => env=publish 
Cube("datav:/com/datavmap-canvas2d-china-border/0.0.13/src/libs/geojson-bbox",[],function(a){function b(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function c(a){var d;return"Point"==a.type?d=[a.coordinates]:"LineString"==a.type||"MultiPoint"==a.type?d=a.coordinates:"Polygon"==a.type||"MultiLineString"==a.type?d=a.coordinates.reduce(function(a,c){return a.push.apply(a,b(c)),a},[]):"MultiPolygon"==a.type?d=a.coordinates.reduce(function(a,c){return a.push.apply(a,b(c.reduce(function(a,c){return a.push.apply(a,b(c)),a},[]))),a},[]):"Feature"==a.type?d=c(a.geometry):"GeometryCollection"==a.type?d=a.geometries.reduce(function(a,d){return a.push.apply(a,b(c(d))),a},[]):"FeatureCollection"==a.type&&(d=a.features.reduce(function(a,d){return a.push.apply(a,b(c(d))),a},[])),d}return a.exports=function(a){var b;if(a.hasOwnProperty("type"))return b=c(a),b.reduce(function(a,b){return[Math.min(b[0],a[0]),Math.min(b[1],a[1]),Math.max(b[0],a[2]),Math.max(b[1],a[3])]},[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY])},a.exports});;
Cube("datav:/com/datavmap-canvas2d-china-border/0.0.13/defaultData/provincialCapital.js",[],function(a){return a.exports=[{lat:39.90403,lng:116.407526,type:"left",name:"\u5317\u4EAC",adcode:"110000",isCapital:!0},{lat:37.87046,lng:112.549717,name:"\u592A\u539F",type:"left",adcode:"140000"},{lat:36.617042,lng:101.778112,name:"\u897F\u5B81",type:"left",adcode:"630000"},{lat:31.82057,lng:117.227308,name:"\u5408\u80A5",type:"left",adcode:"340000"},{lat:22.198951,lng:113.54909,name:"\u6FB3\u95E8",type:"left",adcode:"820000"},{lat:26.075302,lng:119.306239,name:"\u798F\u5DDE",type:"left",adcode:"350000"},{lat:39.085294,lng:117.201538,name:"\u5929\u6D25",type:"right",adcode:"120000"},{lat:38.042225,lng:114.514793,name:"\u77F3\u5BB6\u5E84",type:"right",adcode:"130000"},{lat:40.842723,lng:111.748426,name:"\u547C\u548C\u6D69\u7279",type:"right",adcode:"150000"},{lat:41.677287,lng:123.465009,name:"\u6C88\u9633",type:"right",adcode:"210000"},{lat:43.817001,lng:125.323628,name:"\u957F\u6625",type:"right",adcode:"220000"},{lat:45.803131,lng:126.535319,name:"\u54C8\u5C14\u6EE8",type:"right",adcode:"230000"},{lat:31.230378,lng:121.473658,name:"\u4E0A\u6D77",type:"right",adcode:"310000"},{lat:32.059352,lng:118.796623,name:"\u5357\u4EAC",type:"right",adcode:"320000"},{lat:30.287459,lng:120.153576,name:"\u676D\u5DDE",type:"right",adcode:"330000"},{lat:28.676493,lng:115.892151,name:"\u5357\u660C",type:"right",adcode:"360000"},{lat:36.6512,lng:117.120098,name:"\u6D4E\u5357",type:"right",adcode:"370000"},{lat:34.745795,lng:113.658097,name:"\u90D1\u5DDE",type:"right",adcode:"410000"},{lat:30.592935,lng:114.305215,name:"\u6B66\u6C49",type:"right",adcode:"420000"},{lat:28.19409,lng:112.982279,name:"\u957F\u6C99",type:"right",adcode:"430000"},{lat:23.125178,lng:113.280637,name:"\u5E7F\u5DDE",type:"right",adcode:"440000"},{lat:22.817746,lng:108.36637,name:"\u5357\u5B81",type:"right",adcode:"450000"},{lat:20.044412,lng:110.198286,name:"\u6D77\u53E3",type:"right",adcode:"460000"},{lat:29.563761,lng:106.550464,name:"\u91CD\u5E86",type:"right",adcode:"500000"},{lat:30.573095,lng:104.066143,name:"\u6210\u90FD",type:"right",adcode:"510000"},{lat:26.647661,lng:106.630153,name:"\u8D35\u9633",type:"right",adcode:"520000"},{lat:24.881539,lng:102.833722,name:"\u6606\u660E",type:"right",adcode:"530000"},{lat:29.653482,lng:91.171961,name:"\u62C9\u8428",type:"right",adcode:"540000"},{lat:34.343147,lng:108.939621,name:"\u897F\u5B89",type:"right",adcode:"610000"},{lat:36.06081,lng:103.834249,name:"\u5170\u5DDE",type:"right",adcode:"620000"},{lat:38.487193,lng:106.230909,name:"\u94F6\u5DDD",type:"right",adcode:"640000"},{lat:43.82539,lng:87.616842,name:"\u4E4C\u9C81\u6728\u9F50",type:"right",adcode:"650000"},{lat:25.044332,lng:121.509062,name:"\u53F0\u5317",type:"right",adcode:"710000"},{lat:22.320048,lng:114.173355,name:"\u9999\u6E2F",type:"right",adcode:"810000"},{name:"\u6D77\u5357\u5C9B",lng:109.820432,lat:19.317867,offset:{x:0,y:8},isIslands:!0},{name:"\u53F0\u6E7E\u5C9B",lng:120.945351,lat:23.815415,offset:{x:0,y:0},isIslands:!0},{name:"\u9493\u9C7C\u5C9B",lng:123.475139,lat:25.742234,type:"left",offset:{x:-5,y:0},isIslands:!0},{name:"\u8D64\u5C3E\u5C7F",lng:124.562104,lat:25.919135,offset:{x:0,y:-8},isIslands:!0},{name:"\u4E1C\u6C99\u7FA4\u5C9B",lng:116.001504,lat:21.104913,offset:{x:20,y:16},isIslands:!0},{name:"\u897F\u6C99\u7FA4\u5C9B",lng:112.032693,lat:16.786046,offset:{x:0,y:-10},isIslands:!0},{name:"\u4E2D\u6C99\u7FA4\u5C9B",lng:114.49363,lat:16.122257,type:"center",offset:{x:10,y:-6},isIslands:!0},{name:"\u6C38\u5174\u5C9B",lng:112.23594,lat:15.723436,offset:{x:0,y:4},isIslands:!0},{name:"\u9EC4\u5CA9\u5C9B",lng:117.848817,lat:15.151669,type:"left",offset:{x:4,y:10},isIslands:!0},{name:"\u5357\u6C99\u7FA4\u5C9B",lng:114.427712,lat:9.592533,offset:{x:0,y:0},isIslands:!0},{name:"\u66FE\u6BCD\u6697\u6C99",lng:111.659158,lat:4.785638,offset:{x:0,y:0},isIslands:!0}],a.exports});;
Cube("datav:/com/datavmap-canvas2d-china-border/0.0.13/src/minMap",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1","datav:/npm/geojson-flatten/1.0.1"],function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"===typeof b||"function"===typeof b)?b:a}function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c("datav:/npm/eventemitter3/3.0.0"),i=c("datav:/npm/safely-merge/1.0.1"),k=c("datav:/npm/geojson-flatten/1.0.1"),j=c("datav:/com/datavmap-canvas2d-china-border/0.0.13/src/libs/geojson-bbox"),l={type:"FeatureCollection",features:[{type:"Feature",properties:{stroke:"#555555","stroke-width":2,"stroke-opacity":1,fill:"#555555","fill-opacity":0.5},geometry:{type:"Polygon",coordinates:[[[107.1826171875,2.767477951092084],[123.1787109375,2.767477951092084],[123.1787109375,24.647017162630366],[107.1826171875,24.647017162630366],[107.1826171875,2.767477951092084]]]}}]},m=190,n=270,o=c("datav:/com/datavmap-canvas2d-china-border/0.0.13/defaultData/provincialCapital.js"),p=function(a){function b(a,c){d(this,b);var f=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return f.options=i({},c),f.options.minZoom=c.zoomRange[0],f.options.maxZoom=c.zoomRange[1],f.options.visibility=!0,f.map=a,f.mappingDataMap={},f.init(),f}return f(b,a),g(b,[{key:"init",value:function(){var a=this.options.minMap,b=a.show,c=a.marginRight,d=a.marginBottom,e=a.ctxScale,f=m*e,g=n*e;this.container=document.createElement("canvas"),this.container.width=f,this.container.height=g,this.container.style.width=f+"px",this.container.style.height=g+"px",this.container.style.marginRight=-10+c+"px",this.container.style.marginBottom=d+"px",this.map._container.querySelector("div.leaflet-bottom.leaflet-right").appendChild(this.container);var h=this.ctx=this.container.getContext("2d");h.scale(e,e);var i=this.map.getZoom();if(b&&i>=this.options.zoomRange[0]&&i<=this.options.zoomRange[1]){this.container.style.marginRight=-10+c+"px",this.container.style.marginBottom=d+"px";var j=1,k=this.ctx;k.scale(j,j),this.genGeojson()}else this.hide()}},{key:"renderArea",value:function(a){this.geojson_area=a,this.genGeojson()}},{key:"renderBorder",value:function(a){this.geojson_border=a,this.genGeojson()}},{key:"setMappingData",value:function(a){this.mappingDataMap=a,this.genGeojson()}},{key:"genGeojson",value:function(){var a=this,b=a.ctx,c=a.geojson_area,d=a.geojson_border,e=this.options.minMap,f=e.oceanColor,g=e.borderColor,h=e.borderWeight,i=this.container,k=i.width,p=i.height;b.beginPath(),b.rect(0,0,m,n),b.fillStyle=f,b.fill(),b.lineJoin="round",b.lineCap="round",b.shadowColor=null,b.shadowBlur=null;var q=j(l),r=this.map.project([q[1],q[0]],4),s=this.map.project([q[3],q[2]],4),t={x:Math.min(r.x,s.x),y:Math.min(r.y,s.y)};c&&a.drawLandBackground(b,c,t),c&&a.drawArea(b,c,t),d&&a.drawBorder(b,d,t),this.options.labelStyle.show&&o&&a.drawLabels(b,t),b.beginPath(),b.rect(0,0,m,n),b.lineWidth=2*h,b.strokeStyle=g,b.stroke()}},{key:"drawLandBackground",value:function(a,b,c){if(b&&b.features&&b.features.length)for(var d=this.options.minMap.landColor,e={fillColor:d},f=0;f<b.features.length;f++){for(var g=b.features[f].properties,h=g.adcode,i=k(b.features[f]),l=void 0,o=void 0,q=void 0,r=[],s=0;s<i.length;s++)switch(l=i[s],o=l.geometry,q=o.coordinates,o.type){case"Polygon":for(var j=0;j<q.length;j++)pointsProjected=this.pointsProject(q[j],c),3<=pointsProjected.length&&r.push(pointsProjected);a.beginPath();var t=void 0,m=void 0,n=void 0;for(t=0;t<r.length;t++){for(m=0;m<r[t].length;m++)n=r[t][m],a[m?"lineTo":"moveTo"](n[0],n[1]);a.closePath()}break;default:}a.fillStyle=e.fillColor,a.fill()}}},{key:"drawArea",value:function(a,b,c){if(b&&b.features&&b.features.length)for(var d=this.options.fill,e=0;e<b.features.length;e++){for(var f=b.features[e].properties,g=f.adcode,h={fillColor:d.fillColor||"rgba(2, 111, 222, 0)"},i=k(b.features[e]),l=void 0,o=void 0,q=void 0,r=[],s=0;s<i.length;s++)switch(l=i[s],o=l.geometry,q=o.coordinates,o.type){case"Polygon":for(var j=0;j<q.length;j++)pointsProjected=this.pointsProject(q[j],c),3<=pointsProjected.length&&r.push(pointsProjected);a.beginPath();var t=void 0,m=void 0,n=void 0;for(t=0;t<r.length;t++){for(m=0;m<r[t].length;m++)n=r[t][m],a[m?"lineTo":"moveTo"](n[0],n[1]);a.closePath()}break;default:}g&&this.mappingDataMap[g]&&this.mappingDataMap[g].fillColor&&(h.fillColor=this.mappingDataMap[g].fillColor),a.fillStyle=h.fillColor,a.fill()}}},{key:"drawBorder",value:function(a,b,c){var d=this.options.lineStyle,e=d.guojieColor,f=d.guojieWeight,g=d.shengjieColor,h=d.shengjieWeight,l=d.haianxianColor,n=d.haianxianWeight;if(b&&b.features&&b.features.length)for(var o=0;o<b.features.length;o++){var i=k(b.features[o]),p=void 0,q=void 0,r=void 0,s=[],t=b.features[o].properties,u=t.id||t.adcode,v={strokeColor:"rgba(255,255,255,0.3)",weight:1,dashArray:""};switch(u){case 1:v={strokeColor:e,weight:f,dashArray:"4, 8"};break;case 2:v={strokeColor:l,weight:n,dashArray:""};break;case 3:v={strokeColor:g,weight:h,dashArray:""};break;case 4:v={strokeColor:g,weight:h,dashArray:"10,4,4,4"};break;case 5:v={strokeColor:e,weight:f,dashArray:""};break;default:}a.beginPath();for(var w=0;w<i.length;w++)if(p=i[w],q=p.geometry,r=q.coordinates,0!==r.length)switch(q.type){case"LineString":if(pointsProjected=this.pointsProject(r,c),2<=pointsProjected.length&&(s=pointsProjected),s&&1<s.length&&0<v.weight){a.moveTo(s[0][0],s[0][1]);for(var j=1;j<s.length;j++)a.lineTo(s[j][0],s[j][1])}break;default:}if(a.strokeStyle=v.strokeColor,a.lineWidth=v.weight,a.setLineDash){var m=this.getDashArray(v)||[];a.setLineDash(m)}a.stroke()}}},{key:"drawLabels",value:function(a,b){var c=this.options.labelStyle,e=c.iconColor,f=c.textStyle,g=f.fontFamily,h=f.fontSize,j=f.color,k=f.fontWeight,l=f.shadowColor,m=f.shadowBlur;a.textAlign="center",a.fillStyle=e,a.strokeStyle=e,a.lineWidth=0.5;for(var n,d=0;d<o.length;d++)if(n=o[d],!n.isCapital&&!n.isIslands){var i=this.map.project([n.lat,n.lng],4);a.beginPath(),a.arc(i.x-b.x,i.y-b.y,1.5,0,2*Math.PI),a.fill(),a.beginPath(),a.arc(i.x-b.x,i.y-b.y,4,0,2*Math.PI),a.stroke()}a.textBaseline="middle",a.font=""+k+" "+10+"px "+g,a.fillStyle=j,a.shadowColor=l,a.shadowBlur=m;for(var p=0;p<o.length;p++){var q=o[p],r=this.map.project([q.lat,q.lng],4);switch(q.offset=q.offset?q.offset:{x:0,y:0},q.type){case"left":a.textAlign="right",q.isIslands||(q.offset.x=-8);break;case"right":a.textAlign="left",q.offset.x=8;break;default:a.textAlign="center",q.offset.x=0;}a.fillText(q.name,r.x-b.x+q.offset.x,r.y-b.y+q.offset.y)}}},{key:"getDashArray",value:function(a){if(""===a.dashArray)e=[];else if("string"===typeof a.dashArray){var b,c,d=a.dashArray.split(/[, ]+/),e=[];for(c=0;c<d.length;c++){if(b=+d[c],isNaN(b))return;e.push(b)}}else e=a.dashArray||[];return e}},{key:"pointsProject",value:function(a,b){var c=[],e=void 0,f=void 0;for(e=0;f=a.length,e<f;e++){var g=a[e];if((g[0]||0==g[0])&&(g[1]||0==g[1])){var d=this.map.project([g[1],g[0]],4);c.push(d)}}var h=this.options.smoothFactor,i=[];if(c.length)for(var k=this.map.L.LineUtil.simplify(c,0.5),l=0;l<k.length;l++)i.push([k[l].x-b.x,k[l].y-b.y]);return i}},{key:"getDashArray",value:function(a){if("string"===typeof a.dashArray){var b,c,d=a.dashArray.split(/[, ]+/),e=[];for(c=0;c<d.length;c++){if(b=+d[c],isNaN(b))return;e.push(b)}}else e=a.dashArray||[];return e}},{key:"updateOptions",value:function(a){this.options=i(this.options,a);var b=this.options.minMap,c=b.show,d=b.marginRight,e=b.marginBottom,f=b.ctxScale,g=this.map.getZoom();if(c&&g>=this.options.zoomRange[0]&&g<=this.options.zoomRange[1]){var h=m*f,j=n*f;this.container.width=h,this.container.height=j,this.container.style.width=h+"px",this.container.style.height=j+"px",this.container.style.marginRight=-10+d+"px",this.container.style.marginBottom=e+"px",this.container&&this.container.style&&(this.container.style.display="block");var k=this.ctx;k.scale(f,f),this.genGeojson()}else this.hide()}},{key:"show",value:function(){var a=this.options.minMap.show;a&&this.container&&this.container.style&&(this.container.style.display="block")}},{key:"hide",value:function(){this.container&&this.container.style&&(this.container.style.display="none")}},{key:"destroy",value:function(){this.ctx=null,this.container.remove(),this.container=null,this.data=null,this.options=null,this.style=null}}]),b}(h);return a.exports=p,a.exports});;
Cube("datav:/com/datavmap-canvas2d-china-border/0.0.13/src/layer",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1","datav:/npm/geojson-flatten/1.0.1"],function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"===typeof b||"function"===typeof b)?b:a}function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c("datav:/npm/eventemitter3/3.0.0"),i=c("datav:/npm/safely-merge/1.0.1"),k=c("datav:/npm/geojson-flatten/1.0.1"),l=c("datav:/com/datavmap-canvas2d-china-border/0.0.13/defaultData/provincialCapital.js"),j=function(a){function b(a,c){d(this,b);var f=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return f.options=i({tolerance:3,smoothFactor:1,zoomRange:[0,20],minZoom:0,maxZoom:22},c),f.options.minZoom=c.zoomRange[0],f.options.maxZoom=c.zoomRange[1],f.options.visibility=!0,f.map=a,f.init(),f}return f(b,a),g(b,[{key:"init",value:function(){this.container=document.createElement("canvas");var a=this.padding=this.map.canvasLayer&&this.map.canvasLayer.options&&this.map.canvasLayer.options.padding?this.map.canvasLayer.options.padding:0.1,b=this.map.getSize();this.offset=b.multiplyBy(-a).round();var c=b.x-2*this.offset.x,d=b.y-2*this.offset.y,e=this.map.devicePixelRatio||1;this.container.width=c*e,this.container.height=d*e,this.container.style.width=c+"px",this.container.style.height=d+"px",this.ctx=this.container.getContext("2d"),this.ctx.scale(e,e),this.geojson_area=null,this.geojson_border=null,this.mappingDataMap={}}},{key:"onRender",value:function(){this.genGeojson()}},{key:"onResize",value:function(a,b){var c=this.map.devicePixelRatio||1;this.container.width=a*c,this.container.height=b*c,this.container.style.width=a+"px",this.container.style.height=b+"px",this.ctx.scale(c,c)}},{key:"renderArea",value:function(a){this.geojson_area=a,this.genGeojson()}},{key:"renderBorder",value:function(a){this.geojson_border=a,this.genGeojson()}},{key:"setMappingData",value:function(a){this.mappingDataMap=a,this.genGeojson()}},{key:"updateOptions",value:function(a){this.options=i(this.options,a),this.options.minZoom=a.zoomRange[0],this.options.maxZoom=a.zoomRange[1],this.genGeojson()}},{key:"genGeojson",value:function(){var a=this,b=a.ctx,c=a.geojson_area,d=a.geojson_border;b.clearRect(0,0,this.container.width,this.container.height),b.lineJoin="round",b.lineCap="round",b.shadowColor=null,b.shadowBlur=null,c&&a.drawArea(b,c),d&&a.drawBorder(b,d),this.options.labelStyle.show&&l&&a.drawLabels(b)}},{key:"drawArea",value:function(a,b){if(b&&b.features&&b.features.length)for(var c=this.options.fill,d=0;d<b.features.length;d++){for(var e=b.features[d].properties,f=e.adcode,g={fillColor:c.fillColor||"rgba(2, 111, 222, 0)"},h=k(b.features[d]),i=void 0,l=void 0,o=void 0,q=[],r=0;r<h.length;r++)switch(i=h[r],l=i.geometry,o=l.coordinates,l.type){case"Polygon":for(var j=0;j<o.length;j++)pointsProjected=this.pointsProject(o[j]),3<=pointsProjected.length&&q.push(pointsProjected);a.beginPath();var s=void 0,m=void 0,n=void 0;for(s=0;s<q.length;s++){for(m=0;m<q[s].length;m++)n=q[s][m],a[m?"lineTo":"moveTo"](n[0],n[1]);a.closePath()}break;default:}f&&this.mappingDataMap[f]&&this.mappingDataMap[f].fillColor&&(g.fillColor=this.mappingDataMap[f].fillColor),a.fillStyle=g.fillColor,a.fill()}}},{key:"drawBorder",value:function(a,b){var c=this.options.lineStyle,d=c.guojieColor,e=c.guojieWeight,f=c.shengjieColor,g=c.shengjieWeight,h=c.haianxianColor,l=c.haianxianWeight;if(b&&b.features&&b.features.length)for(var n=0;n<b.features.length;n++){var i=k(b.features[n]),o=void 0,p=void 0,q=void 0,r=[],s=b.features[n].properties,t=s.id||s.adcode,u={strokeColor:"rgba(255,255,255,0.3)",weight:1,dashArray:""};switch(t){case 1:u={strokeColor:d,weight:e,dashArray:"4, 8"};break;case 2:u={strokeColor:h,weight:l,dashArray:""};break;case 3:u={strokeColor:f,weight:g,dashArray:""};break;case 4:u={strokeColor:f,weight:g,dashArray:"10,4,4,4"};break;case 5:u={strokeColor:d,weight:e,dashArray:""};break;default:}a.beginPath();for(var v=0;v<i.length;v++)if(o=i[v],p=o.geometry,q=p.coordinates,0!==q.length)switch(p.type){case"LineString":if(pointsProjected=this.pointsProject(q),2<=pointsProjected.length&&(r=pointsProjected),r&&1<r.length&&0<u.weight){a.moveTo(r[0][0],r[0][1]);for(var j=1;j<r.length;j++)a.lineTo(r[j][0],r[j][1])}break;default:}if(a.strokeStyle=u.strokeColor,a.lineWidth=u.weight,a.setLineDash){var m=this.getDashArray(u)||[];a.setLineDash(m)}a.stroke()}}},{key:"drawLabels",value:function(a){var b=this.options.labelStyle,c=b.iconColor,e=b.textStyle,f=e.fontFamily,g=e.fontSize,h=e.color,k=e.fontWeight,m=e.shadowColor,n=e.shadowBlur;a.textBaseline="middle",a.font="bolder "+1.3*g+"px "+f,a.textAlign="center",a.fillStyle="red",a.shadowColor="white",a.shadowBlur=1,a.beginPath();for(var o,d=0;d<l.length;d++)if(o=Object.assign({},l[d]),o.isCapital){for(var i=5,p=i,q=0.5*i,r=this.map.latLngToContainerPoint([+o.lat,+o.lng]),s=r.x-this.offset.x,t=r.y-this.offset.y,u=0,v=0;5>v;v++)a.lineTo(Math.cos((18+72*v-u)/180*Math.PI)*p+s,-Math.sin((18+72*v-u)/180*Math.PI)*p+t),a.lineTo(Math.cos((54+72*v-u)/180*Math.PI)*q+s,-Math.sin((54+72*v-u)/180*Math.PI)*q+t);switch(a.closePath(),a.fill(),o.offset=o.offset?o.offset:{x:0,y:0},o.type){case"left":a.textAlign="right",o.offset.x=-8;break;case"right":a.textAlign="left",o.offset.x=8;break;default:a.textAlign="center",o.offset.x=0;}a.fillText(o.name,r.x-this.offset.x+o.offset.x,r.y-this.offset.y+o.offset.y)}a.textAlign="center",a.fillStyle=c,a.strokeStyle=c,a.lineWidth=0.5,a.shadowColor=null,a.shadowBlur=null;for(var j,w=0;w<l.length;w++)if(j=l[w],!j.isCapital&&!j.isIslands){var x=this.map.latLngToContainerPoint([j.lat,j.lng]);a.beginPath(),a.arc(x.x-this.offset.x,x.y-this.offset.y,1.5,0,2*Math.PI),a.fill(),a.beginPath(),a.arc(x.x-this.offset.x,x.y-this.offset.y,4,0,2*Math.PI),a.stroke()}a.textBaseline="middle",a.font=""+k+" "+g+"px "+f,a.fillStyle=h,a.shadowColor=m,a.shadowBlur=n;for(var y,z=0;z<l.length;z++)if(y=l[z],!y.isCapital){var A=this.map.latLngToContainerPoint([y.lat,y.lng]);switch(y.offset=y.offset?y.offset:{x:0,y:0},y.type){case"left":a.textAlign="right",y.isIslands||(y.offset.x=-8);break;case"right":a.textAlign="left",y.offset.x=8;break;default:a.textAlign="center",y.offset.x=0;}a.fillText(y.name,A.x-this.offset.x+y.offset.x,A.y-this.offset.y+y.offset.y)}}},{key:"pointsProject",value:function(a){var b=[],c=void 0,e=void 0;for(c=0;e=a.length,c<e;c++){var f=a[c];if((f[0]||0==f[0])&&(f[1]||0==f[1])){var d=this.map.latLngToContainerPoint([f[1],f[0]]);b.push(d)}}var g=this.options.smoothFactor,h=[];if(b.length)for(var i=this.map.L.LineUtil.simplify(b,0.5),k=0;k<i.length;k++)h.push([i[k].x-this.offset.x,i[k].y-this.offset.y]);return h}},{key:"getDashArray",value:function(a){if(""===a.dashArray)e=[];else if("string"===typeof a.dashArray){var b,c,d=a.dashArray.split(/[, ]+/),e=[];for(c=0;c<d.length;c++){if(b=+d[c],isNaN(b))return;e.push(b)}}else e=a.dashArray||[];return e}},{key:"show",value:function(){this.options.visibility=!0,this.genGeojson()}},{key:"hide",value:function(){this.options.visibility=!1,this.ctx.clearRect(0,0,this.container.width,this.container.height)}},{key:"destroy",value:function(){this.geojson_area=null,this.geojson_border=null,this.mappingDataMap=null,delete this.options,this.ctx,this.container,this.geojson_area,this.geojson_border,this.mappingDataMap}}]),b}(h);return a.exports=j,a.exports});;
Cube("datav:/com/datavmap-canvas2d-china-border/0.0.13",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1","datav:/npm/chroma-js/1.3.3"],function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"===typeof b||"function"===typeof b)?b:a}function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c("datav:/npm/eventemitter3/3.0.0"),i=c("datav:/npm/safely-merge/1.0.1"),j=c("datav:/npm/chroma-js/1.3.3"),k=c("datav:/com/datavmap-canvas2d-china-border/0.0.13/src/layer"),l=c("datav:/com/datavmap-canvas2d-china-border/0.0.13/src/minMap"),m=function(a){function b(a,c){d(this,b);var f=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return f.options=i({renderer:"canvas"},c),f.options.minZoom=c.zoomRange[0],f.options.maxZoom=c.zoomRange[1],f.options.visibility=!0,f}return f(b,a),g(b,[{key:"addTo",value:function(a,b){return this.options.id=b,this.layer=new k(a,this.options),this.minMap=new l(a,this.options),this.renderArea(),this.renderBorder(),this}},{key:"renderArea",value:function(){var a=this;fetch(this.options.defaultArea).then(function(a){return a.json()}).then(function(b){a.layer&&a.layer.renderArea(b),a.minMap&&a.minMap.renderArea(b)})}},{key:"renderBorder",value:function(){var a=this;fetch(this.options.defaultBorder).then(function(a){return a.json()}).then(function(b){a.layer&&a.layer.renderBorder(b),a.minMap&&a.minMap.renderBorder(b)})}},{key:"setMappingData",value:function(a){this.mappingData=a||[],this.range=this.getRange();var b=this.options.fill;this.range&&(this.colorScale=j.scale([b.minFillColor,b.maxFillColor]).domain(this.range));var c,e,d,f={};for(c=0;c<a.length;c++)e=Object.assign({},a[c]),d=e.fillColor?e.fillColor:e.hasOwnProperty("value")&&this.range?e.value===this.range[0]?b.minFillColor:+e.value>this.range[0]?this.colorScale(+e.value).css():b.fillColor:b.fillColor,f[e.area_id]=e,f[e.area_id].fillColor=d;this.layer&&this.layer.setMappingData&&this.layer.setMappingData(f),this.minMap&&this.minMap.setMappingData&&this.minMap.setMappingData(f)}},{key:"getRange",value:function(){if(!this.mappingData.length)return null;var a=this.mappingData.filter(function(a){return void 0!=a.value&&!isNaN(+a.value)&&""!==a.value}),b=a.reduce(function(c,a){return+c.value<=+a.value?c:a},{}),c=a.reduce(function(c,a){return+c.value>=+a.value?c:a},{});return[+b.value,+c.value]}},{key:"onRender",value:function(){this.layer&&this.layer.onRender&&this.layer.onRender()}},{key:"onResize",value:function(a,b){this.layer&&this.layer.onResize&&this.layer.onResize(a,b)}},{key:"updateOptions",value:function(a){this.options=i(this.options,a),this.options.minZoom=a.zoomRange[0],this.options.maxZoom=a.zoomRange[1],this.setMappingData(this.mappingData||[]),this.layer&&this.layer.updateOptions&&this.layer.updateOptions(this.options),this.minMap&&this.minMap.updateOptions&&this.minMap.updateOptions(this.options)}},{key:"show",value:function(){this.options.visibility=!0,this.layer&&this.layer.show&&this.layer.show(),this.minMap&&this.minMap.show&&this.minMap.show()}},{key:"hide",value:function(){this.options.visibility=!1,this.layer&&this.layer.hide&&this.layer.hide(),this.minMap&&this.minMap.hide&&this.minMap.hide()}},{key:"destroy",value:function(){this.layer&&this.layer.destroy&&this.layer.destroy(),this.layer=null,this.minMap&&this.minMap.destroy&&this.minMap.destroy(),this.minMap=null,delete this.layer,this.minMap}}]),b}(h);return a.exports=m,a.exports});