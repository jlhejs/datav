// env=undefined => env=publish 
Cube("datav:/com/datav-2dmap/3.0.70/src/layer/draw/draw",[],function(e,l,t,i,n,r){function s(e){var l=[];if(""!==e)if("string"==typeof e)for(var t,i=e.split(/[, ]+/),n=0;n<i.length;n++){if(t=Number(i[n]),isNaN(t))return;l.push(t)}else l=e||[];return l}return e.exports={drawCircle:function(e,l,t){},drawLine:function(e,l,t){if(l&&0!==l.length&&1!==l.length&&t.weight){var i;e.beginPath(),e.setLineDash&&(i=s(t.dashArray),e.setLineDash(i)),e.moveTo(l[0][0],l[0][1]);for(var n=1;n<l.length;n++)e.lineTo(l[n][0],l[n][1]);t.strokeColor&&(e.strokeStyle=t.strokeColor),e.lineWidth=t.weight,e.lineJoin=t.lineJoin||"round",e.lineCap=t.lineCap||"round",e.stroke()}},drawPolygon:function(e,l,t){if(l&&0!==l.length){var i,n,r,o,a;for(e.beginPath(),i=0;i<l.length;i++){for(n=0;n<l[i].length;n++)r=l[i][n],e[n?"lineTo":"moveTo"](r[0],r[1]);e.closePath()}o=e,(t=t).fill&&(o.fillStyle=t.fillColor||t.color,o.fill(t.fillRule||"evenodd")),t.fillPatten&&(a=o.createPattern(t.fillPatten,"repeat"),o.fillStyle=a,o.fill(t.fillRule||"evenodd")),t.stroke&&0!==t.weight&&(o.setLineDash&&(a=s(t.dashArray)||[],o.setLineDash(a)),o.lineWidth=t.weight,o.strokeStyle=t.strokeColor,o.lineCap=t.lineCap,o.lineJoin=t.lineJoin,o.stroke())}}},e.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/layer/GeoJsonFactory",[],function(t,e,r,o,i,n){function a(t,e){for(var o=0;o<e.length;o++){var i=e[o];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}return t.exports=function(t){var e,o,Y=t.map,l=t.L,t=r("datav:/com/datav-2dmap/3.0.70/src/utils"),c=t.Chroma,i=t.RBush,s=t.geojsonBBox,g=t.polylabel,w=t.mergeOptions,_=t.measureText,d=t.getDashArray,S=t.resizeCanvas,f=Y.options.offset,t=r("datav:/com/datav-2dmap/3.0.70/src/layer/draw/draw"),b=(t.drawCirle,t.drawLine),P=t.drawPolygon;function m(t){for(var e=0,o=0;o<t.length;o++)for(var i=t[o],n=0,r=i.length,a=r-1;n<r;a=n++)e+=(i[n][0]-i[a][0])*(i[n][1]+i[a][1])*(o?-1:1);return Math.abs(e)/2}function p(t,e){return t.offset-e.offset}return CanvasRenderingContext2D.prototype.roundRect=function(t,e,o,i,n){var r=n.border,a=n.borderRadius,n=n.background,a={topRight:a.topRight>o||a.topRight>i?Math.min(o,i):a.topRight,bottomRight:a.bottomRight>o||a.bottomRight>i?Math.min(o,i):a.bottomRight,bottomLeft:a.bottomLeft>o||a.bottomLeft>i?Math.min(o,i):a.bottomLeft,topLeft:a.topLeft>o||a.topLeft>i?Math.min(o,i):a.topLeft},s=a.topLeft,h=a.topRight,l=a.bottomLeft,a=a.bottomRight;if(t+=r.weight/2,e+=r.weight/2,this.beginPath(),this.moveTo(t+s,e),this.arcTo(t+o,e,t+o,e+i,h),this.arcTo(t+o,e+i,t,e+i,a),this.arcTo(t,e+i,t,e,l),this.arcTo(t,e,t+o,e,s),this.closePath(),"linearGradient"===n.type){for(var u,h=n.value,a=h.angle,g=h.stops.sort(p),l=[o/2+Math.cos((a+180)/180*Math.PI)*o/2,i/2+Math.sin((a+180)/180*Math.PI)*i/2],t=[o/2+Math.cos(a/180*Math.PI)*o/2,i/2+Math.sin(a/180*Math.PI)*i/2],c=this.createLinearGradient(l[0],l[1],t[0],t[1]),f=0;f<g.length;f++)u=g[f],c.addColorStop(u.offset/100,u.color);this.fillStyle=c}else"flat"==n.type&&(this.fillStyle=n.value||"rgba(255,255,0,0.1)");return this.fill(),0<r.weight&&(this.lineWidth=r.weight,this.strokeStyle=r.color,this.setLineDash&&(e=d(r.dashArray),this.setLineDash(e)),this.stroke()),this},t=n,(e=[{key:"setData",value:function(t){for(var e,o,i=t.features,n=[],r=0,a=i.length;r<a;r++)e=i[r],o=s(e),n.push({minX:o[0],minY:o[1],maxX:o[2],maxY:o[3],feature:e});this.rbush.dirty=n.length,this.rbush.total=n.length,this.rbush.clear(),0<n.length&&this.rbush.load(n)}},{key:"setOptions",value:function(t){this.options.mappingStyle={},this.options=w(this.options,t);var l,u,h=[];for(l in this.options.mappingStyle)(u=this.options.mappingStyle[l]).textureShape&&h.push(u.textureShape);var h=function(t){for(var e,o,i={},n=[],r=t.length,a=0;a<r;a++)o=y(e=t[a]),i[e]?i[e].indexOf(o)<0&&(i[e].push(o),n.push(e)):(i[e]=[o],n.push(e));return n}(h),g=this;new Promise(function(e,o){for(var t,i=[],r=h.length,a=0,s=0;s<r;s++)!function(){var n=h[s];t=new Promise(function(o,t){var i;g.textureImageUrls[n]?o(!0):((i=new Image).crossOrigin="anonymous",i.onload=function(){var t=document.createElement("canvas"),e=t.getContext("2d");t.width=i.width,t.height=i.height,e.imageSmoothingQuality="high",e.drawImage(i,0,0,i.width,i.height),g.textureImageUrls[n]={canvas:t,colorCanvas:{}},o(!0)},i.onerror=function(){t(new Error("Could not load image at ".concat(n)))},i.src=n)}),i.push(t),Promise.all(i).then(function(t){++a==r&&e(!0)}).catch(function(t){++a==r&&o(!1)})}()}).then(function(t){if(t){for(l in g.options.mappingStyle)if(u=g.options.mappingStyle[l],g.textureImageUrls[u.textureShape]){var e=g.textureImageUrls[u.textureShape],o=e.canvas,e=e.colorCanvas;if(!e[u.textureColor]){for(var i=document.createElement("canvas"),n=(i.width=o.width,i.height=o.height,i.getContext("2d")),r=o.getContext("2d").getImageData(0,0,o.width,o.height),a=r.data,s=c(u.textureColor).rgba(),h=0;h<o.width*o.height;h++)(0<a[4*h+0]||0<a[4*h+1]||0<a[4*h+2]||0<a[4*h+3])&&(a[4*h+0]=s[0],a[4*h+1]=s[1],a[4*h+2]=s[2],a[4*h+3]=a[4*h+3]*s[3]);n.putImageData(r,0,0,0,0,o.width,o.height),e[u.textureColor]=i}}g.layer.onRender()}}).catch(function(t){})}},{key:"onRender",value:function(t,e){e&&(this.getFeaturesInBounds(),this.getFeatures()),this.draw(t)}},{key:"draw",value:function(t){var e,o,h,i=this.options,n=i.interaction,r=i.label,a=i.style,s=i.mappingStyle,l=this,u=l.features;if(n.graph.show&&n.graph.hoverStyle.show)for(e=0;e<u.length;e++)if(g=u[e],Y.featureSelect&&Y.featureSelect.geometry.coordinates===g.geometry.coordinates){u.push(u.splice(e,1)[0]);break}for(e=0;e<u.length;e++){var g,c,f=(g=u[e]).geometry,d=f.type,m=f._coordinates,p=void 0,y=void 0,x=void 0;switch(d){case"Point":case"MultiPoint":case"Circle":break;case"LineString":p=g.properties.data_index,x=n.graph.show&&n.graph.hoverStyle.show&&Y.featureSelect&&Y.featureSelect.geometry.coordinates==g.geometry.coordinates?n.graph.hoverStyle:p&&s[p]?w(a,s[p]):a,b(t,m,x);break;case"MultiLineString":for(p=g.properties.data_index,x=n.graph.show&&n.graph.hoverStyle.show&&Y.featureSelect&&Y.featureSelect.geometry.coordinates==g.geometry.coordinates?n.graph.hoverStyle:p&&s[p]?w(a,s[p]):a,o=0;o<m.length;o++)b(t,m[o],x);break;case"Polygon":var v,y=g.properties.adcode,x=n.graph.show&&n.graph.hoverStyle.show&&Y.featureSelect&&Y.featureSelect.geometry.coordinates==g.geometry.coordinates?n.graph.hoverStyle:y&&s[y]?w(a,s[y]):a;y&&s[y]&&(x.textureSize=s[y].textureSize,x.textureShape=s[y].textureShape,x.textureColor=s[y].textureColor),x.textureShape&&x.textureColor&&l.textureImageUrls&&l.textureImageUrls[x.textureShape]&&l.textureImageUrls[x.textureShape].colorCanvas[x.textureColor]?(v=l.textureImageUrls[x.textureShape].colorCanvas[x.textureColor],v=S(v,x.textureSize.width,x.textureSize.height),x.fillPatten=v):x.fillPatten=null,P(t,m,x);break;case"MultiPolygon":for(y=g.properties.adcode,x=n.graph.show&&n.graph.hoverStyle.show&&Y.featureSelect&&Y.featureSelect.geometry.coordinates==g.geometry.coordinates?n.graph.hoverStyle:y&&s[y]?w(a,s[y]):a,y&&s[y]&&(x.textureSize=s[y].textureSize,x.textureShape=s[y].textureShape,x.textureColor=s[y].textureColor),x.textureShape&&x.textureColor&&l.textureImageUrls&&l.textureImageUrls[x.textureShape]&&l.textureImageUrls[x.textureShape].colorCanvas[x.textureColor]?(v=l.textureImageUrls[x.textureShape].colorCanvas[x.textureColor],c=S(v,x.textureSize.width,x.textureSize.height),x.fillPatten=c):x.fillPatten=null,o=0;o<m.length;o++)P(t,m[o],x)}}r.isShow&&("vector"===r.backgroundStyle.backgroundType||l.imageUrls[r.backgroundStyle.imageUrl]?l.drawLables(t):"image"!==r.backgroundStyle.backgroundType||l.imageUrls[r.backgroundStyle.imageUrl]||(h=[r.backgroundStyle.imageUrl],new Promise(function(e,o){for(var t,i=[],r=h.length,a=0,s=0;s<r;s++)!function(){var n=h[s];t=new Promise(function(o,t){var i=new Image;i.onload=function(){var t=document.createElement("canvas"),e=t.getContext("2d");t.width=i.width,t.height=i.height,e.drawImage(i,0,0,t.width,t.height),l.imageUrls[n]=t,o(!0)},i.onerror=function(){t(new Error("Could not load image at ".concat(n)))},i.src=n}),i.push(t),Promise.all(i).then(function(t){++a==r&&e(!0)}).catch(function(t){++a==r&&o(!1)})}()}).then(function(t){t&&l.layer.onRender()}).catch(function(t){})))}},{key:"drawLables",value:function(t){var e=this.options,o=e.label,i=e.mappingStyle,n=o.eventType,e=(o.position,o.contentStyle),r=o.backgroundStyle,a=e.lineSeries,s=e.fieldWidth,O=e.lineHeight,h=e.textBorder;if(0!=a.length){a[0].content,a[0].fieldName,t.textAlign="center",t.textBaseline="middle",Object.assign({},o.offset);for(var l=0;l<this.features.length;l++){(S=this.features[l]).geometry;var u=S.properties,g=S.textPosition;if(Y.featureSelect&&Y.featureSelect.geometry.coordinates==S.geometry.coordinates){if("click"==n&&"click"!=Y.EventType||"mouseover"==n&&"mouseover"!=Y.EventType)continue}else if("all"!=n)continue;for(var c=void 0,f=0,d=0,E=0,m=0;m<a.length;m++){var p=c=a[m],y=p.content,x=p.prefix,p=p.suffix,v=_(u[c.fieldName],y.fontFamily,y.fontWeight,y.fontSize).width;switch(s.widthAdapt){case"adapt":v=Math.min(v,s.maxWidth);break;case"fixedWidth":v=s.fixedWidth}d=v,x.show&&(d+=+x.padding+_(x.name,x.fontFamily,x.fontWeight,x.fontSize).width),p.show&&(d+=+p.padding+_(p.name,p.fontFamily,p.fontWeight,p.fontSize).width),f=Math.max(d,f),E+=Math.max(x.fontSize,y.fontSize,p.fontSize)}for(var w={left:0,right:0,top:0,bottom:0},S={width:f+(w=r.show?r.margin:w).left+w.right,height:E*O+w.top+w.bottom},b=r.border,P=document.createElement("canvas"),k=Y.devicePixelRatio,C=("vector"===r.backgroundType?(P.width=(S.width+b.weight)*k,P.height=(S.height+b.weight)*k):"image"==r.backgroundType&&(P.width=S.width*k,P.height=S.height*k),P.getContext("2d")),j=(C.scale(k,k),r.show&&("vector"===r.backgroundType?C.roundRect(0,0,S.width,S.height,r):"image"==r.backgroundType&&this.imageUrls[r.imageUrl]&&C.drawImage(this.imageUrls[r.imageUrl],0,0,S.width,S.height)),C.strokeStyle=h.color,C.lineWidth=h.weight,!(C.textBaseline="bottom")),I=w.top,L=0;L<a.length;L++){c=a[L];var M="";if(M=(i[u.adcode]&&i[u.adcode][c.fieldName]?i[u.adcode]:u)[c.fieldName]){var j=!0,T=c,U=T.content,z=T.prefix,T=T.suffix,F=(I+=Math.max(z.fontSize,U.fontSize,T.fontSize)*O,z.show&&(C.font="".concat(z.fontWeight," ").concat(z.fontSize,"px ").concat(z.fontFamily),C.fillStyle=z.color,h.show&&C.strokeText(z.name,w.left,I),C.fillText(z.name,w.left,I)),C.font="".concat(U.fontWeight," ").concat(U.fontSize,"px ").concat(U.fontFamily),C.fillStyle=U.color,_(M,U.fontFamily,U.fontWeight,U.fontSize).width),R=0;switch(s.widthAdapt){case"adapt":R=Math.min(F,s.maxWidth);break;case"fixedWidth":R=s.fixedWidth}if(R<F){for(var D=0,A=0,X=C.measureText("...",U.fontFamily,U.fontWeight,U.fontSize).width,B=0;B<M.length;B++)(D+=C.measureText(M[B],U.fontFamily,U.fontWeight,U.fontSize).width)<R-X&&A++;M="".concat(M.substring(0,A),"...")}var W=w.left;z.show&&(W+=z.padding+_(z.name,z.fontFamily,z.fontWeight,z.fontSize).width),h.show&&C.strokeText(M,W,I),C.fillText(M,W,I),T.show&&(C.font="".concat(T.fontWeight," ").concat(T.fontSize,"px ").concat(T.fontFamily),C.fillStyle=T.color,R=Math.min(R,F),h.show&&C.strokeText(T.name,W+R+T.padding,I),C.fillText(T.name,W+R+T.padding,I))}}j&&(k=g.x,g=g.y,t.drawImage(P,k-(S.width+b.weight)/2,g-(S.height+b.weight)/2,S.width+b.weight,S.height+b.weight))}}}},{key:"getFeaturesInBounds",value:function(){for(var t,e,o,i,n=this.options.smoothFactor,r=Y.options.paddingBoundsExtent,a=this.rbush.search(r),s=[],h=0;h<a.length;h++){switch(o=(e=a[h].feature).geometry.coordinates,i=[],e.geometry.type){case"Point":case"MultiPoint":break;case"LineString":i=this.project(o,Y,n||3);break;case"MultiLineString":break;case"Polygon":for(t=0;t<o.length;t++)3<=(s=this.project(o[t])).length&&i.push(s);break;case"MultiPolygon":for(t=0;t<o.length;t++){for(var l=[],u=0;u<o[t].length;u++)3<=(s=this.project(o[t][u])).length&&l.push(s);0<l.length&&i.push(l)}}a[h].feature.geometry._coordinates=i}this.rbushInBounds.clear(),this.rbushInBounds.load(a),this.featuresInBounds=a}},{key:"getFeatures",value:function(){for(var t=this.options,e=(t.label,t.mappingStyle),o=[],i=this.featuresInBounds,n=0;n<i.length;n++){var r=i[n].feature,a=r.geometry,s=r.properties;switch(a.type){case"Point":case"MultiPoint":case"LineString":case"MultiLineString":break;case"Polygon":case"MultiPolygon":var h=s.adcode,l=void 0,l=h&&e[h]&&e[h].customLabelPosition?e[h].customLabelPosition:(h=1,(u=r).geometry&&"Polygon"===u.geometry.type?g(u.geometry.coordinates,h):u.geometry&&"MultiPolygon"===u.geometry.type?(u=u.geometry.coordinates.reduce(function(t,e){return m(t)>=m(e)?t:e},{}),g(u,h)):void 0),u=Y.latLngToContainerPoint([l[1],l[0]]),h=u.x-f.x,l=u.y-f.y;r.textPosition={x:h,y:l}}o.push(r)}return this.features=o}},{key:"contains",value:function(t){var e,o,i=!1,n={minX:t.lng,minY:t.lat,maxX:t.lng,maxY:t.lat},r=this.rbushInBounds.search(n);if(0===r.length)return{flag:i,feature:null};for(var a=[],s=0;s<r.length;s++)if(e=r[s].feature,i=this.isFeatureContainsLatLng(e,t,Y)){o=e,a=[[r[s].minY,r[s].minX],[r[s].maxY,r[s].maxX]];break}return{flag:i,feature:o,featureBounds:a}}},{key:"isFeatureContainsLatLng",value:function(t,e,o){var i,n=o.options.offset,r=t.geometry.coordinates,a=!1;switch(t.geometry.type){case"Point":case"MultiPoint":break;case"LineString":(i=o.latLngToContainerPoint([e.lat,e.lng])).x-=n.x,i.y-=n.y,a=this.isPolylineContainsPoint(t,i,!1);break;case"MultiLineString":(i=o.latLngToContainerPoint([e.lat,e.lng])).x-=n.x,i.y-=n.y;for(var s=0;s<r.length&&!(a=this.isPolylineContainsPoint(t,i,!1));s++);break;case"Polygon":a=this.isPolygonContainsPoint(r,[e.lng,e.lat]);break;case"MultiPolygon":for(var h=0;h<r.length&&!(a=this.isPolygonContainsPoint(r[h],[e.lng,e.lat]));h++);}return a}},{key:"isPolylineContainsPoint",value:function(t,e,o){for(var i=t.geometry._coordinates,n=(t.properties.weight||3)/2+this.options.tolerance,r=0,a=i.length,s=a-1;r<a;s=r++)if((o||0!==r)&&l.LineUtil.pointToSegmentDistance(e,{x:i[s][0],y:i[s][1]},{x:i[r][0],y:i[r][1]})<=n)return!0;return!1}},{key:"isPolygonContainsPoint",value:function(t,e){for(var o,i,n,r,a,s,h=!1,l=0,u=t.length;l<u;l++)for(r=0,a=(s=(o=t[l]).length)-1;r<s;a=r++)i=o[r],n=o[a],i[1]>e[1]!=n[1]>e[1]&&e[0]<(n[0]-i[0])*(e[1]-i[1])/(n[1]-i[1])+i[0]&&(h=!h);return h}},{key:"project",value:function(t){var e,o=Y.options.offset,i=[];if(t){if(1===t.length)e=Y.latLngToContainerPoint([t[1],t[0]]),i.push(e.x-o.x),i.push(e.y-o.y);else if(1<t.length){for(var n,r=[],a=0;a<t.length;a++)!(n=t[a])[0]&&0!=n[0]||!n[1]&&0!=n[1]||((e=Y.latLngToContainerPoint([n[1],n[0]])).x=e.x-o.x,e.y=e.y-o.y,r.push(e));if(r.length)for(var s=this.options.smoothFactor,r=l.LineUtil.simplify(r,s),h=0;h<r.length;h++)e=r[h],i.push([e.x,e.y])}}else i=[];return i}},{key:"destroy",value:function(){this.textureImageUrls=null,this.imageUrls=null,this.rbush=null,this.rbushInBounds=null,this.featuresInBounds=null,this.features=null,this.getFeaturesInBounds=null,this.getFeatures=null}}])&&a(t.prototype,e),o&&a(t,o),Object.defineProperty(t,"prototype",{writable:!1}),n;function n(t){if(!(this instanceof n))throw new TypeError("Cannot call a class as a function");this.options=w({zIndex:0,tolerance:3,smoothFactor:1,style:{fill:!0,fillRule:"evenodd",fillColor:"rgba(2,111,222,0.3)",fillOpacity:1,stroke:!0,strokeColor:"rgba(255,255,255,0.3)",weight:1,lineJoin:"round",lineCap:"square",dashArray:""},mappingStyle:{},interaction:{graph:{show:!0,hoverStyle:{show:!0,fill:!0,fillRule:"evenodd",fillColor:"rgba(2,111,222,0.3)",fillOpacity:1,stroke:!0,strokeColor:"rgba(255,255,255,0.3)",weight:1,lineJoin:"round",lineCap:"square",dashArray:""},clickZoom:{show:!0,zoomPad:1.5}}}},t),this.textureImageUrls={},this.imageUrls={},this.rbush=new i,this.rbush.dirty=0,this.rbush.total=0,this.rbushInBounds=new i,this.featuresInBounds=[],this.features=[],this.onRender=this.onRender.bind(this),this.setOptions=this.setOptions.bind(this),this.draw=this.draw.bind(this),this.getFeaturesInBounds=this.getFeaturesInBounds.bind(this),this.getFeatures=this.getFeatures.bind(this)}},t.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/layer/Layer",["datav:/npm/eventemitter3/3.0.0"],function(t,e,n,r,i,o){function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var n=0;n<e.length;n++){var r=e[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function s(t,e){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function u(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=h(n),e=(t=r?(t=h(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return l(e)}}function l(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function h(t){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var f=n("datav:/npm/eventemitter3/3.0.0"),y=n("datav:/com/datav-2dmap/3.0.70/src/utils");return t.exports=function(){var t=i,e=f;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&s(t,e);var n,r=u(i);function i(){var t;if(this instanceof i)return(t=r.call(this))._layers=[],t.isStateChange=!1,t.resize=t.resize.bind(l(t)),t.onRender=t.onRender.bind(l(t)),t;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"addTo",value:function(t){var e=(this.map=t).options.offset,n=this.map.getSize(),r=n.x-2*e.x,n=n.y-2*e.y,e=this.container=document.createElement("canvas"),t=(this.ctx=e.getContext("2d"),this.ctx.imageSmoothingQuality="high",t.devicePixelRatio);e.width=r*t,e.height=n*t,this.ctx.save(),this.ctx.scale(t,t)}},{key:"addLayer",value:function(t){this._layers.push(t)}},{key:"onRender",value:function(t){if(this.ctx.clearRect(0,0,this.container.width,this.container.height),this._layers){for(var e=0;e<this._layers.length;e++)this._layers[e].onRender(this.ctx,t);this.isStateChange=!0}}},{key:"draw",value:function(t){this.container&&t.drawImage(this.container,0,0,this.container.width,this.container.height)}},{key:"contains",value:function(t){if(!this._layers)return!1;for(var e=!1,n=0;n<this._layers.length&&!(e=this._layers[n].contains(t));n++);return e}},{key:"resize",value:function(t,e){this.map.devicePixelRatio=y.getBestDevicePixelRatio(t,e);var n=this.map.devicePixelRatio;this.container.width=t*n,this.container.height=e*n,this.ctx.restore(),this.ctx.scale(n,n),this.onRender(!0)}},{key:"destroy",value:function(){if(this._layers){for(var t=0;t<this._layers.length;t++)(layer=this._layers[t]).destroy();this._layers=null,this.ctx=null,this.container=null}}},{key:"show",value:function(){this.isStateChange=!0}},{key:"hide",value:function(){this.isStateChange=!0}}])&&c(t.prototype,e),n&&c(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}(),t.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/leaflet/CanvasLayerExt",["datav:/npm/leaflet/1.6.0","datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1","datav:/npm/lodash.throttle/4.1.1"],function(t,e,n,o,i,a){function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function r(t,e){for(var n=0;n<e.length;n++){var o=e[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(n){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c(n),e=(t=o?(t=c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return p(e)}}function p(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=n("datav:/npm/leaflet/1.6.0"),m=n("datav:/npm/eventemitter3/3.0.0"),d=n("datav:/npm/safely-merge/1.0.1"),f=n("datav:/npm/lodash.throttle/4.1.1"),n=function(){var t=i,e=m;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var n,o=h(i);function i(t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");var e;return(e=o.call(this,t)).options=d({pane:"overlayPane",padding:.1,tolerance:0},t),e.pane=null,e.container=null,e.bounds=null,e.update=e.update.bind(p(e)),e.onAnimZoom=e.onAnimZoom.bind(p(e)),e.onMoveEnd=e.onMoveEnd.bind(p(e)),e}return t=i,(e=[{key:"addTo",value:function(t){this.map=t,this.pane=t.getPane(this.options.pane);t=this.container=l.DomUtil.create("canvas");this.ctx=t.getContext("2d"),this.ctx.imageSmoothingQuality="high",l.DomUtil.addClass(this.container,"leaflet-zoom-animated"),this.pane.appendChild(this.container),this.updateContainer(),this.update(),this.initEvents()}},{key:"updateContainer",value:function(){var t,e,n;this.container&&this.options&&(e=this.options.padding,t=this.map.getSize(),n=this.map.containerPointToLayerPoint(t.multiplyBy(-e)).round(),t=(n=this.bounds=new l.Bounds(n,n.add(t.multiplyBy(1+2*e)).round())).getSize().x,e=n.getSize().y,l.DomUtil.setPosition(this.container,this.bounds.min),n=this.map.devicePixelRatio,this.container.width=t*n,this.container.height=e*n,this.container.style.width="".concat(t,"px"),this.container.style.height="".concat(e,"px"))}},{key:"initEvents",value:function(){this.map.on("viewreset",this.onMoveEnd,this),this.map.on("resize",this.onMoveEnd,this),this.map.on("moveend ",f(this.onMoveEnd,32,this),this),this.map.on("zoom",this.onZoom,this),this.map.options.zoomAnimation=!0,this.map.options.zoomAnimation&&l.Browser.any3d&&this.map.on("zoomanim",f(this.onAnimZoom,32,this),this)}},{key:"onAnimZoom",value:function(t){this.updateTransform(t.center,t.zoom)}},{key:"onZoom",value:function(){this.updateTransform(this.map.getCenter(),this.map.getZoom())}},{key:"onMoveEnd",value:function(t){this.update(),this.updateTransform(this.map.getCenter(),this.map.getZoom())}},{key:"update",value:function(){var t,e,n;this.container&&this.options&&(t=this.map.getSize(),e=this.options.padding,n=this.map.containerPointToLayerPoint(t.multiplyBy(-e)).round(),this.bounds=new l.Bounds(n,n.add(t.multiplyBy(1+2*e)).round()),this._center=this.map.getCenter(),this._zoom=this.map.getZoom())}},{key:"updateTransform",value:function(t,e){var n,o,i,a;this.container&&this.options&&(i=this.map.getSize(),n=this.map.getZoomScale(e,this._zoom),o=l.DomUtil.getPosition(this.container),i=i.multiplyBy(.5+this.options.padding),a=this.map.project(this._center,e),t=this.map.project(t,e).subtract(a),e=i.multiplyBy(-n).add(o).add(i).subtract(t),l.Browser.any3d?l.DomUtil.setTransform(this.container,e,n):l.DomUtil.setPosition(this.container,e))}},{key:"updateOptions",value:function(t){this.options=d(this.options,t)}},{key:"show",value:function(){this.container.style.opacity=this.options.opacity||1}},{key:"hide",value:function(){this.container.style.opacity=0}},{key:"setZIndex",value:function(t){this.container.style.zIndex=t}},{key:"remove",value:function(){this.onAnimZoom&&this.map.off("zoomanim",this.onAnimZoom,this),this.onMoveEnd&&this.map.off("movemend",this.onMoveEnd,this),this.container&&this.container.remove(),this.bounds=null,this.onMoveEnd=null,this.update=null,this.onAnimZoom=null,this.options=null,this.container=null,this.pane=null,delete this.bounds,delete this.onMoveEnd,delete this.update,delete this.onAnimZoom,delete this.options,delete this.container,delete this.pane}}])&&r(t.prototype,e),n&&r(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i}();return t.exports=n,t.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/leaflet/customPopup",[],function(t,e,o,n,a,l){return t.exports={openPopup:function(t){t.L;var e=t.map,o=t.latlng,n=(t.feature,t.interaction,t.bindPopup),a=t.offset,l=t.minZoom,t=t.maxZoom,s=n.container,i=(s.style.display="block",s.clientWidth),r=s.clientHeight,o=((n=n.popup).setLatLng(o),n.setContent(s),n.openOn(e),n._container),p=n._closeButton,c=n._tip,y=(n._tipContainer,n._wrapper),d=n._contentNode;o.style.background="transparent",o.style.border="none",o.style.borderRadius=0,o.style.boxShadow="none",o.style.margin=0,y.style.background="transparent",y.style.borderRadius=0,c.style.background="transparent",c.style.boxShadow="none",c.style.border="none",y.style.boxShadow="none",p.style.display="none",d.style.margin=0,d.style.padding=0,d.style.display="flex",d.style.justifyContent="center",d.style.alignItems="center",d.style.lineHeight="",d.style.fontFamily="",d.style.fontWeight="",d.style.color="",d.style.fontSize="",n.options.maxWidth=(i||parseFloat(s.style.width))+100,n.options.maxHeight=(r||parseFloat(s.style.height))+100,n.options.offset=[a.x,-a.y-8],n.update(),e._popup.minZoom=l,e._popup.maxZoom=t},updatePopupStyle:function(t,e){var o,n,a,l,s,i,r,p,c,y,d,u,x,b,f,g,m,h;t.isCustom||(o=e.background,n=(s=e.padding).top,a=s.bottom,l=s.left,s=s.right,i=e.border,r=e.closeBtn,p=e.tipBtn,c=(x=e.textStyle).color,y=x.fontFamily,d=x.fontSize,u=x.fontWeight,x=x.lineHeight,e=e.offset,b=t._container,f=t._closeButton,g=t._tip,t._tipContainer,m=t._wrapper,h=t._contentNode,b.style.borderRadius="".concat(i.radius,"px"),b.style.border="".concat(i.width,"px solid ").concat(i.color),b.style.padding=0,b.style.margin=0,b.style.boxShadow="".concat(o.offsetX,"px ").concat(o.offsetY,"px ").concat(o.blurRadius,"px ").concat(o.blurColor),b.style.background=o.color,m.style.background="transparent",m.style.borderRadius=0,m.style.boxShadow="none",m.style.padding=0,h.style.margin=0,h.style.display="flex",h.style.justifyContent="center",h.style.alignItems="center",h.style.maxWidth="1200px",h.style.maxHeight="1200px",h.style.minWidth="100px",h.style.minHeight="50px",t.options.maxWidth=1200,t.options.maxHeight=1200,h.style.padding="".concat(n,"px ").concat(s,"px ").concat(a,"px ").concat(l,"px"),h.style.lineHeight=x,h.style.fontFamily=y,h.style.fontWeight=u,h.style.color=c,h.style.fontSize="".concat(d,"px"),g.style.background=p.enable?o.color:"transparent",g.style.boxShadow=p.enable?"".concat(o.offsetX,"px ").concat(o.offsetY,"px ").concat(o.blurRadius,"px ").concat(o.blurColor):"none",g.style.border=p.enable?"".concat(i.width,"px solid ").concat(i.color):"none",f.style.color=r.color,f.style.display=r.enable?"block":"none",t.options.offset=[e.x,-e.y-8],t.update())}},t.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/leaflet/geoman",[],function(t,e,r,n,i,o){function ve(t){return(ve="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}return t.exports={bindLeaflet:function(_e){function i(t){if(n[t])return n[t].exports;var e=n[t]={i:t,l:!1,exports:{}};return r[t].call(e.exports,e,e.exports,i),e.l=!0,e.exports}var r,n;r=[function(t,e,r){var n=r(131);t.exports=function(t,e,r){t=null==t?void 0:n(t,e);return void 0===t?r:t}},function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},h=(Object.defineProperty(e,"__esModule",{value:!0}),r(6)),u=r(9),a=n(r(141)),s=r(15),l=n(r(142));function c(t,e){t=u.getCoords(t),e=u.getCoords(e);if(2!==t.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==e.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var r=t[0][0],n=t[0][1],i=t[1][0],t=t[1][1],o=e[0][0],a=e[0][1],s=e[1][0],e=e[1][1],l=(e-a)*(i-r)-(s-o)*(t-n);if(0==l)return null;s=((s-o)*(n-a)-(e-a)*(r-o))/l,e=((i-r)*(n-a)-(t-n)*(r-o))/l;return 0<=s&&s<=1&&0<=e&&e<=1?h.point([r+s*(i-r),n+s*(t-n)]):null}e.default=function(t,e){var r,n={},i=[];if("LineString"===t.type&&(t=h.feature(t)),"LineString"===e.type&&(e=h.feature(e)),"Feature"===t.type&&"Feature"===e.type&&null!==t.geometry&&null!==e.geometry&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length)return(r=c(t,e))&&i.push(r),h.featureCollection(i);var o=l.default();return o.load(a.default(e)),s.featureEach(a.default(t),function(r){s.featureEach(o.search(r),function(t){var e,t=c(r,t);t&&(e=u.getCoords(t).join(","),n[e]||(n[e]=!0,i.push(t)))})}),h.featureCollection(i)}},function(t,e){t.exports=function(t){var e=ve(t);return null!=t&&("object"==e||"function"==e)}},function(t,e,r){var r=r(28),n="object"===("undefined"==typeof self?"undefined":ve(self))&&self&&self.Object===Object&&self,r=r||n||Function("return this")();t.exports=r},function(t,e){t.exports=function(t){return null!=t&&"object"===ve(t)}},function(t,e){var r=Array.isArray;t.exports=r},function(t,n,e){function s(t,e,r){var n={type:"Feature"};return 0!==(r=void 0===r?{}:r).id&&!r.id||(n.id=r.id),r.bbox&&(n.bbox=r.bbox),n.properties=e||{},n.geometry=t,n}function i(t,e,r){return s({type:"Point",coordinates:t},e,r=void 0===r?{}:r)}function o(t,e,r){void 0===r&&(r={});for(var n=0,i=t;n<i.length;n++){var o=i[n];if(o.length<4)throw new Error("Each LinearRing of a Polygon must have 4 or more Positions.");for(var a=0;a<o[o.length-1].length;a++)if(o[o.length-1][a]!==o[0][a])throw new Error("First and last Position are not equivalent.")}return s({type:"Polygon",coordinates:t},e,r)}function a(t,e,r){if(void 0===r&&(r={}),t.length<2)throw new Error("coordinates must be an array of two or more positions");return s({type:"LineString",coordinates:t},e,r)}function l(t,e){var r={type:"FeatureCollection"};return(e=void 0===e?{}:e).id&&(r.id=e.id),e.bbox&&(r.bbox=e.bbox),r.features=t,r}function h(t,e,r){return s({type:"MultiLineString",coordinates:t},e,r=void 0===r?{}:r)}function u(t,e,r){return s({type:"MultiPoint",coordinates:t},e,r=void 0===r?{}:r)}function c(t,e,r){return s({type:"MultiPolygon",coordinates:t},e,r=void 0===r?{}:r)}function p(t,e){var r=n.factors[e=void 0===e?"kilometers":e];if(r)return t*r;throw new Error("".concat(e," units is invalid"))}function f(t,e){var r=n.factors[e=void 0===e?"kilometers":e];if(r)return t/r;throw new Error("".concat(e," units is invalid"))}function r(t){return t%(2*Math.PI)*180/Math.PI}function d(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)&&!/^\s*$/.test(t)}Object.defineProperty(n,"__esModule",{value:!0}),n.earthRadius=6371008.8,n.factors={centimeters:100*n.earthRadius,centimetres:100*n.earthRadius,degrees:n.earthRadius/111325,feet:3.28084*n.earthRadius,inches:39.37*n.earthRadius,kilometers:n.earthRadius/1e3,kilometres:n.earthRadius/1e3,meters:n.earthRadius,metres:n.earthRadius,miles:n.earthRadius/1609.344,millimeters:1e3*n.earthRadius,millimetres:1e3*n.earthRadius,nauticalmiles:n.earthRadius/1852,radians:1,yards:n.earthRadius/1.0936},n.unitsFactors={centimeters:100,centimetres:100,degrees:1/111325,feet:3.28084,inches:39.37,kilometers:.001,kilometres:.001,meters:1,metres:1,miles:1/1609.344,millimeters:1e3,millimetres:1e3,nauticalmiles:1/1852,radians:1/n.earthRadius,yards:1/1.0936},n.areaFactors={acres:247105e-9,centimeters:1e4,centimetres:1e4,feet:10.763910417,inches:1550.003100006,kilometers:1e-6,kilometres:1e-6,meters:1,metres:1,miles:386e-9,millimeters:1e6,millimetres:1e6,yards:1.195990046},n.feature=s,n.geometry=function(t,e,r){switch(void 0===r&&(r={}),t){case"Point":return i(e).geometry;case"LineString":return a(e).geometry;case"Polygon":return o(e).geometry;case"MultiPoint":return u(e).geometry;case"MultiLineString":return h(e).geometry;case"MultiPolygon":return c(e).geometry;default:throw new Error("".concat(t," is invalid"))}},n.point=i,n.points=function(t,e,r){return void 0===r&&(r={}),l(t.map(function(t){return i(t,e)}),r)},n.polygon=o,n.polygons=function(t,e,r){return void 0===r&&(r={}),l(t.map(function(t){return o(t,e)}),r)},n.lineString=a,n.lineStrings=function(t,e,r){return void 0===r&&(r={}),l(t.map(function(t){return a(t,e)}),r)},n.featureCollection=l,n.multiLineString=h,n.multiPoint=u,n.multiPolygon=c,n.geometryCollection=function(t,e,r){return s({type:"GeometryCollection",geometries:t},e,r=void 0===r?{}:r)},n.round=function(t,e){if((e=void 0===e?0:e)&&!(0<=e))throw new Error("precision must be a positive number");e=Math.pow(10,e||0);return Math.round(t*e)/e},n.radiansToLength=p,n.lengthToRadians=f,n.lengthToDegrees=function(t,e){return r(f(t,e))},n.bearingToAzimuth=function(t){t%=360;return t<0&&(t+=360),t},n.radiansToDegrees=r,n.degreesToRadians=function(t){return t%360*Math.PI/180},n.convertLength=function(t,e,r){if(void 0===e&&(e="kilometers"),void 0===r&&(r="kilometers"),0<=t)return p(f(t,e),r);throw new Error("length must be a positive number")},n.convertArea=function(t,e,r){if(void 0===e&&(e="meters"),void 0===r&&(r="kilometers"),!(0<=t))throw new Error("area must be a positive number");e=n.areaFactors[e];if(!e)throw new Error("invalid original units");r=n.areaFactors[r];if(r)return t/e*r;throw new Error("invalid final units")},n.isNumber=d,n.isObject=function(t){return!!t&&t.constructor===Object},n.validateBBox=function(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!d(t))throw new Error("bbox must only contain numbers")})},n.validateId=function(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(ve(t)))throw new Error("id must be a number or a string")},n.radians2degrees=function(){throw new Error("method has been renamed to `radiansToDegrees`")},n.degrees2radians=function(){throw new Error("method has been renamed to `degreesToRadians`")},n.distanceToDegrees=function(){throw new Error("method has been renamed to `lengthToDegrees`")},n.distanceToRadians=function(){throw new Error("method has been renamed to `lengthToRadians`")},n.radiansToDistance=function(){throw new Error("method has been renamed to `radiansToLength`")},n.bearingToAngle=function(){throw new Error("method has been renamed to `bearingToAzimuth`")},n.convertDistance=function(){throw new Error("method has been renamed to `convertLength`")}},function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0});var _=r(6);e.default=function(t){var e,y={type:"FeatureCollection",features:[]};if("LineString"===(t="Feature"===t.type?t.geometry:t).type)e=[t.coordinates];else if("MultiLineString"===t.type)e=t.coordinates;else if("MultiPolygon"===t.type)e=[].concat.apply([],t.coordinates);else{if("Polygon"!==t.type)throw new Error("Input must be a LineString, MultiLineString, Polygon, or MultiPolygon Feature or Geometry");e=t.coordinates}return e.forEach(function(m){e.forEach(function(t){for(var e,r,n,i,o,a,s,l,h,u,c,p,f=0;f<m.length-1;f++)for(var d=f;d<t.length-1;d++){if(m===t){if(1===Math.abs(f-d))continue;if(0===f&&d===m.length-2&&m[f][0]===m[m.length-1][0]&&m[f][1]===m[m.length-1][1])continue}e=m[f][0],r=m[f][1],n=m[f+1][0],i=m[f+1][1],o=t[d][0],a=t[d][1],g=t[d+1][0],s=t[d+1][1],c=u=h=l=void 0,p={x:null,y:null,onLine1:!1,onLine2:!1};var g=0==(l=(s-a)*(n-e)-(g-o)*(i-r))?null!==p.x&&null!==p.y&&p:(c=(n-e)*(h=r-a)-(i-r)*(u=e-o),h=((g-o)*h-(s-a)*u)/l,u=c/l,p.x=e+h*(n-e),p.y=r+h*(i-r),0<=h&&h<=1&&(p.onLine1=!0),0<=u&&u<=1&&(p.onLine2=!0),!(!p.onLine1||!p.onLine2)&&[p.x,p.y]);g&&y.features.push(_.point([g[0],g[1]]))}})}),y}},function(t,e,r){var n=r(18),i=r(79),o=r(80),a=n?n.toStringTag:void 0;t.exports=function(t){return null==t?void 0===t?"[object Undefined]":"[object Null]":(a&&a in Object(t)?i:o)(t)}},function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0});var n=r(6);e.getCoord=function(t){if(!t)throw new Error("coord is required");if(!Array.isArray(t)){if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates}if(Array.isArray(t)&&2<=t.length&&!Array.isArray(t[0])&&!Array.isArray(t[1]))return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")},e.getCoords=function(t){if(Array.isArray(t))return t;if("Feature"===t.type){if(null!==t.geometry)return t.geometry.coordinates}else if(t.coordinates)return t.coordinates;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")},e.containsNumber=function t(e){if(1<e.length&&n.isNumber(e[0])&&n.isNumber(e[1]))return!0;if(Array.isArray(e[0])&&e[0].length)return t(e[0]);throw new Error("coordinates must only contain numbers")},e.geojsonType=function(t,e,r){if(!e||!r)throw new Error("type and name required");if(!t||t.type!==e)throw new Error("Invalid input to ".concat(r,": must be a ").concat(e,", given ").concat(t.type))},e.featureOf=function(t,e,r){if(!t)throw new Error("No feature passed");if(!r)throw new Error(".featureOf() requires a name");if(!t||"Feature"!==t.type||!t.geometry)throw new Error("Invalid input to ".concat(r,", Feature with geometry required"));if(!t.geometry||t.geometry.type!==e)throw new Error("Invalid input to ".concat(r,": must be a ").concat(e,", given ").concat(t.geometry.type))},e.collectionOf=function(t,e,r){if(!t)throw new Error("No featureCollection passed");if(!r)throw new Error(".collectionOf() requires a name");if(!t||"FeatureCollection"!==t.type)throw new Error("Invalid input to ".concat(r,", FeatureCollection required"));for(var n=0,i=t.features;n<i.length;n++){var o=i[n];if(!o||"Feature"!==o.type||!o.geometry)throw new Error("Invalid input to ".concat(r,", Feature with geometry required"));if(!o.geometry||o.geometry.type!==e)throw new Error("Invalid input to ".concat(r,": must be a ").concat(e,", given ").concat(o.geometry.type))}},e.getGeom=function(t){return"Feature"===t.type?t.geometry:t},e.getType=function(t,e){return"FeatureCollection"===t.type?"FeatureCollection":"GeometryCollection"===t.type?"GeometryCollection":("Feature"===t.type&&null!==t.geometry?t.geometry:t).type}},function(t,e,r){var n=r(67),i=r(68),o=r(69),a=r(70),r=r(71);function s(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=i,s.prototype.get=o,s.prototype.has=a,s.prototype.set=r,t.exports=s},function(t,e,r){var n=r(12);t.exports=function(t,e){for(var r=t.length;r--;)if(n(t[r][0],e))return r;return-1}},function(t,e){t.exports=function(t,e){return t===e||t!=t&&e!=e}},function(t,e,r){r=r(16)(Object,"create");t.exports=r},function(t,e,r){var n=r(93);t.exports=function(t,e){t=t.__data__;return n(e)?t["string"==typeof e?"string":"hash"]:t.map}},function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0});var d=r(6);function M(t,e,r){if(null!==t)for(var n,i,o,a,s,l,h=0,u=t.type,c="FeatureCollection"===u,p="Feature"===u,f=c?t.features.length:1,d=0;d<f;d++)for(var g=(l=!!(s=c?t.features[d].geometry:p?t.geometry:t)&&"GeometryCollection"===s.type)?s.geometries.length:1,m=0;m<g;m++){var y=0,_=0;if(null!==(a=l?s.geometries[m]:s)){var v=a.coordinates,b=a.type,k=!r||"Polygon"!==b&&"MultiPolygon"!==b?0:1;switch(b){case null:break;case"Point":if(!1===e(v,h,d,y,_))return!1;h++,y++;break;case"LineString":case"MultiPoint":for(n=0;n<v.length;n++){if(!1===e(v[n],h,d,y,_))return!1;h++,"MultiPoint"===b&&y++}"LineString"===b&&y++;break;case"Polygon":case"MultiLineString":for(n=0;n<v.length;n++){for(i=0;i<v[n].length-k;i++){if(!1===e(v[n][i],h,d,y,_))return!1;h++}"MultiLineString"===b&&y++,"Polygon"===b&&_++}"Polygon"===b&&y++;break;case"MultiPolygon":for(n=0;n<v.length;n++){for(i=_=0;i<v[n].length;i++){for(o=0;o<v[n][i].length-k;o++){if(!1===e(v[n][i][o],h,d,y,_))return!1;h++}_++}y++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===M(a.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}function o(t,e){var r;switch(t.type){case"FeatureCollection":for(r=0;r<t.features.length&&!1!==e(t.features[r].properties,r);r++);break;case"Feature":e(t.properties,0)}}function a(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}function n(t,e){for(var r,n,i,o,a,s,l,h,u,c=0,p="FeatureCollection"===t.type,f="Feature"===t.type,d=p?t.features.length:1,g=0;g<d;g++){for(a=p?t.features[g].geometry:f?t.geometry:t,l=p?t.features[g].properties:f?t.properties:{},h=p?t.features[g].bbox:f?t.bbox:void 0,u=p?t.features[g].id:f?t.id:void 0,o=(s=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,n=0;n<o;n++)if(null!==(i=s?a.geometries[n]:a))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,c,l,h,u))return!1;break;case"GeometryCollection":for(r=0;r<i.geometries.length;r++)if(!1===e(i.geometries[r],c,l,h,u))return!1;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,c,l,h,u))return!1;c++}}function s(t,h){n(t,function(t,e,r,n,i){var o,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==h(d.feature(t,r,{bbox:n,id:i}),e,0)&&void 0}switch(a){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var s=0;s<t.coordinates.length;s++){var l={type:o,coordinates:t.coordinates[s]};if(!1===h(d.feature(l,r),e,s))return!1}})}function i(t,f){s(t,function(o,a,s){var l=0;if(o.geometry){var h,u,c,p,t=o.geometry.type;if("Point"!==t&&"MultiPoint"!==t)return p=c=u=0,!1!==M(o,function(t,e,r,n,i){return void 0===h||u<a||c<n||p<i?(h=t,u=a,c=n,p=i,void(l=0)):(n=d.lineString([h,t],o.properties),!1!==f(n,a,s,i,l)&&(l++,void(h=t)))})&&void 0}})}function l(t,a){if(!t)throw new Error("geojson is required");s(t,function(t,e,r){if(null!==t.geometry){var n=t.geometry.type,i=t.geometry.coordinates;switch(n){case"LineString":if(!1===a(t,e,r,0,0))return!1;break;case"Polygon":for(var o=0;o<i.length;o++)if(!1===a(d.lineString(i[o],t.properties),e,r,o))return!1}}})}e.coordEach=M,e.coordReduce=function(t,o,a,e){var s=a;return M(t,function(t,e,r,n,i){s=0===e&&void 0===a?t:o(s,t,e,r,n,i)},e),s},e.propEach=o,e.propReduce=function(t,r,n){var i=n;return o(t,function(t,e){i=0===e&&void 0===n?t:r(i,t,e)}),i},e.featureEach=a,e.featureReduce=function(t,r,n){var i=n;return a(t,function(t,e){i=0===e&&void 0===n?t:r(i,t,e)}),i},e.coordAll=function(t){var e=[];return M(t,function(t){e.push(t)}),e},e.geomEach=n,e.geomReduce=function(t,o,a){var s=a;return n(t,function(t,e,r,n,i){s=0===e&&void 0===a?t:o(s,t,e,r,n,i)}),s},e.flattenEach=s,e.flattenReduce=function(t,n,i){var o=i;return s(t,function(t,e,r){o=0===e&&0===r&&void 0===i?t:n(o,t,e,r)}),o},e.segmentEach=i,e.segmentReduce=function(t,o,a){var s=a,l=!1;return i(t,function(t,e,r,n,i){s=!1===l&&void 0===a?t:o(s,t,e,r,n,i),l=!0}),s},e.lineEach=l,e.lineReduce=function(t,i,o){var a=o;return l(t,function(t,e,r,n){a=0===e&&void 0===o?t:i(a,t,e,r,n)}),a},e.findSegment=function(t,e){if(!d.isObject(e=e||{}))throw new Error("options is invalid");var r,n=e.featureIndex||0,i=e.multiFeatureIndex||0,o=e.geometryIndex||0,a=e.segmentIndex||0,s=e.properties;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),s=s||t.features[n].properties,r=t.features[n].geometry;break;case"Feature":s=s||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var l=r.coordinates;switch(r.type){case"Point":case"MultiPoint":return null;case"LineString":return a<0&&(a=l.length+a-1),d.lineString([l[a],l[a+1]],s,e);case"Polygon":return o<0&&(o=l.length+o),a<0&&(a=l[o].length+a-1),d.lineString([l[o][a],l[o][a+1]],s,e);case"MultiLineString":return i<0&&(i=l.length+i),a<0&&(a=l[i].length+a-1),d.lineString([l[i][a],l[i][a+1]],s,e);case"MultiPolygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o),a<0&&(a=l[i][o].length-a-1),d.lineString([l[i][o][a],l[i][o][a+1]],s,e)}throw new Error("geojson is invalid")},e.findPoint=function(t,e){if(!d.isObject(e=e||{}))throw new Error("options is invalid");var r,n=e.featureIndex||0,i=e.multiFeatureIndex||0,o=e.geometryIndex||0,a=e.coordIndex||0,s=e.properties;switch(t.type){case"FeatureCollection":n<0&&(n=t.features.length+n),s=s||t.features[n].properties,r=t.features[n].geometry;break;case"Feature":s=s||t.properties,r=t.geometry;break;case"Point":case"MultiPoint":return null;case"LineString":case"Polygon":case"MultiLineString":case"MultiPolygon":r=t;break;default:throw new Error("geojson is invalid")}if(null===r)return null;var l=r.coordinates;switch(r.type){case"Point":return d.point(l,s,e);case"MultiPoint":return i<0&&(i=l.length+i),d.point(l[i],s,e);case"LineString":return a<0&&(a=l.length+a),d.point(l[a],s,e);case"Polygon":return o<0&&(o=l.length+o),a<0&&(a=l[o].length+a),d.point(l[o][a],s,e);case"MultiLineString":return i<0&&(i=l.length+i),a<0&&(a=l[i].length+a),d.point(l[i][a],s,e);case"MultiPolygon":return i<0&&(i=l.length+i),o<0&&(o=l[i].length+o),a<0&&(a=l[i][o].length-a),d.point(l[i][o][a],s,e)}throw new Error("geojson is invalid")}},function(t,e,r){var n=r(77),i=r(84);t.exports=function(t,e){t=i(t,e);return n(t)?t:void 0}},function(t,e,r){var n=r(8),i=r(2);t.exports=function(t){if(!i(t))return!1;t=n(t);return"[object Function]"==t||"[object GeneratorFunction]"==t||"[object AsyncFunction]"==t||"[object Proxy]"==t}},function(t,e,r){r=r(3).Symbol;t.exports=r},function(t,e,r){var n=r(31);t.exports=function(t,e,r){"__proto__"==e&&n?n(t,e,{configurable:!0,enumerable:!0,value:r,writable:!0}):t[e]=r}},function(t,e){t.exports=function(t){return t.webpackPolyfill||(t.deprecate=function(){},t.paths=[],t.children||(t.children=[]),Object.defineProperty(t,"loaded",{enumerable:!0,get:function(){return t.l}}),Object.defineProperty(t,"id",{enumerable:!0,get:function(){return t.i}}),t.webpackPolyfill=1),t}},function(t,e,r){var n=r(108),i=r(4),r=Object.prototype,o=r.hasOwnProperty,a=r.propertyIsEnumerable,r=n(function(){return arguments}())?n:function(t){return i(t)&&o.call(t,"callee")&&!a.call(t,"callee")};t.exports=r},function(t,e,r){var n=r(17),i=r(23);t.exports=function(t){return null!=t&&i(t.length)&&!n(t)}},function(t,e){t.exports=function(t){return"number"==typeof t&&-1<t&&t%1==0&&t<=9007199254740991}},function(t,e){var n=/^(?:0|[1-9]\d*)$/;t.exports=function(t,e){var r=ve(t);return!!(e=null==e?9007199254740991:e)&&("number"==r||"symbol"!=r&&n.test(t))&&-1<t&&t%1==0&&t<e}},function(t,e,r){var n=r(8),i=r(4);t.exports=function(t){return"symbol"===ve(t)||i(t)&&"[object Symbol]"==n(t)}},function($,t,e){!function(t){function s(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function e(t,e,r){e&&I(t.prototype,e),r&&I(t,r)}function A(t,e){return e<t?1:t<e?-1:0}function a(t,e,r){for(var n=new b(null,null),i=n,o=n;;){var a=r(t,e.key);if(a<0){if(null===e.left)break;if(r(t,e.left.key)<0){var s=e.left;if(e.left=s.right,s.right=e,null===(e=s).left)break}o.left=e,e=(o=e).left}else{if(!(0<a))break;if(null===e.right)break;if(0<r(t,e.right.key)){s=e.right;if(e.right=s.left,s.left=e,null===(e=s).right)break}i.right=e,e=(i=e).right}}return i.right=e.left,o.left=e.right,e.left=n.right,e.right=n.left,e}function l(t,e,r,n){e=new b(t,e);if(null===r)return e.left=e.right=null,e;t=n(t,(r=a(t,r,n)).key);return t<0?(e.left=r.left,(e.right=r).left=null):0<=t&&(e.right=r.right,(e.left=r).right=null),e}function G(t,e,r){var n=null,i=null;return e&&(0===(r=r((e=a(t,e,r)).key,t))?(n=e.left,i=e.right):r<0?(i=e.right,e.right=null,n=e):(n=e.left,e.left=null,i=e)),{left:n,right:i}}function u(t,e){return t.ll.x<=e.x&&e.x<=t.ur.x&&t.ll.y<=e.y&&e.y<=t.ur.y}function S(t,e){if(e.ur.x<t.ll.x||t.ur.x<e.ll.x||e.ur.y<t.ll.y||t.ur.y<e.ll.y)return null;var r=(t.ll.x<e.ll.x?e:t).ll.x,n=(t.ur.x<e.ur.x?t:e).ur.x;return{ll:{x:r,y:(t.ll.y<e.ll.y?e:t).ll.y},ur:{x:n,y:(t.ur.y<e.ur.y?t:e).ur.y}}}function r(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:A;s(this,r),this._root=null,this._size=0,this._comparator=t}function n(t,e){if(-k<t&&t<k&&-k<e&&e<k)return 0;var r=t-e;return r*r<Y*t*e?0:t<e?-1:1}function N(t,e,r){return e={x:e.x-t.x,y:e.y-t.y},r={x:r.x-t.x,y:r.y-t.y},t=L(e,r),n(t,0)}function z(t,e,r){return 0===e.y?null:{x:t.x+e.x/e.y*(r-t.y),y:r}}function F(t,e,r){return 0===e.x?null:{x:r,y:t.y+e.y/e.x*(r-t.x)}}function i(){s(this,i)}function o(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:E.compare;s(this,o),this.queue=t,this.tree=new P(e),this.segments=[]}function h(t){s(this,h),this.rings=t,this.polys=this._composePolys(t)}function c(t){s(this,c),((this.exteriorRing=t).poly=this).interiorRings=[]}function y(t){s(this,y);for(var e=0,r=(this.events=t).length;e<r;e++)t[e].segment.ringOut=this;this.poly=null}function p(t,e){if(s(this,p),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");try{"number"==typeof t[0][0][0]&&(t=[t])}catch(t){}this.polys=[],this.bbox={ll:{x:Number.POSITIVE_INFINITY,y:Number.POSITIVE_INFINITY},ur:{x:Number.NEGATIVE_INFINITY,y:Number.NEGATIVE_INFINITY}};for(var r=0,n=t.length;r<n;r++){var i=new U(t[r],this);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.polys.push(i)}this.isSubject=e}function f(t,e){if(s(this,f),!Array.isArray(t))throw new Error("Input geometry is not a valid Polygon or MultiPolygon");this.exteriorRing=new C(t[0],this,!0),this.bbox={ll:{x:this.exteriorRing.bbox.ll.x,y:this.exteriorRing.bbox.ll.y},ur:{x:this.exteriorRing.bbox.ur.x,y:this.exteriorRing.bbox.ur.y}},this.interiorRings=[];for(var r=1,n=t.length;r<n;r++){var i=new C(t[r],this,!1);i.bbox.ll.x<this.bbox.ll.x&&(this.bbox.ll.x=i.bbox.ll.x),i.bbox.ll.y<this.bbox.ll.y&&(this.bbox.ll.y=i.bbox.ll.y),i.bbox.ur.x>this.bbox.ur.x&&(this.bbox.ur.x=i.bbox.ur.x),i.bbox.ur.y>this.bbox.ur.y&&(this.bbox.ur.y=i.bbox.ur.y),this.interiorRings.push(i)}this.multiPoly=e}function d(t,e,r){if(s(this,d),!Array.isArray(t)||0===t.length)throw new Error("Input geometry is not a valid Polygon or MultiPolygon");if(this.poly=e,this.isExterior=r,this.segments=[],"number"!=typeof t[0][0]||"number"!=typeof t[0][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");e=B.round(t[0][0],t[0][1]);this.bbox={ll:{x:e.x,y:e.y},ur:{x:e.x,y:e.y}};for(var n=e,i=1,o=t.length;i<o;i++){if("number"!=typeof t[i][0]||"number"!=typeof t[i][1])throw new Error("Input geometry is not a valid Polygon or MultiPolygon");var a=B.round(t[i][0],t[i][1]);a.x===n.x&&a.y===n.y||(this.segments.push(E.fromRing(n,a,this)),a.x<this.bbox.ll.x&&(this.bbox.ll.x=a.x),a.y<this.bbox.ll.y&&(this.bbox.ll.y=a.y),a.x>this.bbox.ur.x&&(this.bbox.ur.x=a.x),a.y>this.bbox.ur.y&&(this.bbox.ur.y=a.y),n=a)}e.x===n.x&&e.y===n.y||this.segments.push(E.fromRing(n,e,this))}function g(t,e,r,n){s(this,g),this.id=++q,(this.leftSE=t).segment=this,t.otherSE=e,(this.rightSE=e).segment=this,e.otherSE=t,this.rings=r,this.windings=n}function m(t,e){s(this,m),void 0===t.events?t.events=[this]:t.events.push(this),this.point=t,this.isLeft=e}function _(){s(this,_),this.tree=new P,this.round(0)}function v(){s(this,v),this.reset()}var b,P,k,Y,X,M,B,L,w,x,O,q,E,C,U,D,H,R,V,J,T,K,j;$.exports=(b=function t(e,r){s(this,t),this.next=null,this.key=e,this.data=r,this.left=null,this.right=null},e(r,[{key:"insert",value:function(t,e){return this._size++,this._root=l(t,e,this._root,this._comparator)}},{key:"add",value:function(t,e){var e=new b(t,e),r=(null===this._root&&(e.left=e.right=null,this._size++,this._root=e),this._comparator),n=a(t,this._root,r),r=r(t,n.key);return 0===r?this._root=n:(r<0?(e.left=n.left,(e.right=n).left=null):0<r&&(e.right=n.right,(e.left=n).right=null),this._size++,this._root=e),this._root}},{key:"remove",value:function(t){this._root=this._remove(t,this._root,this._comparator)}},{key:"_remove",value:function(t,e,r){var n;return null===e?null:0===r(t,(e=a(t,e,r)).key)?(null===e.left?n=e.right:(n=a(t,e.left,r)).right=e.right,this._size--,n):e}},{key:"pop",value:function(){var t=this._root;if(t){for(;t.left;)t=t.left;return this._root=a(t.key,this._root,this._comparator),this._root=this._remove(t.key,this._root,this._comparator),{key:t.key,data:t.data}}return null}},{key:"findStatic",value:function(t){for(var e=this._root,r=this._comparator;e;){var n=r(t,e.key);if(0===n)return e;e=n<0?e.left:e.right}return null}},{key:"find",value:function(t){return this._root&&(this._root=a(t,this._root,this._comparator),0!==this._comparator(t,this._root.key))?null:this._root}},{key:"contains",value:function(t){for(var e=this._root,r=this._comparator;e;){var n=r(t,e.key);if(0===n)return!0;e=n<0?e.left:e.right}return!1}},{key:"forEach",value:function(t,e){for(var r=this._root,n=[],i=!1;!i;)null!==r?(n.push(r),r=r.left):0!==n.length?(r=n.pop(),t.call(e,r),r=r.right):i=!0;return this}},{key:"range",value:function(t,e,r,n){for(var i=[],o=this._comparator,a=this._root;0!==i.length||a;)if(a)i.push(a),a=a.left;else{if(0<o((a=i.pop()).key,e))break;if(0<=o(a.key,t)&&r.call(n,a))return this;a=a.right}return this}},{key:"keys",value:function(){var e=[];return this.forEach(function(t){t=t.key;return e.push(t)}),e}},{key:"values",value:function(){var e=[];return this.forEach(function(t){t=t.data;return e.push(t)}),e}},{key:"min",value:function(){return this._root?this.minNode(this._root).key:null}},{key:"max",value:function(){return this._root?this.maxNode(this._root).key:null}},{key:"minNode",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._root;if(t)for(;t.left;)t=t.left;return t}},{key:"maxNode",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._root;if(t)for(;t.right;)t=t.right;return t}},{key:"at",value:function(t){for(var e=this._root,r=!1,n=0,i=[];!r;)if(e)i.push(e),e=e.left;else if(0<i.length){if(e=i.pop(),n===t)return e;n++,e=e.right}else r=!0;return null}},{key:"next",value:function(t){var e=this._root,r=null;if(t.right)for(r=t.right;r.left;)r=r.left;else for(var n=this._comparator;e;){var i=n(t.key,e.key);if(0===i)break;e=i<0?(r=e).left:e.right}return r}},{key:"prev",value:function(t){var e=this._root,r=null;if(null!==t.left)for(r=t.left;r.right;)r=r.right;else for(var n=this._comparator;e;){var i=n(t.key,e.key);if(0===i)break;e=i<0?e.left:(r=e).right}return r}},{key:"clear",value:function(){return this._root=null,this._size=0,this}},{key:"toList",value:function(){for(var t=this._root,e=t,r=[],n=!1,i=t=new b(null,null);!n;)e?(r.push(e),e=e.left):0<r.length?e=(e=i=i.next=r.pop()).right:n=!0;return i.next=null,t.next}},{key:"load",value:function(t){var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[],r=t.length,n=this._comparator;return 2<arguments.length&&void 0!==arguments[2]&&arguments[2]&&function t(e,r,n,i,o){if(!(i<=n)){for(var a=e[n+i>>1],s=n-1,l=i+1;;){for(;o(e[++s],a)<0;);for(;0<o(e[--l],a););if(l<=s)break;var h=e[s];e[s]=e[l],e[l]=h,h=r[s],r[s]=r[l],r[l]=h}t(e,r,n,l,o),t(e,r,l+1,i,o)}}(t,e,0,r-1,n),null===this._root?(this._root=function t(e,r,n,i){var o,a,s=i-n;return 0<s?(a=e[s=n+Math.floor(s/2)],o=r[s],(a=new b(a,o)).left=t(e,r,n,s),a.right=t(e,r,s+1,i),a):null}(t,e,0,r),this._size=r):(e=function(t,e,r){for(var n=new b(null,null),i=n,o=t,a=e;null!==o&&null!==a;)r(o.key,a.key)<0?o=(i.next=o).next:a=(i.next=a).next,i=i.next;return null!==o?i.next=o:null!==a&&(i.next=a),n.next}(this.toList(),function(t,e){for(var r=new b(null,null),n=r,i=0;i<t.length;i++)n=n.next=new b(t[i],e[i]);return n.next=null,r.next}(t,e),n),r=this._size+r,this._root=function t(e,r,n){var i,o=n-r;return 0<o?(o=t(e,r,r=r+Math.floor(o/2)),(i=e.head).left=o,e.head=e.head.next,i.right=t(e,r+1,n),i):null}({head:e},0,r)),this}},{key:"isEmpty",value:function(){return null===this._root}},{key:"toString",value:function(){var e=[];return function t(e,r,n,i,o){e&&(i("".concat(r).concat(n?"└── ":"├── ").concat(o(e),"\n")),r=r+(n?"    ":"│   "),e.left&&t(e.left,r,!1,i,o),e.right&&t(e.right,r,!0,i,o))}(this._root,"",!0,function(t){return e.push(t)},0<arguments.length&&void 0!==arguments[0]?arguments[0]:function(t){return String(t.key)}),e.join("")}},{key:"update",value:function(t,e,r){var n=this._comparator,i=G(t,this._root,n),o=i.left,i=i.right;n(t,e)<0?i=l(e,r,i,n):o=l(e,r,o,n),this._root=(t=o,null===(e=i)?t:(null!==t&&((e=a(t.key,e,n)).left=t),e))}},{key:"split",value:function(t){return G(t,this._root,this._comparator)}},{key:"size",get:function(){return this._size}},{key:"root",get:function(){return this._root}}]),P=r,k=Number.EPSILON,Y=(k=void 0===k?Math.pow(2,-52):k)*k,e(v,[{key:"reset",value:function(){this.xRounder=new M,this.yRounder=new M}},{key:"round",value:function(t,e){return{x:this.xRounder.round(t),y:this.yRounder.round(e)}}}]),X=v,e(_,[{key:"round",value:function(t){var e=this.tree.add(t),r=this.tree.prev(e);if(null!==r&&0===n(e.key,r.key))return this.tree.remove(t),r.key;r=this.tree.next(e);return null!==r&&0===n(e.key,r.key)?(this.tree.remove(t),r.key):t}}]),M=_,B=new X,L=function(t,e){return t.x*e.y-t.y*e.x},w=function(t,e){return t.x*e.x+t.y*e.y},x=function(t){return Math.sqrt(w(t,t))},e(m,null,[{key:"compare",value:function(t,e){var r=m.comparePoints(t.point,e.point);return 0!==r?r:(t.point!==e.point&&t.link(e),t.isLeft!==e.isLeft?t.isLeft?1:-1:E.compare(t.segment,e.segment))}},{key:"comparePoints",value:function(t,e){return t.x<e.x?-1:t.x>e.x?1:t.y<e.y?-1:t.y>e.y?1:0}}]),e(m,[{key:"link",value:function(t){if(t.point===this.point)throw new Error("Tried to link already linked events");for(var e=t.point.events,r=0,n=e.length;r<n;r++){var i=e[r];this.point.events.push(i),i.point=this.point}this.checkForConsuming()}},{key:"checkForConsuming",value:function(){for(var t=this.point.events.length,e=0;e<t;e++){var r=this.point.events[e];if(void 0===r.segment.consumedBy)for(var n=e+1;n<t;n++){var i=this.point.events[n];void 0===i.consumedBy&&r.otherSE.point.events===i.otherSE.point.events&&r.segment.consume(i.segment)}}}},{key:"getAvailableLinkedEvents",value:function(){for(var t=[],e=0,r=this.point.events.length;e<r;e++){var n=this.point.events[e];n!==this&&!n.segment.ringOut&&n.segment.isInResult()&&t.push(n)}return t}},{key:"getLeftmostComparator",value:function(r){function i(t){var e=t.otherSE;o.set(t,{sine:function(t,e,r){e={x:e.x-t.x,y:e.y-t.y},r={x:r.x-t.x,y:r.y-t.y};return L(r,e)/x(r)/x(e)}(n.point,r.point,e.point),cosine:function(t,e,r){e={x:e.x-t.x,y:e.y-t.y},r={x:r.x-t.x,y:r.y-t.y};return w(r,e)/x(r)/x(e)}(n.point,r.point,e.point)})}var n=this,o=new Map;return function(t,e){o.has(t)||i(t),o.has(e)||i(e);var t=o.get(t),r=t.sine,t=t.cosine,e=o.get(e),n=e.sine,e=e.cosine;return 0<=r&&0<=n?t<e?1:e<t?-1:0:r<0&&n<0?t<e?-1:e<t?1:0:n<r?-1:r<n?1:0}}}]),O=m,q=0,e(g,null,[{key:"compare",value:function(t,e){var r=t.leftSE.point.x,n=e.leftSE.point.x,i=t.rightSE.point.x,o=e.rightSE.point.x;if(o<r)return 1;if(i<n)return-1;var a=t.leftSE.point.y,s=e.leftSE.point.y,l=t.rightSE.point.y,h=e.rightSE.point.y;if(r<n){if(s<a&&s<l)return 1;if(a<s&&l<s)return-1;var u=t.comparePoint(e.leftSE.point);if(u<0)return 1;if(0<u)return-1;u=e.comparePoint(t.rightSE.point);return 0!==u?u:-1}if(n<r){if(a<s&&a<h)return-1;if(s<a&&h<a)return 1;u=e.comparePoint(t.leftSE.point);if(0!==u)return u;u=t.comparePoint(e.rightSE.point);return!(u<0)&&0<u?-1:1}if(a<s)return-1;if(s<a)return 1;if(i<o){u=e.comparePoint(t.rightSE.point);if(0!==u)return u}if(o<i){u=t.comparePoint(e.rightSE.point);if(u<0)return 1;if(0<u)return-1}if(i!==o){u=l-a,a=i-r,r=h-s,s=o-n;if(a<u&&r<s)return 1;if(u<a&&s<r)return-1}return o<i?1:i<o||l<h?-1:h<l?1:t.id<e.id?-1:t.id>e.id?1:0}}]),e(g,[{key:"replaceRightSE",value:function(t){this.rightSE=t,(this.rightSE.segment=this).rightSE.otherSE=this.leftSE,this.leftSE.otherSE=this.rightSE}},{key:"bbox",value:function(){var t=this.leftSE.point.y,e=this.rightSE.point.y;return{ll:{x:this.leftSE.point.x,y:t<e?t:e},ur:{x:this.rightSE.point.x,y:e<t?t:e}}}},{key:"vector",value:function(){return{x:this.rightSE.point.x-this.leftSE.point.x,y:this.rightSE.point.y-this.leftSE.point.y}}},{key:"isAnEndpoint",value:function(t){return t.x===this.leftSE.point.x&&t.y===this.leftSE.point.y||t.x===this.rightSE.point.x&&t.y===this.rightSE.point.y}},{key:"comparePoint",value:function(t){if(this.isAnEndpoint(t))return 0;var e=this.leftSE.point,r=this.rightSE.point,n=this.vector();if(e.x===r.x)return t.x===e.x?0:t.x<e.x?1:-1;r=(t.y-e.y)/n.y,r=e.x+r*n.x;if(t.x===r)return 0;r=(t.x-e.x)/n.x,e=e.y+r*n.y;return t.y===e?0:t.y<e?-1:1}},{key:"getIntersection",value:function(t){var e=this.bbox(),r=t.bbox(),n=S(e,r);if(null===n)return null;var i=this.leftSE.point,o=this.rightSE.point,a=t.leftSE.point,s=t.rightSE.point,l=u(e,a)&&0===this.comparePoint(a),h=u(r,i)&&0===t.comparePoint(i),e=u(e,s)&&0===this.comparePoint(s),r=u(r,o)&&0===t.comparePoint(o);if(h&&l)return r&&!e?o:!r&&e?s:null;if(h)return e&&i.x===s.x&&i.y===s.y?null:i;if(l)return r&&o.x===a.x&&o.y===a.y?null:a;if(r&&e)return null;if(r)return o;if(e)return s;h=function(t,e,r,n){if(0===e.x)return F(r,n,t.x);if(0===n.x)return F(t,e,r.x);if(0===e.y)return z(r,n,t.y);if(0===n.y)return z(t,e,r.y);var i=L(e,n);if(0==i)return null;var o={x:r.x-t.x,y:r.y-t.y},a=L(o,e)/i,o=L(o,n)/i;return{x:(t.x+o*e.x+(r.x+a*n.x))/2,y:(t.y+o*e.y+(r.y+a*n.y))/2}}(i,this.vector(),a,t.vector());return null!==h&&u(n,h)?B.round(h.x,h.y):null}},{key:"split",value:function(t){var e=[],r=void 0!==t.events,n=new O(t,!0),t=new O(t,!1),i=this.rightSE,i=(this.replaceRightSE(t),e.push(t),e.push(n),new g(n,i,this.rings.slice(),this.windings.slice()));return 0<O.comparePoints(i.leftSE.point,i.rightSE.point)&&i.swapEvents(),0<O.comparePoints(this.leftSE.point,this.rightSE.point)&&this.swapEvents(),r&&(n.checkForConsuming(),t.checkForConsuming()),e}},{key:"swapEvents",value:function(){var t=this.rightSE;this.rightSE=this.leftSE,this.leftSE=t,this.leftSE.isLeft=!0,this.rightSE.isLeft=!1;for(var e=0,r=this.windings.length;e<r;e++)this.windings[e]*=-1}},{key:"consume",value:function(t){for(var e=this,r=t;e.consumedBy;)e=e.consumedBy;for(;r.consumedBy;)r=r.consumedBy;var t=g.compare(e,r);if(0!==t){0<t&&(t=e,e=r,r=t),e.prev===r&&(t=e,e=r,r=t);for(var n=0,i=r.rings.length;n<i;n++){var o=r.rings[n],a=r.windings[n],s=e.rings.indexOf(o);-1===s?(e.rings.push(o),e.windings.push(a)):e.windings[s]+=a}r.rings=null,r.windings=null,r.consumedBy=e,r.leftSE.consumedBy=e.leftSE,r.rightSE.consumedBy=e.rightSE}}},{key:"prevInResult",value:function(){return void 0===this._prevInResult&&(this.prev?this.prev.isInResult()?this._prevInResult=this.prev:this._prevInResult=this.prev.prevInResult():this._prevInResult=null),this._prevInResult}},{key:"beforeState",value:function(){var t;return void 0===this._beforeState&&(this.prev?(t=this.prev.consumedBy||this.prev,this._beforeState=t.afterState()):this._beforeState={rings:[],windings:[],multiPolys:[]}),this._beforeState}},{key:"afterState",value:function(){if(void 0===this._afterState){var t=this.beforeState();this._afterState={rings:t.rings.slice(0),windings:t.windings.slice(0),multiPolys:[]};for(var e=this._afterState.rings,r=this._afterState.windings,n=this._afterState.multiPolys,i=0,o=this.rings.length;i<o;i++){var a=this.rings[i],s=this.windings[i],l=e.indexOf(a);-1===l?(e.push(a),r.push(s)):r[l]+=s}for(var h,u,c=[],p=[],f=0,d=e.length;f<d;f++)0!==r[f]&&(u=(h=e[f]).poly,-1===p.indexOf(u)&&(h.isExterior?c.push(u):(-1===p.indexOf(u)&&p.push(u),-1!==(u=c.indexOf(h.poly))&&c.splice(u,1))));for(var g=0,m=c.length;g<m;g++){var y=c[g].multiPoly;-1===n.indexOf(y)&&n.push(y)}}return this._afterState}},{key:"isInResult",value:function(){if(this.consumedBy)return!1;if(void 0===this._isInResult){var t=this.beforeState().multiPolys,e=this.afterState().multiPolys;switch(j.type){case"union":var r=0===t.length,n=0===e.length;this._isInResult=r!=n;break;case"intersection":var i,r=t.length<e.length?(i=t.length,e.length):(i=e.length,t.length);this._isInResult=r===j.numMultiPolys&&i<r;break;case"xor":n=Math.abs(t.length-e.length);this._isInResult=n%2==1;break;case"difference":function o(t){return 1===t.length&&t[0].isSubject}this._isInResult=o(t)!==o(e);break;default:throw new Error("Unrecognized operation type found ".concat(j.type))}}return this._isInResult}}],[{key:"fromRing",value:function(t,e,r){var n,i,o,a=O.comparePoints(t,e);if(a<0)n=t,i=e,o=1;else{if(!(0<a))throw new Error("Tried to create degenerate segment at [".concat(t.x,", ").concat(t.y,"]"));n=e,i=t,o=-1}return new g(new O(n,!0),new O(i,!1),[r],[o])}}]),E=g,e(d,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,r=this.segments.length;e<r;e++){var n=this.segments[e];t.push(n.leftSE),t.push(n.rightSE)}return t}}]),C=d,e(f,[{key:"getSweepEvents",value:function(){for(var t=this.exteriorRing.getSweepEvents(),e=0,r=this.interiorRings.length;e<r;e++)for(var n=this.interiorRings[e].getSweepEvents(),i=0,o=n.length;i<o;i++)t.push(n[i]);return t}}]),U=f,e(p,[{key:"getSweepEvents",value:function(){for(var t=[],e=0,r=this.polys.length;e<r;e++)for(var n=this.polys[e].getSweepEvents(),i=0,o=n.length;i<o;i++)t.push(n[i]);return t}}]),D=p,e(y,null,[{key:"factory",value:function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i=t[r];if(i.isInResult()&&!i.ringOut){for(var o,a=i.leftSE,s=i.rightSE,l=[a],h=a.point,u=[];o=a,a=s,l.push(a),a.point!==h;)for(;;){var c=a.getAvailableLinkedEvents();if(0===c.length)throw g=l[0].point,m=l[l.length-1].point,new Error("Unable to complete output ring starting at [".concat(g.x,",")+" ".concat(g.y,"]. Last matching segment found ends at")+" [".concat(m.x,", ").concat(m.y,"]."));if(1===c.length){s=c[0].otherSE;break}for(var p=null,f=0,d=u.length;f<d;f++)if(u[f].point===a.point){p=f;break}if(null===p){u.push({index:l.length,point:a.point});var g=a.getLeftmostComparator(o),s=c.sort(g)[0].otherSE;break}var m=u.splice(p)[0],c=l.splice(m.index);c.unshift(c[0].otherSE),e.push(new y(c.reverse()))}e.push(new y(l))}}return e}}]),e(y,[{key:"getGeom",value:function(){for(var t=this.events[0].point,e=[t],r=1,n=this.events.length-1;r<n;r++){var i=this.events[r].point,o=this.events[r+1].point;0!==N(i,t,o)&&(e.push(i),t=i)}if(1===e.length)return null;var a=e[0],s=e[1];0===N(a,t,s)&&e.shift(),e.push(e[0]);for(var l=this.isExteriorRing()?1:-1,a=this.isExteriorRing()?0:e.length-1,h=this.isExteriorRing()?e.length:-1,u=[],c=a;c!=h;c+=l)u.push([e[c].x,e[c].y]);return u}},{key:"isExteriorRing",value:function(){var t;return void 0===this._isExteriorRing&&(t=this.enclosingRing(),this._isExteriorRing=!t||!t.isExteriorRing()),this._isExteriorRing}},{key:"enclosingRing",value:function(){return void 0===this._enclosingRing&&(this._enclosingRing=this._calcEnclosingRing()),this._enclosingRing}},{key:"_calcEnclosingRing",value:function(){for(var t=this.events[0],e=1,r=this.events.length;e<r;e++){var n=this.events[e];0<O.compare(t,n)&&(t=n)}for(var i=t.segment.prevInResult(),o=i?i.prevInResult():null;;){if(!i)return null;if(!o)return i.ringOut;if(o.ringOut!==i.ringOut)return o.ringOut.enclosingRing()!==i.ringOut?i.ringOut:i.ringOut.enclosingRing();o=(i=o.prevInResult())?i.prevInResult():null}}}]),H=y,e(c,[{key:"addInterior",value:function(t){this.interiorRings.push(t),t.poly=this}},{key:"getGeom",value:function(){var t=[this.exteriorRing.getGeom()];if(null===t[0])return null;for(var e=0,r=this.interiorRings.length;e<r;e++){var n=this.interiorRings[e].getGeom();null!==n&&t.push(n)}return t}}]),R=c,e(h,[{key:"getGeom",value:function(){for(var t=[],e=0,r=this.polys.length;e<r;e++){var n=this.polys[e].getGeom();null!==n&&t.push(n)}return t}},{key:"_composePolys",value:function(t){for(var e=[],r=0,n=t.length;r<n;r++){var i,o=t[r];o.poly||(o.isExteriorRing()?e.push(new R(o)):((i=o.enclosingRing()).poly||e.push(new R(i)),i.poly.addInterior(o)))}return e}}]),V=h,e(o,[{key:"process",value:function(t){var e=t.segment,r=[];if(t.consumedBy)return t.isLeft?this.queue.remove(t.otherSE):this.tree.remove(e),r;var n=t.isLeft?this.tree.insert(e):this.tree.find(e);if(!n)throw new Error("".concat("Unable to find segment #".concat(e.id," ")+"[".concat(e.leftSE.point.x,", ").concat(e.leftSE.point.y,"] -> ")+"[".concat(e.rightSE.point.x,", ").concat(e.rightSE.point.y,"] "),"in SweepLine tree. Please submit a bug report."));for(var i=n,o=n,a=void 0,s=void 0;void 0===a;)null===(i=this.tree.prev(i))?a=null:void 0===i.key.consumedBy&&(a=i.key);for(;void 0===s;)null===(o=this.tree.next(o))?s=null:void 0===o.key.consumedBy&&(s=o.key);if(t.isLeft){n=null;if(a){var l=a.getIntersection(e);if(null!==l&&(e.isAnEndpoint(l)||(n=l),!a.isAnEndpoint(l)))for(var h=this._splitSafely(a,l),u=0,c=h.length;u<c;u++)r.push(h[u])}l=null;if(s){var p=s.getIntersection(e);if(null!==p&&(e.isAnEndpoint(p)||(l=p),!s.isAnEndpoint(p)))for(var f=this._splitSafely(s,p),d=0,g=f.length;d<g;d++)r.push(f[d])}if(null!==n||null!==l){p=null,p=null!==n&&(null===l||O.comparePoints(n,l)<=0)?n:l;this.queue.remove(e.rightSE),r.push(e.rightSE);for(var m=e.split(p),y=0,_=m.length;y<_;y++)r.push(m[y])}0<r.length?(this.tree.remove(e),r.push(t)):(this.segments.push(e),e.prev=a)}else{if(a&&s){n=a.getIntersection(s);if(null!==n){if(!a.isAnEndpoint(n))for(var v=this._splitSafely(a,n),b=0,k=v.length;b<k;b++)r.push(v[b]);if(!s.isAnEndpoint(n))for(var M=this._splitSafely(s,n),L=0,w=M.length;L<w;L++)r.push(M[L])}}this.tree.remove(e)}return r}},{key:"_splitSafely",value:function(t,e){this.tree.remove(t);var r=t.rightSE,e=(this.queue.remove(r),t.split(e));return e.push(r),void 0===t.consumedBy&&this.tree.insert(t),e}}]),J=o,T=void 0!==t&&t.env.POLYGON_CLIPPING_MAX_QUEUE_SIZE||1e6,K=void 0!==t&&t.env.POLYGON_CLIPPING_MAX_SWEEPLINE_SEGMENTS||1e6,e(i,[{key:"run",value:function(t,e,r){j.type=t,B.reset();for(var n=[new D(e,!0)],i=0,o=r.length;i<o;i++)n.push(new D(r[i],!1));if(j.numMultiPolys=n.length,"difference"===j.type)for(var a=n[0],s=1;s<n.length;)null!==S(n[s].bbox,a.bbox)?s++:n.splice(s,1);if("intersection"===j.type)for(var l=0,h=n.length;l<h;l++)for(var u=n[l],c=l+1,p=n.length;c<p;c++)if(null===S(u.bbox,n[c].bbox))return[];for(var f=new P(O.compare),d=0,g=n.length;d<g;d++)for(var m=n[d].getSweepEvents(),y=0,_=m.length;y<_;y++)if(f.insert(m[y]),f.size>T)throw new Error("Infinite loop when putting segment endpoints in a priority queue (queue size too big). Please file a bug report.");for(var v=new J(f),b=f.size,k=f.pop();k;){var M,L=k.key;if(f.size===b)throw M=L.segment,new Error("".concat("Unable to pop() ".concat(L.isLeft?"left":"right"," SweepEvent ")+"[".concat(L.point.x,", ").concat(L.point.y,"] from segment #").concat(M.id," ")+"[".concat(M.leftSE.point.x,", ").concat(M.leftSE.point.y,"] -> ")+"[".concat(M.rightSE.point.x,", ").concat(M.rightSE.point.y,"] from queue. "),"Please file a bug report."));if(f.size>T)throw new Error("Infinite loop when passing sweep line over endpoints (queue size too big). Please file a bug report.");if(v.segments.length>K)throw new Error("Infinite loop when passing sweep line over endpoints (too many sweep line segments). Please file a bug report.");for(var w=v.process(L),x=0,E=w.length;x<E;x++){var C=w[x];void 0===C.consumedBy&&f.insert(C)}b=f.size,k=f.pop()}B.reset();t=H.factory(v.segments);return new V(t).getGeom()}}]),j=new i,{union:function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return j.run("union",t,r)},intersection:function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return j.run("intersection",t,r)},xor:function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return j.run("xor",t,r)},difference:function(t){for(var e=arguments.length,r=new Array(1<e?e-1:0),n=1;n<e;n++)r[n-1]=arguments[n];return j.run("difference",t,r)}})}.call(this,e(147))},function(t,e,r){r=r(16)(r(3),"Map");t.exports=r},function(e,t,r){!function(t){t="object"===ve(t)&&t&&t.Object===Object&&t;e.exports=t}.call(this,r(78))},function(t,e,r){var n=r(85),i=r(92),o=r(94),a=r(95),r=r(96);function s(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=i,s.prototype.get=o,s.prototype.has=a,s.prototype.set=r,t.exports=s},function(t,e,r){var n=r(19),i=r(12);t.exports=function(t,e,r){(void 0===r||i(t[e],r))&&(void 0!==r||e in t)||n(t,e,r)}},function(t,e,r){var n=r(16),r=function(){try{var t=n(Object,"defineProperty");return t({},"",{}),t}catch(t){}}();t.exports=r},function(t,e,r){r=r(107)(Object.getPrototypeOf,Object);t.exports=r},function(t,e){var r=Object.prototype;t.exports=function(t){var e=t&&t.constructor;return t===("function"==typeof e&&e.prototype||r)}},function(t,o,a){!function(t){var e=a(3),r=a(110),n=o&&!o.nodeType&&o,i=n&&"object"===ve(t)&&t&&!t.nodeType&&t,i=i&&i.exports===n?e.Buffer:void 0,n=(i?i.isBuffer:void 0)||r;t.exports=n}.call(this,a(20)(t))},function(t,e,r){var n=r(112),i=r(113),r=r(114),r=r&&r.isTypedArray,i=r?i(r):n;t.exports=i},function(t,e){t.exports=function(t,e){if(("constructor"!==e||"function"!=typeof t[e])&&"__proto__"!=e)return t[e]}},function(t,e,r){var n=r(118),i=r(120),o=r(22);t.exports=function(t){return o(t)?n(t,!0):i(t)}},function(t,e){t.exports=function(t){return t}},function(t,e,r){var n=r(5),i=r(132),o=r(133),a=r(136);t.exports=function(t,e){return n(t)?t:i(t,e)?[t]:o(a(t))}},function(t,e,r){var n=r(25);t.exports=function(t){if("string"==typeof t||n(t))return t;var e="".concat(t);return"0"==e&&1/t==-1/0?"-0":e}},function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0});var n=r(15);e.default=function(t){var e=[1/0,1/0,-1/0,-1/0];return n.coordEach(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}},function(t){t.exports=JSON.parse('{"a":"2.8.0"}')},function(t,e,r){var n=r(65),r=r(122)(function(t,e,r){n(t,e,r)});t.exports=r},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Click to place marker","firstVertex":"Click to place first vertex","continueLine":"Click to continue drawing","finishLine":"Click any existing marker to finish","finishPoly":"Click first marker to finish","finishRect":"Click to finish","startCircle":"Click to place circle center","finishCircle":"Click to finish circle","placeCircleMarker":"Click to place circle marker"},"actions":{"finish":"Finish","cancel":"Cancel","removeLastVertex":"Remove Last Vertex"},"buttonTitles":{"drawMarkerButton":"Draw Marker","drawPolyButton":"Draw Polygons","drawLineButton":"Draw Polyline","drawCircleButton":"Draw Circle","drawRectButton":"Draw Rectangle","editButton":"Edit Layers","dragButton":"Drag Layers","cutButton":"Cut Layers","deleteButton":"Remove Layers","drawCircleMarkerButton":"Draw Circle Marker","snappingButton":"Snap dragged marker to other layers and vertices","pinningButton":"Pin shared vertices together"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Platziere den Marker mit Klick","firstVertex":"Platziere den ersten Marker mit Klick","continueLine":"Klicke, um weiter zu zeichnen","finishLine":"Beende mit Klick auf existierenden Marker","finishPoly":"Beende mit Klick auf ersten Marker","finishRect":"Beende mit Klick","startCircle":"Platziere das Kreiszentrum mit Klick","finishCircle":"Beende den Kreis mit Klick","placeCircleMarker":"Platziere den Kreismarker mit Klick"},"actions":{"finish":"Beenden","cancel":"Abbrechen","removeLastVertex":"Letzten Vertex löschen"},"buttonTitles":{"drawMarkerButton":"Marker zeichnen","drawPolyButton":"Polygon zeichnen","drawLineButton":"Polyline zeichnen","drawCircleButton":"Kreis zeichnen","drawRectButton":"Rechteck zeichnen","editButton":"Layer editieren","dragButton":"Layer bewegen","cutButton":"Layer schneiden","deleteButton":"Layer löschen","drawCircleMarkerButton":"Kreismarker zeichnen","snappingButton":"Bewegter Layer an andere Layer oder Vertexe einhacken","pinningButton":"Vertexe an der gleichen Position verknüpfen"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Clicca per posizionare un Marker","firstVertex":"Clicca per posizionare il primo vertice","continueLine":"Clicca per continuare a disegnare","finishLine":"Clicca qualsiasi marker esistente per terminare","finishPoly":"Clicca il primo marker per terminare","finishRect":"Clicca per terminare","startCircle":"Clicca per posizionare il punto centrale del cerchio","finishCircle":"Clicca per terminare il cerchio","placeCircleMarker":"Clicca per posizionare un Marker del cherchio"},"actions":{"finish":"Termina","cancel":"Annulla","removeLastVertex":"Rimuovi l\'ultimo vertice"},"buttonTitles":{"drawMarkerButton":"Disegna Marker","drawPolyButton":"Disegna Poligoni","drawLineButton":"Disegna Polilinea","drawCircleButton":"Disegna Cerchio","drawRectButton":"Disegna Rettangolo","editButton":"Modifica Livelli","dragButton":"Sposta Livelli","cutButton":"Ritaglia Livelli","deleteButton":"Elimina Livelli","drawCircleMarkerButton":"Disegna Marker del Cerchio","snappingButton":"Snap ha trascinato il pennarello su altri strati e vertici","pinningButton":"Pin condiviso vertici insieme"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Klik untuk menempatkan marker","firstVertex":"Klik untuk menempatkan vertex pertama","continueLine":"Klik untuk meneruskan digitasi","finishLine":"Klik pada sembarang marker yang ada untuk mengakhiri","finishPoly":"Klik marker pertama untuk mengakhiri","finishRect":"Klik untuk mengakhiri","startCircle":"Klik untuk menempatkan titik pusat lingkaran","finishCircle":"Klik untuk mengakhiri lingkaran","placeCircleMarker":"Klik untuk menempatkan penanda lingkarann"},"actions":{"finish":"Selesai","cancel":"Batal","removeLastVertex":"Hilangkan Vertex Terakhir"},"buttonTitles":{"drawMarkerButton":"Digitasi Marker","drawPolyButton":"Digitasi Polygon","drawLineButton":"Digitasi Polyline","drawCircleButton":"Digitasi Lingkaran","drawRectButton":"Digitasi Segi Empat","editButton":"Edit Layer","dragButton":"Geser Layer","cutButton":"Potong Layer","deleteButton":"Hilangkan Layer","drawCircleMarkerButton":"Digitasi Penanda Lingkaran","snappingButton":"Jepretkan penanda yang ditarik ke lapisan dan simpul lain","pinningButton":"Sematkan simpul bersama bersama"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Adaugă un punct","firstVertex":"Apasă aici pentru a adăuga primul Vertex","continueLine":"Apasă aici pentru a continua desenul","finishLine":"Apasă pe orice obiect pentru a finisa desenul","finishPoly":"Apasă pe primul obiect pentru a finisa","finishRect":"Apasă pentru a finisa","startCircle":"Apasă pentru a desena un cerc","finishCircle":"Apasă pentru a finisa un cerc","placeCircleMarker":"Adaugă un punct"},"actions":{"finish":"Termină","cancel":"Anulează","removeLastVertex":"Șterge ultimul Vertex"},"buttonTitles":{"drawMarkerButton":"Adaugă o bulină","drawPolyButton":"Desenează un poligon","drawLineButton":"Desenează o linie","drawCircleButton":"Desenează un cerc","drawRectButton":"Desenează un dreptunghi","editButton":"Editează straturile","dragButton":"Mută straturile","cutButton":"Taie straturile","deleteButton":"Șterge straturile","drawCircleMarkerButton":"Desenează marcatorul cercului","snappingButton":"Fixați marcatorul glisat pe alte straturi și vârfuri","pinningButton":"Fixați vârfurile partajate împreună"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Нажмите, чтобы нанести маркер","firstVertex":"Нажмите, чтобы нанести первый объект","continueLine":"Нажмите, чтобы продолжить рисование","finishLine":"Нажмите любой существующий маркер для завершения","finishPoly":"Выберите первую точку, чтобы закончить","finishRect":"Нажмите, чтобы закончить","startCircle":"Нажмите, чтобы добавить центр круга","finishCircle":"Нажмите, чтобы задать радиус","placeCircleMarker":"Нажмите, чтобы нанести круговой маркер"},"actions":{"finish":"Завершить","cancel":"Отменить","removeLastVertex":"Отменить последнее действие"},"buttonTitles":{"drawMarkerButton":"Добавить маркер","drawPolyButton":"Рисовать полигон","drawLineButton":"Рисовать кривую","drawCircleButton":"Рисовать круг","drawRectButton":"Рисовать прямоугольник","editButton":"Редактировать слой","dragButton":"Перенести слой","cutButton":"Вырезать слой","deleteButton":"Удалить слой","drawCircleMarkerButton":"Добавить круговой маркер","snappingButton":"Привязать перетаскиваемый маркер к другим слоям и вершинам","pinningButton":"Связать общие точки вместе"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Presiona para colocar un marcador","firstVertex":"Presiona para colocar el primer vértice","continueLine":"Presiona para continuar dibujando","finishLine":"Presiona cualquier marcador existente para finalizar","finishPoly":"Presiona el primer marcador para finalizar","finishRect":"Presiona para finalizar","startCircle":"Presiona para colocar el centro del circulo","finishCircle":"Presiona para finalizar el circulo","placeCircleMarker":"Presiona para colocar un marcador de circulo"},"actions":{"finish":"Finalizar","cancel":"Cancelar","removeLastVertex":"Remover ultimo vértice"},"buttonTitles":{"drawMarkerButton":"Dibujar Marcador","drawPolyButton":"Dibujar Polígono","drawLineButton":"Dibujar Línea","drawCircleButton":"Dibujar Circulo","drawRectButton":"Dibujar Rectángulo","editButton":"Editar Capas","dragButton":"Arrastrar Capas","cutButton":"Cortar Capas","deleteButton":"Remover Capas","drawCircleMarkerButton":"Dibujar Marcador de Circulo","snappingButton":"El marcador de Snap arrastrado a otras capas y vértices","pinningButton":"Fijar juntos los vértices compartidos"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Klik om een marker te plaatsen","firstVertex":"Klik om het eerste punt te plaatsen","continueLine":"Klik om te blijven tekenen","finishLine":"Klik op een bestaand punt om te beëindigen","finishPoly":"Klik op het eerst punt om te beëindigen","finishRect":"Klik om te beëindigen","startCircle":"Klik om het middelpunt te plaatsen","finishCircle":"Klik om de cirkel te beëindigen","placeCircleMarker":"Klik om een marker te plaatsen"},"actions":{"finish":"Bewaar","cancel":"Annuleer","removeLastVertex":"Verwijder laatste punt"},"buttonTitles":{"drawMarkerButton":"Plaats Marker","drawPolyButton":"Teken een vlak","drawLineButton":"Teken een lijn","drawCircleButton":"Teken een cirkel","drawRectButton":"Teken een vierkant","editButton":"Bewerk","dragButton":"Verplaats","cutButton":"Knip","deleteButton":"Verwijder","drawCircleMarkerButton":"Plaats Marker","snappingButton":"Snap gesleepte marker naar andere lagen en hoekpunten","pinningButton":"Speld gedeelde hoekpunten samen"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Cliquez pour placer un marqueur","firstVertex":"Cliquez pour placer le premier sommet","continueLine":"Cliquez pour continuer à dessiner","finishLine":"Cliquez sur n\'importe quel marqueur pour terminer","finishPoly":"Cliquez sur le premier marqueur pour terminer","finishRect":"Cliquez pour terminer","startCircle":"Cliquez pour placer le centre du cercle","finishCircle":"Cliquez pour finir le cercle","placeCircleMarker":"Cliquez pour placer le marqueur circulaire"},"actions":{"finish":"Terminer","cancel":"Annuler","removeLastVertex":"Retirer le dernier sommet"},"buttonTitles":{"drawMarkerButton":"Placer des marqueurs","drawPolyButton":"Dessiner des polygones","drawLineButton":"Dessiner des polylignes","drawCircleButton":"Dessiner un cercle","drawRectButton":"Dessiner un rectangle","editButton":"Éditer des calques","dragButton":"Déplacer des calques","cutButton":"Couper des calques","deleteButton":"Supprimer des calques","drawCircleMarkerButton":"Dessiner un marqueur circulaire","snappingButton":"Glisser le marqueur vers d\'autres couches et sommets","pinningButton":"Épingler ensemble les sommets partagés"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"单击放置标记","firstVertex":"单击放置首个顶点","continueLine":"单击继续绘制","finishLine":"单击任何存在的标记以完成","finishPoly":"单击第一个标记以完成","finishRect":"单击完成","startCircle":"单击放置圆心","finishCircle":"单击完成圆形","placeCircleMarker":"点击放置圆形标记"},"actions":{"finish":"完成","cancel":"取消","removeLastVertex":"移除最后的顶点"},"buttonTitles":{"drawMarkerButton":"绘制标记","drawPolyButton":"绘制多边形","drawLineButton":"绘制线段","drawCircleButton":"绘制圆形","drawRectButton":"绘制长方形","editButton":"编辑图层","dragButton":"拖拽图层","cutButton":"剪切图层","deleteButton":"删除图层","drawCircleMarkerButton":"画圆圈标记","snappingButton":"将拖动的标记捕捉到其他图层和顶点","pinningButton":"将共享顶点固定在一起"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"單擊放置標記","firstVertex":"單擊放置第一個頂點","continueLine":"單擊繼續繪製","finishLine":"單擊任何存在的標記以完成","finishPoly":"單擊第一個標記以完成","finishRect":"單擊完成","startCircle":"單擊放置圓心","finishCircle":"單擊完成圓形","placeCircleMarker":"點擊放置圓形標記"},"actions":{"finish":"完成","cancel":"取消","removeLastVertex":"移除最後一個頂點"},"buttonTitles":{"drawMarkerButton":"放置標記","drawPolyButton":"繪製多邊形","drawLineButton":"繪製線段","drawCircleButton":"繪製圓形","drawRectButton":"繪製方形","editButton":"編輯圖形","dragButton":"移動圖形","cutButton":"裁切圖形","deleteButton":"刪除圖形","drawCircleMarkerButton":"畫圓圈標記","snappingButton":"將拖動的標記對齊到其他圖層和頂點","pinningButton":"將共享頂點固定在一起"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Clique para posicionar o marcador","firstVertex":"Clique para posicionar o primeiro vértice","continueLine":"Clique para continuar desenhando","finishLine":"Clique em qualquer marcador existente para finalizar","finishPoly":"Clique no primeiro ponto para fechar o polígono","finishRect":"Clique para finalizar","startCircle":"Clique para posicionar o centro do círculo","finishCircle":"Clique para fechar o círculo","placeCircleMarker":"Clique para posicionar o marcador circular"},"actions":{"finish":"Finalizar","cancel":"Cancelar","removeLastVertex":"Remover último vértice"},"buttonTitles":{"drawMarkerButton":"Desenhar um marcador","drawPolyButton":"Desenhar um polígono","drawLineButton":"Desenhar uma polilinha","drawCircleButton":"Desenhar um círculo","drawRectButton":"Desenhar um retângulo","editButton":"Editar camada(s)","dragButton":"Mover camada(s)","cutButton":"Recortar camada(s)","deleteButton":"Remover camada(s)","drawCircleMarkerButton":"Marcador de círculos de desenho","snappingButton":"Marcador arrastado para outras camadas e vértices","pinningButton":"Vértices compartilhados de pinos juntos"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Kliknij, aby ustawić znacznik","firstVertex":"Kliknij, aby ustawić pierwszy punkt","continueLine":"Kliknij, aby kontynuować rysowanie","finishLine":"Kliknij dowolny punkt, aby zakończyć","finishPoly":"Kliknij pierwszy punkt, aby zakończyć","finishRect":"Kliknij, aby zakończyć","startCircle":"Kliknij, aby ustawić środek koła","finishCircle":"Kliknij, aby zakończyć rysowanie koła","placeCircleMarker":"Kliknij, aby ustawić okrągły znacznik"},"actions":{"finish":"Zakończ","cancel":"Anuluj","removeLastVertex":"Usuń ostatni punkt"},"buttonTitles":{"drawMarkerButton":"Narysuj znacznik","drawPolyButton":"Narysuj wielokąt","drawLineButton":"Narysuj ścieżkę","drawCircleButton":"Narysuj koło","drawRectButton":"Narysuj prostokąt","editButton":"Edytuj","dragButton":"Przesuń","cutButton":"Wytnij","deleteButton":"Usuń","drawCircleMarkerButton":"Narysuj okrągły znacznik","snappingButton":"Snap przeciągnięty marker na inne warstwy i wierzchołki","pinningButton":"Sworzeń wspólne wierzchołki razem"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Klicka för att placera markör","firstVertex":"Klicka för att placera första hörnet","continueLine":"Klicka för att fortsätta rita","finishLine":"Klicka på en existerande punkt för att slutföra","finishPoly":"Klicka på den första punkten för att slutföra","finishRect":"Klicka för att slutföra","startCircle":"Klicka för att placera cirkelns centrum","finishCircle":"Klicka för att slutföra cirkeln","placeCircleMarker":"Klicka för att placera cirkelmarkör"},"actions":{"finish":"Slutför","cancel":"Avbryt","removeLastVertex":"Ta bort sista hörnet"},"buttonTitles":{"drawMarkerButton":"Rita Markör","drawPolyButton":"Rita Polygoner","drawLineButton":"Rita Linje","drawCircleButton":"Rita Cirkel","drawRectButton":"Rita Rektangel","editButton":"Redigera Lager","dragButton":"Dra Lager","cutButton":"Klipp i Lager","deleteButton":"Ta bort Lager","drawCircleMarkerButton":"Rita Cirkelmarkör","snappingButton":"Snäpp dra markören till andra lager och hörn","pinningButton":"Fäst delade hörn tillsammans"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Κάντε κλικ για να τοποθετήσετε Δείκτη","firstVertex":"Κάντε κλικ για να τοποθετήσετε το πρώτο σημείο","continueLine":"Κάντε κλικ για να συνεχίσετε να σχεδιάζετε","finishLine":"Κάντε κλικ σε οποιονδήποτε υπάρχον σημείο για να ολοκληρωθεί","finishPoly":"Κάντε κλικ στο πρώτο σημείο για να τελειώσετε","finishRect":"Κάντε κλικ για να τελειώσετε","startCircle":"Κάντε κλικ για να τοποθετήσετε κέντρο Κύκλου","finishCircle":"Κάντε κλικ για να ολοκληρώσετε τον Κύκλο","placeCircleMarker":"Κάντε κλικ για να τοποθετήσετε Κυκλικό Δείκτη"},"actions":{"finish":"Τέλος","cancel":"Ακύρωση","removeLastVertex":"Κατάργηση τελευταίου σημείου"},"buttonTitles":{"drawMarkerButton":"Σχεδίαση Δείκτη","drawPolyButton":"Σχεδίαση Πολυγώνου","drawLineButton":"Σχεδίαση Γραμμής","drawCircleButton":"Σχεδίαση Κύκλου","drawRectButton":"Σχεδίαση Ορθογωνίου","editButton":"Επεξεργασία Επιπέδων","dragButton":"Μεταφορά Επιπέδων","cutButton":"Αποκοπή Επιπέδων","deleteButton":"Κατάργηση Επιπέδων","drawCircleMarkerButton":"Σχεδίαση Κυκλικού Δείκτη","snappingButton":"Προσκόλληση του Δείκτη μεταφοράς σε άλλα Επίπεδα και Κορυφές","pinningButton":"Περικοπή κοινών κορυφών μαζί"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Kattintson a jelölő elhelyezéséhez","firstVertex":"Kattintson az első pont elhelyezéséhez","continueLine":"Kattintson a következő pont elhelyezéséhez","finishLine":"A befejezéshez kattintson egy meglévő pontra","finishPoly":"A befejezéshez kattintson az első pontra","finishRect":"Kattintson a befejezéshez","startCircle":"Kattintson a kör középpontjának elhelyezéséhez","finishCircle":"Kattintson a kör befejezéséhez","placeCircleMarker":"Kattintson a körjelölő elhelyezéséhez"},"actions":{"finish":"Befejezés","cancel":"Mégse","removeLastVertex":"Utolsó pont eltávolítása"},"buttonTitles":{"drawMarkerButton":"Jelölő rajzolása","drawPolyButton":"Poligon rajzolása","drawLineButton":"Vonal rajzolása","drawCircleButton":"Kör rajzolása","drawRectButton":"Négyzet rajzolása","editButton":"Elemek szerkesztése","dragButton":"Elemek mozgatása","cutButton":"Elemek vágása","deleteButton":"Elemek törlése","drawCircleMarkerButton":"Kör jelölő rajzolása","snappingButton":"Kapcsolja a jelöltőt másik elemhez vagy ponthoz","pinningButton":"Közös pontok összekötése"}}')},function(t){t.exports=JSON.parse('{"tooltips":{"placeMarker":"Tryk for at placere en markør","firstVertex":"Tryk for at placere det første punkt","continueLine":"Tryk for at fortsætte linjen","finishLine":"Tryk på et eksisterende punkt for at afslutte","finishPoly":"Tryk på det første punkt for at afslutte","finishRect":"Tryk for at afslutte","startCircle":"Tryk for at placere cirklens center","finishCircle":"Tryk for at afslutte cirklen","placeCircleMarker":"Tryk for at placere en cirkelmarkør"},"actions":{"finish":"Afslut","cancel":"Afbryd","removeLastVertex":"Fjern sidste punkt"},"buttonTitles":{"drawMarkerButton":"Placer markør","drawPolyButton":"Tegn polygon","drawLineButton":"Tegn linje","drawCircleButton":"Tegn cirkel","drawRectButton":"Tegn firkant","editButton":"Rediger","dragButton":"Træk","cutButton":"Klip","deleteButton":"Fjern","drawCircleMarkerButton":"Tegn cirkelmarkør","snappingButton":"Fastgør trukket markør til andre elementer","pinningButton":"Sammenlæg delte elementer"}}')},function(t,e,r){var n=r(139),i=r(140);t.exports=function(t,e){return null!=t&&i(t,e,n)}},function(t,e,r){var n=this&&this.__importDefault||function(t){return t&&t.__esModule?t:{default:t}},s=(Object.defineProperty(e,"__esModule",{value:!0}),n(r(41))),l=n(r(145)),h=n(r(146)),u=r(9);function c(t,e){for(var r=!1,n=0;n<t.coordinates.length;n++)if(v(t.coordinates[n],e.coordinates)){r=!0;break}return r}function p(t,e){for(var r=0,n=e.coordinates;r<n.length;r++){for(var i=n[r],o=!1,a=0,s=t.coordinates;a<s.length;a++)if(v(i,s[a])){o=!0;break}if(!o)return!1}return!0}function f(t,e){for(var r=!1,n=0,i=e.coordinates;n<i.length;n++){var o=i[n];if(h.default(o,t,{ignoreEndVertices:!0})&&(r=!0),!h.default(o,t))return!1}return!!r}function d(t,e){for(var r=0,n=e.coordinates;r<n.length;r++){var i=n[r];if(!l.default(i,t,{ignoreBoundary:!0}))return!1}return!0}function g(t,e){for(var r=!1,n=0,i=e.coordinates;n<i.length;n++){var o=i[n];if(h.default({type:"Point",coordinates:o},t,{ignoreEndVertices:!0})&&(r=!0),!h.default({type:"Point",coordinates:o},t,{ignoreEndVertices:!1}))return!1}return r}function m(t,e){var r=!1,n=0;if(!_(s.default(t),s.default(e)))return!1;for(;n<e.coordinates.length-1;n++){var i=o(e.coordinates[n],e.coordinates[n+1]);if(l.default({type:"Point",coordinates:i},t,{ignoreBoundary:!0})){r=!0;break}}return r}function y(t,e){if("Feature"===t.type&&null===t.geometry)return!1;if("Feature"===e.type&&null===e.geometry)return!1;if(!_(s.default(t),s.default(e)))return!1;for(var r=0,n=u.getGeom(e).coordinates;r<n.length;r++)for(var i=0,o=n[r];i<o.length;i++){var a=o[i];if(!l.default(a,t))return!1}return!0}function _(t,e){return!(t[0]>e[0]||t[2]<e[2]||t[1]>e[1]||t[3]<e[3])}function v(t,e){return t[0]===e[0]&&t[1]===e[1]}function o(t,e){return[(t[0]+e[0])/2,(t[1]+e[1])/2]}e.default=function(t,e){var r=u.getGeom(t),n=u.getGeom(e),i=u.getType(t),o=u.getType(e),a=u.getCoords(t),s=u.getCoords(e);switch(i){case"Point":if("Point"!==o)throw new Error("feature2 ".concat(o," geometry not supported"));return v(a,s);case"MultiPoint":switch(o){case"Point":return c(r,n);case"MultiPoint":return p(r,n);default:throw new Error("feature2 ".concat(o," geometry not supported"))}case"LineString":switch(o){case"Point":return h.default(n,r,{ignoreEndVertices:!0});case"LineString":return g(r,n);case"MultiPoint":return f(r,n);default:throw new Error("feature2 ".concat(o," geometry not supported"))}case"Polygon":switch(o){case"Point":return l.default(n,r,{ignoreBoundary:!0});case"LineString":return m(r,n);case"Polygon":return y(r,n);case"MultiPoint":return d(r,n);default:throw new Error("feature2 ".concat(o," geometry not supported"))}default:throw new Error("feature1 ".concat(i," geometry not supported"))}},e.isPointInMultiPoint=c,e.isMultiPointInMultiPoint=p,e.isMultiPointOnLine=f,e.isMultiPointInPoly=d,e.isLineOnLine=g,e.isLineInPoly=m,e.isPolyInPoly=y,e.doBBoxOverlap=_,e.compareCoords=v,e.getMidpoint=o},function(t,e,r){t.exports=r(150)},function(t,e){Array.prototype.findIndex=Array.prototype.findIndex||function(t){if(null===this)throw new TypeError("Array.prototype.findIndex called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),r=e.length>>>0,n=arguments[1],i=0;i<r;i++)if(t.call(n,e[i],i,e))return i;return-1},Array.prototype.find=Array.prototype.find||function(t){if(null===this)throw new TypeError("Array.prototype.find called on null or undefined");if("function"!=typeof t)throw new TypeError("callback must be a function");for(var e=Object(this),r=e.length>>>0,n=arguments[1],i=0;i<r;i++){var o=e[i];if(t.call(n,o,i,e))return o}},"function"!=typeof Object.assign&&(Object.assign=function(t){if(null==t)throw new TypeError("Cannot convert undefined or null to object");t=Object(t);for(var e=1;e<arguments.length;e++){var r=arguments[e];if(null!=r)for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(t[n]=r[n])}return t}),[Element.prototype,CharacterData.prototype,DocumentType.prototype].forEach(function(t){t.hasOwnProperty("remove")||Object.defineProperty(t,"remove",{configurable:!0,enumerable:!0,writable:!0,value:function(){this.parentNode.removeChild(this)}})}),Array.prototype.includes||Object.defineProperty(Array.prototype,"includes",{value:function(t,e){if(null==this)throw new TypeError('"this" is null or not defined');var r=Object(this),n=r.length>>>0;if(0!=n)for(var i,o,e=0|e,a=Math.max(0<=e?e:n-Math.abs(e),0);a<n;){if((i=r[a])===(o=t)||"number"==typeof i&&"number"==typeof o&&isNaN(i)&&isNaN(o))return!0;a++}return!1}})},function(t,e,r){var h=r(66),u=r(30),c=r(97),p=r(99),f=r(2),d=r(37),g=r(36);t.exports=function n(i,o,a,s,l){i!==o&&c(o,function(t,e){var r;l=l||new h,f(t)?p(i,o,e,a,n,s,l):(r=s?s(g(i,e),t,"".concat(e),i,o,l):void 0,u(i,e,r=void 0===r?t:r))},d)}},function(t,e,r){var n=r(10),i=r(72),o=r(73),a=r(74),s=r(75),r=r(76);function l(t){t=this.__data__=new n(t);this.size=t.size}l.prototype.clear=i,l.prototype.delete=o,l.prototype.get=a,l.prototype.has=s,l.prototype.set=r,t.exports=l},function(t,e){t.exports=function(){this.__data__=[],this.size=0}},function(t,e,r){var n=r(11),i=Array.prototype.splice;t.exports=function(t){var e=this.__data__,t=n(e,t);return!(t<0||(t==e.length-1?e.pop():i.call(e,t,1),--this.size,0))}},function(t,e,r){var n=r(11);t.exports=function(t){var e=this.__data__,t=n(e,t);return t<0?void 0:e[t][1]}},function(t,e,r){var n=r(11);t.exports=function(t){return-1<n(this.__data__,t)}},function(t,e,r){var i=r(11);t.exports=function(t,e){var r=this.__data__,n=i(r,t);return n<0?(++this.size,r.push([t,e])):r[n][1]=e,this}},function(t,e,r){var n=r(10);t.exports=function(){this.__data__=new n,this.size=0}},function(t,e){t.exports=function(t){var e=this.__data__,t=e.delete(t);return this.size=e.size,t}},function(t,e){t.exports=function(t){return this.__data__.get(t)}},function(t,e){t.exports=function(t){return this.__data__.has(t)}},function(t,e,r){var i=r(10),o=r(27),a=r(29);t.exports=function(t,e){var r=this.__data__;if(r instanceof i){var n=r.__data__;if(!o||n.length<199)return n.push([t,e]),this.size=++r.size,this;r=this.__data__=new a(n)}return r.set(t,e),this.size=r.size,this}},function(t,e,r){var n=r(17),i=r(81),o=r(2),a=r(83),s=/^\[object .+?Constructor\]$/,r=Function.prototype,l=Object.prototype,r=r.toString,l=l.hasOwnProperty,h=RegExp("^".concat(r.call(l).replace(/[\\^$.*+?()[\]{}|]/g,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?"),"$"));t.exports=function(t){return!(!o(t)||i(t))&&(n(t)?h:s).test(a(t))}},function(t,e){var r=function(){return this}();try{r=r||new Function("return this")()}catch(t){"object"===("undefined"==typeof window?"undefined":ve(window))&&(r=window)}t.exports=r},function(t,e,r){var r=r(18),n=Object.prototype,o=n.hasOwnProperty,a=n.toString,s=r?r.toStringTag:void 0;t.exports=function(t){var e=o.call(t,s),r=t[s];try{var n=!(t[s]=void 0)}catch(t){}var i=a.call(t);return n&&(e?t[s]=r:delete t[s]),i}},function(t,e){var r=Object.prototype.toString;t.exports=function(t){return r.call(t)}},function(t,e,r){var r=r(82),n=(r=/[^.]+$/.exec(r&&r.keys&&r.keys.IE_PROTO||""))?"Symbol(src)_1.".concat(r):"";t.exports=function(t){return!!n&&n in t}},function(t,e,r){r=r(3)["__core-js_shared__"];t.exports=r},function(t,e){var r=Function.prototype.toString;t.exports=function(t){if(null!=t){try{return r.call(t)}catch(t){}try{return"".concat(t)}catch(t){}}return""}},function(t,e){t.exports=function(t,e){return null==t?void 0:t[e]}},function(t,e,r){var n=r(86),i=r(10),o=r(27);t.exports=function(){this.size=0,this.__data__={hash:new n,map:new(o||i),string:new n}}},function(t,e,r){var n=r(87),i=r(88),o=r(89),a=r(90),r=r(91);function s(t){var e=-1,r=null==t?0:t.length;for(this.clear();++e<r;){var n=t[e];this.set(n[0],n[1])}}s.prototype.clear=n,s.prototype.delete=i,s.prototype.get=o,s.prototype.has=a,s.prototype.set=r,t.exports=s},function(t,e,r){var n=r(13);t.exports=function(){this.__data__=n?n(null):{},this.size=0}},function(t,e){t.exports=function(t){t=this.has(t)&&delete this.__data__[t];return this.size-=t?1:0,t}},function(t,e,r){var n=r(13),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e,r=this.__data__;return n?"__lodash_hash_undefined__"===(e=r[t])?void 0:e:i.call(r,t)?r[t]:void 0}},function(t,e,r){var n=r(13),i=Object.prototype.hasOwnProperty;t.exports=function(t){var e=this.__data__;return n?void 0!==e[t]:i.call(e,t)}},function(t,e,r){var n=r(13);t.exports=function(t,e){var r=this.__data__;return this.size+=this.has(t)?0:1,r[t]=n&&void 0===e?"__lodash_hash_undefined__":e,this}},function(t,e,r){var n=r(14);t.exports=function(t){t=n(this,t).delete(t);return this.size-=t?1:0,t}},function(t,e){t.exports=function(t){var e=ve(t);return"string"==e||"number"==e||"symbol"==e||"boolean"==e?"__proto__"!==t:null===t}},function(t,e,r){var n=r(14);t.exports=function(t){return n(this,t).get(t)}},function(t,e,r){var n=r(14);t.exports=function(t){return n(this,t).has(t)}},function(t,e,r){var i=r(14);t.exports=function(t,e){var r=i(this,t),n=r.size;return r.set(t,e),this.size+=r.size==n?0:1,this}},function(t,e,r){r=r(98)();t.exports=r},function(t,e){t.exports=function(l){return function(t,e,r){for(var n=-1,i=Object(t),o=r(t),a=o.length;a--;){var s=o[l?a:++n];if(!1===e(i[s],s,i))break}return t}}},function(t,e,r){var f=r(30),d=r(100),g=r(101),m=r(104),y=r(105),_=r(21),v=r(5),b=r(109),k=r(34),M=r(17),L=r(2),w=r(111),x=r(35),E=r(36),C=r(115);t.exports=function(t,e,r,n,i,o,a){var s,l,h,u=E(t,r),c=E(e,r),p=a.get(c);p?f(t,r,p):((e=void 0===(p=o?o(u,c,"".concat(r),t,e,a):void 0))&&(l=!(s=v(c))&&k(c),h=!s&&!l&&x(c),p=c,s||l||h?p=v(u)?u:b(u)?m(u):l?d(c,!(e=!1)):h?g(c,!(e=!1)):[]:w(c)||_(c)?_(p=u)?p=C(u):L(u)&&!M(u)||(p=y(c)):e=!1),e&&(a.set(c,p),i(p,c,n,o,a),a.delete(c)),f(t,r,p))}},function(t,o,a){!function(t){var e=a(3),r=o&&!o.nodeType&&o,n=r&&"object"===ve(t)&&t&&!t.nodeType&&t,n=n&&n.exports===r?e.Buffer:void 0,i=n?n.allocUnsafe:void 0;t.exports=function(t,e){if(e)return t.slice();e=t.length,e=i?i(e):new t.constructor(e);return t.copy(e),e}}.call(this,a(20)(t))},function(t,e,r){var n=r(102);t.exports=function(t,e){e=e?n(t.buffer):t.buffer;return new t.constructor(e,t.byteOffset,t.length)}},function(t,e,r){var n=r(103);t.exports=function(t){var e=new t.constructor(t.byteLength);return new n(e).set(new n(t)),e}},function(t,e,r){r=r(3).Uint8Array;t.exports=r},function(t,e){t.exports=function(t,e){var r=-1,n=t.length;for(e=e||Array(n);++r<n;)e[r]=t[r];return e}},function(t,e,r){var n=r(106),i=r(32),o=r(33);t.exports=function(t){return"function"!=typeof t.constructor||o(t)?{}:n(i(t))}},function(t,e,r){var n=r(2),i=Object.create;function o(){}t.exports=function(t){if(!n(t))return{};if(i)return i(t);o.prototype=t;t=new o;return o.prototype=void 0,t}},function(t,e){t.exports=function(e,r){return function(t){return e(r(t))}}},function(t,e,r){var n=r(8),i=r(4);t.exports=function(t){return i(t)&&"[object Arguments]"==n(t)}},function(t,e,r){var n=r(22),i=r(4);t.exports=function(t){return i(t)&&n(t)}},function(t,e){t.exports=function(){return!1}},function(t,e,r){var n=r(8),i=r(32),o=r(4),r=Function.prototype,a=Object.prototype,s=r.toString,l=a.hasOwnProperty,h=s.call(Object);t.exports=function(t){if(!o(t)||"[object Object]"!=n(t))return!1;t=i(t);if(null===t)return!0;t=l.call(t,"constructor")&&t.constructor;return"function"==typeof t&&t instanceof t&&s.call(t)==h}},function(t,e,r){var n=r(8),i=r(23),o=r(4),a={};a["[object Float32Array]"]=a["[object Float64Array]"]=a["[object Int8Array]"]=a["[object Int16Array]"]=a["[object Int32Array]"]=a["[object Uint8Array]"]=a["[object Uint8ClampedArray]"]=a["[object Uint16Array]"]=a["[object Uint32Array]"]=!0,a["[object Arguments]"]=a["[object Array]"]=a["[object ArrayBuffer]"]=a["[object Boolean]"]=a["[object DataView]"]=a["[object Date]"]=a["[object Error]"]=a["[object Function]"]=a["[object Map]"]=a["[object Number]"]=a["[object Object]"]=a["[object RegExp]"]=a["[object Set]"]=a["[object String]"]=a["[object WeakMap]"]=!1,t.exports=function(t){return o(t)&&i(t.length)&&!!a[n(t)]}},function(t,e){t.exports=function(e){return function(t){return e(t)}}},function(t,o,a){!function(t){var e=a(28),r=o&&!o.nodeType&&o,n=r&&"object"===ve(t)&&t&&!t.nodeType&&t,i=n&&n.exports===r&&e.process,r=function(){try{return n&&n.require&&n.require("util").types||i&&i.binding&&i.binding("util")}catch(t){}}();t.exports=r}.call(this,a(20)(t))},function(t,e,r){var n=r(116),i=r(37);t.exports=function(t){return n(t,i(t))}},function(t,e,r){var h=r(117),u=r(19);t.exports=function(t,e,r,n){var i=!r;r=r||{};for(var o=-1,a=e.length;++o<a;){var s=e[o],l=n?n(r[s],t[s],s,r,t):void 0;void 0===l&&(l=t[s]),(i?u:h)(r,s,l)}return r}},function(t,e,r){var i=r(19),o=r(12),a=Object.prototype.hasOwnProperty;t.exports=function(t,e,r){var n=t[e];a.call(t,e)&&o(n,r)&&(void 0!==r||e in t)||i(t,e,r)}},function(t,e,r){var u=r(119),c=r(21),p=r(5),f=r(34),d=r(24),g=r(35),m=Object.prototype.hasOwnProperty;t.exports=function(t,e){var r,n=p(t),i=!n&&c(t),o=!n&&!i&&f(t),a=!n&&!i&&!o&&g(t),s=n||i||o||a,l=s?u(t.length,String):[],h=l.length;for(r in t)!e&&!m.call(t,r)||s&&("length"==r||o&&("offset"==r||"parent"==r)||a&&("buffer"==r||"byteLength"==r||"byteOffset"==r)||d(r,h))||l.push(r);return l}},function(t,e){t.exports=function(t,e){for(var r=-1,n=Array(t);++r<t;)n[r]=e(r);return n}},function(t,e,r){var i=r(2),o=r(33),a=r(121),s=Object.prototype.hasOwnProperty;t.exports=function(t){if(!i(t))return a(t);var e,r=o(t),n=[];for(e in t)("constructor"!=e||!r&&s.call(t,e))&&n.push(e);return n}},function(t,e){t.exports=function(t){var e=[];if(null!=t)for(var r in Object(t))e.push(r);return e}},function(t,e,r){var n=r(123),l=r(130);t.exports=function(s){return n(function(t,e){var r=-1,n=e.length,i=1<n?e[n-1]:void 0,o=2<n?e[2]:void 0,i=3<s.length&&"function"==typeof i?(n--,i):void 0;for(o&&l(e[0],e[1],o)&&(i=n<3?void 0:i,n=1),t=Object(t);++r<n;){var a=e[r];a&&s(t,a,r,i)}return t})}},function(t,e,r){var n=r(38),i=r(124),o=r(126);t.exports=function(t,e){return o(i(t,e,n),"".concat(t))}},function(t,e,r){var l=r(125),h=Math.max;t.exports=function(o,a,s){return a=h(void 0===a?o.length-1:a,0),function(){for(var t=arguments,e=-1,r=h(t.length-a,0),n=Array(r);++e<r;)n[e]=t[a+e];for(var e=-1,i=Array(a+1);++e<a;)i[e]=t[e];return i[a]=s(n),l(o,this,i)}}},function(t,e){t.exports=function(t,e,r){switch(r.length){case 0:return t.call(e);case 1:return t.call(e,r[0]);case 2:return t.call(e,r[0],r[1]);case 3:return t.call(e,r[0],r[1],r[2])}return t.apply(e,r)}},function(t,e,r){var n=r(127),r=r(129)(n);t.exports=r},function(t,e,r){var n=r(128),i=r(31),r=r(38);t.exports=i?function(t,e){return i(t,"toString",{configurable:!0,enumerable:!1,value:n(e),writable:!0})}:r},function(t,e){t.exports=function(t){return function(){return t}}},function(t,e){var o=Date.now;t.exports=function(r){var n=0,i=0;return function(){var t=o(),e=16-(t-i);if(i=t,0<e){if(800<=++n)return arguments[0]}else n=0;return r.apply(void 0,arguments)}}},function(t,e,r){var i=r(12),o=r(22),a=r(24),s=r(2);t.exports=function(t,e,r){if(!s(r))return!1;var n=ve(e);return!!("number"==n?o(r)&&a(e,r.length):"string"==n&&e in r)&&i(r[e],t)}},function(t,e,r){var i=r(39),o=r(40);t.exports=function(t,e){for(var r=0,n=(e=i(e,t)).length;null!=t&&r<n;)t=t[o(e[r++])];return r&&r==n?t:void 0}},function(t,e,r){var n=r(5),i=r(25),o=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,a=/^\w*$/;t.exports=function(t,e){if(n(t))return!1;var r=ve(t);return!("number"!=r&&"symbol"!=r&&"boolean"!=r&&null!=t&&!i(t))||a.test(t)||!o.test(t)||null!=e&&t in Object(e)}},function(t,e,r){var r=r(134),n=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,o=/\\(\\)?/g,r=r(function(t){var i=[];return 46===t.charCodeAt(0)&&i.push(""),t.replace(n,function(t,e,r,n){i.push(r?n.replace(o,"$1"):e||t)}),i});t.exports=r},function(t,e,r){var n=r(135);t.exports=function(t){var t=n(t,function(t){return 500===e.size&&e.clear(),t}),e=t.cache;return t}},function(t,e,r){var a=r(29);function s(n,i){if("function"!=typeof n||null!=i&&"function"!=typeof i)throw new TypeError("Expected a function");function o(){var t=arguments,e=i?i.apply(this,t):t[0],r=o.cache;return r.has(e)?r.get(e):(t=n.apply(this,t),o.cache=r.set(e,t)||r,t)}return o.cache=new(s.Cache||a),o}s.Cache=a,t.exports=s},function(t,e,r){var n=r(137);t.exports=function(t){return null==t?"":n(t)}},function(t,e,r){var n=r(18),i=r(138),o=r(5),a=r(25),r=n?n.prototype:void 0,s=r?r.toString:void 0;t.exports=function t(e){if("string"==typeof e)return e;if(o(e))return"".concat(i(e,t));if(a(e))return s?s.call(e):"";var r="".concat(e);return"0"==r&&1/e==-1/0?"-0":r}},function(t,e){t.exports=function(t,e){for(var r=-1,n=null==t?0:t.length,i=Array(n);++r<n;)i[r]=e(t[r],r,t);return i}},function(t,e){var r=Object.prototype.hasOwnProperty;t.exports=function(t,e){return null!=t&&r.call(t,e)}},function(t,e,r){var s=r(39),l=r(21),h=r(5),u=r(24),c=r(23),p=r(40);t.exports=function(t,e,r){for(var n=-1,i=(e=s(e,t)).length,o=!1;++n<i;){var a=p(e[n]);if(!(o=null!=t&&r(t,a)))break;t=t[a]}return o||++n!=i?o:!!(i=null==t?0:t.length)&&c(i)&&u(a,i)&&(h(t)||l(t))}},function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0});var l=r(6),a=r(9),n=r(15);e.default=function(t){if(!t)throw new Error("geojson is required");var o=[];return n.flattenEach(t,function(t){var e=t,r=o,n=[],i=e.geometry;if(null!==i){switch(i.type){case"Polygon":n=a.getCoords(i);break;case"LineString":n=[a.getCoords(i)]}n.forEach(function(t){var a,s;a=e.properties,s=[],t.reduce(function(t,e){var r,n,i,o=l.lineString([t,e],a);return o.bbox=(r=t[0],t=t[1],n=e[0],i=e[1],[r<n?r:n,t<i?t:i,n<r?r:n,i<t?t:i]),s.push(o),e}),s.forEach(function(t){t.id=r.length,r.push(t)})})}}),l.featureCollection(o)}},function(t,e,r){var n=r(143),i=r(6),o=r(15),a=r(41).default,s=o.featureEach,l=(o.coordEach,i.polygon,i.featureCollection);function h(t){t=n(t);return t.insert=function(t){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox||a(t),n.prototype.insert.call(this,t)},t.load=function(t){var e=[];return Array.isArray(t)?t.forEach(function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox||a(t),e.push(t)}):s(t,function(t){if("Feature"!==t.type)throw new Error("invalid features");t.bbox=t.bbox||a(t),e.push(t)}),n.prototype.load.call(this,e)},t.remove=function(t,e){if("Feature"!==t.type)throw new Error("invalid feature");return t.bbox=t.bbox||a(t),n.prototype.remove.call(this,t,e)},t.clear=function(){return n.prototype.clear.call(this)},t.search=function(t){t=n.prototype.search.call(this,this.toBBox(t));return l(t)},t.collides=function(t){return n.prototype.collides.call(this,this.toBBox(t))},t.all=function(){var t=n.prototype.all.call(this);return l(t)},t.toJSON=function(){return n.prototype.toJSON.call(this)},t.fromJSON=function(t){return n.prototype.fromJSON.call(this,t)},t.toBBox=function(t){var e;if(t.bbox)e=t.bbox;else if(Array.isArray(t)&&4===t.length)e=t;else if(Array.isArray(t)&&6===t.length)e=[t[0],t[1],t[3],t[4]];else if("Feature"===t.type)e=a(t);else{if("FeatureCollection"!==t.type)throw new Error("invalid geojson");e=a(t)}return{minX:e[0],minY:e[1],maxX:e[2],maxY:e[3]}},t}t.exports=h,t.exports.default=h},function(t,e,r){t.exports=n,t.exports.default=n;var s=r(144);function n(t,e){if(!(this instanceof n))return new n(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function f(t,e){d(t,0,t.children.length,e,t)}function d(t,e,r,n,i){(i=i||m(null)).minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,a=e;a<r;a++)o=t.children[a],u(i,t.leaf?n(o):o);return i}function u(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function o(t,e){return t.minX-e.minX}function a(t,e){return t.minY-e.minY}function g(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function c(t){return t.maxX-t.minX+(t.maxY-t.minY)}function p(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function h(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function m(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function y(t,e,r,n,i){for(var o,a=[e,r];a.length;)(r=a.pop())-(e=a.pop())<=n||(o=e+Math.ceil((r-e)/n/2)*n,s(t,o,e,r,i),a.push(e,o,o,r))}n.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],n=this.toBBox;if(h(t,e))for(var i,o,a,s,l=[];e;){for(i=0,o=e.children.length;i<o;i++)a=e.children[i],h(t,s=e.leaf?n(a):a)&&(e.leaf?r.push(a):p(t,s)?this._all(a,r):l.push(a));e=l.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(h(t,e))for(var n,i,o,a,s=[];e;){for(n=0,i=e.children.length;n<i;n++)if(o=e.children[n],h(t,a=e.leaf?r(o):o)){if(e.leaf||p(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(t&&t.length)if(t.length<this._minEntries)for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);else{var n,i=this._build(t.slice(),0,t.length-1,0);this.data.children.length?this.data.height===i.height?this._splitRoot(this.data,i):(this.data.height<i.height&&(n=this.data,this.data=i,i=n),this._insert(i,this.data.height-i.height-1,!0)):this.data=i}return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=m([]),this},remove:function(t,e){if(t)for(var r,n,i,o,a=this.data,s=this.toBBox(t),l=[],h=[];a||l.length;){if(a||(a=l.pop(),n=l[l.length-1],r=h.pop(),o=!0),a.leaf&&-1!==(i=function(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}(t,a.children,e)))return a.children.splice(i,1),l.push(a),this._condense(l),this;o||a.leaf||!p(a,s)?n?(r++,a=n.children[r],o=!1):a=null:(l.push(a),h.push(r),a=(n=a).children[r=0])}return this},toBBox:function(t){return t},compareMinX:o,compareMinY:a,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,n){var i,o=r-e+1,a=this._maxEntries;if(o<=a)return f(i=m(t.slice(e,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(i=m([])).leaf=!1,i.height=n;var s,l,h,u,c=Math.ceil(o/a),p=c*Math.ceil(Math.sqrt(a));for(y(t,e,r,p,this.compareMinX),s=e;s<=r;s+=p)for(y(t,s,h=Math.min(s+p-1,r),c,this.compareMinY),l=s;l<=h;l+=c)u=Math.min(l+c-1,h),i.children.push(this._build(t,l,u,n-1));return f(i,this.toBBox),i},_chooseSubtree:function(t,e,r,n){for(var i,o,a,s,l,h,u,c,p;n.push(e),!e.leaf&&n.length-1!==r;){for(h=u=1/0,i=0,o=e.children.length;i<o;i++)l=g(a=e.children[i]),c=t,p=a,(p=(Math.max(p.maxX,c.maxX)-Math.min(p.minX,c.minX))*(Math.max(p.maxY,c.maxY)-Math.min(p.minY,c.minY))-l)<u?(u=p,h=l<h?l:h,s=a):p===u&&l<h&&(h=l,s=a);e=s||e.children[0]}return e},_insert:function(t,e,r){var n=this.toBBox,r=r?t:n(t),i=[],n=this._chooseSubtree(r,this.data,e,i);for(n.children.push(t),u(n,r);0<=e&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},_split:function(t,e){var r=t[e],n=r.children.length,i=this._minEntries,i=(this._chooseSplitAxis(r,i,n),this._chooseSplitIndex(r,i,n)),n=m(r.children.splice(i,r.children.length-i));n.height=r.height,n.leaf=r.leaf,f(r,this.toBBox),f(n,this.toBBox),e?t[e-1].children.push(n):this._splitRoot(r,n)},_splitRoot:function(t,e){this.data=m([t,e]),this.data.height=t.height+1,this.data.leaf=!1,f(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){for(var n,i,o,a,s,l,h,u,c,p=o=1/0,f=e;f<=r-e;f++)c=n=d(t,0,f,this.toBBox),s=i=d(t,f,r,this.toBBox),l=Math.max(c.minX,s.minX),h=Math.max(c.minY,s.minY),u=Math.min(c.maxX,s.maxX),c=Math.min(c.maxY,s.maxY),s=Math.max(0,u-l)*Math.max(0,c-h),u=g(n)+g(i),s<p?(p=s,a=f,o=u<o?u:o):s===p&&u<o&&(o=u,a=f);return a},_chooseSplitAxis:function(t,e,r){var n=t.leaf?this.compareMinX:o,i=t.leaf?this.compareMinY:a;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)},_allDistMargin:function(t,e,r,n){t.children.sort(n);for(var i,o=this.toBBox,a=d(t,0,e,o),s=d(t,r-e,r,o),l=c(a)+c(s),h=e;h<r-e;h++)i=t.children[h],u(a,t.leaf?o(i):i),l+=c(a);for(h=r-e-1;e<=h;h--)i=t.children[h],u(s,t.leaf?o(i):i),l+=c(s);return l},_adjustParentBBoxes:function(t,e,r){for(var n=r;0<=n;n--)u(e[n],t)},_condense:function(t){for(var e,r=t.length-1;0<=r;r--)0===t[r].children.length?0<r?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():f(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a".concat(t[0],", minY: a").concat(t[1],", maxX: a").concat(t[2],", maxY: a").concat(t[3],"};"))}}},function(t,e,r){function f(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function o(t,e){return t<e?-1:e<t?1:0}t.exports=function(t,e,r,n,i){!function t(e,r,n,i,o){for(;n<i;){600<i-n&&(a=i-n+1,s=r-n+1,h=Math.log(a),l=.5*Math.exp(2*h/3),h=.5*Math.sqrt(h*l*(a-l)/a)*(s-a/2<0?-1:1),t(e,r,Math.max(n,Math.floor(r-s*l/a+h)),Math.min(i,Math.floor(r+(a-s)*l/a+h)),o));var a,s,l,h,u=e[r],c=n,p=i;for(f(e,n,r),0<o(e[i],u)&&f(e,n,i);c<p;){for(f(e,c,p),c++,p--;o(e[c],u)<0;)c++;for(;0<o(e[p],u);)p--}0===o(e[n],u)?f(e,n,p):f(e,++p,i),p<=r&&(n=p+1),r<=p&&(i=p-1)}}(t,e,r||0,n||t.length-1,i||o)}},function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0});var u=r(9);function c(t,e,r){for(var n=!1,i=0,o=(e=e[0][0]===e[e.length-1][0]&&e[0][1]===e[e.length-1][1]?e.slice(0,e.length-1):e).length-1;i<e.length;o=i++){var a=e[i][0],s=e[i][1],l=e[o][0],h=e[o][1];if(t[1]*(a-l)+s*(l-t[0])+h*(t[0]-a)==0&&(a-t[0])*(l-t[0])<=0&&(s-t[1])*(h-t[1])<=0)return!r;s>t[1]!=h>t[1]&&t[0]<(l-a)*(t[1]-s)/(h-s)+a&&(n=!n)}return n}e.default=function(t,e,r){if(void 0===r&&(r={}),!t)throw new Error("point is required");if(!e)throw new Error("polygon is required");var n=u.getCoord(t),t=u.getGeom(e),i=t.type,e=e.bbox,o=t.coordinates;if(e&&!1==(e[0]<=n[0]&&e[1]<=n[1]&&e[2]>=n[0]&&e[3]>=n[1]))return!1;"Polygon"===i&&(o=[o]);for(var a=!1,s=0;s<o.length&&!a;s++)if(c(n,o[s][0],r.ignoreBoundary)){for(var l=!1,h=1;h<o[s].length&&!l;)c(n,o[s][h],!r.ignoreBoundary)&&(l=!0),h++;l||(a=!0)}return a}},function(t,e,r){Object.defineProperty(e,"__esModule",{value:!0});var g=r(9);e.default=function(t,e,r){void 0===r&&(r={});for(var n,i,o,a,s,l,h,u,c=g.getCoord(t),p=g.getCoords(e),f=0;f<p.length-1;f++){var d=!1;if(r.ignoreEndVertices&&(0===f&&(d="start"),f===p.length-2&&(d="end"),0===f&&f+1===p.length-1&&(d="both")),n=p[f],i=p[f+1],d=d,u=h=l=s=a=o=void 0,o=c[0],a=c[1],s=n[0],n=n[1],l=i[0],i=i[1],h=l-s,u=i-n,(c[0]-s)*u-(c[1]-n)*h==0&&(d?"start"===d?Math.abs(h)>=Math.abs(u)?0<h?s<o&&o<=l:l<=o&&o<s:0<u?n<a&&a<=i:i<=a&&a<n:"end"===d?Math.abs(h)>=Math.abs(u)?0<h?s<=o&&o<l:l<o&&o<=s:0<u?n<=a&&a<i:i<a&&a<=n:"both"===d&&(Math.abs(h)>=Math.abs(u)?0<h?s<o&&o<l:l<o&&o<s:0<u?n<a&&a<i:i<a&&a<n):Math.abs(h)>=Math.abs(u)?0<h?s<=o&&o<=l:l<=o&&o<=s:0<u?n<=a&&a<=i:i<=a&&a<=n))return!0}return!1}},function(t,e){var r,n,t=t.exports={};function i(){throw new Error("setTimeout has not been defined")}function o(){throw new Error("clearTimeout has not been defined")}function a(e){if(r===setTimeout)return setTimeout(e,0);if((r===i||!r)&&setTimeout)return(r=setTimeout)(e,0);try{return r(e,0)}catch(t){try{return r.call(null,e,0)}catch(t){return r.call(this,e,0)}}}try{r="function"==typeof setTimeout?setTimeout:i}catch(t){r=i}try{n="function"==typeof clearTimeout?clearTimeout:o}catch(t){n=o}var s,l=[],h=!1,u=-1;function c(){h&&s&&(h=!1,s.length?l=s.concat(l):u=-1,l.length&&p())}function p(){if(!h){var t=a(c);h=!0;for(var e=l.length;e;){for(s=l,l=[];++u<e;)s&&s[u].run();u=-1,e=l.length}s=null,h=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===o||!n)&&clearTimeout)return(n=clearTimeout)(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(t)}}function f(t,e){this.fun=t,this.array=e}function d(){}t.nextTick=function(t){var e=new Array(arguments.length-1);if(1<arguments.length)for(var r=1;r<arguments.length;r++)e[r-1]=arguments[r];l.push(new f(t,e)),1!==l.length||h||a(p)},f.prototype.run=function(){this.fun.apply(null,this.array)},t.title="browser",t.browser=!0,t.env={},t.argv=[],t.version="",t.versions={},t.on=d,t.addListener=d,t.once=d,t.off=d,t.removeListener=d,t.removeAllListeners=d,t.emit=d,t.prependListener=d,t.prependOnceListener=d,t.listeners=function(t){return[]},t.binding=function(t){throw new Error("process.binding is not supported")},t.cwd=function(){return"/"},t.chdir=function(t){throw new Error("process.chdir is not supported")},t.umask=function(){return 0}},function(t,e,r){},function(t,e,r){},function(I,A,t){t.r(A),t(64);var A=t(42),e=t(43),G=t.n(e),e=t(44),N=t(45),z=t(46),r=t(47),F=t(48),Y=t(49),n=t(50),X=t(51),q=t(52),i=t(53),o=t(54),a={en:e,de:N,it:z,id:r,ro:F,ru:Y,es:n,nl:X,fr:q,pt_br:t(55),zh:i,zh_tw:o,pl:t(56),sv:t(57),el:t(58),hu:t(59),da:t(60)},e=t(0),h=t.n(e),N=t(61),U=t.n(N);function c(t){var e=_e.PM.activeLang;return U()(a,e)||(e="en"),h()(a[e],t)}function H(t){return!function r(t){return t.filter(function(t){return![null,"",void 0].includes(t)}).reduce(function(t,e){return t.concat(Array.isArray(e)?r(e):e)},[])}(t).length}function V(t){return t.reduce(function(t,e){return 0!==e.length&&t.push(Array.isArray(e)?V(e):e),t},[])}function J(t,e,r,n){for(var i,o=[],a=0;a<r;a+=1)i=function(t,e,r){for(var n,i,o,a=6356752.3142,s=1/298.257223563,l=t.lng,t=t.lat,h=r,r=Math.PI,e=e*r/180,u=Math.sin(e),e=Math.cos(e),t=(1-s)*Math.tan(t*r/180),c=1/Math.sqrt(1+t*t),p=t*c,f=Math.atan2(t,e),d=1-(t=c*u)*t,g=272331606681.9453*d/(a*a),m=1+g/16384*(4096+g*(g*(320-175*g)-768)),y=g/1024*(256+g*(g*(74-47*g)-128)),_=h/(a*m),v=2*Math.PI;1e-12<Math.abs(_-v);)n=Math.cos(2*f+_),v=_,_=h/(a*m)+y*(i=Math.sin(_))*(n+y/4*((o=Math.cos(_))*(2*n*n-1)-y/6*n*(4*i*i-3)*(4*n*n-3)));return g=p*i-c*o*e,g=Math.atan2(p*o+c*i*e,(1-s)*Math.sqrt(t*t+g*g)),d=s/16*d*(4+s*(4-3*d)),l+=180*(Math.atan2(i*u,c*o-p*i*e)-(1-d)*s*t*(_+d*i*(n+d*o*(2*n*n-1))))/r,_e.latLng(l,180*g/r)}(t,360*a/r+n,e),i=_e.latLng(i.lng,i.lat),o.push(i);return o}function s(t,e,r,n){return i=e,r=r,e=(t=t).latLngToContainerPoint(e),t=t.latLngToContainerPoint(r),r=180*Math.atan2(t.y-e.y,t.x-e.x)/Math.PI+90,t=r+(r<0?360:0),e=n,r=Math.PI/180,n=180/Math.PI,o=i.lng*r,i=i.lat*r,t=(t+360)%360*r,r=Math.sin(i),i=Math.cos(i),a=Math.cos(e/6378137),e=Math.sin(e/6378137),s=Math.asin(r*a+i*e*Math.cos(t)),o=180<(o=(o+=Math.atan2(Math.sin(t)*e*i,a-r*Math.sin(s)))*n)?o-360:o<-180?o+360:o,_e.latLng([s*n,o]);var i,o,a,s}var u={calcMiddleLatLng:function(t,e,r){e=t.project(e),r=t.project(r);return t.unproject(e._add(r)._divideBy(2))},findLayers:function(t){var e=[];return t.eachLayer(function(t){(t instanceof _e.Polyline||t instanceof _e.Marker||t instanceof _e.Circle||t instanceof _e.CircleMarker||t instanceof _e.ImageOverlay)&&e.push(t)}),e=(e=e.filter(function(t){return!!t.pm})).filter(function(t){return!t._pmTempLayer})},circleToPolygon:function(t){for(var e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:60,r=J(t.getLatLng(),t.getRadius(),e,0),n=[],i=0;i<r.length;i+=1){var o=[r[i].lat,r[i].lng];n.push(o)}return _e.polygon(n,t.options)},disablePopup:function(t){t.getPopup()&&(t._tempPopupCopy=t.getPopup(),t.unbindPopup())},enablePopup:function(t){t._tempPopupCopy&&(t.bindPopup(t._tempPopupCopy),delete t._tempPopupCopy)},_fireEvent:function(t,e,r){var n=3<arguments.length&&void 0!==arguments[3]&&arguments[3];t.fire(e,r,n),this.getAllParentGroups(t).groups.forEach(function(t){t.fire(e,r,n)})},getAllParentGroups:function(t){var n=[],i=[];return!t._pmLastGroupFetch||!t._pmLastGroupFetch.time||1e3<(new Date).getTime()-t._pmLastGroupFetch.time?(function t(e){for(var r in e._eventParents)-1===n.indexOf(r)&&(n.push(r),r=e._eventParents[r],i.push(r),t(r))}(t),t._pmLastGroupFetch={time:(new Date).getTime(),groups:i,groupIds:n},{groupIds:n,groups:i}):{groups:t._pmLastGroupFetch.groups,groupIds:t._pmLastGroupFetch.groupIds}},createGeodesicPolygon:J,getTranslation:c,findDeepCoordIndex:function(t,i){t.some(function r(n){return function(t,e){e=n.concat(e);return t.lat&&t.lat===i.lat&&t.lng===i.lng?(o=e,!0):Array.isArray(t)&&t.some(r(e))}}([]));var o,t={};return t=o?{indexPath:o,index:o[o.length-1],parentPath:o.slice(0,o.length-1)}:t},_getIndexFromSegment:function(t,e){var r;return e&&2===e.length?(r=this.findDeepCoordIndex(t,e[0]),t=this.findDeepCoordIndex(t,e[1]),e=Math.max(r.index,t.index),0!==r.index&&0!==t.index||1===e||(e+=1),{indexA:r,indexB:t,newIndex:e,indexPath:r.indexPath,parentPath:r.parentPath}):null}};function K(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)),n}function $(n){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?K(Object(i),!0).forEach(function(t){var e,r;e=n,r=i[t=t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):K(Object(i)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(i,t))})}return n}var Z=u.findLayers,W=u.findLayers;function Q(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)),n}function tt(n){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?Q(Object(i),!0).forEach(function(t){var e,r;e=n,r=i[t=t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(i)):Q(Object(i)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(i,t))})}return n}var l=u.findLayers,z=_e.Class.extend({includes:[{_globalEditMode:!1,enableGlobalEditMode:function(t){var e=$({snappable:this._globalSnappingEnabled},t);this.Toolbar.toggleButton("editMode",!0),Z(this.map).forEach(function(t){t.pm.enable(e)}),this.throttledReInitEdit||(this.throttledReInitEdit=_e.Util.throttle(this.handleLayerAdditionInGlobalEditMode,100,this)),this._addedLayers=[],this.map.on("layeradd",this._layerAdded,this),this.map.on("layeradd",this.throttledReInitEdit,this),this.setGlobalEditStatus(!0)},disableGlobalEditMode:function(){Z(this.map).forEach(function(t){t.pm.disable()}),this.map.off("layeradd",this.throttledReInitEdit,this),this.Toolbar.toggleButton("editMode",!1),this.setGlobalEditStatus(!1)},globalEditEnabled:function(){return this.globalEditModeEnabled()},globalEditModeEnabled:function(){return this._globalEditMode},setGlobalEditStatus:function(t){this._globalEditMode=t,this._fireEditModeEvent(this._globalEditMode)},toggleGlobalEditMode:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.globalOptions;this.globalEditModeEnabled()?this.disableGlobalEditMode():this.enableGlobalEditMode(t)},handleLayerAdditionInGlobalEditMode:function(){var e=this,t=this._addedLayers;this._addedLayers=[],t.forEach(function(t){t.pm&&!t._pmTempLayer&&e.globalEditModeEnabled()&&t.pm.enable($({},e.globalOptions))})},_layerAdded:function(t){t=t.layer;this._addedLayers.push(t)},_fireEditModeEvent:function(t){u._fireEvent(this.map,"pm:globaleditmodetoggled",{enabled:t,map:this.map})}},{enableGlobalDragMode:function(){var t=W(this.map);this._globalDragMode=!0,t.forEach(function(t){t.pm.enableLayerDrag()}),this.throttledReInitDrag||(this.throttledReInitDrag=_e.Util.throttle(this.reinitGlobalDragMode,100,this)),this.map.on("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this._globalDragMode),this._fireDragModeEvent(!0)},disableGlobalDragMode:function(){var t=W(this.map);this._globalDragMode=!1,t.forEach(function(t){t.pm.disableLayerDrag()}),this.map.off("layeradd",this.throttledReInitDrag,this),this.Toolbar.toggleButton("dragMode",this._globalDragMode),this._fireDragModeEvent(!1)},globalDragModeEnabled:function(){return!!this._globalDragMode},toggleGlobalDragMode:function(){this.globalDragModeEnabled()?this.disableGlobalDragMode():this.enableGlobalDragMode()},reinitGlobalDragMode:function(t){t=t.layer;t.pm&&!t._pmTempLayer&&this.globalDragModeEnabled()&&(this.disableGlobalDragMode(),this.enableGlobalDragMode())},_fireDragModeEvent:function(t){u._fireEvent(this.map,"pm:globaldragmodetoggled",{enabled:t,map:this.map})}},{enableGlobalRemovalMode:function(){var e=this;this._globalRemovalMode=!0,this.map.eachLayer(function(t){!t.pm||t instanceof _e.LayerGroup||(t.pm.disable(),t.on("click",e.removeLayer,e))}),this.throttledReInitRemoval||(this.throttledReInitRemoval=_e.Util.throttle(this.reinitGlobalRemovalMode,100,this)),this.map.on("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("deleteLayer",this._globalRemovalMode),this._fireRemovalModeEvent(!0)},disableGlobalRemovalMode:function(){var e=this;this._globalRemovalMode=!1,this.map.eachLayer(function(t){t.off("click",e.removeLayer,e)}),this.map.off("layeradd",this.throttledReInitRemoval,this),this.Toolbar.toggleButton("deleteLayer",this._globalRemovalMode),this._fireRemovalModeEvent(!1)},globalRemovalEnabled:function(){return this.globalRemovalModeEnabled()},globalRemovalModeEnabled:function(){return!!this._globalRemovalMode},toggleGlobalRemovalMode:function(){this.globalRemovalModeEnabled()?this.disableGlobalRemovalMode():this.enableGlobalRemovalMode()},reinitGlobalRemovalMode:function(t){t=t.layer;t.pm&&!t._pmTempLayer&&this.globalRemovalModeEnabled()&&(this.disableGlobalRemovalMode(),this.enableGlobalRemovalMode())},_fireRemovalModeEvent:function(t){u._fireEvent(this.map,"pm:globalremovalmodetoggled",{enabled:t,map:this.map})},removeLayer:function(t){t=t.target;t._pmTempLayer||t.pm&&t.pm.dragging()||(t.removeFrom(this.map.pm._getContainingLayer()),t.remove(),t instanceof _e.LayerGroup?(u._fireEvent(t,"pm:remove",{layer:t,shape:void 0}),u._fireEvent(this.map,"pm:remove",{layer:t,shape:void 0})):(u._fireEvent(t,"pm:remove",{layer:t,shape:t.pm.getShape()}),u._fireEvent(this.map,"pm:remove",{layer:t,shape:t.pm.getShape()})))}}],initialize:function(t){this.map=t,this.Draw=new _e.PM.Draw(t),this.Toolbar=new _e.PM.Toolbar(t),this._globalRemovalMode=!1,this.globalOptions={snappable:!0,layerGroup:void 0,snappingOrder:["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"]}},setLang:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"en",e=1<arguments.length?arguments[1]:void 0,r=2<arguments.length&&void 0!==arguments[2]?arguments[2]:"en",n=_e.PM.activeLang;e&&(a[t]=G()(a[r],e)),_e.PM.activeLang=t,this.map.pm.Toolbar.reinit(),u._fireEvent(this.map,"pm:langchange",{oldLang:n,activeLang:t,fallback:r,translations:a[t]})},addControls:function(t){this.Toolbar.addControls(t)},removeControls:function(){this.Toolbar.removeControls()},toggleControls:function(){this.Toolbar.toggleControls()},controlsVisible:function(){return this.Toolbar.isVisible},enableDraw:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Polygon";this.Draw.enable(t="Poly"===t?"Polygon":t,1<arguments.length?arguments[1]:void 0)},disableDraw:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:"Polygon";this.Draw.disable(t="Poly"===t?"Polygon":t)},setPathOptions:function(e){var r=this,n=(1<arguments.length&&void 0!==arguments[1]?arguments[1]:{}).ignoreShapes||[];this.map.pm.Draw.shapes.forEach(function(t){-1===n.indexOf(t)&&r.map.pm.Draw[t].setPathOptions(e)})},getGlobalOptions:function(){return this.globalOptions},setGlobalOptions:function(t){var e=this,r=tt(tt({},this.globalOptions),t),t=!1;this.map.pm.Draw.CircleMarker.enabled()&&this.map.pm.Draw.CircleMarker.options.editable!==r.editable&&(this.map.pm.Draw.CircleMarker.disable(),t=!0),this.map.pm.Draw.shapes.forEach(function(t){e.map.pm.Draw[t].setOptions(r)}),t&&this.map.pm.Draw.CircleMarker.enable(),l(this.map).forEach(function(t){t.pm.setOptions(r)}),this.applyGlobalOptions(),this.globalOptions=r},applyGlobalOptions:function(){l(this.map).forEach(function(t){t.pm.enabled()&&t.pm.applyOptions()})},globalDrawModeEnabled:function(){return!!this.Draw.getActiveShape()},globalCutModeEnabled:function(){return!!this.Draw.Cut.enabled()},enableGlobalCutMode:function(t){return this.Draw.Cut.enable(t)},toggleGlobalCutMode:function(t){return this.Draw.Cut.toggle(t)},disableGlobalCutMode:function(){return this.Draw.Cut.disable()},getGeomanLayers:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=l(this.map);if(!t)return e;var r=_e.featureGroup();return r._pmTempLayer=!0,e.forEach(function(t){r.addLayer(t)}),r},getGeomanDrawLayers:function(){var t=0<arguments.length&&void 0!==arguments[0]&&arguments[0],e=l(this.map).filter(function(t){return!0===t._drawnByGeoman});if(!t)return e;var r=_e.featureGroup();return r._pmTempLayer=!0,e.forEach(function(t){r.addLayer(t)}),r},_getContainingLayer:function(){return this.globalOptions.layerGroup&&this.globalOptions.layerGroup instanceof _e.LayerGroup?this.globalOptions.layerGroup:this.map}}),r=_e.Control.extend({options:{position:"topleft"},initialize:function(t){this._button=Object.assign({},this.options,t)},onAdd:function(t){return this._map=t,this._map.pm.Toolbar.options.oneBlock?this._container=this._map.pm.Toolbar._createContainer(this.options.position):"edit"===this._button.tool?this._container=this._map.pm.Toolbar.editContainer:"options"===this._button.tool?this._container=this._map.pm.Toolbar.optionsContainer:"custom"===this._button.tool?this._container=this._map.pm.Toolbar.customContainer:this._container=this._map.pm.Toolbar.drawContainer,this.buttonsDomNode=this._makeButton(this._button),this._container.appendChild(this.buttonsDomNode),this._container},onRemove:function(){return this.buttonsDomNode.remove(),this._container},getText:function(){return this._button.text},getIconUrl:function(){return this._button.iconUrl},destroy:function(){this._button={},this._update()},toggle:function(t){return this._button.toggleStatus="boolean"==typeof t?t:!this._button.toggleStatus,this._applyStyleClasses(),this._button.toggleStatus},toggled:function(){return this._button.toggleStatus},onCreate:function(){this.toggle(!1)},_triggerClick:function(t){this._button.onClick(t,{button:this,event:t}),this._clicked(t),this._button.afterClick(t,{button:this,event:t})},_makeButton:function(i){var o=this,e=-1<this.options.position.indexOf("right")?"pos-right":"",t=_e.DomUtil.create("div","button-container",this._container),r=_e.DomUtil.create("a","leaflet-buttons-control-button",t),a=_e.DomUtil.create("div","leaflet-pm-actions-container ".concat(e),t),n=i.actions,s={cancel:{text:c("actions.cancel"),onClick:function(){this._triggerClick()}},finishMode:{text:c("actions.finish"),onClick:function(){this._triggerClick()}},removeLastVertex:{text:c("actions.removeLastVertex"),onClick:function(){this._map.pm.Draw[i.jsClass]._removeLastVertex()}},finish:{text:c("actions.finish"),onClick:function(t){this._map.pm.Draw[i.jsClass]._finishShape(t)}}},n=(n.forEach(function(t){var n;if(s[t])n=s[t];else{if(!t.text)return;n=t}t=_e.DomUtil.create("a","leaflet-pm-action ".concat(e," action-").concat(t),a);t.innerHTML=n.text,!i.disabled&&n.onClick&&(_e.DomEvent.addListener(t,"click",function(){var t,e="",r=o._map.pm.Toolbar.buttons;for(t in r)if(r[t]._button===i){e=t;break}u._fireEvent(o._map,"pm:actionclick",{text:n.text,action:n,btnName:e,button:i})},o),_e.DomEvent.addListener(t,"click",n.onClick,o)),_e.DomEvent.disableClickPropagation(t)}),i.toggleStatus&&_e.DomUtil.addClass(t,"active"),_e.DomUtil.create("div","control-icon",r));return i.title&&n.setAttribute("title",i.title),i.iconUrl&&n.setAttribute("src",i.iconUrl),i.className&&_e.DomUtil.addClass(n,i.className),i.disabled||(_e.DomEvent.addListener(r,"click",function(){o._button.disableOtherButtons&&o._map.pm.Toolbar.triggerClickOnToggledButtons(o);var t,e="",r=o._map.pm.Toolbar.buttons;for(t in r)if(r[t]._button===i){e=t;break}u._fireEvent(o._map,"pm:buttonclick",{btnName:e,button:i})}),_e.DomEvent.addListener(r,"click",this._triggerClick,this)),i.disabled&&(_e.DomUtil.addClass(r,"pm-disabled"),_e.DomUtil.addClass(n,"pm-disabled")),_e.DomEvent.disableClickPropagation(r),t},_applyStyleClasses:function(){this._container&&(this._button.toggleStatus&&!1!==this._button.cssToggle?(_e.DomUtil.addClass(this.buttonsDomNode,"active"),_e.DomUtil.addClass(this._container,"activeChild")):(_e.DomUtil.removeClass(this.buttonsDomNode,"active"),_e.DomUtil.removeClass(this._container,"activeChild")))},_clicked:function(){this._button.doToggle&&this.toggle()}});function et(t){return(et="function"==typeof Symbol&&"symbol"===ve(Symbol.iterator)?function(t){return ve(t)}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":ve(t)})(t)}_e.Control.PMButton=r;var F=_e.Class.extend({options:{drawMarker:!0,drawRectangle:!0,drawPolyline:!0,drawPolygon:!0,drawCircle:!0,drawCircleMarker:!0,editMode:!0,dragMode:!0,cutPolygon:!0,removalMode:!0,snappingOption:!0,drawControls:!0,editControls:!0,optionsControls:!0,customControls:!0,oneBlock:!1,position:"topleft",positions:{draw:"",edit:"",options:"",custom:""}},customButtons:[],initialize:function(t){this.init(t)},reinit:function(){var t=this.isVisible;this.removeControls(),this._defineButtons(),t&&this.addControls()},init:function(t){this.map=t,this.buttons={},this.isVisible=!1,this.drawContainer=_e.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-draw leaflet-bar leaflet-control"),this.editContainer=_e.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-edit leaflet-bar leaflet-control"),this.optionsContainer=_e.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-options leaflet-bar leaflet-control"),this.customContainer=_e.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-custom leaflet-bar leaflet-control"),this._defineButtons()},_createContainer:function(t){var e="".concat(t,"Container");return this[e]||(this[e]=_e.DomUtil.create("div","leaflet-pm-toolbar leaflet-pm-".concat(t," leaflet-bar leaflet-control"))),this[e]},getButtons:function(){return this.buttons},addControls:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options;void 0!==t.editPolygon&&(t.editMode=t.editPolygon),void 0!==t.deleteLayer&&(t.removalMode=t.deleteLayer),_e.Util.setOptions(this,t),this.applyIconStyle(),this._showHideButtons(),this.isVisible=!0},applyIconStyle:function(){var t,e=this.getButtons(),r={geomanIcons:{drawMarker:"control-icon leaflet-pm-icon-marker",drawPolyline:"control-icon leaflet-pm-icon-polyline",drawRectangle:"control-icon leaflet-pm-icon-rectangle",drawPolygon:"control-icon leaflet-pm-icon-polygon",drawCircle:"control-icon leaflet-pm-icon-circle",drawCircleMarker:"control-icon leaflet-pm-icon-circle-marker",editMode:"control-icon leaflet-pm-icon-edit",dragMode:"control-icon leaflet-pm-icon-drag",cutPolygon:"control-icon leaflet-pm-icon-cut",removalMode:"control-icon leaflet-pm-icon-delete"}};for(t in e){var n=e[t];_e.Util.setOptions(n,{className:r.geomanIcons[t]})}},removeControls:function(){var t,e=this.getButtons();for(t in e)e[t].remove();this.isVisible=!1},toggleControls:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.options;this.isVisible?this.removeControls():this.addControls(t)},_addButton:function(t,e){return this.buttons[t]=e,this.options[t]=this.options[t]||!1,this.buttons[t]},triggerClickOnToggledButtons:function(t){var e,r=["snappingOption"];for(e in this.buttons)!r.includes(e)&&this.buttons[e]!==t&&this.buttons[e].toggled()&&this.buttons[e]._triggerClick()},toggleButton:function(t,e){return"deleteLayer"===(t="editPolygon"===t?"editMode":t)&&(t="removalMode"),2<arguments.length&&void 0!==arguments[2]&&!arguments[2]||this.triggerClickOnToggledButtons(this.buttons[t]),!!this.buttons[t]&&this.buttons[t].toggle(e)},_defineButtons:function(){var r=this,t={className:"control-icon leaflet-pm-icon-marker",title:c("buttonTitles.drawMarkerButton"),jsClass:"Marker",onClick:function(){},afterClick:function(t,e){r.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},e={title:c("buttonTitles.drawPolyButton"),className:"control-icon leaflet-pm-icon-polygon",jsClass:"Polygon",onClick:function(){},afterClick:function(t,e){r.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},n={className:"control-icon leaflet-pm-icon-polyline",title:c("buttonTitles.drawLineButton"),jsClass:"Line",onClick:function(){},afterClick:function(t,e){r.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["finish","removeLastVertex","cancel"]},i={title:c("buttonTitles.drawCircleButton"),className:"control-icon leaflet-pm-icon-circle",jsClass:"Circle",onClick:function(){},afterClick:function(t,e){r.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},o={title:c("buttonTitles.drawCircleMarkerButton"),className:"control-icon leaflet-pm-icon-circle-marker",jsClass:"CircleMarker",onClick:function(){},afterClick:function(t,e){r.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},a={title:c("buttonTitles.drawRectButton"),className:"control-icon leaflet-pm-icon-rectangle",jsClass:"Rectangle",onClick:function(){},afterClick:function(t,e){r.map.pm.Draw[e.button._button.jsClass].toggle()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,actions:["cancel"]},s={title:c("buttonTitles.editButton"),className:"control-icon leaflet-pm-icon-edit",onClick:function(){},afterClick:function(){r.map.pm.toggleGlobalEditMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},l={title:c("buttonTitles.dragButton"),className:"control-icon leaflet-pm-icon-drag",onClick:function(){},afterClick:function(){r.map.pm.toggleGlobalDragMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]},h={title:c("buttonTitles.cutButton"),className:"control-icon leaflet-pm-icon-cut",jsClass:"Cut",onClick:function(){},afterClick:function(t,e){r.map.pm.Draw[e.button._button.jsClass].toggle({snappable:!0,cursorMarker:!0,allowSelfIntersection:!1})},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finish","removeLastVertex","cancel"]},u={title:c("buttonTitles.deleteButton"),className:"control-icon leaflet-pm-icon-delete",onClick:function(){},afterClick:function(){r.map.pm.toggleGlobalRemovalMode()},doToggle:!0,toggleStatus:!1,disableOtherButtons:!0,position:this.options.position,tool:"edit",actions:["finishMode"]};this._addButton("drawMarker",new _e.Control.PMButton(t)),this._addButton("drawPolyline",new _e.Control.PMButton(n)),this._addButton("drawRectangle",new _e.Control.PMButton(a)),this._addButton("drawPolygon",new _e.Control.PMButton(e)),this._addButton("drawCircle",new _e.Control.PMButton(i)),this._addButton("drawCircleMarker",new _e.Control.PMButton(o)),this._addButton("editMode",new _e.Control.PMButton(s)),this._addButton("dragMode",new _e.Control.PMButton(l)),this._addButton("cutPolygon",new _e.Control.PMButton(h)),this._addButton("removalMode",new _e.Control.PMButton(u))},_showHideButtons:function(){this.removeControls();var t,e,r=this.getButtons(),n=[];for(t in!1===this.options.drawControls&&(n=n.concat(Object.keys(r).filter(function(t){return!r[t]._button.tool}))),!1===this.options.editControls&&(n=n.concat(Object.keys(r).filter(function(t){return"edit"===r[t]._button.tool}))),!1===this.options.optionsControls&&(n=n.concat(Object.keys(r).filter(function(t){return"options"===r[t]._button.tool}))),!1===this.options.customControls&&(n=n.concat(Object.keys(r).filter(function(t){return"custom"===r[t]._button.tool}))),r)this.options[t]&&-1===n.indexOf(t)&&(e=r[t]._button.tool,r[t].setPosition(this._getBtnPosition(e=e||"draw")),r[t].addTo(this.map))},_getBtnPosition:function(t){return this.options.positions&&this.options.positions[t]?this.options.positions[t]:this.options.position},setBlockPosition:function(t,e){this.options.positions[t]=e,this._showHideButtons(),this.changeControlOrder()},getBlockPositions:function(){return this.options.positions},copyDrawControl:function(t,e){if(!e)throw new TypeError("Button has no name");"object"!==et(e)&&(e={name:e});t=this._btnNameMapping(t);if(!e.name)throw new TypeError("Button has no name");if(this.buttons[e.name])throw new TypeError("Button with this name already exists");var r=this.map.pm.Draw.createNewDrawInstance(e.name,t),t=this.buttons[t]._button;return e=Object.assign({},t,e),{drawInstance:r,control:this.createCustomControl(e)}},createCustomControl:function(t){if(!t.name)throw new TypeError("Button has no name");if(this.buttons[t.name])throw new TypeError("Button with this name already exists");t.onClick||(t.onClick=function(){}),t.afterClick||(t.afterClick=function(){}),!1!==t.toggle&&(t.toggle=!0),t.block&&(t.block=t.block.toLowerCase()),t.block&&"draw"!==t.block||(t.block=""),t.className?-1===t.className.indexOf("control-icon")&&(t.className="control-icon ".concat(t.className)):t.className="control-icon";var e={tool:t.block,className:t.className,title:t.title||"",jsClass:t.name,onClick:t.onClick,afterClick:t.afterClick,doToggle:t.toggle,toggleStatus:!1,disableOtherButtons:!0,cssToggle:t.toggle,position:this.options.position,actions:t.actions||[],disabled:!!t.disabled},t=(!1!==this.options[t.name]&&(this.options[t.name]=!0),this._addButton(t.name,new _e.Control.PMButton(e)));return this.changeControlOrder(),t},changeControlOrder:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[],e=this._shapeMapping(),r=[],n=(t.forEach(function(t){e[t]?r.push(e[t]):r.push(t)}),this.getButtons()),i={};r.forEach(function(t){n[t]&&(i[t]=n[t])}),Object.keys(n).filter(function(t){return!n[t]._button.tool}).forEach(function(t){-1===r.indexOf(t)&&(i[t]=n[t])}),Object.keys(n).filter(function(t){return"edit"===n[t]._button.tool}).forEach(function(t){-1===r.indexOf(t)&&(i[t]=n[t])}),Object.keys(n).filter(function(t){return"options"===n[t]._button.tool}).forEach(function(t){-1===r.indexOf(t)&&(i[t]=n[t])}),Object.keys(n).filter(function(t){return"custom"===n[t]._button.tool}).forEach(function(t){-1===r.indexOf(t)&&(i[t]=n[t])}),Object.keys(n).forEach(function(t){-1===r.indexOf(t)&&(i[t]=n[t])}),this.map.pm.Toolbar.buttons=i,this._showHideButtons()},getControlOrder:function(){var t,e=[];for(t in this.getButtons())e.push(t);return e},changeActionsOfControl:function(t,e){t=this._btnNameMapping(t);if(!t)throw new TypeError("No name passed");if(!e)throw new TypeError("No actions passed");if(!this.buttons[t])throw new TypeError("Button with this name not exists");this.buttons[t]._button.actions=e,this.changeControlOrder()},setButtonDisabled:function(t,e){t=this._btnNameMapping(t);this.buttons[t]._button.disabled=!!e,this._showHideButtons()},_shapeMapping:function(){return{Marker:"drawMarker",Circle:"drawCircle",Polygon:"drawPolygon",Rectangle:"drawRectangle",Polyline:"drawPolyline",Line:"drawPolyline",CircleMarker:"drawCircleMarker",Edit:"editMode",Drag:"dragMode",Cut:"cutPolygon",Removal:"removalMode"}},_btnNameMapping:function(t){var e=this._shapeMapping();return e[t]||t}}),Y={_initSnappableMarkers:function(){this.options.snapDistance=this.options.snapDistance||30,this._assignEvents(this._markers),this._layer.off("pm:dragstart",this._unsnap,this),this._layer.on("pm:dragstart",this._unsnap,this)},_disableSnapping:function(){this._layer.off("pm:dragstart",this._unsnap,this)},_assignEvents:function(t){var e=this;t.forEach(function(t){Array.isArray(t)?e._assignEvents(t):(t.off("drag",e._handleSnapping,e),t.on("drag",e._handleSnapping,e),t.off("dragend",e._cleanupSnapping,e),t.on("dragend",e._cleanupSnapping,e))})},_cleanupSnapping:function(){delete this._snapList,this.throttledList&&(this._map.off("layeradd",this.throttledList,this),this.throttledList=void 0),this._map.off("pm:remove",this._handleSnapLayerRemoval,this),this.debugIndicatorLines&&this.debugIndicatorLines.forEach(function(t){t.remove()})},_handleSnapping:function(t){if(this.throttledList||(this.throttledList=_e.Util.throttle(this._createSnapList,100,this)),t.originalEvent.altKey)return!1;if(void 0===this._snapList&&(this._createSnapList(),this._map.off("layeradd",this.throttledList,this),this._map.on("layeradd",this.throttledList,this)),this._snapList.length<=0)return!1;var t=t.target,e=this._calcClosestLayer(t.getLatLng(),this._snapList);if(0===Object.keys(e).length)return!1;var r=e.layer instanceof _e.Marker||e.layer instanceof _e.CircleMarker?e.latlng:this._checkPrioritiySnapping(e),n=this.options.snapDistance,i={marker:t,shape:this._shape,snapLatLng:r,segment:e.segment,layer:this._layer,workingLayer:this._layer,layerInteractedWith:e.layer,distance:e.distance};return u._fireEvent(i.marker,"pm:snapdrag",i),u._fireEvent(this._layer,"pm:snapdrag",i),e.distance<n?(t._orgLatLng=t.getLatLng(),t.setLatLng(r),t._snapped=!0,t._snapInfo=i,(e=this._snapLatLng||{}).lat===(n=r||{}).lat&&e.lng===n.lng||(this._snapLatLng=r,u._fireEvent(t,"pm:snap",i),u._fireEvent(this._layer,"pm:snap",i))):this._snapLatLng&&(this._unsnap(i),t._snapped=!1,u._fireEvent(i.marker,"pm:unsnap",i),u._fireEvent(this._layer,"pm:unsnap",i)),!0},_createSnapList:function(){var e=this,r=[],n=[],t=this._map;t.off("pm:remove",this._handleSnapLayerRemoval,this),t.on("pm:remove",this._handleSnapLayerRemoval,this),t.eachLayer(function(t){var e;(t instanceof _e.Polyline||t instanceof _e.Marker||t instanceof _e.CircleMarker||t instanceof _e.ImageOverlay)&&!0!==t.options.snapIgnore&&(!_e.PM.optIn&&!t.options.pmIgnore||_e.PM.optIn&&!1===t.options.pmIgnore)&&((t instanceof _e.Circle||t instanceof _e.CircleMarker)&&t.pm&&t.pm._hiddenPolyCircle?r.push(t.pm._hiddenPolyCircle):t instanceof _e.ImageOverlay&&(t=_e.rectangle(t.getBounds())),r.push(t),(e=_e.polyline([],{color:"red",pmIgnore:!0}))._pmTempLayer=!0,n.push(e),(t instanceof _e.Circle||t instanceof _e.CircleMarker)&&n.push(e))}),r=(r=(r=r.filter(function(t){return e._layer!==t})).filter(function(t){return t._latlng||t._latlngs&&!H(t._latlngs)})).filter(function(t){return!t._pmTempLayer}),this._otherSnapLayers?this._snapList=r.concat(this._otherSnapLayers):this._snapList=r,this.debugIndicatorLines=n},_handleSnapLayerRemoval:function(t){var e=t.layer,t=this._snapList.findIndex(function(t){return t._leaflet_id===e._leaflet_id});this._snapList.splice(t,1)},_calcClosestLayer:function(n,t){var i=this,o=[],a={};return t.forEach(function(t,e){var r;t._parentCopy&&t._parentCopy===i._layer||(r=i._calcLayerDistances(n,t),i.debugIndicatorLines[e].setLatLngs([n,r.latlng]),(void 0===a.distance||r.distance<=a.distance)&&(r.distance<a.distance&&(o=[]),(a=r).layer=t,o.push(a)))}),this._getClosestLayerByPriority(o)},_calcLayerDistances:function(t,e){var o,a,s=this,l=this._map,r=e instanceof _e.Marker||e instanceof _e.CircleMarker,h=e instanceof _e.Polygon,u=t,e=r?e.getLatLng():e.getLatLngs();if(r)return{latlng:Object.assign({},e),distance:this._getDistance(l,e,u)};!function n(i){i.forEach(function(t,e){var r;Array.isArray(t)?n(t):(t=t,e=h?e+1===i.length?0:e+1:e+1===i.length?void 0:e+1,(e=i[e])&&(r=s._getDistanceToSegment(l,u,t,e),(void 0===a||r<a)&&(a=r,o=[t,e])))})}(e);r=this._getClosestPointOnSegment(l,t,o[0],o[1]);return{latlng:Object.assign({},r),segment:o,distance:a}},_getClosestLayerByPriority:function(t){t=t.sort(function(t,e){return t._leaflet_id-e._leaflet_id});var e=this._map.pm.globalOptions.snappingOrder||[],r=0,n={};return e.concat(["Marker","CircleMarker","Circle","Line","Polygon","Rectangle"]).forEach(function(t){n[t]||(r+=1,n[t]=r)}),t.sort(function(i,t,e){var o=2<arguments.length&&void 0!==e?e:"asc";if(!t||0===Object.keys(t).length)return function(t,e){return t-e};for(var r,n=Object.keys(t),a=n.length,s={};a--;)r=n[a],s[r.toLowerCase()]=t[r];function l(t){return t instanceof _e.Marker?"Marker":t instanceof _e.Circle?"Circle":t instanceof _e.CircleMarker?"CircleMarker":t instanceof _e.Rectangle?"Rectangle":t instanceof _e.Polygon?"Polygon":t instanceof _e.Polyline?"Line":void 0}return function(t,e){var r;if("instanceofShape"===i){if(n=l(t.layer).toLowerCase(),r=l(e.layer).toLowerCase(),!n||!r)return 0}else{if(!t.hasOwnProperty(i)||!e.hasOwnProperty(i))return 0;n=t[i].toLowerCase(),r=e[i].toLowerCase()}var t=n in s?s[n]:Number.MAX_SAFE_INTEGER,e=r in s?s[r]:Number.MAX_SAFE_INTEGER,n=0;return t<e?n=-1:e<t&&(n=1),"desc"===o?-1*n:n}}("instanceofShape",n)),t[0]||{}},_checkPrioritiySnapping:function(t){var e=this._map,r=t.segment[0],n=t.segment[1],t=t.latlng,i=this._getDistance(e,r,t),o=this._getDistance(e,n,t),a=i<o?r:n,s=i<o?i:o;return this.options.snapMiddle&&(r=u.calcMiddleLatLng(e,r,n),(n=this._getDistance(e,r,t))<i&&n<o&&(a=r,s=n)),e=s<this.options.snapDistance?a:t,Object.assign({},e)},_unsnap:function(){delete this._snapLatLng},_getClosestPointOnSegment:function(t,e,r,n){var i=t.getMaxZoom(),e=(i===1/0&&(i=t.getZoom()),t.project(e,i)),r=t.project(r,i),n=t.project(n,i),e=_e.LineUtil.closestPointOnSegment(e,r,n);return t.unproject(e,i)},_getDistanceToSegment:function(t,e,r,n){e=t.latLngToLayerPoint(e),r=t.latLngToLayerPoint(r),t=t.latLngToLayerPoint(n);return _e.LineUtil.pointToSegmentDistance(e,r,t)},_getDistance:function(t,e,r){return t.latLngToLayerPoint(e).distanceTo(t.latLngToLayerPoint(r))}},n=_e.Class.extend({includes:[Y],options:{snappable:!0,snapDistance:20,tooltips:!0,cursorMarker:!0,finishOnDoubleClick:!1,finishOn:null,allowSelfIntersection:!0,templineStyle:{},hintlineStyle:{color:"#3388ff",dashArray:"5,5"},markerStyle:{draggable:!0,icon:_e.icon()},markerEditable:!0,continueDrawing:!1},setOptions:function(t){_e.Util.setOptions(this,t)},initialize:function(t){var e=this,r=new _e.Icon.Default;r.options.tooltipAnchor=[0,0],this.options.markerStyle.icon=r,this._map=t,this.shapes=["Marker","CircleMarker","Line","Polygon","Rectangle","Circle","Cut"],this.shapes.forEach(function(t){e[t]=new _e.PM.Draw[t](e._map)}),this.Marker.setOptions({continueDrawing:!0}),this.CircleMarker.setOptions({continueDrawing:!0})},setPathOptions:function(t){this.options.pathOptions=t},getShapes:function(){return this.shapes},enable:function(t,e){if(!t)throw new Error("Error: Please pass a shape as a parameter. Possible shapes are: ".concat(this.getShapes().join(",")));this.disable(),this[t].enable(e)},disable:function(){var e=this;this.shapes.forEach(function(t){e[t].disable()})},addControls:function(){var e=this;this.shapes.forEach(function(t){e[t].addButton()})},getActiveShape:function(){var e,r=this;return this.shapes.forEach(function(t){r[t]._enabled&&(e=t)}),e},_setGlobalDrawMode:function(){"Cut"===this._shape?u._fireEvent(this._map,"pm:globalcutmodetoggled",{enabled:!!this._enabled,map:this._map}):u._fireEvent(this._map,"pm:globaldrawmodetoggled",{enabled:this._enabled,shape:this._shape,map:this._map});var t=u.findLayers(this._map);this._enabled?t.forEach(function(t){u.disablePopup(t)}):t.forEach(function(t){u.enablePopup(t)})},createNewDrawInstance:function(t,e){var r=this._getShapeFromBtnName(e);if(this[t])throw new TypeError("Draw Type already exists");if(_e.PM.Draw[r])return this[t]=new _e.PM.Draw[r](this._map),this[t].toolbarButtonName=t,this[t]._shape=t,this.shapes.push(t),this[e]&&this[t].setOptions(this[e].options),this[t].setOptions(this[t].options),this[t];throw new TypeError("There is no class L.PM.Draw.".concat(r))},_getShapeFromBtnName:function(t){var e={drawMarker:"Marker",drawCircle:"Circle",drawPolygon:"Polygon",drawPolyline:"Line",drawRectangle:"Rectangle",drawCircleMarker:"CircleMarker",editMode:"Edit",dragMode:"Drag",cutPolygon:"Cut",removalMode:"Removal"};return e[t]||(this[t]?this[t]._shape:t)},_finishLayer:function(t){t.pm.setOptions(this.options),t.pm&&(t.pm._shape=this._shape),this._addDrawnLayerProp(t)},_addDrawnLayerProp:function(t){t._drawnByGeoman=!0}}),X=(n.Marker=n.extend({initialize:function(t){this._map=t,this._shape="Marker",this.toolbarButtonName="drawMarker"},enable:function(t){var e=this;_e.Util.setOptions(this,t),this._enabled=!0,this._map.on("click",this._createMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._hintMarker=_e.marker([0,0],this.options.markerStyle),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this.options.tooltips&&this._hintMarker.bindTooltip(c("tooltips.placeMarker"),{permanent:!0,offset:_e.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._layer=this._hintMarker,this._map.on("mousemove",this._syncHintMarker,this),this.options.markerEditable&&this._map.eachLayer(function(t){e.isRelevantMarker(t)&&t.pm.enable()}),u._fireEvent(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._setGlobalDrawMode()},disable:function(){var e=this;this._enabled&&(this._enabled=!1,this._map.off("click",this._createMarker,this),this._hintMarker.remove(),this._map.off("mousemove",this._syncHintMarker,this),this._map.eachLayer(function(t){e.isRelevantMarker(t)&&t.pm.disable()}),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),u._fireEvent(this._map,"pm:drawend",{shape:this._shape}),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},isRelevantMarker:function(t){return t instanceof _e.Marker&&t.pm&&!t._pmTempLayer},_syncHintMarker:function(t){this._hintMarker.setLatLng(t.latlng),this.options.snappable&&((t=t).target=this._hintMarker,this._handleSnapping(t))},_createMarker:function(t){t.latlng&&(this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng),t=this._hintMarker.getLatLng(),t=new _e.Marker(t,this.options.markerStyle),this._finishLayer(t),t.pm||(t.options.draggable=!1),t.addTo(this._map.pm._getContainingLayer()),t.pm&&this.options.markerEditable?t.pm.enable():t.dragging&&t.dragging.disable(),u._fireEvent(this._map,"pm:create",{shape:this._shape,marker:t,layer:t}),this._cleanupSnapping(),this.options.continueDrawing||this.disable())}}),t(7)),p=t.n(X),q=(n.Line=n.extend({initialize:function(t){this._map=t,this._shape="Line",this.toolbarButtonName="drawPolyline",this._doesSelfIntersect=!1},enable:function(t){_e.Util.setOptions(this,t),this.options.finishOnDoubleClick&&!this.options.finishOn&&(this.options.finishOn="dblclick"),this._enabled=!0,this._layerGroup=new _e.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=_e.polyline([],this.options.templineStyle),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._hintline=_e.polyline([],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._hintMarker=_e.marker(this._map.getCenter(),{icon:_e.divIcon({className:"marker-icon cursor-marker"})}),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&_e.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(c("tooltips.firstVertex"),{permanent:!0,offset:_e.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._map._container.style.cursor="crosshair",this._map.on("click",this._createVertex,this),this.options.finishOn&&this._map.on(this.options.finishOn,this._finishShape,this),"dblclick"===this.options.finishOn&&(this.tempMapDoubleClickZoomState=this._map.doubleClickZoom._enabled,this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.disable()),this._map.on("mousemove",this._syncHintMarker,this),this._hintMarker.on("move",this._syncHintLine,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],u._fireEvent(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._setGlobalDrawMode()},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._createVertex,this),this._map.off("mousemove",this._syncHintMarker,this),this.options.finishOn&&this._map.off(this.options.finishOn,this._finishShape,this),this.tempMapDoubleClickZoomState&&this._map.doubleClickZoom.enable(),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),u._fireEvent(this._map,"pm:drawend",{shape:this._shape}),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_syncHintLine:function(){var t=this._layer.getLatLngs();0<t.length&&(t=t[t.length-1],this._hintline.setLatLngs([t,this._hintMarker.getLatLng()]))},_syncHintMarker:function(t){var e;this._hintMarker.setLatLng(t.latlng),this.options.snappable&&((e=t).target=this._hintMarker,this._handleSnapping(e)),this.options.allowSelfIntersection||this._handleSelfIntersection(!0,t.latlng)},hasSelfIntersection:function(){return 0<p()(this._layer.toGeoJSON(15)).features.length},_handleSelfIntersection:function(t,e){var r=_e.polyline(this._layer.getLatLngs()),t=(t&&(e=e||this._hintMarker.getLatLng(),r.addLatLng(e)),p()(r.toGeoJSON(15)));this._doesSelfIntersect=0<t.features.length,this._doesSelfIntersect?this._hintline.setStyle({color:"red"}):this._hintline.isEmpty()||this._hintline.setStyle(this.options.hintlineStyle)},_createVertex:function(t){var e;!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,t.latlng),this._doesSelfIntersect)||(this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng),(e=this._hintMarker.getLatLng()).equals(this._layer.getLatLngs()[0])?this._finishShape(t):(t=0===this._layer.getLatLngs().length,this._layer._latlngInfo=this._layer._latlngInfo||[],this._layer._latlngInfo.push({latlng:e,snapInfo:this._hintMarker._snapInfo}),this._layer.addLatLng(e),t=this._createMarker(e,t),this._hintline.setLatLngs([e,e]),u._fireEvent(this._layer,"pm:vertexadded",{shape:this._shape,workingLayer:this._layer,marker:t,latlng:e})))},_removeLastVertex:function(){var t,e=this._layer.getLatLngs(),r=e.pop();e.length<1?this.disable():(t=this._layerGroup.getLayers().filter(function(t){return t instanceof _e.Marker}).filter(function(t){return!_e.DomUtil.hasClass(t._icon,"cursor-marker")}).find(function(t){return t.getLatLng()===r}),this._layerGroup.removeLayer(t),this._layer.setLatLngs(e),this._syncHintLine())},_finishShape:function(){var t;!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!1),this._doesSelfIntersect)||((t=this._layer.getLatLngs()).length<=1||(t=_e.polyline(t,this.options.pathOptions).addTo(this._map.pm._getContainingLayer()),this._finishLayer(t),u._fireEvent(this._map,"pm:create",{shape:this._shape,layer:t}),this.options.snappable&&this._cleanupSnapping(),this.disable(),this.options.continueDrawing&&this.enable()))},_createMarker:function(t,e){t=new _e.Marker(t,{draggable:!1,icon:_e.divIcon({className:"marker-icon"})});return t._pmTempLayer=!0,this._layerGroup.addLayer(t),t.on("click",this._finishShape,this),e&&this._hintMarker.setTooltipContent(c("tooltips.continueLine")),2===this._layer.getLatLngs().length&&this._hintMarker.setTooltipContent(c("tooltips.finishLine")),t}}),n.Polygon=n.Line.extend({initialize:function(t){this._map=t,this._shape="Polygon",this.toolbarButtonName="drawPolygon"},_createMarker:function(t,e){t=new _e.Marker(t,{draggable:!1,icon:_e.divIcon({className:"marker-icon"})});return t._pmTempLayer=!0,this._layerGroup.addLayer(t),e?(t.on("click",this._finishShape,this),this._tempSnapLayerIndex=this._otherSnapLayers.push(t)-1,this.options.snappable&&this._cleanupSnapping()):t.on("click",function(){return 1}),e&&this._hintMarker.setTooltipContent(c("tooltips.continueLine")),3===this._layer.getLatLngs().length&&this._hintMarker.setTooltipContent(c("tooltips.finishPoly")),t},_finishShape:function(t){var e;!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||((e=this._layer.getLatLngs()).length<=2||(e=_e.polygon(e,this.options.pathOptions).addTo(this._map.pm._getContainingLayer()),this._finishLayer(e),u._fireEvent(this._map,"pm:create",{shape:this._shape,layer:e}),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this.disable(),this.options.continueDrawing&&this.enable()))}}),n.Rectangle=n.extend({initialize:function(t){this._map=t,this._shape="Rectangle",this.toolbarButtonName="drawRectangle"},enable:function(t){if(_e.Util.setOptions(this,t),this._enabled=!0,this._layerGroup=new _e.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=_e.rectangle([[0,0],[0,0]],this.options.pathOptions),this._layer._pmTempLayer=!0,this._startMarker=_e.marker([0,0],{icon:_e.divIcon({className:"marker-icon rect-start-marker"}),draggable:!1,zIndexOffset:100,opacity:this.options.cursorMarker?1:0}),this._startMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._startMarker),this._hintMarker=_e.marker([0,0],{icon:_e.divIcon({className:"marker-icon cursor-marker"})}),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.tooltips&&this._hintMarker.bindTooltip(c("tooltips.firstVertex"),{permanent:!0,offset:_e.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this.options.cursorMarker){_e.DomUtil.addClass(this._hintMarker._icon,"visible"),this._styleMarkers=[];for(var e=0;e<2;e+=1){var r=_e.marker([0,0],{icon:_e.divIcon({className:"marker-icon rect-style-marker"}),draggable:!1,zIndexOffset:100});r._pmTempLayer=!0,this._layerGroup.addLayer(r),this._styleMarkers.push(r)}}this._map._container.style.cursor="crosshair",this._map.on("click",this._placeStartingMarkers,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],u._fireEvent(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._setGlobalDrawMode()},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeStartingMarkers,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),u._fireEvent(this._map,"pm:drawend",{shape:this._shape}),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_placeStartingMarkers:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var e=this._hintMarker.getLatLng();_e.DomUtil.addClass(this._startMarker._icon,"visible"),this._startMarker.setLatLng(e),this.options.cursorMarker&&this._styleMarkers&&this._styleMarkers.forEach(function(t){_e.DomUtil.addClass(t._icon,"visible"),t.setLatLng(e)}),this._map.off("click",this._placeStartingMarkers,this),this._map.on("click",this._finishShape,this),this._hintMarker.setTooltipContent(c("tooltips.finishRect")),this._setRectangleOrigin()},_setRectangleOrigin:function(){var t=this._startMarker.getLatLng();t&&(this._layerGroup.addLayer(this._layer),this._layer.setLatLngs([t,t]),this._hintMarker.on("move",this._syncRectangleSize,this))},_syncHintMarker:function(t){this._hintMarker.setLatLng(t.latlng),this.options.snappable&&((t=t).target=this._hintMarker,this._handleSnapping(t))},_syncRectangleSize:function(){var e,r=this,t=this._startMarker.getLatLng(),n=this._hintMarker.getLatLng();this._layer.setBounds([t,n]),this.options.cursorMarker&&this._styleMarkers&&(t=this._findCorners(),e=[],t.forEach(function(t){t.equals(r._startMarker.getLatLng())||t.equals(r._hintMarker.getLatLng())||e.push(t)}),e.forEach(function(t,e){r._styleMarkers[e].setLatLng(t)}))},_findCorners:function(){var t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]},_finishShape:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var t=this._hintMarker.getLatLng(),e=this._startMarker.getLatLng(),e=_e.rectangle([e,t],this.options.pathOptions).addTo(this._map.pm._getContainingLayer());this._finishLayer(e),u._fireEvent(this._map,"pm:create",{shape:this._shape,layer:e}),this.disable(),this.options.continueDrawing&&this.enable()}}),n.Circle=n.extend({initialize:function(t){this._map=t,this._shape="Circle",this.toolbarButtonName="drawCircle"},enable:function(t){_e.Util.setOptions(this,t),this.options.radius=0,this._enabled=!0,this._layerGroup=new _e.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=_e.circle([0,0],this.options.templineStyle),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._centerMarker=_e.marker([0,0],{icon:_e.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._centerMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._centerMarker),this._hintMarker=_e.marker([0,0],{icon:_e.divIcon({className:"marker-icon cursor-marker"})}),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&_e.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(c("tooltips.startCircle"),{permanent:!0,offset:_e.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=_e.polyline([],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map._container.style.cursor="crosshair",this._map.on("click",this._placeCenterMarker,this),this._map.on("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this._otherSnapLayers=[],u._fireEvent(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._setGlobalDrawMode()},disable:function(){this._enabled&&(this._enabled=!1,this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.off("mousemove",this._syncHintMarker,this),this._map.removeLayer(this._layerGroup),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),u._fireEvent(this._map,"pm:drawend",{shape:this._shape}),this._setGlobalDrawMode())},enabled:function(){return this._enabled},toggle:function(t){this.enabled()?this.disable():this.enable(t)},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([t,e])},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),t=this._map.options.crs===_e.CRS.Simple?this._map.distance(t,e):t.distanceTo(e);this.options.minRadiusCircle&&t<this.options.minRadiusCircle?this._layer.setRadius(this.options.minRadiusCircle):this.options.maxRadiusCircle&&t>this.options.maxRadiusCircle?this._layer.setRadius(this.options.maxRadiusCircle):this._layer.setRadius(t)},_syncHintMarker:function(t){this._hintMarker.setLatLng(t.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable&&((t=t).target=this._hintMarker,this._handleSnapping(t)),this._handleHintMarkerSnapping()},_placeCenterMarker:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);t=this._hintMarker.getLatLng();this._centerMarker.setLatLng(t),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter:function(){var t=this._centerMarker.getLatLng();t&&(this._layer.setLatLng(t),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(c("tooltips.finishCircle")),u._fireEvent(this._layer,"pm:centerplaced",{workingLayer:this._layer,latlng:t,shape:this._shape}))},_finishShape:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),e=this._map.options.crs===_e.CRS.Simple?this._map.distance(t,e):t.distanceTo(e),e=(this.options.minRadiusCircle&&e<this.options.minRadiusCircle?e=this.options.minRadiusCircle:this.options.maxRadiusCircle&&e>this.options.maxRadiusCircle&&(e=this.options.maxRadiusCircle),Object.assign({},this.options.pathOptions,{radius:e})),t=_e.circle(t,e).addTo(this._map.pm._getContainingLayer());this._finishLayer(t),t.pm&&t.pm._updateHiddenPolyCircle(),u._fireEvent(this._map,"pm:create",{shape:this._shape,layer:t}),this.disable(),this.options.continueDrawing&&this.enable()},_getNewDestinationOfHintMarker:function(){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),r=t.distanceTo(e);return this.options.minRadiusCircle&&r<this.options.minRadiusCircle?e=s(this._map,t,e,this.options.minRadiusCircle):this.options.maxRadiusCircle&&r>this.options.maxRadiusCircle&&(e=s(this._map,t,e,this.options.maxRadiusCircle)),e},_handleHintMarkerSnapping:function(){var t,e;this._hintMarker._snapped&&(e=this._centerMarker.getLatLng(),t=this._hintMarker.getLatLng(),e=e.distanceTo(t),(this.options.minRadiusCircle&&e<this.options.minRadiusCircle||this.options.maxRadiusCircle&&e>this.options.maxRadiusCircle)&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng)),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker())}}),n.CircleMarker=n.Marker.extend({initialize:function(t){this._map=t,this._shape="CircleMarker",this.toolbarButtonName="drawCircleMarker",this._layerIsDragging=!1},enable:function(t){var e=this;_e.Util.setOptions(this,t),this._enabled=!0,this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!0),this.options.editable?(this._layerGroup=new _e.LayerGroup,this._layerGroup._pmTempLayer=!0,this._layerGroup.addTo(this._map),this._layer=_e.circleMarker([0,0],this.options.templineStyle),this._layer._pmTempLayer=!0,this._layerGroup.addLayer(this._layer),this._centerMarker=_e.marker([0,0],{icon:_e.divIcon({className:"marker-icon"}),draggable:!1,zIndexOffset:100}),this._centerMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._centerMarker),this._hintMarker=_e.marker([0,0],{icon:_e.divIcon({className:"marker-icon cursor-marker"})}),this._hintMarker._pmTempLayer=!0,this._layerGroup.addLayer(this._hintMarker),this.options.cursorMarker&&_e.DomUtil.addClass(this._hintMarker._icon,"visible"),this.options.tooltips&&this._hintMarker.bindTooltip(c("tooltips.startCircle"),{permanent:!0,offset:_e.point(0,10),direction:"bottom",opacity:.8}).openTooltip(),this._hintline=_e.polyline([],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._layerGroup.addLayer(this._hintline),this._map.on("click",this._placeCenterMarker,this),this._map._container.style.cursor="crosshair"):(this._map.on("click",this._createMarker,this),this._hintMarker=_e.circleMarker([0,0],this.options.templineStyle),this._hintMarker._pmTempLayer=!0,this._hintMarker.addTo(this._map),this._layer=this._hintMarker,this.options.tooltips&&this._hintMarker.bindTooltip(c("tooltips.placeCircleMarker"),{permanent:!0,offset:_e.point(0,10),direction:"bottom",opacity:.8}).openTooltip()),this._map.on("mousemove",this._syncHintMarker,this),!this.options.editable&&this.options.markerEditable&&this._map.eachLayer(function(t){e.isRelevantMarker(t)&&t.pm.enable()}),this._layer.bringToBack(),u._fireEvent(this._map,"pm:drawstart",{shape:this._shape,workingLayer:this._layer}),this._setGlobalDrawMode()},disable:function(){var e=this;this._enabled&&(this._enabled=!1,this.options.editable?(this._map._container.style.cursor="",this._map.off("click",this._finishShape,this),this._map.off("click",this._placeCenterMarker,this),this._map.removeLayer(this._layerGroup)):(this._map.off("click",this._createMarker,this),this._map.eachLayer(function(t){e.isRelevantMarker(t)&&t.pm.disable()}),this._hintMarker.remove()),this._map.off("mousemove",this._syncHintMarker,this),this._map.pm.Toolbar.toggleButton(this.toolbarButtonName,!1),this.options.snappable&&this._cleanupSnapping(),u._fireEvent(this._map,"pm:drawend",{shape:this._shape}),this._setGlobalDrawMode())},_placeCenterMarker:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);t=this._hintMarker.getLatLng();this._centerMarker.setLatLng(t),this._map.off("click",this._placeCenterMarker,this),this._map.on("click",this._finishShape,this),this._placeCircleCenter()},_placeCircleCenter:function(){var t=this._centerMarker.getLatLng();t&&(this._layer.setLatLng(t),this._hintMarker.on("move",this._syncHintLine,this),this._hintMarker.on("move",this._syncCircleRadius,this),this._hintMarker.setTooltipContent(c("tooltips.finishCircle")),u._fireEvent(this._layer,"pm:centerplaced",{shape:this._shape,workingLayer:this._layer,latlng:t}))},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._getNewDestinationOfHintMarker();this._hintline.setLatLngs([t,e])},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),t=this._map.project(t).distanceTo(this._map.project(e));this.options.minRadiusCircleMarker&&t<this.options.minRadiusCircleMarker?this._layer.setRadius(this.options.minRadiusCircleMarker):this.options.maxRadiusCircleMarker&&t>this.options.maxRadiusCircleMarker?this._layer.setRadius(this.options.maxRadiusCircleMarker):this._layer.setRadius(t)},_syncHintMarker:function(t){this._hintMarker.setLatLng(t.latlng),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()),this.options.snappable&&((t=t).target=this._hintMarker,this._handleSnapping(t)),this._handleHintMarkerSnapping()},isRelevantMarker:function(t){return t instanceof _e.CircleMarker&&!(t instanceof _e.Circle)&&t.pm&&!t._pmTempLayer},_createMarker:function(t){t.latlng&&!this._layerIsDragging&&(this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng),t=this._hintMarker.getLatLng(),t=_e.circleMarker(t,this.options.pathOptions),this._finishLayer(t),t.addTo(this._map.pm._getContainingLayer()),t.pm&&this.options.markerEditable&&t.pm.enable(),u._fireEvent(this._map,"pm:create",{shape:this._shape,marker:t,layer:t}),this._cleanupSnapping(),this.options.continueDrawing||this.disable())},_finishShape:function(t){this._hintMarker._snapped||this._hintMarker.setLatLng(t.latlng);var t=this._centerMarker.getLatLng(),e=this._hintMarker.getLatLng(),e=this._map.project(t).distanceTo(this._map.project(e)),e=(this.options.editable&&(this.options.minRadiusCircleMarker&&e<this.options.minRadiusCircleMarker?e=this.options.minRadiusCircleMarker:this.options.maxRadiusCircleMarker&&e>this.options.maxRadiusCircleMarker&&(e=this.options.maxRadiusCircleMarker)),Object.assign({},this.options.pathOptions,{radius:e})),t=_e.circleMarker(t,e).addTo(this._map.pm._getContainingLayer());this._finishLayer(t),t.pm&&t.pm._updateHiddenPolyCircle(),u._fireEvent(this._map,"pm:create",{shape:this._shape,layer:t}),this.disable(),this.options.continueDrawing&&this.enable()},_getNewDestinationOfHintMarker:function(){var t,e,r=this._hintMarker.getLatLng();return this.options.editable&&(t=this._centerMarker.getLatLng(),e=this._map.project(t).distanceTo(this._map.project(r)),this.options.minRadiusCircleMarker&&e<this.options.minRadiusCircleMarker?r=s(this._map,t,r,this._pxRadiusToMeter(this.options.minRadiusCircleMarker)):this.options.maxRadiusCircleMarker&&e>this.options.maxRadiusCircleMarker&&(r=s(this._map,t,r,this._pxRadiusToMeter(this.options.maxRadiusCircleMarker)))),r},_handleHintMarkerSnapping:function(){var t,e;this.options.editable&&(this._hintMarker._snapped&&(e=this._centerMarker.getLatLng(),t=this._hintMarker.getLatLng(),e=this._map.project(e).distanceTo(this._map.project(t)),(this.options.minRadiusCircleMarker&&e<this.options.minRadiusCircleMarker||this.options.maxRadiusCircleMarker&&e>this.options.maxRadiusCircleMarker)&&this._hintMarker.setLatLng(this._hintMarker._orgLatLng)),this._hintMarker.setLatLng(this._getNewDestinationOfHintMarker()))},_pxRadiusToMeter:function(t){var e=this._centerMarker.getLatLng(),r=this._map.project(e),t=_e.point(r.x+t,r.y);return this._map.unproject(t).distanceTo(e)}}),t(1)),f=t.n(q);function d(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function rt(t,e){return t<e?-1:e<t?1:0}function g(t,e){if(!(this instanceof g))return new g(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function m(t,e){y(t,0,t.children.length,e,t)}function y(t,e,r,n,i){(i=i||v(null)).minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,a=e;a<r;a++)o=t.children[a],_(i,t.leaf?n(o):o);return i}function _(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function nt(t,e){return t.minX-e.minX}function it(t,e){return t.minY-e.minY}function ot(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function at(t){return t.maxX-t.minX+(t.maxY-t.minY)}function st(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function lt(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function v(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function ht(t,e,r,n,i){for(var o,a,s=[e,r];s.length;)(r=s.pop())-(e=s.pop())<=n||(o=e+Math.ceil((r-e)/n/2)*n,function t(e,r,n,i,o){for(;n<i;){600<i-n&&(a=i-n+1,s=r-n+1,h=Math.log(a),l=.5*Math.exp(2*h/3),h=.5*Math.sqrt(h*l*(a-l)/a)*(s-a/2<0?-1:1),t(e,r,Math.max(n,Math.floor(r-s*l/a+h)),Math.min(i,Math.floor(r+(a-s)*l/a+h)),o));var a,s,l,h,u=e[r],c=n,p=i;for(d(e,n,r),0<o(e[i],u)&&d(e,n,i);c<p;){for(d(e,c,p),c++,p--;o(e[c],u)<0;)c++;for(;0<o(e[p],u);)p--}0===o(e[n],u)?d(e,n,p):d(e,++p,i),p<=r&&(n=p+1),r<=p&&(i=p-1)}}(a=t,o,e||0,r||a.length-1,i||rt),s.push(e,o,o,r))}g.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],n=this.toBBox;if(lt(t,e))for(var i,o,a,s,l=[];e;){for(i=0,o=e.children.length;i<o;i++)a=e.children[i],lt(t,s=e.leaf?n(a):a)&&(e.leaf?r.push(a):st(t,s)?this._all(a,r):l.push(a));e=l.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(lt(t,e))for(var n,i,o,a,s=[];e;){for(n=0,i=e.children.length;n<i;n++)if(o=e.children[n],lt(t,a=e.leaf?r(o):o)){if(e.leaf||st(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(t&&t.length)if(t.length<this._minEntries)for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);else{var n,i=this._build(t.slice(),0,t.length-1,0);this.data.children.length?this.data.height===i.height?this._splitRoot(this.data,i):(this.data.height<i.height&&(n=this.data,this.data=i,i=n),this._insert(i,this.data.height-i.height-1,!0)):this.data=i}return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=v([]),this},remove:function(t,e){if(t)for(var r,n,i,o,a=this.data,s=this.toBBox(t),l=[],h=[];a||l.length;){if(a||(a=l.pop(),n=l[l.length-1],r=h.pop(),o=!0),a.leaf&&-1!==(i=function(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}(t,a.children,e)))return a.children.splice(i,1),l.push(a),this._condense(l),this;o||a.leaf||!st(a,s)?n?(r++,a=n.children[r],o=!1):a=null:(l.push(a),h.push(r),a=(n=a).children[r=0])}return this},toBBox:function(t){return t},compareMinX:nt,compareMinY:it,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,n){var i,o=r-e+1,a=this._maxEntries;if(o<=a)return m(i=v(t.slice(e,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(i=v([])).leaf=!1,i.height=n;var s,l,h,u,c=Math.ceil(o/a),p=c*Math.ceil(Math.sqrt(a));for(ht(t,e,r,p,this.compareMinX),s=e;s<=r;s+=p)for(ht(t,s,h=Math.min(s+p-1,r),c,this.compareMinY),l=s;l<=h;l+=c)u=Math.min(l+c-1,h),i.children.push(this._build(t,l,u,n-1));return m(i,this.toBBox),i},_chooseSubtree:function(t,e,r,n){for(var i,o,a,s,l,h,u,c,p;n.push(e),!e.leaf&&n.length-1!==r;){for(h=u=1/0,i=0,o=e.children.length;i<o;i++)l=ot(a=e.children[i]),c=t,p=a,(p=(Math.max(p.maxX,c.maxX)-Math.min(p.minX,c.minX))*(Math.max(p.maxY,c.maxY)-Math.min(p.minY,c.minY))-l)<u?(u=p,h=l<h?l:h,s=a):p===u&&l<h&&(h=l,s=a);e=s||e.children[0]}return e},_insert:function(t,e,r){var n=this.toBBox,r=r?t:n(t),i=[],n=this._chooseSubtree(r,this.data,e,i);for(n.children.push(t),_(n,r);0<=e&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},_split:function(t,e){var r=t[e],n=r.children.length,i=this._minEntries,i=(this._chooseSplitAxis(r,i,n),this._chooseSplitIndex(r,i,n)),n=v(r.children.splice(i,r.children.length-i));n.height=r.height,n.leaf=r.leaf,m(r,this.toBBox),m(n,this.toBBox),e?t[e-1].children.push(n):this._splitRoot(r,n)},_splitRoot:function(t,e){this.data=v([t,e]),this.data.height=t.height+1,this.data.leaf=!1,m(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){for(var n,i,o,a,s,l,h,u,c,p=o=1/0,f=e;f<=r-e;f++)c=n=y(t,0,f,this.toBBox),s=i=y(t,f,r,this.toBBox),l=Math.max(c.minX,s.minX),h=Math.max(c.minY,s.minY),u=Math.min(c.maxX,s.maxX),c=Math.min(c.maxY,s.maxY),s=Math.max(0,u-l)*Math.max(0,c-h),u=ot(n)+ot(i),s<p?(p=s,a=f,o=u<o?u:o):s===p&&u<o&&(o=u,a=f);return a},_chooseSplitAxis:function(t,e,r){var n=t.leaf?this.compareMinX:nt,i=t.leaf?this.compareMinY:it;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)},_allDistMargin:function(t,e,r,n){t.children.sort(n);for(var i,o=this.toBBox,a=y(t,0,e,o),s=y(t,r-e,r,o),l=at(a)+at(s),h=e;h<r-e;h++)i=t.children[h],_(a,t.leaf?o(i):i),l+=at(a);for(h=r-e-1;e<=h;h--)i=t.children[h],_(s,t.leaf?o(i):i),l+=at(s);return l},_adjustParentBBoxes:function(t,e,r){for(var n=r;0<=n;n--)_(e[n],t)},_condense:function(t){for(var e,r=t.length-1;0<=r;r--)0===t[r].children.length?0<r?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():m(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a".concat(t[0],", minY: a").concat(t[1],", maxX: a").concat(t[2],", maxY: a").concat(t[3],"};"))}};var b=g;function k(t,e,r){if(!ct(r=r||{}))throw new Error("options is invalid");var n=r.bbox,r=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&pt(n),r&&ft(r);var i={type:"Feature"};return r&&(i.id=r),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}function ut(t,e,r){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(L(t[0][1])&&L(t[0][1]))return k({type:"LineString",coordinates:t},e,r);throw new Error("coordinates must contain numbers")}function M(t,e){if(!ct(e=e||{}))throw new Error("options is invalid");var r=e.bbox,e=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");r&&pt(r),e&&ft(e);var n={type:"FeatureCollection"};return e&&(n.id=e),r&&(n.bbox=r),n.features=t,n}function L(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function ct(t){return t&&t.constructor===Object}function pt(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!L(t))throw new Error("bbox must only contain numbers")})}function ft(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(ve(t)))throw new Error("id must be a number or a string")}function dt(t,e,r){if(null!==t)for(var n,i,o,a,s,l,h=0,u=t.type,c="FeatureCollection"===u,p="Feature"===u,f=c?t.features.length:1,d=0;d<f;d++)for(var g=(l=!!(s=c?t.features[d].geometry:p?t.geometry:t)&&"GeometryCollection"===s.type)?s.geometries.length:1,m=0;m<g;m++){var y=0,_=0;if(null!==(a=l?s.geometries[m]:s)){var v=a.coordinates,b=a.type,k=!r||"Polygon"!==b&&"MultiPolygon"!==b?0:1;switch(b){case null:break;case"Point":if(!1===e(v,h,d,y,_))return!1;h++,y++;break;case"LineString":case"MultiPoint":for(n=0;n<v.length;n++){if(!1===e(v[n],h,d,y,_))return!1;h++,"MultiPoint"===b&&y++}"LineString"===b&&y++;break;case"Polygon":case"MultiLineString":for(n=0;n<v.length;n++){for(i=0;i<v[n].length-k;i++){if(!1===e(v[n][i],h,d,y,_))return!1;h++}"MultiLineString"===b&&y++,"Polygon"===b&&_++}"Polygon"===b&&y++;break;case"MultiPolygon":for(n=0;n<v.length;n++){for("MultiPolygon"===b&&(_=0),i=0;i<v[n].length;i++){for(o=0;o<v[n][i].length-k;o++){if(!1===e(v[n][i][o],h,d,y,_))return!1;h++}_++}y++}break;case"GeometryCollection":for(n=0;n<a.geometries.length;n++)if(!1===dt(a.geometries[n],e,r))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}function w(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}function gt(t,h){function e(t,e,r,n,i){var o,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==h(k(t,r,{bbox:n,id:i}),e,0)&&void 0}switch(a){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var s=0;s<t.coordinates.length;s++){var l=t.coordinates[s];if(!1===h(k({type:o,coordinates:l},r),e,s))return!1}}for(var r,n,i,o,a,s,l,u,c,p=t,f=0,d="FeatureCollection"===p.type,g="Feature"===p.type,m=d?p.features.length:1,y=0;y<m;y++){for(a=d?p.features[y].geometry:g?p.geometry:p,l=d?p.features[y].properties:g?p.properties:{},u=d?p.features[y].bbox:g?p.bbox:void 0,c=d?p.features[y].id:g?p.id:void 0,o=(s=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,n=0;n<o;n++)if(null!==(i=s?a.geometries[n]:a))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,f,l,u,c))return;break;case"GeometryCollection":for(r=0;r<i.geometries.length;r++)if(!1===e(i.geometries[r],f,l,u,c))return;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,l,u,c))return;f++}}function mt(t){var e=[t[0],t[1]],r=[t[0],t[3]],n=[t[2],t[3]];return{type:"Feature",bbox:t,properties:{},geometry:{type:"Polygon",coordinates:[[e,[t[2],t[1]],n,r,e]]}}}function yt(t){var e=[1/0,1/0,-1/0,-1/0];return dt(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}var _t=function(t){t=b(t);return t.insert=function(t){var e;return Array.isArray(t)?(t=mt(e=t)).bbox=e:t.bbox=t.bbox||yt(t),b.prototype.insert.call(this,t)},t.load=function(t){var r=[];return Array.isArray(t)?t.forEach(function(t){var e=mt(t);e.bbox=t,r.push(e)}):w(t,function(t){t.bbox=t.bbox||yt(t),r.push(t)}),b.prototype.load.call(this,r)},t.remove=function(t){var e;return Array.isArray(t)&&((t=mt(e=t)).bbox=e),b.prototype.remove.call(this,t)},t.clear=function(){return b.prototype.clear.call(this)},t.search=function(t){return{type:"FeatureCollection",features:b.prototype.search.call(this,this.toBBox(t))}},t.collides=function(t){return b.prototype.collides.call(this,this.toBBox(t))},t.all=function(){return{type:"FeatureCollection",features:b.prototype.all.call(this)}},t.toJSON=function(){return b.prototype.toJSON.call(this)},t.fromJSON=function(t){return b.prototype.fromJSON.call(this,t)},t.toBBox=function(t){return{minX:(t=t.bbox||(Array.isArray(t)&&4===t.length?t:yt(t)))[0],minY:t[1],maxX:t[2],maxY:t[3]}},t},i=6371008.8,vt={meters:i,metres:i,millimeters:1e3*i,millimetres:1e3*i,centimeters:100*i,centimetres:100*i,kilometers:i/1e3,kilometres:i/1e3,miles:i/1609.344,nauticalmiles:i/1852,inches:39.37*i,yards:i/1.0936,feet:3.28084*i,radians:1,degrees:i/111325};function bt(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function kt(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&2<=t.length&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Mt(t,e){if(!(e=e||{})||e.constructor!==Object)throw new Error("options is invalid");var r=e.precision,i=e.coordinates,e=e.mutate,r=null==r||isNaN(r)?6:r,i=null==i||isNaN(i)?3:i;if(!t)throw new Error("<geojson> is required");if("number"!=typeof r)throw new Error("<precision> must be a number");if("number"!=typeof i)throw new Error("<coordinates> must be a number");!1!==e&&void 0!==e||(t=JSON.parse(JSON.stringify(t)));var o=Math.pow(10,r);return function t(e,r,n){if(null!==e)for(var i,o,a,s,l,h,u=0,c=e.type,p="FeatureCollection"===c,f="Feature"===c,d=p?e.features.length:1,g=0;g<d;g++)for(var m=(h=!!(l=p?e.features[g].geometry:f?e.geometry:e)&&"GeometryCollection"===l.type)?l.geometries.length:1,y=0;y<m;y++){var _=0,v=0;if(null!==(s=h?l.geometries[y]:l)){var b=s.coordinates,k=s.type,M=!n||"Polygon"!==k&&"MultiPolygon"!==k?0:1;switch(k){case null:break;case"Point":if(!1===r(b,u,g,_,v))return!1;u++,_++;break;case"LineString":case"MultiPoint":for(i=0;i<b.length;i++){if(!1===r(b[i],u,g,_,v))return!1;u++,"MultiPoint"===k&&_++}"LineString"===k&&_++;break;case"Polygon":case"MultiLineString":for(i=0;i<b.length;i++){for(o=0;o<b[i].length-M;o++){if(!1===r(b[i][o],u,g,_,v))return!1;u++}"MultiLineString"===k&&_++,"Polygon"===k&&v++}"Polygon"===k&&_++;break;case"MultiPolygon":for(i=0;i<b.length;i++){for("MultiPolygon"===k&&(v=0),o=0;o<b[i].length;o++){for(a=0;a<b[i][o].length-M;a++){if(!1===r(b[i][o][a],u,g,_,v))return!1;u++}v++}_++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===t(s.geometries[i],r,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}(t,function(t){var e=t,r=o,t=i;e.length>t&&e.splice(t,e.length);for(var n=0;n<e.length;n++)e[n]=Math.round(e[n]*r)/r}),t}var x=function(t,e,r){if(!(r=r||{})||r.constructor!==Object)throw new Error("options is invalid");var r=r.units,t=kt(t),e=kt(e),n=bt(e[1]-t[1]),i=bt(e[0]-t[0]),t=bt(t[1]),e=bt(e[1]),n=Math.pow(Math.sin(n/2),2)+Math.pow(Math.sin(i/2),2)*Math.cos(t)*Math.cos(e),i=2*Math.atan2(Math.sqrt(n),Math.sqrt(1-n)),t=r;if(null==i)throw new Error("radians is required");if(t&&"string"!=typeof t)throw new Error("units must be a string");e=vt[t||"kilometers"];if(e)return i*e;throw new Error("".concat(t," units is invalid"))};function Lt(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&2<=t.length&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function E(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}function wt(t,e){if(!t)throw new Error("".concat(e||"geojson"," is required"));if(t.geometry&&t.geometry.type)return t.geometry.type;if(t.type)return t.type;throw new Error("".concat(e||"geojson"," is invalid"))}var xt=function(t){if(!t)throw new Error("geojson is required");var o=[];return gt(t,function(t){var e=t,r=o,n=[],i=e.geometry;switch(i.type){case"Polygon":n=E(i);break;case"LineString":n=[E(i)]}n.forEach(function(t){var a,s;a=e.properties,s=[],t.reduce(function(t,e){var r,n,i,o=ut([t,e],a);return o.bbox=(r=t[0],t=t[1],n=e[0],i=e[1],[r<n?r:n,t<i?t:i,n<r?r:n,i<t?t:i]),s.push(o),e}),s.forEach(function(t){t.id=r.length,r.push(t)})})}),M(o)};function Et(t,e){t=E(t),e=E(e);if(2!==t.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==e.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var r=t[0][0],n=t[0][1],i=t[1][0],t=t[1][1],o=e[0][0],a=e[0][1],s=e[1][0],e=e[1][1],l=(e-a)*(i-r)-(s-o)*(t-n);if(0!=l){s=((s-o)*(n-a)-(e-a)*(r-o))/l,e=((i-r)*(n-a)-(t-n)*(r-o))/l;if(0<=s&&s<=1&&0<=e&&e<=1){a=[r+s*(i-r),n+s*(t-n)];if(!Array.isArray(a))throw new Error("coordinates must be an Array");if(a.length<2)throw new Error("coordinates must be at least 2 numbers long");if(L(a[0])&&L(a[1]))return k({type:"Point",coordinates:a},void 0,void 0);throw new Error("coordinates must contain numbers")}}return null}function Ct(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function St(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&2<=t.length&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}function Pt(t,e,r){if(!(r=r||{})||r.constructor!==Object)throw new Error("options is invalid");if(!0===r.final)return(Pt(e,t)+180)%360;var r=St(t),t=St(e),e=Ct(r[0]),n=Ct(t[0]),r=Ct(r[1]),t=Ct(t[1]),i=Math.sin(n-e)*Math.cos(t),r=Math.cos(r)*Math.sin(t)-Math.sin(r)*Math.cos(t)*Math.cos(n-e);if(null==(t=Math.atan2(i,r)))throw new Error("radians is required");return t%(2*Math.PI)*180/Math.PI}var o=6371008.8,Bt={meters:o,metres:o,millimeters:1e3*o,millimetres:1e3*o,centimeters:100*o,centimetres:100*o,kilometers:o/1e3,kilometres:o/1e3,miles:o/1609.344,nauticalmiles:o/1852,inches:39.37*o,yards:o/1.0936,feet:3.28084*o,radians:1,degrees:o/111325};function Ot(t){if(null==t)throw new Error("radians is required");return t%(2*Math.PI)*180/Math.PI}function Dt(t){if(null==t)throw new Error("degrees is required");return t%360*Math.PI/180}function Rt(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Tt(t){return t&&t.constructor===Object}function jt(t,e,r,n){if(!Tt(n=n||{}))throw new Error("options is invalid");var i=n.units,n=n.properties,o=Dt((t=function(t){if(!t)throw new Error("coord is required");if("Feature"===t.type&&null!==t.geometry&&"Point"===t.geometry.type)return t.geometry.coordinates;if("Point"===t.type)return t.coordinates;if(Array.isArray(t)&&2<=t.length&&void 0===t[0].length&&void 0===t[1].length)return t;throw new Error("coord must be GeoJSON Point or an Array of numbers")}(t))[0]),t=Dt(t[1]),r=Dt(r),e=function(t,e){if(null==t)throw new Error("distance is required");if(e&&"string"!=typeof e)throw new Error("units must be a string");var r=Bt[e||"kilometers"];if(r)return t/r;throw new Error("".concat(e," units is invalid"))}(e,i),i=Math.asin(Math.sin(t)*Math.cos(e)+Math.cos(t)*Math.sin(e)*Math.cos(r)),o=[Ot(o+Math.atan2(Math.sin(r)*Math.sin(e)*Math.cos(t),Math.cos(e)-Math.sin(t)*Math.sin(i))),Ot(i)],r=n;if(!Array.isArray(o))throw new Error("coordinates must be an Array");if(o.length<2)throw new Error("coordinates must be at least 2 numbers long");if(Rt(o[0])&&Rt(o[1])){o={type:"Point",coordinates:o};if(!Tt(e=(e=void 0)||{}))throw new Error("options is invalid");t=e.bbox,e=e.id;if(void 0===o)throw new Error("geometry is required");if(r&&r.constructor!==Object)throw new Error("properties must be an Object");if(t){var a=t;if(!a)throw new Error("bbox is required");if(!Array.isArray(a))throw new Error("bbox must be an Array");if(4!==a.length&&6!==a.length)throw new Error("bbox must be an Array of 4 or 6 numbers");a.forEach(function(t){if(!Rt(t))throw new Error("bbox must only contain numbers")})}if(e){if(!(a=e))throw new Error("id is required");if(-1===["string","number"].indexOf(ve(a)))throw new Error("id must be a number or a string")}i={type:"Feature"};return e&&(i.id=e),t&&(i.bbox=t),i.properties=r||{},i.geometry=o,i}throw new Error("coordinates must contain numbers")}function C(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}function It(t,e){return t<e?-1:e<t?1:0}function At(t,e){if(!(this instanceof At))return new At(t,e);this._maxEntries=Math.max(4,t||9),this._minEntries=Math.max(2,Math.ceil(.4*this._maxEntries)),e&&this._initFormat(e),this.clear()}function S(t,e){P(t,0,t.children.length,e,t)}function P(t,e,r,n,i){(i=i||O(null)).minX=1/0,i.minY=1/0,i.maxX=-1/0,i.maxY=-1/0;for(var o,a=e;a<r;a++)o=t.children[a],B(i,t.leaf?n(o):o);return i}function B(t,e){return t.minX=Math.min(t.minX,e.minX),t.minY=Math.min(t.minY,e.minY),t.maxX=Math.max(t.maxX,e.maxX),t.maxY=Math.max(t.maxY,e.maxY),t}function Gt(t,e){return t.minX-e.minX}function Nt(t,e){return t.minY-e.minY}function zt(t){return(t.maxX-t.minX)*(t.maxY-t.minY)}function Ft(t){return t.maxX-t.minX+(t.maxY-t.minY)}function Yt(t,e){return t.minX<=e.minX&&t.minY<=e.minY&&e.maxX<=t.maxX&&e.maxY<=t.maxY}function Xt(t,e){return e.minX<=t.maxX&&e.minY<=t.maxY&&e.maxX>=t.minX&&e.maxY>=t.minY}function O(t){return{children:t,height:1,leaf:!0,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0}}function qt(t,e,r,n,i){for(var o,a,s=[e,r];s.length;)(r=s.pop())-(e=s.pop())<=n||(o=e+Math.ceil((r-e)/n/2)*n,function t(e,r,n,i,o){for(;n<i;){600<i-n&&(a=i-n+1,s=r-n+1,h=Math.log(a),l=.5*Math.exp(2*h/3),h=.5*Math.sqrt(h*l*(a-l)/a)*(s-a/2<0?-1:1),t(e,r,Math.max(n,Math.floor(r-s*l/a+h)),Math.min(i,Math.floor(r+(a-s)*l/a+h)),o));var a,s,l,h,u=e[r],c=n,p=i;for(C(e,n,r),0<o(e[i],u)&&C(e,n,i);c<p;){for(C(e,c,p),c++,p--;o(e[c],u)<0;)c++;for(;0<o(e[p],u);)p--}0===o(e[n],u)?C(e,n,p):C(e,++p,i),p<=r&&(n=p+1),r<=p&&(i=p-1)}}(a=t,o,e||0,r||a.length-1,i||It),s.push(e,o,o,r))}At.prototype={all:function(){return this._all(this.data,[])},search:function(t){var e=this.data,r=[],n=this.toBBox;if(Xt(t,e))for(var i,o,a,s,l=[];e;){for(i=0,o=e.children.length;i<o;i++)a=e.children[i],Xt(t,s=e.leaf?n(a):a)&&(e.leaf?r.push(a):Yt(t,s)?this._all(a,r):l.push(a));e=l.pop()}return r},collides:function(t){var e=this.data,r=this.toBBox;if(Xt(t,e))for(var n,i,o,a,s=[];e;){for(n=0,i=e.children.length;n<i;n++)if(o=e.children[n],Xt(t,a=e.leaf?r(o):o)){if(e.leaf||Yt(t,a))return!0;s.push(o)}e=s.pop()}return!1},load:function(t){if(t&&t.length)if(t.length<this._minEntries)for(var e=0,r=t.length;e<r;e++)this.insert(t[e]);else{var n,i=this._build(t.slice(),0,t.length-1,0);this.data.children.length?this.data.height===i.height?this._splitRoot(this.data,i):(this.data.height<i.height&&(n=this.data,this.data=i,i=n),this._insert(i,this.data.height-i.height-1,!0)):this.data=i}return this},insert:function(t){return t&&this._insert(t,this.data.height-1),this},clear:function(){return this.data=O([]),this},remove:function(t,e){if(t)for(var r,n,i,o,a=this.data,s=this.toBBox(t),l=[],h=[];a||l.length;){if(a||(a=l.pop(),n=l[l.length-1],r=h.pop(),o=!0),a.leaf&&-1!==(i=function(t,e,r){if(!r)return e.indexOf(t);for(var n=0;n<e.length;n++)if(r(t,e[n]))return n;return-1}(t,a.children,e)))return a.children.splice(i,1),l.push(a),this._condense(l),this;o||a.leaf||!Yt(a,s)?n?(r++,a=n.children[r],o=!1):a=null:(l.push(a),h.push(r),a=(n=a).children[r=0])}return this},toBBox:function(t){return t},compareMinX:Gt,compareMinY:Nt,toJSON:function(){return this.data},fromJSON:function(t){return this.data=t,this},_all:function(t,e){for(var r=[];t;)t.leaf?e.push.apply(e,t.children):r.push.apply(r,t.children),t=r.pop();return e},_build:function(t,e,r,n){var i,o=r-e+1,a=this._maxEntries;if(o<=a)return S(i=O(t.slice(e,r+1)),this.toBBox),i;n||(n=Math.ceil(Math.log(o)/Math.log(a)),a=Math.ceil(o/Math.pow(a,n-1))),(i=O([])).leaf=!1,i.height=n;var s,l,h,u,c=Math.ceil(o/a),p=c*Math.ceil(Math.sqrt(a));for(qt(t,e,r,p,this.compareMinX),s=e;s<=r;s+=p)for(qt(t,s,h=Math.min(s+p-1,r),c,this.compareMinY),l=s;l<=h;l+=c)u=Math.min(l+c-1,h),i.children.push(this._build(t,l,u,n-1));return S(i,this.toBBox),i},_chooseSubtree:function(t,e,r,n){for(var i,o,a,s,l,h,u,c,p;n.push(e),!e.leaf&&n.length-1!==r;){for(h=u=1/0,i=0,o=e.children.length;i<o;i++)l=zt(a=e.children[i]),c=t,p=a,(p=(Math.max(p.maxX,c.maxX)-Math.min(p.minX,c.minX))*(Math.max(p.maxY,c.maxY)-Math.min(p.minY,c.minY))-l)<u?(u=p,h=l<h?l:h,s=a):p===u&&l<h&&(h=l,s=a);e=s||e.children[0]}return e},_insert:function(t,e,r){var n=this.toBBox,r=r?t:n(t),i=[],n=this._chooseSubtree(r,this.data,e,i);for(n.children.push(t),B(n,r);0<=e&&i[e].children.length>this._maxEntries;)this._split(i,e),e--;this._adjustParentBBoxes(r,i,e)},_split:function(t,e){var r=t[e],n=r.children.length,i=this._minEntries,i=(this._chooseSplitAxis(r,i,n),this._chooseSplitIndex(r,i,n)),n=O(r.children.splice(i,r.children.length-i));n.height=r.height,n.leaf=r.leaf,S(r,this.toBBox),S(n,this.toBBox),e?t[e-1].children.push(n):this._splitRoot(r,n)},_splitRoot:function(t,e){this.data=O([t,e]),this.data.height=t.height+1,this.data.leaf=!1,S(this.data,this.toBBox)},_chooseSplitIndex:function(t,e,r){for(var n,i,o,a,s,l,h,u,c,p=o=1/0,f=e;f<=r-e;f++)c=n=P(t,0,f,this.toBBox),s=i=P(t,f,r,this.toBBox),l=Math.max(c.minX,s.minX),h=Math.max(c.minY,s.minY),u=Math.min(c.maxX,s.maxX),c=Math.min(c.maxY,s.maxY),s=Math.max(0,u-l)*Math.max(0,c-h),u=zt(n)+zt(i),s<p?(p=s,a=f,o=u<o?u:o):s===p&&u<o&&(o=u,a=f);return a},_chooseSplitAxis:function(t,e,r){var n=t.leaf?this.compareMinX:Gt,i=t.leaf?this.compareMinY:Nt;this._allDistMargin(t,e,r,n)<this._allDistMargin(t,e,r,i)&&t.children.sort(n)},_allDistMargin:function(t,e,r,n){t.children.sort(n);for(var i,o=this.toBBox,a=P(t,0,e,o),s=P(t,r-e,r,o),l=Ft(a)+Ft(s),h=e;h<r-e;h++)i=t.children[h],B(a,t.leaf?o(i):i),l+=Ft(a);for(h=r-e-1;e<=h;h--)i=t.children[h],B(s,t.leaf?o(i):i),l+=Ft(s);return l},_adjustParentBBoxes:function(t,e,r){for(var n=r;0<=n;n--)B(e[n],t)},_condense:function(t){for(var e,r=t.length-1;0<=r;r--)0===t[r].children.length?0<r?(e=t[r-1].children).splice(e.indexOf(t[r]),1):this.clear():S(t[r],this.toBBox)},_initFormat:function(t){var e=["return a"," - b",";"];this.compareMinX=new Function("a","b",e.join(t[0])),this.compareMinY=new Function("a","b",e.join(t[1])),this.toBBox=new Function("a","return {minX: a".concat(t[0],", minY: a").concat(t[1],", maxX: a").concat(t[2],", maxY: a").concat(t[3],"};"))}};var D=At;function R(t,e,r){if(!Jt(r=r||{}))throw new Error("options is invalid");var n=r.bbox,r=r.id;if(void 0===t)throw new Error("geometry is required");if(e&&e.constructor!==Object)throw new Error("properties must be an Object");n&&Kt(n),r&&$t(r);var i={type:"Feature"};return r&&(i.id=r),n&&(i.bbox=n),i.properties=e||{},i.geometry=t,i}function Ut(t,e,r){if(!t)throw new Error("coordinates is required");if(!Array.isArray(t))throw new Error("coordinates must be an Array");if(t.length<2)throw new Error("coordinates must be at least 2 numbers long");if(T(t[0])&&T(t[1]))return R({type:"Point",coordinates:t},e,r);throw new Error("coordinates must contain numbers")}function Ht(t,e,r){if(!t)throw new Error("coordinates is required");if(t.length<2)throw new Error("coordinates must be an array of two or more positions");if(T(t[0][1])&&T(t[0][1]))return R({type:"LineString",coordinates:t},e,r);throw new Error("coordinates must contain numbers")}function Vt(t,e){if(!Jt(e=e||{}))throw new Error("options is invalid");var r=e.bbox,e=e.id;if(!t)throw new Error("No features passed");if(!Array.isArray(t))throw new Error("features must be an Array");r&&Kt(r),e&&$t(e);var n={type:"FeatureCollection"};return e&&(n.id=e),r&&(n.bbox=r),n.features=t,n}function T(t){return!isNaN(t)&&null!==t&&!Array.isArray(t)}function Jt(t){return t&&t.constructor===Object}function Kt(t){if(!t)throw new Error("bbox is required");if(!Array.isArray(t))throw new Error("bbox must be an Array");if(4!==t.length&&6!==t.length)throw new Error("bbox must be an Array of 4 or 6 numbers");t.forEach(function(t){if(!T(t))throw new Error("bbox must only contain numbers")})}function $t(t){if(!t)throw new Error("id is required");if(-1===["string","number"].indexOf(ve(t)))throw new Error("id must be a number or a string")}function Zt(t,e){if("Feature"===t.type)e(t,0);else if("FeatureCollection"===t.type)for(var r=0;r<t.features.length&&!1!==e(t.features[r],r);r++);}function Wt(t,h){function e(t,e,r,n,i){var o,a=null===t?null:t.type;switch(a){case null:case"Point":case"LineString":case"Polygon":return!1!==h(R(t,r,{bbox:n,id:i}),e,0)&&void 0}switch(a){case"MultiPoint":o="Point";break;case"MultiLineString":o="LineString";break;case"MultiPolygon":o="Polygon"}for(var s=0;s<t.coordinates.length;s++){var l=t.coordinates[s];if(!1===h(R({type:o,coordinates:l},r),e,s))return!1}}for(var r,n,i,o,a,s,l,u,c,p=t,f=0,d="FeatureCollection"===p.type,g="Feature"===p.type,m=d?p.features.length:1,y=0;y<m;y++){for(a=d?p.features[y].geometry:g?p.geometry:p,l=d?p.features[y].properties:g?p.properties:{},u=d?p.features[y].bbox:g?p.bbox:void 0,c=d?p.features[y].id:g?p.id:void 0,o=(s=!!a&&"GeometryCollection"===a.type)?a.geometries.length:1,n=0;n<o;n++)if(null!==(i=s?a.geometries[n]:a))switch(i.type){case"Point":case"LineString":case"MultiPoint":case"Polygon":case"MultiLineString":case"MultiPolygon":if(!1===e(i,f,l,u,c))return;break;case"GeometryCollection":for(r=0;r<i.geometries.length;r++)if(!1===e(i.geometries[r],f,l,u,c))return;break;default:throw new Error("Unknown Geometry Type")}else if(!1===e(null,f,l,u,c))return;f++}}function Qt(t){var e=[t[0],t[1]],r=[t[0],t[3]],n=[t[2],t[3]];return{type:"Feature",bbox:t,properties:{},geometry:{type:"Polygon",coordinates:[[e,[t[2],t[1]],n,r,e]]}}}function te(t){var e=[1/0,1/0,-1/0,-1/0];return function t(e,r,n){if(null!==e)for(var i,o,a,s,l,h,u=0,c=e.type,p="FeatureCollection"===c,f="Feature"===c,d=p?e.features.length:1,g=0;g<d;g++)for(var m=(h=!!(l=p?e.features[g].geometry:f?e.geometry:e)&&"GeometryCollection"===l.type)?l.geometries.length:1,y=0;y<m;y++){var _=0,v=0;if(null!==(s=h?l.geometries[y]:l)){var b=s.coordinates,k=s.type,M=!n||"Polygon"!==k&&"MultiPolygon"!==k?0:1;switch(k){case null:break;case"Point":if(!1===r(b,u,g,_,v))return!1;u++,_++;break;case"LineString":case"MultiPoint":for(i=0;i<b.length;i++){if(!1===r(b[i],u,g,_,v))return!1;u++,"MultiPoint"===k&&_++}"LineString"===k&&_++;break;case"Polygon":case"MultiLineString":for(i=0;i<b.length;i++){for(o=0;o<b[i].length-M;o++){if(!1===r(b[i][o],u,g,_,v))return!1;u++}"MultiLineString"===k&&_++,"Polygon"===k&&v++}"Polygon"===k&&_++;break;case"MultiPolygon":for(i=0;i<b.length;i++){for("MultiPolygon"===k&&(v=0),o=0;o<b[i].length;o++){for(a=0;a<b[i][o].length-M;a++){if(!1===r(b[i][o][a],u,g,_,v))return!1;u++}v++}_++}break;case"GeometryCollection":for(i=0;i<s.geometries.length;i++)if(!1===t(s.geometries[i],r,n))return!1;break;default:throw new Error("Unknown Geometry Type")}}}}(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e}function j(t){if(!t)throw new Error("coords is required");if("Feature"===t.type&&null!==t.geometry)return t.geometry.coordinates;if(t.coordinates)return t.coordinates;if(Array.isArray(t))return t;throw new Error("coords must be GeoJSON Feature, Geometry Object or an Array")}var ee=function(t){if(!t)throw new Error("geojson is required");var o=[];return Wt(t,function(t){var e=t,r=o,n=[],i=e.geometry;switch(i.type){case"Polygon":n=j(i);break;case"LineString":n=[j(i)]}n.forEach(function(t){var a,s;a=e.properties,s=[],t.reduce(function(t,e){var r,n,i,o=Ht([t,e],a);return o.bbox=(r=t[0],t=t[1],n=e[0],i=e[1],[r<n?r:n,t<i?t:i,n<r?r:n,i<t?t:i]),s.push(o),e}),s.forEach(function(t){t.id=r.length,r.push(t)})})}),Vt(o)};function re(t,e){t=j(t),e=j(e);if(2!==t.length)throw new Error("<intersects> line1 must only contain 2 coordinates");if(2!==e.length)throw new Error("<intersects> line2 must only contain 2 coordinates");var r=t[0][0],n=t[0][1],i=t[1][0],t=t[1][1],o=e[0][0],a=e[0][1],s=e[1][0],e=e[1][1],l=(e-a)*(i-r)-(s-o)*(t-n);if(0==l)return null;s=((s-o)*(n-a)-(e-a)*(r-o))/l,e=((i-r)*(n-a)-(t-n)*(r-o))/l;return 0<=s&&s<=1&&0<=e&&e<=1?Ut([r+s*(i-r),n+s*(t-n)]):null}function ne(t,e){var n={},i=[];if("LineString"===t.type&&(t=R(t)),"LineString"===e.type&&(e=R(e)),"Feature"===t.type&&"Feature"===e.type&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length)return(r=re(t,e))&&i.push(r),Vt(i);(r=D(void 0)).insert=function(t){var e;return Array.isArray(t)?(t=Qt(e=t)).bbox=e:t.bbox=t.bbox||te(t),D.prototype.insert.call(this,t)},r.load=function(t){var r=[];return Array.isArray(t)?t.forEach(function(t){var e=Qt(t);e.bbox=t,r.push(e)}):Zt(t,function(t){t.bbox=t.bbox||te(t),r.push(t)}),D.prototype.load.call(this,r)},r.remove=function(t){var e;return Array.isArray(t)&&((t=Qt(e=t)).bbox=e),D.prototype.remove.call(this,t)},r.clear=function(){return D.prototype.clear.call(this)},r.search=function(t){return{type:"FeatureCollection",features:D.prototype.search.call(this,this.toBBox(t))}},r.collides=function(t){return D.prototype.collides.call(this,this.toBBox(t))},r.all=function(){return{type:"FeatureCollection",features:D.prototype.all.call(this)}},r.toJSON=function(){return D.prototype.toJSON.call(this)},r.fromJSON=function(t){return D.prototype.fromJSON.call(this,t)},r.toBBox=function(t){return{minX:(t=t.bbox||(Array.isArray(t)&&4===t.length?t:te(t)))[0],minY:t[1],maxX:t[2],maxY:t[3]}};var r,o=r;return o.load(ee(e)),Zt(ee(t),function(r){Zt(o.search(r),function(t){var e,t=re(r,t);t&&(e=j(t).join(","),n[e]||(n[e]=!0,i.push(t)))})}),Vt(i)}function ie(n,t){var i=[],o=_t();return gt(t,function(t){var e,r;i.forEach(function(t,e){t.id=e}),i.length?(e=o.search(t)).features.length&&(r=ae(t,e),i=i.filter(function(t){return t.id!==r.id}),o.remove(r),w(oe(r,t),function(t){i.push(t),o.insert(t)})):((i=oe(n,t).features).forEach(function(t){var e;t.bbox||(t.bbox=function(t){var e=t[0],r=t[1],n=t[2],i=t[3],o=x(t.slice(0,2),[n,r]);if(x(t.slice(0,2),[e,i])<=o)return[e,(t=(r+i)/2)-(n-e)/2,n,t+(n-e)/2];o=(e+n)/2;return[o-(i-r)/2,r,o+(i-r)/2,i]}((e=[1/0,1/0,-1/0,-1/0],dt(t,function(t){e[0]>t[0]&&(e[0]=t[0]),e[1]>t[1]&&(e[1]=t[1]),e[2]<t[0]&&(e[2]=t[0]),e[3]<t[1]&&(e[3]=t[1])}),e)))}),o.load(M(i)))}),M(i)}function oe(t,i){var o=[],e=E(t)[0],r=E(t)[t.geometry.coordinates.length-1];if(se(e,Lt(i))||se(r,Lt(i)))return M([t]);var r=_t(),n=xt(t),r=(r.load(n),r.search(i));if(!r.features.length)return M([t]);var a,s=ae(i,r),t=(a=[e],w(n,function(t,e){var r,n;r=a,e=e,t=E(t)[1],n=Lt(i),a=e===s.id?(r.push(n),o.push(ut(r)),se(n,t)?[n]:[n,t]):(r.push(t),r)}),a);return 1<t.length&&o.push(ut(t)),M(o)}function ae(r,t){if(!t.features.length)throw new Error("lines must contain features");if(1===t.features.length)return t.features[0];var n,i=1/0;return w(t,function(t){var e=function(t,h,u){if(!Jt(u={}))throw new Error("options is invalid");var e=(t.geometry||t).type;if("LineString"!==e&&"MultiLineString"!==e)throw new Error("lines must be LineString or MultiLineString");var c=Ut([1/0,1/0],{dist:1/0}),p=0;return Wt(t,function(t){for(var e=j(t),r=0;r<e.length-1;r++){var n=Ut(e[r]),i=(n.properties.dist=x(h,n,u),Ut(e[r+1])),o=(i.properties.dist=x(h,i,u),x(n,i,u)),a=Math.max(n.properties.dist,i.properties.dist),s=Pt(n,i),l=jt(h,a,s+90,u),a=jt(h,a,s-90,u),s=ne(Ht([l.geometry.coordinates,a.geometry.coordinates]),Ht([n.geometry.coordinates,i.geometry.coordinates])),l=null;0<s.features.length&&((l=s.features[0]).properties.dist=x(h,l,u),l.properties.location=p+x(n,l,u)),n.properties.dist<c.properties.dist&&((c=n).properties.index=r,c.properties.location=p),i.properties.dist<c.properties.dist&&((c=i).properties.index=r+1,c.properties.location=p+o),l&&l.properties.dist<c.properties.dist&&((c=l).properties.index=r),p+=o}}),c}(t,r).properties.dist;e<i&&(n=t,i=e)}),n}function se(t,e){return t[0]===e[0]&&t[1]===e[1]}var e=t(62),le=t.n(e),N=t(26),he=t.n(N);function ue(t){var e={type:"Feature"};return e.geometry=t,e}function ce(t){return"Feature"===t.type?t.geometry:t}function pe(t){return ue({type:"Polygon",coordinates:t})}function fe(t){return ue({type:"MultiPolygon",coordinates:t})}function de(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}n.Cut=n.Polygon.extend({initialize:function(t){this._map=t,this._shape="Cut",this.toolbarButtonName="cutPolygon"},_finishShape:function(){var t,r=this;this._editedLayers=[],!this.options.allowSelfIntersection&&(this._handleSelfIntersection(!0,this._layer.getLatLngs()[0]),this._doesSelfIntersect)||(t=this._layer.getLatLngs(),(t=_e.polygon(t,this.options.pathOptions))._latlngInfos=this._layer._latlngInfo,this.cut(t),this._cleanupSnapping(),this._otherSnapLayers.splice(this._tempSnapLayerIndex,1),delete this._tempSnapLayerIndex,this._editedLayers.forEach(function(t){var e=t.layer,t=t.originalLayer;u._fireEvent(t,"pm:cut",{shape:r._shape,layer:e,originalLayer:t}),u._fireEvent(r._map,"pm:cut",{shape:r._shape,layer:e,originalLayer:t}),u._fireEvent(t,"pm:edit",{layer:t,shape:t.pm.getShape()})}),this._editedLayers=[],this.disable(),this.options.continueDrawing&&this.enable())},cut:function(n){var a=this,e=this._map._layers,s=n._latlngInfos||[];Object.keys(e).map(function(t){return e[t]}).filter(function(t){return t.pm}).filter(function(t){return t instanceof _e.Polyline}).filter(function(t){return t!==n}).filter(function(t){return!a._layerGroup.hasLayer(t)}).filter(function(t){try{return 0<!!f()(n.toGeoJSON(15),t.toGeoJSON(15)).features.length||!!function(t,e){t=ce(t),e=ce(e),t=he.a.intersection(t.coordinates,e.coordinates);return 0!==t.length&&(1===t.length?pe(t[0]):fe(t))}(n.toGeoJSON(15),t.toGeoJSON(15))}catch(t){return console.error("You cant cut polygons with self-intersections"),!1}}).forEach(function(t){t instanceof _e.Polygon?(o=(i=_e.polygon(t.getLatLngs())).getLatLngs(),s.forEach(function(t){var e,r,n;t&&t.snapInfo&&(t=t.latlng,(n=a._calcClosestLayer(t,[i]))&&n.segment&&n.distance<a.options.snapDistance&&((n=n.segment)&&2===n.length&&(e=(n=u._getIndexFromSegment(o,n)).indexPath,r=n.parentPath,n=n.newIndex,(1<e.length?h()(o,r):o).splice(n,0,t))))})):i=t;var i,o,e=a._cutLayer(n,i),e=_e.geoJSON(e,t.options),r=(e=1===e.getLayers().length?(function(t){if(Array.isArray(t))return t}(r=e.getLayers())||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var e=[],r=!0,n=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done)&&(e.push(o.value),1!==e.length);r=!0);}catch(t){n=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}return e}}(r)||function(t){if(t){if("string"==typeof t)return de(t,1);var e=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(e="Object"===e&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?de(t,1):void 0}}(r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}())[0]:e).addTo(a._map.pm._getContainingLayer());r.pm.enable(a.options),r.pm.disable(),t._pmTempLayer=!0,n._pmTempLayer=!0,t.remove(),t.removeFrom(a._map.pm._getContainingLayer()),n.remove(),n.removeFrom(a._map.pm._getContainingLayer()),r.getLayers&&0===r.getLayers().length&&a._map.pm.removeLayer({target:r}),a._addDrawnLayerProp(r),a._editedLayers.push({layer:r,originalLayer:t})})},_cutLayer:function(e,t){var r,n=_e.geoJSON();if(t instanceof _e.Polygon)r=function(t,e){t=ce(t),e=ce(e),t=he.a.difference(t.coordinates,e.coordinates);return 0===t.length?null:1===t.length?pe(t[0]):fe(t)}(t.toGeoJSON(15),e.toGeoJSON(15));else{t=function(t,e){if(!t)throw new Error("line is required");if(!e)throw new Error("splitter is required");var r=wt(t),n=wt(e);if("LineString"!==r)throw new Error("line must be LineString");if("FeatureCollection"===n)throw new Error("splitter cannot be a FeatureCollection");if("GeometryCollection"===n)throw new Error("splitter cannot be a GeometryCollection");var i=Mt(e,{precision:7});switch(n){case"Point":return oe(t,i);case"MultiPoint":return ie(t,i);case"LineString":case"MultiLineString":case"Polygon":case"MultiPolygon":return ie(t,function(t,e){var r,n={},i=[];if("LineString"===t.type&&(t=k(t)),"LineString"===e.type&&(e=k(e)),"Feature"===t.type&&"Feature"===e.type&&"LineString"===t.geometry.type&&"LineString"===e.geometry.type&&2===t.geometry.coordinates.length&&2===e.geometry.coordinates.length)return(r=Et(t,e))&&i.push(r),M(i);var o=_t();return o.load(xt(e)),w(xt(t),function(r){w(o.search(r),function(t){var e,t=Et(r,t);t&&(e=E(t).join(","),n[e]||(n[e]=!0,i.push(t)))})}),M(i)}(t,i))}}(t.toGeoJSON(15),e.toGeoJSON(15));if(!t)return null;_e.geoJSON(t).getLayers().forEach(function(t){le()(e.toGeoJSON(15),t.toGeoJSON(15))||t.addTo(n)}),r=n.toGeoJSON(15)}return r}});r=_e.Class.extend({includes:[{enableLayerDrag:function(){if(this.disable(),this._map||(this._map=this._layer._map),this._layer instanceof _e.Marker)return this._layer.on("dragstart",this._fireDragStart,this),this._layer.on("drag",this._fireDrag,this),this._layer.on("dragend",this._fireDragEnd,this),this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),void(this._layer.dragging&&this._layer.dragging.enable());this._layer instanceof _e.ImageOverlay&&(this._getDOMElem().ondragstart=function(){return!1}),this._tempDragCoord=null,this._layer._map.options.preferCanvas?(this._layer.on("mouseout",this.removeDraggingClass,this),this._layer.on("mouseover",this.addDraggingClass,this)):this.addDraggingClass(),this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!0,this._layer.on("mousedown",this._dragMixinOnMouseDown,this)},disableLayerDrag:function(){if(this._layer instanceof _e.Marker)return this._layer.off("dragstart",this._fireDragStart,this),this._layer.off("drag",this._fireDrag,this),this._layer.off("dragend",this._fireDragEnd,this),void(this._layer.dragging&&this._layer.dragging.disable());this._layer._map.options.preferCanvas?(this._layer.off("mouseout",this.removeDraggingClass,this),this._layer.off("mouseover",this.addDraggingClass,this)):this.removeDraggingClass(),this._safeToCacheDragState=!1,this._layer.off("mousedown",this._dragMixinOnMouseDown,this)},dragging:function(){return this._dragging},_dragMixinOnMouseDown:function(t){0<t.originalEvent.button||(this._safeToCacheDragState&&(this._originalMapDragState=this._layer._map.dragging._enabled,this._safeToCacheDragState=!1),this._tempDragCoord=t.latlng,this._layer._map.on("mouseup",this._dragMixinOnMouseUp,this),this._layer._map.on("mousemove",this._dragMixinOnMouseMove,this))},_dragMixinOnMouseMove:function(t){var e=this._getDOMElem();this._dragging||(this._dragging=!0,_e.DomUtil.addClass(e,"leaflet-pm-dragging"),this._layer.bringToFront(),this._originalMapDragState&&this._layer._map.dragging.disable(),this._fireDragStart()),this._onLayerDrag(t)},_dragMixinOnMouseUp:function(){var t=this,e=this._getDOMElem();return this._originalMapDragState&&this._layer._map.dragging.enable(),this._safeToCacheDragState=!0,this._layer._map.off("mousemove",this._dragMixinOnMouseMove,this),this._layer._map.off("mouseup",this._dragMixinOnMouseUp,this),!!this._dragging&&(this._layer instanceof _e.CircleMarker&&this._layer.pm._updateHiddenPolyCircle(),window.setTimeout(function(){t._dragging=!1,_e.DomUtil.removeClass(e,"leaflet-pm-dragging"),t._fireDragEnd(),t._fireEdit()},10),!0)},_onLayerDrag:function(t){function e(t){return t.map(function(t){return Array.isArray(t)?e(t):{lat:t.lat+i,lng:t.lng+o}})}var r,n=t.latlng,i=n.lat-this._tempDragCoord.lat,o=n.lng-this._tempDragCoord.lng;this._layer instanceof _e.CircleMarker?(r=e([this._layer.getLatLng()]),this._layer.setLatLng(r[0])):this._layer instanceof _e.ImageOverlay?(r=e([this._layer.getBounds().getNorthWest(),this._layer.getBounds().getSouthEast()]),this._layer.setBounds(r)):(r=e(this._layer.getLatLngs()),this._layer.setLatLngs(r)),this._tempDragCoord=n,t.layer=this._layer,this._fireDrag(t)},_fireDragStart:function(){u._fireEvent(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()})},_fireDrag:function(t){u._fireEvent(this._layer,"pm:drag",Object.assign({},t,{shape:this.getShape()}))},_fireDragEnd:function(){u._fireEvent(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()})},addDraggingClass:function(){var t=this._getDOMElem();t&&_e.DomUtil.addClass(t,"leaflet-pm-draggable")},removeDraggingClass:function(){var t=this._getDOMElem();t&&_e.DomUtil.removeClass(t,"leaflet-pm-draggable")},_getDOMElem:function(){var t=null;return this._layer._path?t=this._layer._path:this._layer._renderer&&this._layer._renderer._container?t=this._layer._renderer._container:this._layer._image&&(t=this._layer._image),t}},Y],options:{snappable:!0,snapDistance:20,allowSelfIntersection:!0,allowSelfIntersectionEdit:!1,draggable:!0,limitMarkersToCount:-1,preventMarkerRemoval:!1,hideMiddleMarkers:!1},setOptions:function(t){_e.Util.setOptions(this,t)},applyOptions:function(){},isPolygon:function(){return this._layer instanceof _e.Polygon},getShape:function(){return this._shape}});function ge(t){return function(t){if(Array.isArray(t))return me(t)}(t)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t))return Array.from(t)}(t)||function(t){if(t){if("string"==typeof t)return me(t,void 0);var e=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(e="Object"===e&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?me(t,void 0):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function me(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}function ye(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}r.LayerGroup=_e.Class.extend({initialize:function(t){var e=this;this._layerGroup=t,this._layers=this.findLayers(),this._layers.forEach(function(t){return e._initLayer(t)}),this._layerGroup.on("layeradd",_e.Util.throttle(function(t){t.target._pmTempLayer||(e._layers=e.findLayers(),(t=e._layers.filter(function(t){return!(t.pm._parentLayerGroup&&e._layerGroup._leaflet_id in t.pm._parentLayerGroup)})).forEach(function(t){e._initLayer(t)}),0<t.length&&e.enabled()&&e.enable(e.getOptions()))},100,this),this),this._layerGroup.on("layerremove",function(t){e._removeLayerFromGroup(t.target)},this),this._layerGroup.on("layerremove",_e.Util.throttle(function(t){t.target._pmTempLayer||(e._layers=e.findLayers())},100,this),this)},enable:function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this._options=e,this._layers.forEach(function(t){t instanceof _e.LayerGroup?-1===r.indexOf(t._leaflet_id)&&(r.push(t._leaflet_id),t.pm.enable(e,r)):t.pm.enable(e)})},disable:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];this._layers.forEach(function(t){t instanceof _e.LayerGroup?-1===e.indexOf(t._leaflet_id)&&(e.push(t._leaflet_id),t.pm.disable(e)):t.pm.disable()})},enabled:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:[];return!!this._layers.find(function(t){return t instanceof _e.LayerGroup?-1===e.indexOf(t._leaflet_id)&&(e.push(t._leaflet_id),t.pm.enabled(e)):t.pm.enabled()})},toggleEdit:function(e){var r=1<arguments.length&&void 0!==arguments[1]?arguments[1]:[];this._options=e,this._layers.forEach(function(t){t instanceof _e.LayerGroup?-1===r.indexOf(t._leaflet_id)&&(r.push(t._leaflet_id),t.pm.toggleEdit(e,r)):t.pm.toggleEdit(e)})},_initLayer:function(t){var e=_e.Util.stamp(this._layerGroup);t.pm._parentLayerGroup||(t.pm._parentLayerGroup={}),t.pm._parentLayerGroup[e]=this._layerGroup},_removeLayerFromGroup:function(t){var e;t.pm&&t.pm._layerGroup&&(e=_e.Util.stamp(this._layerGroup),delete t.pm._layerGroup[e])},findLayers:function(){return this._layerGroup.getLayers().filter(function(t){return!!t.pm}).filter(function(t){return!t._pmTempLayer})},dragging:function(){return!!this._layers&&!!this._layers.find(function(t){return t.pm.dragging()})},getOptions:function(){return this._options}}),r.Marker=r.extend({_shape:"Marker",initialize:function(t){this._layer=t,this._enabled=!1,this._layer.on("dragend",this._onDragEnd,this)},enable:function(){_e.Util.setOptions(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{draggable:!0}),this._map=this._layer._map,this.enabled()||(this.applyOptions(),this._enabled=!0,u._fireEvent(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()}))},disable:function(){this._enabled=!1,this.disableLayerDrag(),this._layer.off("contextmenu",this._removeMarker,this),u._fireEvent(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()}),this._layerEdited&&u._fireEvent(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()}),this._layerEdited=!1},enabled:function(){return this._enabled},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_removeMarker:function(t){t=t.target;t.remove(),u._fireEvent(t,"pm:remove",{layer:t,shape:this.getShape()}),u._fireEvent(this._map,"pm:remove",{layer:t,shape:this.getShape()})},_onDragEnd:function(t){t=t.target;u._fireEvent(t,"pm:edit",{layer:this._layer,shape:this.getShape()}),this._layerEdited=!0},_initSnappableMarkers:function(){var t=this._layer;this.options.snapDistance=this.options.snapDistance||30,t.off("drag",this._handleSnapping,this),t.on("drag",this._handleSnapping,this),t.off("dragend",this._cleanupSnapping,this),t.on("dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnapping:function(){var t=this._layer;t.off("drag",this._handleSnapping,this),t.off("dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)}}),r.Line=r.extend({includes:[{filterMarkerGroup:function(){this.markerCache=[],this.createCache(),this._layer.on("pm:edit",this.createCache,this),this.applyLimitFilters({}),this._layer.on("pm:disable",this._removeMarkerLimitEvents,this),-1<this.options.limitMarkersToCount&&(this._layer.on("pm:vertexremoved",this._initMarkers,this),this._map.on("mousemove",this.applyLimitFilters,this))},_removeMarkerLimitEvents:function(){this._map.off("mousemove",this.applyLimitFilters,this),this._layer.off("pm:edit",this.createCache,this),this._layer.off("pm:disable",this._removeMarkerLimitEvents,this),this._layer.off("pm:vertexremoved",this._initMarkers,this)},createCache:function(){var t=[].concat(ge(this._markerGroup.getLayers()),ge(this.markerCache));this.markerCache=t.filter(function(t,e,r){return r.indexOf(t)===e})},renderLimits:function(e){var r=this;this.markerCache.forEach(function(t){e.includes(t)?r._markerGroup.addLayer(t):r._markerGroup.removeLayer(t)})},applyLimitFilters:function(t){t=t.latlng,t=ge(this._filterClosestMarkers(void 0===t?{lat:0,lng:0}:t));this.renderLimits(t)},_filterClosestMarkers:function(r){var t=ge(this.markerCache),n=this.options.limitMarkersToCount;return t.sort(function(t,e){return t._latlng.distanceTo(r)-e._latlng.distanceTo(r)}),t.filter(function(t,e){return!(-1<n)||e<n})}}],_shape:"Line",initialize:function(t){this._layer=t,this._enabled=!1},enable:function(t){_e.Util.setOptions(this,t),this._map=this._layer._map,this._map&&(this.enabled()||this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",this._onLayerRemove,this),this.options.allowSelfIntersection||this._layer.on("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this),this.options.allowSelfIntersection?this.cachedColor=void 0:("red"!==this._layer.options.color?(this.cachedColor=this._layer.options.color,this.isRed=!1):this.isRed=!0,this._handleLayerStyle()),u._fireEvent(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()}))},disable:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._layer;if(!this.enabled())return!1;if(t.pm._dragging)return!1;t.pm._enabled=!1,t.pm._markerGroup.clearLayers(),t.pm._markerGroup.removeFrom(this._map),t.off("mousedown"),t.off("mouseup"),this._layer.off("remove",this._onLayerRemove,this),this.options.allowSelfIntersection||this._layer.off("pm:vertexremoved",this._handleSelfIntersectionOnVertexRemoval,this);t=t._path||this._layer._renderer._container;return _e.DomUtil.removeClass(t,"leaflet-pm-draggable"),this.hasSelfIntersection()&&_e.DomUtil.removeClass(t,"leaflet-pm-invalid"),this._layerEdited&&u._fireEvent(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()}),this._layerEdited=!1,u._fireEvent(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()}),!0},enabled:function(){return this._enabled},toggleEdit:function(t){return this.enabled()?this.disable():this.enable(t),this.enabled()},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping()},_onLayerRemove:function(t){this.disable(t.target)},_initMarkers:function(){var o=this,t=this._map,e=this._layer.getLatLngs();this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new _e.LayerGroup,this._markerGroup._pmTempLayer=!0,this._markers=function t(n){if(Array.isArray(n[0]))return n.map(t,o);var i=n.map(o._createMarker,o);return!0!==o.options.hideMiddleMarkers&&n.map(function(t,e){var r=o.isPolygon()?(e+1)%n.length:e+1;return o._createMiddleMarker(i[e],i[r])}),i}(e),this.filterMarkerGroup(),t.addLayer(this._markerGroup)},_createMarker:function(t){t=new _e.Marker(t,{draggable:!0,icon:_e.divIcon({className:"marker-icon"})});return t._pmTempLayer=!0,t.on("dragstart",this._onMarkerDragStart,this),t.on("move",this._onMarkerDrag,this),t.on("dragend",this._onMarkerDragEnd,this),this.options.preventMarkerRemoval||t.on("contextmenu",this._removeMarker,this),this._markerGroup.addLayer(t),t},_createMiddleMarker:function(e,r){var n=this;if(!e||!r)return!1;var t=u.calcMiddleLatLng(this._map,e.getLatLng(),r.getLatLng()),i=this._createMarker(t),t=_e.divIcon({className:"marker-icon marker-icon-middle"});return i.setIcon(t),e._middleMarkerNext=i,(r._middleMarkerPrev=i).on("click",function(){var t=_e.divIcon({className:"marker-icon"});i.setIcon(t),n._addMarker(i,e,r)}),i.on("movestart",function(){i.on("moveend",function(){var t=_e.divIcon({className:"marker-icon"});i.setIcon(t),i.off("moveend")}),n._addMarker(i,e,r)}),i},_addMarker:function(t,e,r){t.off("movestart"),t.off("click");var n=t.getLatLng(),i=this._layer._latlngs,o=this.findDeepMarkerIndex(this._markers,e),a=o.indexPath,s=o.index,o=o.parentPath,l=1<a.length?h()(i,o):i,a=1<a.length?h()(this._markers,o):this._markers;l.splice(s+1,0,n),a.splice(s+1,0,t),this._layer.setLatLngs(i),!0!==this.options.hideMiddleMarkers&&(this._createMiddleMarker(e,t),this._createMiddleMarker(t,r)),this._fireEdit(),u._fireEvent(this._layer,"pm:vertexadded",{layer:this._layer,marker:t,indexPath:this.findDeepMarkerIndex(this._markers,t).indexPath,latlng:n,shape:this.getShape()}),this.options.snappable&&this._initSnappableMarkers()},hasSelfIntersection:function(){return 0<p()(this._layer.toGeoJSON(15)).features.length},_handleSelfIntersectionOnVertexRemoval:function(){this._handleLayerStyle(!0),this.hasSelfIntersection()&&(this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers())},_handleLayerStyle:function(t){var e=this,r=this._layer;this.hasSelfIntersection()?(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!0),this.isRed||(t?(r.setStyle({color:"red"}),this.isRed=!0,window.setTimeout(function(){r.setStyle({color:e.cachedColor}),e.isRed=!1},200)):(r.setStyle({color:"red"}),this.isRed=!0),u._fireEvent(this._layer,"pm:intersect",{layer:this._layer,intersection:p()(this._layer.toGeoJSON(15)),shape:this.getShape()}))):(r.setStyle({color:this.cachedColor}),this.isRed=!1,!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._updateDisabledMarkerStyle(this._markers,!1))},_updateDisabledMarkerStyle:function(t,e){var r=this;t.forEach(function(t){if(Array.isArray(t))return r._updateDisabledMarkerStyle(t,e);t._icon&&(e&&!r._checkMarkerAllowedToDrag(t)?_e.DomUtil.addClass(t._icon,"vertexmarker-disabled"):_e.DomUtil.removeClass(t._icon,"vertexmarker-disabled"))})},_removeMarker:function(t){this.options.allowSelfIntersection||(o=this._layer.getLatLngs(),this._coordsBeforeEdit=JSON.parse(JSON.stringify(o)));var e,r,n,i,o=t.target,t=this._layer.getLatLngs(),a=this.findDeepMarkerIndex(this._markers,o),s=a.indexPath,l=a.index,a=a.parentPath;s&&(i=1<s.length?h()(t,a):t,e=1<s.length?h()(this._markers,a):this._markers,i.splice(l,1),this._layer.setLatLngs(t),this.isPolygon()&&i.length<=2&&i.splice(0,i.length),i.length<=1&&(i.splice(0,i.length),this._layer.setLatLngs(t),this.disable(),this.enable(this.options)),H(t)&&this._layer.remove(),t=V(t),this._layer.setLatLngs(t),this._markers=V(this._markers),e=1<s.length?h()(this._markers,a):this._markers,o._middleMarkerPrev&&this._markerGroup.removeLayer(o._middleMarkerPrev),o._middleMarkerNext&&this._markerGroup.removeLayer(o._middleMarkerNext),this._markerGroup.removeLayer(o),e&&(this.isPolygon()?(r=(l+1)%e.length,n=(l+(e.length-1))%e.length):(n=l-1<0?void 0:l-1,r=l+1>=e.length?void 0:l+1),r!==n&&(i=e[n],t=e[r],!0!==this.options.hideMiddleMarkers&&this._createMiddleMarker(i,t)),e.splice(l,1)),this._fireEdit(),u._fireEvent(this._layer,"pm:vertexremoved",{layer:this._layer,marker:o,indexPath:s,shape:this.getShape()}))},findDeepMarkerIndex:function(t,i){t.some(function r(n){return function(t,e){e=n.concat(e);return t._leaflet_id===i._leaflet_id?(o=e,!0):Array.isArray(t)&&t.some(r(e))}}([]));var o,t={};return t=o?{indexPath:o,index:o[o.length-1],parentPath:o.slice(0,o.length-1)}:t},updatePolygonCoordsFromMarkerDrag:function(t){var e=this._layer.getLatLngs(),r=t.getLatLng(),t=this.findDeepMarkerIndex(this._markers,t),n=t.indexPath,i=t.index,t=t.parentPath;(1<n.length?h()(e,t):e).splice(i,1,r),this._layer.setLatLngs(e)},_getNeighborMarkers:function(t){var t=this.findDeepMarkerIndex(this._markers,t),e=t.indexPath,r=t.index,t=t.parentPath,e=1<e.length?h()(this._markers,t):this._markers,t=(r+1)%e.length;return{prevMarker:e[(r+(e.length-1))%e.length],nextMarker:e[t]}},_checkMarkerAllowedToDrag:function(t){var e=this._getNeighborMarkers(t),r=e.prevMarker,e=e.nextMarker,r=_e.polyline([r.getLatLng(),t.getLatLng()]),e=_e.polyline([t.getLatLng(),e.getLatLng()]),r=f()(this._layer.toGeoJSON(15),r.toGeoJSON(15)).features.length,e=f()(this._layer.toGeoJSON(15),e.toGeoJSON(15)).features.length;return t.getLatLng()===this._markers[0][0].getLatLng()?e+=1:t.getLatLng()===this._markers[0][this._markers[0].length-1].getLatLng()&&(r+=1),!(r<=2&&e<=2)},_onMarkerDragStart:function(t){var e=t.target,r=this.findDeepMarkerIndex(this._markers,e).indexPath;u._fireEvent(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:t,indexPath:r,shape:this.getShape()}),this.options.allowSelfIntersection||(this._coordsBeforeEdit=this._layer.getLatLngs()),this.cachedColor||(this.cachedColor=this._layer.options.color),!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()?this._markerAllowedToDrag=this._checkMarkerAllowedToDrag(e):this._markerAllowedToDrag=null},_onMarkerDrag:function(t){var e=t.target,r=this.findDeepMarkerIndex(this._markers,e),n=r.indexPath,i=r.index,r=r.parentPath;if(n){if(!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this.hasSelfIntersection()&&!1===this._markerAllowedToDrag)return this._layer.setLatLngs(this._coordsBeforeEdit),this._initMarkers(),void this._handleLayerStyle();this.updatePolygonCoordsFromMarkerDrag(e);var r=1<n.length?h()(this._markers,r):this._markers,o=(i+1)%r.length,i=(i+(r.length-1))%r.length,a=e.getLatLng(),i=r[i].getLatLng(),r=r[o].getLatLng();e._middleMarkerNext&&(o=u.calcMiddleLatLng(this._map,a,r),e._middleMarkerNext.setLatLng(o)),e._middleMarkerPrev&&(r=u.calcMiddleLatLng(this._map,a,i),e._middleMarkerPrev.setLatLng(r)),this.options.allowSelfIntersection||this._handleLayerStyle(),u._fireEvent(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:n})}},_onMarkerDragEnd:function(t){var e=t.target,e=this.findDeepMarkerIndex(this._markers,e).indexPath,t=(u._fireEvent(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:t,indexPath:e,shape:this.getShape()}),this.hasSelfIntersection());if(t&&this.options.allowSelfIntersectionEdit&&this._markerAllowedToDrag&&(t=!1),!this.options.allowSelfIntersection&&t)return this._layer.setLatLngs(this._coordsBeforeEdit),this._coordsBeforeEdit=null,this._initMarkers(),void this._handleLayerStyle();!this.options.allowSelfIntersection&&this.options.allowSelfIntersectionEdit&&this._handleLayerStyle(),this._fireEdit()},_fireEdit:function(){this._layerEdited=!0,u._fireEvent(this._layer,"pm:edit",{layer:this._layer,shape:this.getShape()})}}),r.Polygon=r.Line.extend({_shape:"Polygon",_checkMarkerAllowedToDrag:function(t){var e=this._getNeighborMarkers(t),r=e.prevMarker,e=e.nextMarker,r=_e.polyline([r.getLatLng(),t.getLatLng()]),t=_e.polyline([t.getLatLng(),e.getLatLng()]),e=f()(this._layer.toGeoJSON(15),r.toGeoJSON(15)).features.length,r=f()(this._layer.toGeoJSON(15),t.toGeoJSON(15)).features.length;return!(e<=2&&r<=2)}}),r.Rectangle=r.Polygon.extend({_shape:"Rectangle",_initMarkers:function(){var t=this._map,e=this._findCorners(),e=(this._markerGroup&&this._markerGroup.clearLayers(),this._markerGroup=new _e.LayerGroup,this._markerGroup._pmTempLayer=!0,t.addLayer(this._markerGroup),this._markers=[],this._markers[0]=e.map(this._createMarker,this),function(t){if(Array.isArray(t))return t}(t=this._markers)||function(t){if("undefined"!=typeof Symbol&&Symbol.iterator in Object(t)){var e=[],r=!0,n=!1,i=void 0;try{for(var o,a=t[Symbol.iterator]();!(r=(o=a.next()).done)&&(e.push(o.value),1!==e.length);r=!0);}catch(t){n=!0,i=t}finally{try{r||null==a.return||a.return()}finally{if(n)throw i}}return e}}(t)||function(t){if(t){if("string"==typeof t)return ye(t,1);var e=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(e="Object"===e&&t.constructor?t.constructor.name:e)||"Set"===e?Array.from(t):"Arguments"===e||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(e)?ye(t,1):void 0}}(t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}());this._cornerMarkers=e[0]},applyOptions:function(){this.options.snappable?this._initSnappableMarkers():this._disableSnapping(),this._addMarkerEvents()},_createMarker:function(t,e){var r=new _e.Marker(t,{draggable:!0,icon:_e.divIcon({className:"marker-icon"})});return r._origLatLng=t,r._index=e,r._pmTempLayer=!0,this._markerGroup.addLayer(r),r},_addMarkerEvents:function(){var e=this;this._markers[0].forEach(function(t){t.on("dragstart",e._onMarkerDragStart,e),t.on("drag",e._onMarkerDrag,e),t.on("dragend",e._onMarkerDragEnd,e),t.on("pm:snap",e._adjustRectangleForMarkerSnap,e),e.options.preventMarkerRemoval||t.on("contextmenu",e._removeMarker,e)})},_removeMarker:function(){return null},_onMarkerDragStart:function(t){var e=t.target,r=this._findCorners();e._oppositeCornerLatLng=r[(e._index+2)%4],e._snapped=!1,u._fireEvent(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:void 0})},_onMarkerDrag:function(t){var e=t.target;void 0!==e._index&&(e._snapped||this._adjustRectangleForMarkerMove(e),u._fireEvent(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:void 0}))},_onMarkerDragEnd:function(t){var e=this._findCorners();this._adjustAllMarkers(e),this._cornerMarkers.forEach(function(t){delete t._oppositeCornerLatLng}),this._layer.setLatLngs(e),u._fireEvent(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:void 0}),this._fireEdit()},_adjustRectangleForMarkerMove:function(t){_e.extend(t._origLatLng,t._latlng);var e=t.getLatLng();this._layer.setBounds(_e.latLngBounds(e,t._oppositeCornerLatLng)),this._adjustAdjacentMarkers(t),this._layer.redraw()},_adjustRectangleForMarkerSnap:function(t){this.options.snappable&&(t=t.target,this._adjustRectangleForMarkerMove(t))},_adjustAllMarkers:function(r){r.length&&4===r.length?this._cornerMarkers.forEach(function(t,e){t.setLatLng(r[e])}):console.error("_adjustAllMarkers() requires an array of EXACTLY 4 LatLng coordinates")},_adjustAdjacentMarkers:function(t){var r,n,i,o;t&&t.getLatLng&&t._oppositeCornerLatLng?(r=t.getLatLng(),n=t._oppositeCornerLatLng,i=[],this._findCorners().forEach(function(t){t.equals(r)||t.equals(n)||i.push(t)}),o=0,2===i.length&&this._cornerMarkers.forEach(function(t){var e=t.getLatLng();e.equals(r)||e.equals(n)||(t.setLatLng(i[o]),o+=1)})):console.error("_adjustAdjacentMarkers() requires a valid Marker object")},_findCorners:function(){var t=this._layer.getBounds();return[t.getNorthWest(),t.getNorthEast(),t.getSouthEast(),t.getSouthWest()]}}),r.Circle=r.extend({_shape:"Circle",initialize:function(t){this._layer=t,this._enabled=!1,this._updateHiddenPolyCircle()},enable:function(t){var e=this;_e.Util.setOptions(this,t),this._map=this._layer._map,this.enabled()||this.disable(),this._enabled=!0,this._initMarkers(),this.applyOptions(),this._layer.on("remove",function(t){e.disable(t.target)}),this._updateHiddenPolyCircle(),u._fireEvent(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()})},disable:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._layer;if(!this.enabled())return!1;if(t.pm._dragging)return!1;this._centerMarker.off("dragstart",this._fireDragStart,this),this._centerMarker.off("drag",this._fireDrag,this),this._centerMarker.off("dragend",this._fireDragEnd,this),this._outerMarker.off("drag",this._handleOuterMarkerSnapping,this),t.pm._enabled=!1,t.pm._helperLayers.clearLayers(),t.off("mousedown"),t.off("mouseup");t=t._path||this._layer._renderer._container;return _e.DomUtil.removeClass(t,"leaflet-pm-draggable"),this._layerEdited&&u._fireEvent(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()}),this._layerEdited=!1,u._fireEvent(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()}),!0},enabled:function(){return this._enabled},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},_initMarkers:function(){var t=this._map,t=(this._helperLayers&&this._helperLayers.clearLayers(),this._helperLayers=new _e.LayerGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(t),this._layer.getLatLng()),e=this._layer._radius,e=this._getLatLngOnCircle(t,e);this._centerMarker=this._createCenterMarker(t),this._outerMarker=this._createOuterMarker(e),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},applyOptions:function(){this.options.snappable?(this._initSnappableMarkers(),this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this),this._centerMarker.on("move",this._moveCircle,this)):this._disableSnapping()},_createHintLine:function(t,e){t=t.getLatLng(),e=e.getLatLng();this._hintline=_e.polyline([t,e],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker:function(t){t=this._createMarker(t);return _e.DomUtil.addClass(t._icon,"leaflet-pm-draggable"),t.on("drag",this._moveCircle,this),t.on("dragstart",this._fireDragStart,this),t.on("drag",this._fireDrag,this),t.on("dragend",this._fireDragEnd,this),t},_createOuterMarker:function(t){t=this._createMarker(t);return t.on("drag",this._resizeCircle,this),t},_createMarker:function(t){var e=new _e.Marker(t,{draggable:!0,icon:_e.divIcon({className:"marker-icon"})});return e._origLatLng=t,e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("drag",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this._helperLayers.addLayer(e),e},_resizeCircle:function(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_moveCircle:function(t){var t=t.latlng,e=(this._layer.setLatLng(t),this._layer._radius),e=this._getLatLngOnCircle(t,e);this._outerMarker.setLatLng(e),this._syncHintLine(),this._updateHiddenPolyCircle(),u._fireEvent(this._layer,"pm:centerplaced",{layer:this._layer,latlng:t,shape:this.getShape()})},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),t=t.distanceTo(e);this.options.minRadiusCircle&&t<this.options.minRadiusCircle?this._layer.setRadius(this.options.minRadiusCircle):this.options.maxRadiusCircle&&t>this.options.maxRadiusCircle?this._layer.setRadius(this.options.maxRadiusCircle):this._layer.setRadius(t),this._updateHiddenPolyCircle()},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng();this._hintline.setLatLngs([t,e])},_disableSnapping:function(){var e=this;this._markers.forEach(function(t){t.off("move",e._syncHintLine,e),t.off("move",e._syncCircleRadius,e),t.off("drag",e._handleSnapping,e),t.off("dragend",e._cleanupSnapping,e)}),this._layer.off("pm:dragstart",this._unsnap,this)},_onMarkerDragStart:function(t){u._fireEvent(this._layer,"pm:markerdragstart",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:void 0})},_onMarkerDrag:function(t){u._fireEvent(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:void 0})},_onMarkerDragEnd:function(t){this._fireEdit(),u._fireEvent(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:void 0})},_fireEdit:function(){u._fireEvent(this._layer,"pm:edit",{layer:this._layer,shape:this.getShape()}),this._layerEdited=!0},_fireDragStart:function(){u._fireEvent(this._layer,"pm:dragstart",{layer:this._layer,shape:this.getShape()})},_fireDrag:function(t){u._fireEvent(this._layer,"pm:drag",Object.assign({},t,{shape:this.getShape()}))},_fireDragEnd:function(){u._fireEvent(this._layer,"pm:dragend",{layer:this._layer,shape:this.getShape()})},_updateHiddenPolyCircle:function(){this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(u.circleToPolygon(this._layer,200).getLatLngs()):this._hiddenPolyCircle=u.circleToPolygon(this._layer,200),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer)},_getLatLngOnCircle:function(t,e){t=this._map.project(t),e=_e.point(t.x+e,t.y);return this._map.unproject(e)},_getNewDestinationOfOuterMarker:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),r=t.distanceTo(e);return this.options.minRadiusCircle&&r<this.options.minRadiusCircle?e=s(this._map,t,e,this.options.minRadiusCircle):this.options.maxRadiusCircle&&r>this.options.maxRadiusCircle&&(e=s(this._map,t,e,this.options.maxRadiusCircle)),e},_handleOuterMarkerSnapping:function(){var t,e;this._outerMarker._snapped&&(e=this._centerMarker.getLatLng(),t=this._outerMarker.getLatLng(),e=e.distanceTo(t),(this.options.minRadiusCircle&&e<this.options.minRadiusCircle||this.options.maxRadiusCircle&&e>this.options.maxRadiusCircle)&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)),this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())}}),r.CircleMarker=r.extend({_shape:"CircleMarker",initialize:function(t){this._layer=t,this._enabled=!1,this._updateHiddenPolyCircle()},enable:function(){_e.Util.setOptions(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{draggable:!0,snappable:!0}),this._map=this._layer._map,this._map&&(this.enabled()&&this.disable(),this.applyOptions(),this._enabled=!0,this._layer.on("pm:dragstart",this._onDragStart,this),this._layer.on("pm:dragend",this._onMarkerDragEnd,this),this._updateHiddenPolyCircle(),u._fireEvent(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()}))},disable:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._layer;return!(t.pm._dragging||(t.pm._helperLayers&&t.pm._helperLayers.clearLayers(),this._map||(this._map=this._layer._map),this.options.editable?(this._map.off("move",this._syncMarkers,this),this._outerMarker&&this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this)):this._map.off("move",this._updateHiddenPolyCircle,this),this.disableLayerDrag(),this._layer.off("contextmenu",this._removeMarker,this),this.enabled()||(this._layerEdited&&u._fireEvent(this._layer,"pm:update",{layer:this._layer,shape:this.getShape()}),this._layerEdited=!1,u._fireEvent(this._layer,"pm:disable",{layer:this._layer,shape:this.getShape()})),t.pm._enabled=!1))},enabled:function(){return this._enabled},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},applyOptions:function(){!this.options.editable&&this.options.draggable?this.enableLayerDrag():this.disableLayerDrag(),this.options.editable?(this._initMarkers(),this._map.on("move",this._syncMarkers,this)):this._map.on("move",this._updateHiddenPolyCircle,this),this.options.snappable?this.options.editable?(this._initSnappableMarkers(),this.options.editable&&this._outerMarker.on("drag",this._handleOuterMarkerSnapping,this),this._outerMarker.on("move",this._syncHintLine,this),this._outerMarker.on("move",this._syncCircleRadius,this)):this._initSnappableMarkersDrag():this.options.editable?this._disableSnapping():this._disableSnappingDrag(),this.options.preventMarkerRemoval||this._layer.on("contextmenu",this._removeMarker,this)},_initMarkers:function(){var t=this._map,t=(this._helperLayers&&this._helperLayers.clearLayers(),this._helperLayers=new _e.LayerGroup,this._helperLayers._pmTempLayer=!0,this._helperLayers.addTo(t),this._layer.getLatLng()),e=this._layer._radius,e=this._getLatLngOnCircle(t,e);this._centerMarker=this._createCenterMarker(t),this._outerMarker=this._createOuterMarker(e),this._markers=[this._centerMarker,this._outerMarker],this._createHintLine(this._centerMarker,this._outerMarker)},_getLatLngOnCircle:function(t,e){t=this._map.project(t),e=_e.point(t.x+e,t.y);return this._map.unproject(e)},_createHintLine:function(t,e){t=t.getLatLng(),e=e.getLatLng();this._hintline=_e.polyline([t,e],this.options.hintlineStyle),this._hintline._pmTempLayer=!0,this._helperLayers.addLayer(this._hintline)},_createCenterMarker:function(t){t=this._createMarker(t);return this.options.draggable?(_e.DomUtil.addClass(t._icon,"leaflet-pm-draggable"),t.on("drag",this._moveCircle,this)):t.dragging.disable(),t},_createOuterMarker:function(t){t=this._createMarker(t);return t.on("drag",this._resizeCircle,this),t},_createMarker:function(t){var e=new _e.Marker(t,{draggable:!0,icon:_e.divIcon({className:"marker-icon"})});return e._origLatLng=t,e._pmTempLayer=!0,e.on("dragstart",this._onMarkerDragStart,this),e.on("drag",this._onMarkerDrag,this),e.on("dragend",this._onMarkerDragEnd,this),this._helperLayers.addLayer(e),e},_moveCircle:function(t){var t=t.latlng,e=(this._layer.setLatLng(t),this._layer._radius),e=this._getLatLngOnCircle(t,e);this._outerMarker.setLatLng(e),this._syncHintLine(),u._fireEvent(this._layer,"pm:centerplaced",{layer:this._layer,latlng:t,shape:this.getShape()})},_syncMarkers:function(){var t=this._layer.getLatLng(),e=this._layer._radius,e=this._getLatLngOnCircle(t,e);this._outerMarker.setLatLng(e),this._centerMarker.setLatLng(t),this._syncHintLine(),this._updateHiddenPolyCircle()},_resizeCircle:function(){this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker()),this._syncHintLine(),this._syncCircleRadius()},_syncCircleRadius:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),t=this._map.project(t).distanceTo(this._map.project(e));this.options.minRadiusCircleMarker&&t<this.options.minRadiusCircleMarker?this._layer.setRadius(this.options.minRadiusCircleMarker):this.options.maxRadiusCircleMarker&&t>this.options.maxRadiusCircleMarker?this._layer.setRadius(this.options.maxRadiusCircleMarker):this._layer.setRadius(t),this._updateHiddenPolyCircle()},_syncHintLine:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng();this._hintline.setLatLngs([t,e])},_removeMarker:function(){this.options.editable&&this.disable(),this._layer.remove(),u._fireEvent(this._layer,"pm:remove",{layer:this._layer,shape:this.getShape()}),u._fireEvent(this._map,"pm:remove",{layer:this._layer,shape:this.getShape()})},_onDragStart:function(){this._map.pm.Draw.CircleMarker._layerIsDragging=!0},_onMarkerDragStart:function(t){u._fireEvent(this._layer,"pm:markerdragstart",{markerEvent:t,layer:this._layer,shape:this.getShape(),indexPath:void 0})},_onMarkerDrag:function(t){u._fireEvent(this._layer,"pm:markerdrag",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:void 0})},_onMarkerDragEnd:function(t){this._map.pm.Draw.CircleMarker._layerIsDragging=!1,u._fireEvent(this._layer,"pm:markerdragend",{layer:this._layer,markerEvent:t,shape:this.getShape(),indexPath:void 0})},_fireEdit:function(){u._fireEvent(this._layer,"pm:edit",{layer:this._layer,shape:this.getShape()}),this._layerEdited=!0},_initSnappableMarkersDrag:function(){var t=this._layer;this.options.snapDistance=this.options.snapDistance||30,t.off("pm:drag",this._handleSnapping,this),t.on("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.on("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this),t.on("pm:dragstart",this._unsnap,this)},_disableSnappingDrag:function(){var t=this._layer;t.off("pm:drag",this._handleSnapping,this),t.off("pm:dragend",this._cleanupSnapping,this),t.off("pm:dragstart",this._unsnap,this)},_updateHiddenPolyCircle:function(){var t,e=this._layer._map||this._map;e&&(t=e.project(this._layer.getLatLng()),t=_e.point(t.x+this._layer.getRadius(),t.y),e=this._layer.getLatLng().distanceTo(e.unproject(t)),(t=_e.circle(this._layer.getLatLng(),this._layer.options)).setRadius(e),this._hiddenPolyCircle?this._hiddenPolyCircle.setLatLngs(u.circleToPolygon(t,200).getLatLngs()):this._hiddenPolyCircle=u.circleToPolygon(t,200),this._hiddenPolyCircle._parentCopy||(this._hiddenPolyCircle._parentCopy=this._layer))},_getNewDestinationOfOuterMarker:function(){var t=this._centerMarker.getLatLng(),e=this._outerMarker.getLatLng(),r=this._map.project(t).distanceTo(this._map.project(e));return this.options.minRadiusCircleMarker&&r<this.options.minRadiusCircleMarker?e=s(this._map,t,e,this._pxRadiusToMeter(this.options.minRadiusCircleMarker)):this.options.maxRadiusCircleMarker&&r>this.options.maxRadiusCircleMarker&&(e=s(this._map,t,e,this._pxRadiusToMeter(this.options.maxRadiusCircleMarker))),e},_handleOuterMarkerSnapping:function(){var t,e;this._outerMarker._snapped&&(e=this._centerMarker.getLatLng(),t=this._outerMarker.getLatLng(),e=this._map.project(e).distanceTo(this._map.project(t)),(this.options.minRadiusCircleMarker&&e<this.options.minRadiusCircleMarker||this.options.maxRadiusCircleMarker&&e>this.options.maxRadiusCircleMarker)&&this._outerMarker.setLatLng(this._outerMarker._orgLatLng)),this._outerMarker.setLatLng(this._getNewDestinationOfOuterMarker())},_pxRadiusToMeter:function(t){var e=this._centerMarker.getLatLng(),r=this._map.project(e),t=_e.point(r.x+t,r.y);return this._map.unproject(t).distanceTo(e)}}),r.ImageOverlay=r.extend({_shape:"ImageOverlay",initialize:function(t){this._layer=t,this._enabled=!1},toggleEdit:function(t){this.enabled()?this.disable():this.enable(t)},enabled:function(){return this._enabled},enable:function(){_e.Util.setOptions(this,0<arguments.length&&void 0!==arguments[0]?arguments[0]:{draggable:!0,snappable:!0}),this._map=this._layer._map,this._map&&(this.enabled()||this.disable(),this.enableLayerDrag(),this._enabled=!0,this._otherSnapLayers=_e.PM.Edit.Rectangle.prototype._findCorners.apply(this),u._fireEvent(this._layer,"pm:enable",{layer:this._layer,shape:this.getShape()}))},disable:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this._layer;return!(t.pm._dragging||(this._map||(this._map=this._layer._map),this.disableLayerDrag(),this.enabled()||(this._layerEdited&&u._fireEvent(t,"pm:update",{layer:t,shape:this.getShape()}),this._layerEdited=!1,u._fireEvent(t,"pm:disable",{layer:t,shape:this.getShape()})),this._layer.off("contextmenu",this._removeMarker,this),t.pm._enabled=!1))},_fireEdit:function(){u._fireEvent(this._layer,"pm:edit",{layer:this._layer,shape:this.getShape()}),this._layerEdited=!0}}),t(148),t(149),_e.PM=_e.PM||{version:A.a,Map:z,Toolbar:F,Draw:n,Edit:r,Utils:u,activeLang:"en",optIn:!1,initialize:function(t){this.addInitHooks(t)},setOptIn:function(t){this.optIn=!!t},addInitHooks:function(){_e.Map.addInitHook(function(){this.pm=void 0,_e.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new _e.PM.Map(this)):this.options.pmIgnore||(this.pm=new _e.PM.Map(this))}),_e.LayerGroup.addInitHook(function(){this.pm=void 0,_e.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new _e.PM.Edit.LayerGroup(this)):this.options.pmIgnore||(this.pm=new _e.PM.Edit.LayerGroup(this))}),_e.Marker.addInitHook(function(){this.pm=void 0,_e.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new _e.PM.Edit.Marker(this)):this.options.pmIgnore||(this.pm=new _e.PM.Edit.Marker(this))}),_e.CircleMarker.addInitHook(function(){this.pm=void 0,_e.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new _e.PM.Edit.CircleMarker(this)):this.options.pmIgnore||(this.pm=new _e.PM.Edit.CircleMarker(this))}),_e.Polyline.addInitHook(function(){this.pm=void 0,_e.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new _e.PM.Edit.Line(this)):this.options.pmIgnore||(this.pm=new _e.PM.Edit.Line(this))}),_e.Polygon.addInitHook(function(){this.pm=void 0,_e.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new _e.PM.Edit.Polygon(this)):this.options.pmIgnore||(this.pm=new _e.PM.Edit.Polygon(this))}),_e.Rectangle.addInitHook(function(){this.pm=void 0,_e.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new _e.PM.Edit.Rectangle(this)):this.options.pmIgnore||(this.pm=new _e.PM.Edit.Rectangle(this))}),_e.Circle.addInitHook(function(){this.pm=void 0,_e.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new _e.PM.Edit.Circle(this)):this.options.pmIgnore||(this.pm=new _e.PM.Edit.Circle(this))}),_e.ImageOverlay.addInitHook(function(){this.pm=void 0,_e.PM.optIn?!1===this.options.pmIgnore&&(this.pm=new _e.PM.Edit.ImageOverlay(this)):this.options.pmIgnore||(this.pm=new _e.PM.Edit.ImageOverlay(this))})},reInitLayer:function(t){var e=this;t instanceof _e.LayerGroup?t.eachLayer(function(t){e.reInitLayer(t)}):t.pm||_e.PM.optIn&&!1!==t.options.pmIgnore||t.options.pmIgnore||(t instanceof _e.Map?t.pm=new _e.PM.Map(t):t instanceof _e.Marker?t.pm=new _e.PM.Edit.Marker(t):t instanceof _e.Circle?t.pm=new _e.PM.Edit.Circle(t):t instanceof _e.CircleMarker?t.pm=new _e.PM.Edit.CircleMarker(t):t instanceof _e.Rectangle?t.pm=new _e.PM.Edit.Rectangle(t):t instanceof _e.Polygon?t.pm=new _e.PM.Edit.Polygon(t):t instanceof _e.Polyline&&(t.pm=new _e.PM.Edit.Line(t)))}},_e.PM.initialize()}],n={},i.m=r,i.c=n,i.d=function(t,e,r){i.o(t,e)||Object.defineProperty(t,e,{enumerable:!0,get:r})},i.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},i.t=function(e,t){if(1&t&&(e=i(e)),8&t)return e;if(4&t&&"object"===ve(e)&&e&&e.__esModule)return e;var r=Object.create(null);if(i.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var n in e)i.d(r,n,function(t){return e[t]}.bind(null,n));return r},i.n=function(t){var e=t&&t.__esModule?function(){return t.default}:function(){return t};return i.d(e,"a",e),e},i.o=function(t,e){return Object.prototype.hasOwnProperty.call(t,e)},i.p="",i(i.s=63)}},t.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/css/main.css", [], function(m){m.exports="";return m.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/config",[],function(o,t,r,e,i,n){return o.exports={DEFAULT_OPTIONS:{padding:.01,visibility:!0,steplessZooming:!0,highPerformance:!0,mapOptions:{background:"rgba(0,0,0,0)",zoom:{zoomRange:[0,20],default:4.5},center:{lng:108,lat:38},coordinateSystem:"normal",normal:"EPSG3857",custom:{epsg:"",proj:"",originX:0,originY:0,resolutions:""},scaleControl:{show:!1,fontColor:"#fff",borderColor:"#777",offsetX:5,offsetY:25}},popupStyle:{textStyle:{fontFamily:"Microsoft Yahei",fontWeight:"bold",fontSize:14,color:"#ffffff",lineHeight:1.8},border:{radius:8,width:2,color:"#000000"},padding:{top:16,right:40,bottom:16,left:16},background:{color:"rgba(0, 0, 0, 0.88)",blurColor:"rgba(0, 0, 0, 0.3)",offsetX:0,offsetY:4,blurRadius:12},closeBtn:{enable:!0,color:"rgba(255, 255, 255, 0.4)"},tipBtn:{enable:!0},isEmptyShow:!1},interaction:{dragging:!0,scrollWheelZoom:!0,isInteraction:!0}}},o.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/layer",[],function(a,r,o,t,e,c){var d=o("datav:/com/datav-2dmap/3.0.70/src/layer/Layer"),o=o("datav:/com/datav-2dmap/3.0.70/src/layer/GeoJsonFactory");return a.exports={Layer:d,GeoJsonFactory:o},a.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/leaflet/leafletExt",["datav:/npm/leaflet/1.6.0/dist/leaflet","datav:/npm/leaflet/1.6.0/dist/leaflet.css","datav:/npm/@geoman-io/leaflet-geoman-free/2.13.0/dist/leaflet-geoman.css","datav:/npm/proj4leaflet/1.0.2/lib/proj4-compressed","datav:/npm/topojson-client/3.0.0"],function(t,o,e,i,s,n){var a=e("datav:/npm/leaflet/1.6.0/dist/leaflet");e("datav:/npm/leaflet/1.6.0/dist/leaflet.css",""),e("datav:/npm/@geoman-io/leaflet-geoman-free/2.13.0/dist/leaflet-geoman.css",""),e("datav:/com/datav-2dmap/3.0.70/css/main.css",""),e("datav:/com/datav-2dmap/3.0.70/src/leaflet/geoman").bindLeaflet(a);var r=e("datav:/com/datav-2dmap/3.0.70/src/utils").$,l=e("datav:/npm/proj4leaflet/1.0.2/lib/proj4-compressed"),c=(a.topojson=e("datav:/npm/topojson-client/3.0.0"),a.customPopup=e("datav:/com/datav-2dmap/3.0.70/src/leaflet/customPopup"),a.CanvasLayerExt=e("datav:/com/datav-2dmap/3.0.70/src/leaflet/CanvasLayerExt"),a.GridLayer.prototype._initTile),d=(a.GridLayer.prototype._initTile=function(t){c.call(this,t);var o=this.getTileSize(),e=void 0===this.options.expandPiexl?1:this.options.expandPiexl;t.style.width="".concat(o.x+e,"px"),t.style.height="".concat(o.y+e,"px")},a.Map.prototype.getSize);return a.Map.prototype.getSize=function(t){var o;return d.call(this,t),this._size&&!this._sizeChanged&&0!==this._size.x&&0!==this._size.y||(t=r(this._container).actual("width"),o=r(this._container).actual("height"),this._size=new a.Point(this._container.clientWidth||t||0,this._container.clientHeight||o||0),this._sizeChanged=!1),this._size.clone()},a.Proj={},a.Proj._isProj4Obj=function(t){return void 0!==t.inverse&&void 0!==t.forward},a.Proj.Projection=a.Class.extend({initialize:function(t,o,e){var i=a.Proj._isProj4Obj(t);this._proj=i?t:this._projFromCodeDef(t,o),this.bounds=i?o:e},project:function(t){t=this._proj.forward([t.lng,t.lat]);return new a.Point(t[0],t[1])},unproject:function(t,o){t=this._proj.inverse([t.x,t.y]);return new a.LatLng(t[1],t[0],o)},_projFromCodeDef:function(t,o){if(o)l.defs(t,o);else if(void 0===l.defs[t]){o=t.split(":");if(3<o.length&&(t="".concat(o[o.length-3],":").concat(o[o.length-1])),void 0===l.defs[t])throw"No projection definition for code ".concat(t)}return l(t)}}),a.Proj.CRS=a.Class.extend({includes:a.CRS,options:{transformation:new a.Transformation(1,0,-1,0)},initialize:function(t,o,e){var i,s;if(a.Proj._isProj4Obj(t)?(i=t.srsCode,this.projection=new a.Proj.Projection(t,(s=o||{}).bounds)):this.projection=new a.Proj.Projection(i=t,o,(s=e||{}).bounds),a.Util.setOptions(this,s),this.code=i,this.transformation=this.options.transformation,this.options.origin&&(this.transformation=new a.Transformation(1,-this.options.origin[0],-1,this.options.origin[1])),this.options.scales)this._scales=this.options.scales;else if(this.options.resolutions){this._scales=[];for(var n=this.options.resolutions.length-1;0<=n;n--)this.options.resolutions[n]&&(this._scales[n]=1/this.options.resolutions[n])}this.infinite=!this.options.bounds},scale:function(t){var o,e=Math.floor(t);return t===e?this._scales[t]:(o=this._scales[e])+(this._scales[e+1]-o)*(t-e)},zoom:function(t){var o,e=this._closestElement(this._scales,t),i=this._scales.indexOf(e);return t===e?i:void 0===(o=this._scales[i+1])?1/0:(t-e)/(o-e)+i},distance:a.CRS.Earth.distance,R:a.CRS.Earth.R,_closestElement:function(t,o){for(var e,i=t.length;i--;)t[i]<=o&&(void 0===e||e<t[i])&&(e=t[i]);return e}}),a.CRS.BD09=new a.Proj.CRS("EPSG:900913","+proj=merc +a=6378206 +b=6356584.314245179 +lat_ts=0.0 +lon_0=0.0 +x_0=0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext  +no_defs",{resolutions:function(){level=19;var t=[];t[0]=Math.pow(2,18);for(var o=1;o<level;o++)t[o]=Math.pow(2,18-o);return t}(),origin:[0,0],bounds:a.bounds([20037508.342789244,0],[0,20037508.342789244])}),t.exports=a,t.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/utils/geojson-bbox",[],function(t,e,r,n,o,u){function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(r="Object"===r&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}return t.exports=function(t){if(t.hasOwnProperty("type"))return function r(t){var e;"Point"==t.type?e=[t.coordinates]:"LineString"==t.type||"MultiPoint"==t.type?e=t.coordinates:"Polygon"==t.type||"MultiLineString"==t.type?e=t.coordinates.reduce(function(t,e){return t.push.apply(t,i(e)),t},[]):"MultiPolygon"==t.type?e=t.coordinates.reduce(function(t,e){return t.push.apply(t,i(e.reduce(function(t,e){return t.push.apply(t,i(e)),t},[]))),t},[]):"Feature"==t.type?e=r(t.geometry):"GeometryCollection"==t.type?e=t.geometries.reduce(function(t,e){return t.push.apply(t,i(r(e))),t},[]):"FeatureCollection"==t.type&&(e=t.features.reduce(function(t,e){return t.push.apply(t,i(r(e))),t},[]));return e}(t).reduce(function(t,e){return[Math.min(e[0],t[0]),Math.min(e[1],t[1]),Math.max(e[0],t[2]),Math.max(e[1],t[3])]},[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY])},t.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/utils/mergeOptions",["datav:/npm/lodash.mergewith/4.6.2","datav:/npm/lodash.clonedeep/4.5.0"],function(a,e,t,r,n,d){var o=t("datav:/npm/lodash.mergewith/4.6.2"),p=t("datav:/npm/lodash.clonedeep/4.5.0");return a.exports=function(a,e){return a=p(a),e=p(e),o(a,e,function(a,e){if(Array.isArray(a))return e})},a.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/utils/linearScale",[],function(t,r,n,a,e,u){return t.exports=function(n,a){return function(t){if(n[0]===n[1]||a[0]===a[1])return a[0];var r=(a[1]-a[0])/(n[1]-n[0]),r=a[0]+r*(t-n[0]);return Math.min(a[1],Math.max(a[0],r))}},t.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/utils/arr2geojson",[],function(t,e,r,n,a,o){return t.exports=function(t,e){var r=e||{lat:"lat",lng:"lng"};return{type:"FeatureCollection",features:t.map(function(t){return{type:"Feature",properties:t,geometry:{type:"Point",coordinates:[+t[r.lng],+t[r.lat]]}}})}},t.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/utils/ainimateFrame",[],function(n,e,a,i,t,o){for(var m=0,r=["webkit","moz"],w=0;w<r.length&&!window.requestAnimationFrame;++w)window.requestAnimationFrame=window["".concat(r[w],"RequestAnimationFrame")],window.cancelAnimationFrame=window["".concat(r[w],"CancelAnimationFrame")]||window["".concat(r[w],"CancelRequestAnimationFrame")];return window.requestAnimationFrame||(window.requestAnimationFrame=function(n,e){var a=(new Date).getTime(),i=Math.max(0,16.7-(a-m)),t=window.setTimeout(function(){n(a+i)},i);return m=a+i,t}),window.cancelAnimationFrame||(window.cancelAnimationFrame=function(n){clearTimeout(n)}),n.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/utils/jquery.actual",[],function(t,n,a,e,o,i){return t.exports=function(s){return s.fn.addBack=s.fn.addBack||s.fn.andSelf,s.fn.extend({actual:function(t,n){if(!this[t])throw'$.actual => The jQuery method "'.concat(t,'" you called does not exist');var a,e,o,i=s.extend({absolute:!1,clone:!1,includeMargin:!1,display:"block"},n),c=this.eq(0),r=(n=!0===i.clone?(r=function(){c=c.clone().attr("style","position: absolute !important; top: -1000 !important; ").appendTo("body")},function(){c.remove()}):(a=[],e="",r=function(){o=c.parents().addBack().filter(":hidden"),e+="visibility: hidden !important; display: ".concat(i.display," !important; "),!0===i.absolute&&(e+="position: absolute !important; "),o.each(function(){var t=s(this),n=t.attr("style");a.push(n),t.attr("style",n?"".concat(n,";").concat(e):e)})},function(){o.each(function(t){var n=s(this),t=a[t];void 0===t?n.removeAttr("style"):n.attr("style",t)})}),r(),/(outer)/.test(t)?c[t](i.includeMargin):c[t]());return n(),r}}),s},t.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/utils/resize-canvas",[],function(a,t,e,r,h,o){return a.exports=function(a,t,e){for(var r=a.width,h=a.height,o=(t=Math.round(t),e=Math.round(e),document.createElement("canvas")),n=r/(o.width=t),i=h/(o.height=e),c=Math.ceil(n/2),M=Math.ceil(i/2),a=a.getContext("2d").getImageData(0,0,r,h),d=o.getContext("2d"),s=d.createImageData(t,e),u=a.data,m=s.data,v=0;v<e;v++)for(var f=0;f<t;f++){for(var g=4*(f+v*t),l=0,p=0,x=0,b=0,C=0,D=0,I=0,w=v*i,q=Math.floor(f*n),z=Math.ceil((f+1)*n),E=Math.floor(v*i),j=Math.ceil((v+1)*i),z=Math.min(z,r),j=Math.min(j,h),k=E;k<j;k++)for(var y=Math.abs(w-k)/M,A=f*n,B=y*y,F=q;F<z;F++){var G=Math.abs(A-F)/c,G=Math.sqrt(B+G*G);1<=G||(I+=(l=2*G*G*G-3*G*G+1)*u[3+(G=4*(F+k*r))],x+=l,b+=(l=u[3+G]<255?l*u[3+G]/250:l)*u[G],C+=l*u[1+G],D+=l*u[2+G],p+=l)}m[g]=b/p,m[1+g]=C/p,m[2+g]=D/p,m[3+g]=I/x}return d.putImageData(s,0,0),o},a.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/utils/get-devicepixelratio",["datav:/npm/ua-parser-js/1.0.2"],function(e,a,i,r,n,o){var i=i("datav:/npm/ua-parser-js/1.0.2")(navigator.userAgent),d=i.os,s=(i.device,i.browser),c={pc:{chrome:268435456,edge:268435456,firefox:124992400,ie:67108864,safafi:268435456},mobile:{chrome:117418896,firefox:117418896,edge:117418896,safari:16777216,ie:16777216}};return e.exports=function(e,a){var i="iOS"===(i=d).name||"Android"===i.name?"mobile":"pc",r=(r=s).name.includes("Chrome")||r.name.includes("Android Browser")?"chrome":r.name.includes("Firefox")?"firefox":r.name.includes("Edge")?"edge":r.name.includes("Safari")?"safafi":r.name.includes("IE")?"ie":"chrome",i=c[i][r]||16777216,r=window.devicePixelRatio||1;return i<r*e*a*r?Math.sqrt(i/e/a)-.1:r},e.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/utils",["datav:/npm/chroma-js/1.3.3","datav:/npm/rbush/3.0.0","datav:/npm/polylabel/1.0.2","datav:/npm/geojson-flatten/1.0.1","datav:/npm/lodash/4.17.21","datav:/npm/jquery/2.1.4"],function(a,t,e,n,r,o){var u=e("datav:/npm/chroma-js/1.3.3"),l=e("datav:/npm/rbush/3.0.0"),s=e("datav:/npm/polylabel/1.0.2"),v=e("datav:/npm/geojson-flatten/1.0.1"),d=e("datav:/npm/lodash/4.17.21"),i=e("datav:/npm/jquery/2.1.4"),c=e("datav:/com/datav-2dmap/3.0.70/src/utils/get-devicepixelratio"),m=e("datav:/com/datav-2dmap/3.0.70/src/utils/resize-canvas"),p=(e("datav:/com/datav-2dmap/3.0.70/src/utils/jquery.actual")(i),e("datav:/com/datav-2dmap/3.0.70/src/utils/ainimateFrame"),e("datav:/com/datav-2dmap/3.0.70/src/utils/arr2geojson")),f=e("datav:/com/datav-2dmap/3.0.70/src/utils/linearScale"),g=e("datav:/com/datav-2dmap/3.0.70/src/utils/mergeOptions"),e=e("datav:/com/datav-2dmap/3.0.70/src/utils/geojson-bbox");var h=document.createElement("canvas").getContext("2d");return a.exports={_:d,$:i,arr2geojson:p,linearScale:f,mergeOptions:g,geojsonBBox:e,geojsonFlatten:v,polylabel:s,Chroma:u,RBush:l,getRandomCode:function(a){if(0<a){for(var t=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],e="",n=0;n<a;n++)e+=t[parseInt(61*Math.random())];return e}return!1},measureText:function(a,t,e,n){return h.font="".concat(e," ").concat(n,"px ").concat(t),{width:Math.ceil(h.measureText(a).width),height:n}},getRange:function(a){if(!a.length)return null;if(0===(a=a.filter(function(a){return null!=a.value&&!isNaN(+a.value)&&""!==a.value})).length)return null;if(1===a.length)return[a[0].value,a[0].value];var t=a.reduce(function(a,t){return+a.value<=+t.value?a:t},{}),a=a.reduce(function(a,t){return+a.value>=+t.value?a:t},{});return[+t.value,+a.value]},getDashArray:function(a){var t=[];if(""!==a&&a)if("string"==typeof a)for(var e,n=a.split(/[, ]+/),r=0;r<n.length;r++){if(e=Number(n[r]),isNaN(e))return;t.push(e)}else t=a;else t=[];return t},getBestDevicePixelRatio:c,resizeCanvas:m},a.exports});;
Cube("datav:/com/datav-2dmap/3.0.70/src/Viewer",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1","datav:/npm/@amap/amap-jsapi-loader/1.0.1"],function(e,o,t,n,i,a){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function r(e,o){for(var t=0;t<o.length;t++){var n=o[t];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,o){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,o){return e.__proto__=o,e})(e,o)}function c(t){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,o=u(t),o=(e=n?(e=u(this).constructor,Reflect.construct(o,arguments,e)):o.apply(this,arguments),this);if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==o)return o;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=t("datav:/npm/eventemitter3/3.0.0"),h=t("datav:/npm/safely-merge/1.0.1"),p=t("datav:/npm/@amap/amap-jsapi-loader/1.0.1"),d=t("datav:/com/datav-2dmap/3.0.70/src/utils"),f=t("datav:/com/datav-2dmap/3.0.70/src/leaflet/leafletExt"),m=t("datav:/com/datav-2dmap/3.0.70/src/layer"),g=m.Layer,b=m.GeoJsonFactory,L=t("datav:/com/datav-2dmap/3.0.70/src/config").DEFAULT_OPTIONS;return e.exports=function(){var m,e=d._,o=e.throttle,v=e.isNil,e=a,t=y;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t);var n,i=c(a);function a(e,o,t){var n;if(this instanceof a)return(n=i.call(this)).options=h(L,o),n.container=e,n.GuiUtils=t,n.Utils=d,n.L=f,n.AMapLoader=p,n.Layer=g,n.layerKeys=[],n.subcoms={},n.groupCanvasLayerKeys_types=[],n.groupCanvasLayerKeys={},n.canvasLayerGroup=[],n.fly_timer=null,n.loopIndex=0,n.loopIndex_noAnimateLayer=0,n.init(),n;throw new TypeError("Cannot call a class as a function")}return e=a,(t=[{key:"init",value:function(){var e=this.options,o=e.padding,t=e.general,n=e.coordinate,i=e.interaction,e=e.popupStyle,a=t.background,s=t.zoom,r=t.center,t=t.scaleControl,l=n.coordinateSystem,c=n.normal,n=n.custom,u=i.interaction,y=u.dragging,h=u.scrollWheelZoom,u=u.steplessZooming?.1:.5,p={center:r,zoomSnap:u,zoomDelta:u,zoom:s.defaultZoom,doubleClickZoom:!1,padding:o,tolerance:3,smoothFactor:1,dragging:!!i.interaction.show&&y,keyboard:!!i.interaction.show&&y,scrollWheelZoom:!!i.interaction.show&&h};if("normal"===l)switch(c){case"EPSG3857":case"EPSG3395":case"EPSG4326":case"BD09":p.crs=f.CRS[c],p.crsCode=c;break;default:p.crs=f.CRS.EPSG3857,p.crsCode="EPSG3857"}else v(n.epsg)||v(n.proj)||v(n.originX)||v(n.originY)||v(n.resolutions)?(p.crs=f.CRS.EPSG3857,p.crsCode="EPSG3857"):(r=(r=n.resolutions.split(",")).map(function(e){return+e}),f.CRS.EPSG_Custom=new f.Proj.CRS(n.epsg,n.proj,{origin:[+n.originX,+n.originY],resolutions:r}),p.crs=f.CRS.EPSG_Custom,p.crsCode="EPSG_Custom");u=(m=this.map=f.map(this.container,p)).getSize(),y=u.multiplyBy(-o).round();m.options.offset=y,m.popupStyle=e;l=m.getBounds().pad(o),m.options.paddingBoundsExtent={minX:l.getWest(),minY:l.getSouth(),maxX:l.getEast(),maxY:l.getNorth()},this.zoom=m.getZoom(),n=u.x-2*y.x,r=u.y-2*y.y,m.devicePixelRatio=d.getBestDevicePixelRatio(n,r),e=m.devicePixelRatio,this.width=n*e,this.height=r*e,h?(m.scrollWheelZoom.enable(),m.touchZoom.enable()):(m.scrollWheelZoom.disable(),m.touchZoom.disable()),m.isMapMoving=!1,m.featureSelect=null,m.setMinZoom(s.zoomRange[0]),m.setMaxZoom(s.zoomRange[1]),this.container.style.background=a,this.container.style.cursor="",this.container.querySelector(".leaflet-control-attribution").innerHTML="",this.container.querySelector(".leaflet-control-zoom").style.display="none",this.container.style.pointerEvents=i.interaction.show?"auto":"none",this.updateScaleControl(t),o=b({map:m,L:f});this.GeoJson=o,this.initEvents=this.initEvents.bind(this),this.reDrawCanvas=this.reDrawCanvas.bind(this),this.updateOptions=this.updateOptions.bind(this),this.loop=this.loop.bind(this),this.initEvents(),this.loop()}},{key:"initEvents",value:function(){m.on("click",o(this.onClick,32,this),this),m.on("dblclick",o(this.onDblclick,32,this),this),m.on("mouseout",this.onMouseOut,this),m.on("mousedown",this.onMouseDown,this),m.on("mousemove",o(this.onMouseMove,32,this),this),m.on("movestart",this.onMoveStart,this),m.on("move",this.onMove,this),m.on("moveend",o(this.onMoveEnd,32,this),this),m.on("zoomend",o(this.onZoomEnd,32,this),this)}},{key:"loop",value:function(){this.options.visibility?m.visibility=!0:m.visibility=!1,!this.options.visibility||!this.loopId||m.isMapMoving||m.dragging.moving()||m._panAnim&&m._panAnim._inProgress||this.reDrawCanvas(),this.loopId=window.requestAnimationFrame(this.loop)}},{key:"reDrawCanvas",value:function(e){for(var o,t=this.groupCanvasLayerKeys_types.length-1;0<=t;t--){var n=this.groupCanvasLayerKeys_types[t],i=this.groupCanvasLayerKeys[t],a=!0;if(!e&&0===n){for(var a=!1,s=0;s<i.length;s++)if((o=this.subcoms[i[s]])&&o.layer&&o.layer.isStateChange){o.layer.isStateChange=!(a=!0);break}if(!a)continue}var r,l=this.map.devicePixelRatio;(r=this.canvasLayerGroup[this.groupCanvasLayerKeys_types.length-1-t].ctx).clearRect(0,0,this.width,this.height);for(var c=i.length-1;0<=c;c--)(o=this.subcoms[i[c]])&&o.options&&o.options.renderer&&"canvas"===o.options.renderer&&o.options.visibility&&this.zoom>=o.options.general.minZoom&&this.zoom<=o.options.general.maxZoom&&(o.layer instanceof g?o.draw&&o.draw(r):(r.save(),r.scale(l,l),o.draw&&o.draw(r),r.restore()))}}},{key:"onRender",value:function(){for(var e=0;e<this.groupCanvasLayerKeys_types.length;e++)this.canvasLayerGroup[e].updateContainer();var o=m.options.padding,o=m.getBounds().pad(o);m.options.paddingBoundsExtent={minX:o.getWest(),minY:o.getSouth(),maxX:o.getEast(),maxY:o.getNorth()};for(e=this.layerKeys.length-1;0<=e;e--){var t,n=(t=this.subcoms[this.layerKeys[e]]).options,i=n.general;n.visibility&&this.zoom>=i.minZoom&&this.zoom<=i.maxZoom&&t.onRender&&t.onRender(!0)}this.reDrawCanvas()}},{key:"onClick",value:function(a){var s=this;setTimeout(function(){if(!(s.isDblclick||!m||m.dragging.moving()||m._animatingZoom||!s.options.interaction.isInteraction||m._panAnim&&m._panAnim._inProgress)){for(var e,o,t=m.containerPointToLatLng([a.containerPoint.x,a.containerPoint.y]),n=s.subcoms,i=0;i<s.layerKeys.length;i++)if((e=n[s.layerKeys[i]])&&e.options.visibility&&e.options.interaction&&e.contains&&!(s.zoom<e.options.general.minZoom||s.zoom>e.options.general.maxZoom)&&(o=e.contains(t)).flag){m.featureSelect!=o.feature&&(m.featureSelect=o.feature,s.hoveredLayer=e),m.EventType="click",e.onClick&&e.onClick({latlng:t,feature:o.feature,featureBounds:o.featureBounds}),e.onRender&&e.onRender();break}o&&!o.flag&&(m.featureSelect=null,s.hoveredLayer=null,s.isNewHover&&(m.isMapMoving||e.onRender&&e.onRender(),s.isNewHover=!1))}},300),setTimeout(function(){s.isDblclick=!1},500)}},{key:"onDblclick",value:function(e){if(!(!m||m.dragging.moving()||m._animatingZoom||!this.options.interaction.isInteraction||m._panAnim&&m._panAnim._inProgress)){this.isDblclick=!0;for(var o,t=m.containerPointToLatLng([e.containerPoint.x,e.containerPoint.y]),n=this.subcoms,i=0;i<this.layerKeys.length;i++){var a=n[this.layerKeys[i]];if(a&&a.options.visibility&&a.options.interaction&&a.contains&&!(this.zoom<a.options.general.minZoom||this.zoom>a.options.general.maxZoom)){if((o=a.contains(t)).flag){m.featureSelect!=o.feature&&(m.featureSelect=o.feature,this.hoveredLayer=a),a.onDblclick&&a.onDblclick({feature:o.feature,latlng:t});break}a.onDblclick&&a.onDblclick({feature:null,latlng:null})}}o&&!o.flag&&(m.featureSelect=null,this.hoveredLayer=null)}}},{key:"onMouseOut",value:function(e){m.featureSelect&&(m.featureSelect=null,this.hoveredLayer=null)}},{key:"onMouseDown",value:function(e){m.mouseState="mouse"}},{key:"onMouseMove",value:function(e){var o;!m||m.dragging.moving()||m._animatingZoom||!this.options.interaction.isInteraction||m._panAnim&&m._panAnim._inProgress||(o=m.mouseEventToLayerPoint(e),this.handleMouseHover(e,o)&&this.reDrawCanvas())}},{key:"handleMouseHover",value:function(e,o){for(var t,n=m.containerPointToLatLng([e.containerPoint.x,e.containerPoint.y]),i=this.subcoms,a=0;a<this.layerKeys.length;a++)if((t=i[this.layerKeys[a]])&&t.options.visibility&&t.contains&&!(this.zoom<t.options.minZoom||this.zoom>t.options.maxZoom)){var s=t.contains(n);if(m.featureSelect&&s.flag&&m.featureSelect.geometry.coordinates!=s.feature.geometry.coordinates&&(this.hoveredLayer.onMouseOut&&this.hoveredLayer.onMouseOut({feature:m.featureSelect,layer:m.featureSelect.layer,latlng:n}),m.featureSelect=null,m.isMapMoving||(m.EventType="mouseout",this.hoveredLayer.onRender&&this.hoveredLayer.onRender()),this.hoveredLayer.options.interaction&&this.hoveredLayer.options.interaction.popup&&this.hoveredLayer.options.interaction.popup.show&&"mouseover"===this.hoveredLayer.options.interaction.popup.eventType&&m.getContainer().querySelector(".leaflet-popup")&&m.closePopup()),s.flag&&(this.container.style.cursor="pointer",m.featureSelect&&m.featureSelect.geometry.coordinates==s.feature.geometry.coordinates||(m.featureSelect=s.feature,m.featureSelect.layer=s.layer,(this.hoveredLayer=t).onMouseOver&&t.onMouseOver({feature:s.feature,layer:s.layer,latlng:n}),this.isNewHover=!0,m.isMapMoving||(m.EventType="mouseover",t.onRender&&t.onRender()))),s.flag)break}s&&!s.flag&&(this.container.style.cursor="",this.isNewHover&&(!m.isMapMoving&&this.hoveredLayer&&(this.hoveredLayer.onMouseOut&&this.hoveredLayer.onMouseOut({feature:m.featureSelect,layer:s.layer,latlng:n}),m.featureSelect=null,m.EventType="mouseout",this.hoveredLayer.onRender&&this.hoveredLayer.onRender(),this.hoveredLayer=null),this.isNewHover=!1))}},{key:"updateLayerIndex",value:function(e){this.layerKeys=[].concat(e);for(var o,t,n=this.layerKeys.length-1;0<=n;n--)(o=this.subcoms[this.layerKeys[n]])&&o.setZIndex&&(t=this.layerKeys.length-1-n,o.setZIndex&&o.setZIndex(t));this.canvasLayerKeys=[];for(var i=0;i<this.layerKeys.length;i++)(o=this.subcoms[this.layerKeys[i]])&&o.options&&o.options.renderer&&"canvas"===o.options.renderer&&this.canvasLayerKeys.push(this.layerKeys[i]);var a=0;if(this.groupCanvasLayerKeys={},this.groupCanvasLayerKeys[a]=[],this.groupCanvasLayerKeys_types=[],0!==this.canvasLayerKeys.length)if(1===this.canvasLayerKeys.length){this.groupCanvasLayerKeys[a]=[],this.groupCanvasLayerKeys[a].push(this.canvasLayerKeys[0]);e=this.subcoms[this.canvasLayerKeys[0]];e&&e.options&&e.options.isAnimateLayer?this.groupCanvasLayerKeys_types.push(1):this.groupCanvasLayerKeys_types.push(0)}else for(var s,r,l=1;l<this.canvasLayerKeys.length;l++)s=this.subcoms[this.canvasLayerKeys[l-1]],r=this.subcoms[this.canvasLayerKeys[l]],s&&s.options.renderer&&"canvas"==s.options.renderer&&r&&r.options.renderer&&"canvas"==r.options.renderer&&(1===l&&(this.groupCanvasLayerKeys[a].push(this.canvasLayerKeys[l-1]),s.options.isAnimateLayer?this.groupCanvasLayerKeys_types.push(1):this.groupCanvasLayerKeys_types.push(0)),r.options.isAnimateLayer!=s.options.isAnimateLayer&&(this.groupCanvasLayerKeys[++a]=[],r.options.isAnimateLayer?this.groupCanvasLayerKeys_types.push(1):this.groupCanvasLayerKeys_types.push(0)),this.groupCanvasLayerKeys[a].push(this.canvasLayerKeys[l]));for(var c=0;c<this.canvasLayerGroup.length;c++){var u=this.canvasLayerGroup[c];m.removeLayer(u),u.remove()}this.canvasLayerGroup=[];for(var y=0;y<this.groupCanvasLayerKeys_types.length;y++){var h=new f.CanvasLayerExt({padding:this.options.padding});h.addTo(m),this.canvasLayerGroup.push(h)}this.reDrawCanvas(!0)}},{key:"onMoveStart",value:function(e){m.isMapMoving=!0}},{key:"onMove",value:function(e){e.mouseState="".concat(m.mouseState),this.emit("onMapMove",e)}},{key:"onMoveEnd",value:function(e){this.zoom=m.getZoom(),m.isMapMoving=!1,e.mouseState="".concat(m.mouseState),this.emit("onMapMoveEnd",e),this.onRender()}},{key:"onZoomEnd",value:function(e){var o,t,n,i;this.zoom=m.getZoom(),m._mapPane.querySelector(".leaflet-popup")&&(o=m._popup)&&(t=o.minZoom||0,n=o.maxZoom||22,(this.zoom<t||this.zoom>n)&&o._close());for(var a=this.layerKeys.length-1;0<=a;a--)(i=this.subcoms[this.layerKeys[a]])&&i.onZoomEnd&&i.onZoomEnd(this.zoom)}},{key:"updateOptions",value:function(e){m.mouseState="updateOptions";var o=Object.assign({},this.options),e=(this.options=h(this.options,e||{}),this.options),t=(e.padding,e.general),n=e.coordinate,i=e.interaction,e=e.popupStyle,e=(m.popupStyle=e,t.background),a=t.zoom,s=t.center,t=t.scaleControl,r=n.coordinateSystem,l=n.normal,n=n.custom;if(r!=o.coordinate.coordinateSystem||l!=o.coordinate.normal||n.epsg!=o.coordinate.custom.epsg||n.proj!=o.coordinate.custom.proj||n.originX!=o.coordinate.custom.originX||n.originY!=o.coordinate.custom.originY||n.resolutions!=o.coordinate.custom.resolutions){if("normal"===r)switch(l){case"EPSG3857":case"EPSG3395":case"EPSG4326":case"BD09":m.options.crs=f.CRS[l],m.options.crsCode=l;break;default:m.options.crs=f.CRS.EPSG3857,m.options.crsCode="EPSG3857"}else v(n.epsg)||v(n.proj)||v(n.originX)||v(n.originY)||v(n.resolutions)?(m.options.crs=f.CRS.EPSG3857,m.options.crsCode="EPSG3857"):(r=(r=n.resolutions.split(",")).map(function(e){return+e}),f.CRS.EPSG_Custom=new f.Proj.CRS(n.epsg,n.proj,{origin:[+n.originX,+n.originY],resolutions:r}),m.options.crs=f.CRS.EPSG_Custom,m.options.crsCode="EPSG_Custom");m.setView(s),m._resetView(m.getCenter(),m.getZoom())}e!=o.general.background&&(this.container.style.background=e);n=i.interaction,r=n.dragging,e=n.scrollWheelZoom;n.steplessZooming;a.zoomRange[0]==o.general.zoom.zoomRange[0]&&a.zoomRange[1]==o.general.zoom.zoomRange[1]&&a.defaultZoom==o.general.zoom.defaultZoom&&s.lng==o.general.center.lng&&s.lat==o.general.center.lat||(m.setMinZoom(a.zoomRange[0]),m.setMaxZoom(a.zoomRange[1]),m.setView(s,a.defaultZoom)),t!=o.general.scaleControl&&this.updateScaleControl(t),r?m.dragging.enable():m.dragging.disable(),r?m.keyboard.enable():m.keyboard.disable(),e?(m.scrollWheelZoom.enable(),m.touchZoom.enable()):(m.scrollWheelZoom.disable(),m.touchZoom.disable()),this.container.style.pointerEvents=i.interaction.show?"auto":"none"}},{key:"addScaleControl",value:function(){this.scaleControl&&this.removeScaleControl();var e=this.scaleControl=f.control.scale({imperial:!1,maxWidth:150}),e=(e.addTo(m),e.getContainer().querySelector(".leaflet-control-scale-line")),o=this.options.mapOptions;e.style.marginBottom="".concat(+(5+o.scaleControl.offsetY),"px"),e.style.marginLeft="".concat(+(5+o.scaleControl.offsetX),"px")}},{key:"updateScaleControl",value:function(e){var o;e.show?(this.addScaleControl(),(o=this.scaleControl.getContainer().querySelector(".leaflet-control-scale-line")).style.background="rgba(0,0,0,0)",o.style.color=e.fontColor,o.style.borderColor=e.borderColor,o.style.marginBottom="".concat(e.offsetY,"px"),o.style.marginLeft="".concat(e.offsetX,"px")):this.removeScaleControl()}},{key:"removeScaleControl",value:function(){this.scaleControl&&this.scaleControl.remove(),this.scaleControl=null}},{key:"resize",value:function(e,o){this.container.style.width="".concat(+e,"px"),this.container.style.height="".concat(+o,"px"),m.invalidateSize(!0);for(var t,e=this.options.padding,o=m.getSize(),e=o.multiplyBy(-e).round(),n=(m.options.offset=e,o.x-2*e.x),i=o.y-2*e.y,a=this.layerKeys.length-1;0<=a;a--)(t=this.subcoms[this.layerKeys[a]]).resize&&t.resize(n,i)}},{key:"setView",value:function(e){m.mouseState="setView";var o=[],t=(isNaN(e.zoom)?this:e).zoom,o=isNaN(e.lng)||isNaN(e.lat)?m.getCenter():[e.lat,e.lng];m.setView(o,t)}},{key:"setZoom",value:function(e){m.mouseState="setZoom";e=e.zoom;"number"!=typeof e||isNaN(e)||m.setZoom(e)}},{key:"setZoomRange",value:function(e){e=e.range;m.setMinZoom(e[0]),m.setMaxZoom(e[1])}},{key:"setMaxBounds",value:function(e){e=e.bounds;e&&e[0]&&e[1]&&m.setMaxBounds(e)}},{key:"flyTo",value:function(e){for(var o=this,t=(m.mouseState="flyTo",[]),n=(isNaN(e.zoom)?this:e).zoom,t=isNaN(e.lng)||isNaN(e.lat)?m.getCenter():[+e.lat,+e.lng],i=0;i<this.groupCanvasLayerKeys_types.length;i++)this.canvasLayerGroup[i].container.style.display="none";e=e.duration||.25;m.flyTo(t,n,{duration:e,animate:!0}),this.fly_timer&&clearTimeout(this.fly_timer),this.fly_timer=setTimeout(function(){for(var e=0;e<o.groupCanvasLayerKeys_types.length;e++)o.canvasLayerGroup[e]&&o.canvasLayerGroup[e].container&&(o.canvasLayerGroup[e].container.style.display="block")},1e3*e)}},{key:"flyToBounds",value:function(e){for(var o=this,t=(m.mouseState="flyToBounds",e.bounds),n=0;n<this.groupCanvasLayerKeys_types.length;n++)this.canvasLayerGroup[n].container.style.display="none";var i=e.duration||.25;m.flyToBounds(t,{paddingTopLeft:e.paddingTopLeft||[0,0],paddingBottomRight:e.paddingBottomRight||[0,0],padding:e.padding||[0,0],duration:i,animate:!0,maxZoom:m.getMaxZoom()}),this.fly_timer&&clearTimeout(this.fly_timer),this.fly_timer=setTimeout(function(){for(var e=0;e<o.groupCanvasLayerKeys_types.length;e++)o.canvasLayerGroup[e]&&o.canvasLayerGroup[e].container&&(o.canvasLayerGroup[e].container.style.display="block")},1e3*i)}},{key:"show",value:function(){this.options.visibility=!0;var e=this.container.querySelector(".leaflet-proxy.leaflet-zoom-animated"),o=m.getCenter(),t=this.zoom,o=m.project(o,t),t=m.getZoomScale(t,1);f.DomUtil.setTransform(e,o,t)}},{key:"hide",value:function(){this.options.visibility=!1,this.fly_timer&&clearTimeout(this.fly_timer)}},{key:"get",value:function(e){return this.coms[e]}},{key:"add",value:function(e,o){this.subcoms[o]=e,this.layerKeys.push(o)}},{key:"remove",value:function(e,o){this.subcoms[o]=null,delete this.subcoms[o];o=this.layerKeys.indexOf(o);-1!==o&&(this.layerKeys.splice(o,1),this.updateLayerIndex(this.layerKeys))}},{key:"destroy",value:function(){this.loopId&&window.cancelAnimationFrame(this.loopId),this.fly_timer&&clearTimeout(this.fly_timer),m.off("mousemove",this.onMouseMove),m.off("click",this.onClick),m.off("dblclick",this.onDblclick),m.off("mouseout",this.onMouseOut),m.off("mousedown",this.onMouseDown),m.off("movestart",this.onMoveStart),m.off("move",this.onMove),m.off("moveend",this.onMoveEnd),m.off("zoomend",this.onZoomEnd),this.hoveredLayer=null;for(var e=0;e<this.canvasLayerGroup.length;e++)this.canvasLayerGroup[e]&&this.canvasLayerGroup[e].remove&&this.canvasLayerGroup[e].remove();m.remove(),this.container&&(this.container.innerHTML="",this.container._leaflet_id=null)}}])&&r(e.prototype,t),n&&r(e,n),Object.defineProperty(e,"prototype",{writable:!1}),a},e.exports});;
Cube("datav:/com/datav-2dmap/3.0.70",["datav:/npm/eventemitter3/3.0.0","datav:/npm/alibabacloud-datav-tool-gui-utils/1.0.1"],function(e,t,i,n,o,r){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(i){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(i),t=(e=n?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=i("datav:/npm/eventemitter3/3.0.0"),h=i("datav:/npm/alibabacloud-datav-tool-gui-utils/1.0.1"),f=i("datav:/com/datav-2dmap/3.0.70/src/Viewer"),p=i("datav:/com/datav-2dmap/3.0.70/src/utils"),i=function(){var e=a,t=l;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&c(e,t);var i,r=u(a);function a(e,t){var i;if(!(this instanceof a))throw new TypeError("Cannot call a class as a function");(i=r.call(this)).container=document.createElement("div");var n=p.$(e).actual("width"),o=p.$(e).actual("height"),n=(i.container.style.width="".concat(n,"px"),i.container.style.height="".concat(o,"px"),e.appendChild(i.container),i._container=e,t.options),o=(i.options=Object.assign({},n),f());return i.viewer=new o(i.container,n,h),i.initEvent(),i}return e=a,(t=[{key:"initEvent",value:function(){var n=this;this.viewer.on("onMapMove",function(e){var t,i;n.viewer&&n.viewer.map&&(t=n.viewer.map.getZoom(),i=n.viewer.map.getCenter(),e={type:e.mouseState||"",zoom:t,lng:+i.lng.toFixed(6),lat:+i.lat.toFixed(6)},n.emit("map-move",e))}),this.viewer.on("onMapMoveEnd",function(e){var t,i;n.viewer&&n.viewer.map&&(t=n.viewer.map.getZoom(),i=n.viewer.map.getCenter(),e={type:e.mouseState||"",zoom:t,lng:+i.lng.toFixed(6),lat:+i.lat.toFixed(6)},n.emit("map-moveend",e),n.mouseState="")})}},{key:"resize",value:function(e,t){this.viewer&&this.viewer.resize&&this.viewer.resize(e,t)}},{key:"get",value:function(e){return this.viewer.get(e)}},{key:"add",value:function(e,t){if(!e)return console.log("layer 没有定义");e.id=t,e.addTo&&e.addTo(this.viewer,t),this.viewer&&this.viewer.add&&this.viewer.add(e,t)}},{key:"remove",value:function(e,t){this.viewer&&this.viewer.remove&&this.viewer.remove(e,t)}},{key:"updateLayerIndex",value:function(e){this.viewer&&this.viewer.updateLayerIndex&&this.viewer.updateLayerIndex(e)}},{key:"updateOptions",value:function(e){e=e.options;this.viewer&&this.viewer.updateOptions&&this.viewer.updateOptions(e)}},{key:"show",value:function(){this.container&&(this.container.style.opacity=1,this.container.style.pointerEvents=this.options.interaction.interaction.show?"auto":"none"),this._container&&(this._container.style.opacity=1,this._container.style.pointerEvents=this.options.interaction.interaction.show?"auto":"none"),this.viewer&&this.viewer.show&&this.viewer.show()}},{key:"hide",value:function(){this.container&&(this.container.style.opacity=0,this.container.style.pointerEvents="none"),this._container&&(this._container.style.opacity=0,this._container.style.pointerEvents="none"),this.viewer&&this.viewer.show&&this.viewer.hide()}},{key:"render",value:function(e){e&&e[0]&&(e=e[0],this.setView(e))}},{key:"setView",value:function(e){e&&this.viewer&&this.viewer.setView&&this.viewer.setView(e)}},{key:"setZoom",value:function(e){e&&this.viewer&&this.viewer.setZoom&&this.viewer.setZoom(e)}},{key:"setZoomRange",value:function(e){e&&e.range&&this.viewer&&this.viewer.setZoomRange&&this.viewer.setZoomRange(e)}},{key:"setMaxBounds",value:function(e){e&&e.bounds&&this.viewer&&this.viewer.setMaxBounds&&this.viewer.setMaxBounds(e)}},{key:"flyTo",value:function(e){e&&this.viewer&&this.viewer.flyTo&&this.viewer.flyTo(e)}},{key:"flyToBounds",value:function(e){e&&e.bounds&&this.viewer&&this.viewer.flyToBounds&&this.viewer.flyToBounds(e)}},{key:"getCenterAndZoom",value:function(){var e={};return e=this.viewer&&this.viewer.map?{center:this.viewer.map.getCenter(),zoom:this.viewer.map.getZoom()}:e}},{key:"destroy",value:function(){this.viewer&&this.viewer.destroy&&this.viewer.destroy(),this.viewer=null,this.container&&(this.container.innerHTML="",this.container._leaflet_id=null),this.container.remove()}}])&&s(e.prototype,t),i&&s(e,i),Object.defineProperty(e,"prototype",{writable:!1}),a}();function y(e,t){var e=e.componentData,i=e.instance;e.config,t.quitCallback;return function(){var e=i.getCenterAndZoom(),t=e.zoom,e=e.center;return{config:{options:{general:{zoom:{defaultZoom:t},center:{lng:+e.lng,lat:+e.lat}}}}}}}return y.config={stretchSize:!1,enterIcon:"citylite-immersion",enterText:"进入设置",quitIcon:"save-exit",quitText:"保存并退出设置"},i.editOnImmerse=y,e.exports=i,e.exports});