// env=undefined => env=publish 
Cube("datav:/com/@echarts/echarts-sankey/0.0.23",["datav:/com/maliang-echarts-utils/2.1.1","datav:/npm/bcore/0.0.18/event","datav:/npm/jquery/2.1.4","datav:/npm/lodash/4.6.1","datav:/npm/echarts/4.4.0"],function(t,i,e,s,n,c){var r=e("datav:/npm/bcore/0.0.18/event"),a=e("datav:/npm/jquery/2.1.4"),o=e("datav:/npm/lodash/4.6.1"),h=e("datav:/npm/echarts/4.4.0"),d=e("datav:/com/maliang-echarts-utils/2.1.1");return t.exports=r.extend(function(t,i){this.config={tooltip:{trigger:"item"},_series:{nodeAlign:"justify"}},this.container=a(t),this.apis=i.apis,this._data=null,this.chart=null,this.init(i)},{init:function(t){var i=this;this.mergeConfig(t),this.chart=h.init(this.container[0],null,{renderer:t.renderer}),this.chart.off(),this.chart.on("click",function(t){if(!t||!t.data)return null;t.data.source&&t.data.target?i.emit("edge-click",t.data):i.emit("node-click",t.data),i.emit("click",t.data)})},switchRenderer:function(t){this.chart.dispose(),this.chart=h.init(this.container[0],null,{renderer:t}),this.render()},highlight:function(t){t=o.merge(t||{},{type:"highlight"}),this.chart.dispatchAction(t)},downplay:function(t){t=o.merge(t||{},{type:"downplay"}),this.chart.dispatchAction(t)},showTip:function(t){t=o.merge(t||{},{type:"showTip"}),this.chart.dispatchAction(t)},hideTip:function(){this.chart.dispatchAction({type:"hideTip"})},render:function(t,i){t=this.data(t),cfg=this.mergeConfig(i);i=d.data2echartsSankey(t,cfg),t=o.defaultsDeep(i,cfg),i=d.config2echartsOptions(t);i.series&&cfg._series&&cfg._series.focusNodeAdjacency&&i.series.forEach(function(t){t.focusNodeAdjacency=cfg._series.focusNodeAdjacency}),i.series&&cfg._series&&cfg._series.margin&&i.series.forEach(function(t){var i=t.margin,e=i.top,s=i.right,n=i.bottom,i=i.left;t.top=e,t.right=s,t.bottom=n,t.left=i}),this.chart.setOption(i,!0)},resize:function(t,i){this.chart.resize({width:t,height:i})},data:function(t){return t&&(this._data=t),this._data},mergeConfig:function(t){this.config=d.setGlobalColor(d.mergeConfig(this.config,t));t=this.config._series.lineStyle.color;return t&&t["color-type"]&&("user-defined"===t["color-type"]?this.config._series.lineStyle.color=t["defined-color"]:this.config._series.lineStyle.color=t["color-type"]),this.config._series.type="sankey",this.config.series=[this.config._series],this.config},clear:function(){this.chart&&this.chart.clear&&this.chart.clear()},destroy:function(){this.chart&&this.chart.dispose&&this.chart.dispose()}}),t.exports});