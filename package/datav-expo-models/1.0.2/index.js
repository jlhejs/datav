// env=undefined => env=publish 
Cube("datav:/com/datav-expo-models/1.0.2/libs/dependencies/inflate.min",[],function(a){return function(){"use strict";function a(g,c){var d=g.split("."),a=f;!(d[0]in a)&&a.execScript&&a.execScript("var "+d[0]);for(var b;d.length&&(b=d.shift());)d.length||c===o?a=a[b]?a[b]:a[b]={}:a[b]=c}function i(i){var c,e,f,g,h,j,k,m,n,o,p=i.length,d=0,a=Number.POSITIVE_INFINITY;for(m=0;m<p;++m)i[m]>d&&(d=i[m]),i[m]<a&&(a=i[m]);for(c=1<<d,e=new(l?Uint32Array:Array)(c),f=1,g=0,h=2;f<=d;){for(m=0;m<p;++m)if(i[m]===f){for(j=0,k=g,n=0;n<f;++n)j=j<<1|1&k,k>>=1;for(o=f<<16|m,n=j;n<c;n+=h)e[n]=o;++g}++f,g<<=1,h<<=1}return[e,d,a]}function e(a,b){switch(this.g=[],this.h=32768,this.d=this.f=this.a=this.l=0,this.input=l?new Uint8Array(a):a,this.m=!1,this.i=n,this.r=!1,(b||!(b={}))&&(b.index&&(this.a=b.index),b.bufferSize&&(this.h=b.bufferSize),b.bufferType&&(this.i=b.bufferType),b.resize&&(this.r=b.resize)),this.i){case h:this.b=32768,this.c=new(l?Uint8Array:Array)(32768+this.h+258);break;case n:this.b=0,this.c=new(l?Uint8Array:Array)(this.h),this.e=this.z,this.n=this.v,this.j=this.w;break;default:throw Error("invalid inflate mode");}}function j(i,c){for(var d,h=i.f,a=i.d,b=i.input,e=i.a,f=b.length;a<c;){if(e>=f)throw Error("input buffer is broken");h|=b[e++]<<a,a+=8}return d=h&(1<<c)-1,i.f=h>>>c,i.d=a-c,i.a=e,d}function m(i,c){for(var d,j,l=i.f,a=i.d,b=i.input,e=i.a,f=b.length,g=c[0],h=c[1];a<h&&!(e>=f);)l|=b[e++]<<a,a+=8;if(d=g[l&(1<<h)-1],j=d>>>16,j>a)throw Error("invalid code length: "+j);return i.f=l>>j,i.d=a-j,i.a=e,65535&d}function b(f,c){var d,a;switch(this.input=f,this.a=0,(c||!(c={}))&&(c.index&&(this.a=c.index),c.verify&&(this.A=c.verify)),d=f[this.a++],a=f[this.a++],15&d){case H:this.method=H;break;default:throw Error("unsupported compression method");}if(0!==((d<<8)+a)%31)throw Error("invalid fcheck flag:"+((d<<8)+a)%31);if(32&a)throw Error("fdict flag is not supported");this.q=new e(f,{index:this.a,bufferSize:c.bufferSize,bufferType:c.bufferType,resize:c.resize})}var o,f=this,l="undefined"!==typeof Uint8Array&&"undefined"!==typeof Uint16Array&&"undefined"!==typeof Uint32Array&&"undefined"!==typeof DataView,h=0,n=1,c={t:h,s:n};e.prototype.k=function(){for(;!this.m;){var r=j(this,3);switch(1&r&&(this.m=!0),r>>>=1,r){case 0:var c=this.input,d=this.a,a=this.c,b=this.b,e=c.length,f=o,g=o,v=a.length,k=o;if(this.d=this.f=0,d+1>=e)throw Error("invalid uncompressed block header: LEN");if(f=c[d++]|c[d++]<<8,d+1>=e)throw Error("invalid uncompressed block header: NLEN");if(g=c[d++]|c[d++]<<8,f===~g)throw Error("invalid uncompressed block header: length verify");if(d+f>c.length)throw Error("input buffer is broken");switch(this.i){case h:for(;b+f>a.length;){if(k=v-b,f-=k,l)a.set(c.subarray(d,d+k),b),b+=k,d+=k;else for(;k--;)a[b++]=c[d++];this.b=b,a=this.e(),b=this.b}break;case n:for(;b+f>a.length;)a=this.e({p:2});break;default:throw Error("invalid inflate mode");}if(l)a.set(c.subarray(d,d+f),b),b+=f,d+=f;else for(;f--;)a[b++]=c[d++];this.a=d,this.b=b,this.c=a;break;case 1:this.j(E,G);break;case 2:for(var w=j(this,5)+257,y=j(this,5)+1,A=j(this,4)+4,s=new(l?Uint8Array:Array)(p.length),x=o,B=o,C=o,D=o,u=o,H=o,F=o,z=o,q=o,z=0;z<A;++z)s[p[z]]=j(this,3);if(!l)for(z=A,A=s.length;z<A;++z)s[p[z]]=0;for(x=i(s),D=new(l?Uint8Array:Array)(w+y),z=0,q=w+y;z<q;)switch(u=m(this,x),u){case 16:for(F=3+j(this,2);F--;)D[z++]=H;break;case 17:for(F=3+j(this,3);F--;)D[z++]=0;H=0;break;case 18:for(F=11+j(this,7);F--;)D[z++]=0;H=0;break;default:H=D[z++]=u;}B=l?i(D.subarray(0,w)):i(D.slice(0,w)),C=l?i(D.subarray(w)):i(D.slice(w)),this.j(B,C);break;default:throw Error("unknown BTYPE: "+r);}}return this.n()};var d,g,k=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],p=l?new Uint16Array(k):k,q=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258,258,258],r=l?new Uint16Array(q):q,s=[0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0],u=l?new Uint8Array(s):s,v=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577],w=l?new Uint16Array(v):v,x=[0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13],z=l?new Uint8Array(x):x,B=new(l?Uint8Array:Array)(288);for(d=0,g=B.length;d<g;++d)B[d]=143>=d?8:255>=d?9:279>=d?7:8;var C,D,E=i(B),F=new(l?Uint8Array:Array)(30);for(C=0,D=F.length;C<D;++C)F[C]=5;var G=i(F);e.prototype.j=function(i,c){var d=this.c,a=this.b;this.o=i;for(var b,f,g,h,k=d.length-258;256!==(b=m(this,i));)if(256>b)a>=k&&(this.b=a,d=this.e(),a=this.b),d[a++]=b;else for(f=b-257,h=r[f],0<u[f]&&(h+=j(this,u[f])),b=m(this,c),g=w[b],0<z[b]&&(g+=j(this,z[b])),a>=k&&(this.b=a,d=this.e(),a=this.b);h--;)d[a]=d[a++-g];for(;8<=this.d;)this.d-=8,this.a--;this.b=a},e.prototype.w=function(i,c){var d=this.c,a=this.b;this.o=i;for(var b,f,g,h,k=d.length;256!==(b=m(this,i));)if(256>b)a>=k&&(d=this.e(),k=d.length),d[a++]=b;else for(f=b-257,h=r[f],0<u[f]&&(h+=j(this,u[f])),b=m(this,c),g=w[b],0<z[b]&&(g+=j(this,z[b])),a+h>k&&(d=this.e(),k=d.length);h--;)d[a]=d[a++-g];for(;8<=this.d;)this.d-=8,this.a--;this.b=a},e.prototype.e=function(){var f,a,b=new(l?Uint8Array:Array)(this.b-32768),c=this.b-32768,d=this.c;if(l)b.set(d.subarray(32768,b.length));else for(f=0,a=b.length;f<a;++f)b[f]=d[f+32768];if(this.g.push(b),this.l+=b.length,l)d.set(d.subarray(c,c+32768));else for(f=0;32768>f;++f)d[f]=d[c+f];return this.b=32768,d},e.prototype.z=function(i){var c,d,b,e,f=0|this.input.length/this.a+1,a=this.input,g=this.c;return i&&("number"===typeof i.p&&(f=i.p),"number"===typeof i.u&&(f+=i.u)),2>f?(d=(a.length-this.a)/this.o[2],e=0|258*(d/2),b=e<g.length?g.length+e:g.length<<1):b=g.length*f,l?(c=new Uint8Array(b),c.set(g)):c=g,this.c=c},e.prototype.n=function(){var i,b,f,g,h,j=0,c=this.c,d=this.g,a=new(l?Uint8Array:Array)(this.l+(this.b-32768));if(0===d.length)return l?this.c.subarray(32768,this.b):this.c.slice(32768,this.b);for(b=0,f=d.length;b<f;++b)for(i=d[b],g=0,h=i.length;g<h;++g)a[j++]=i[g];for(b=32768,f=this.b;b<f;++b)a[j++]=c[b];return this.g=[],this.buffer=a},e.prototype.v=function(){var a,b=this.b;return l?this.r?(a=new Uint8Array(b),a.set(this.c.subarray(0,b))):a=this.c.subarray(0,b):(this.c.length>b&&(this.c.length=b),a=this.c),this.buffer=a},b.prototype.k=function(){var i,d,a=this.input;if(i=this.q.k(),this.a=this.q.a,this.A){d=(a[this.a++]<<24|a[this.a++]<<16|a[this.a++]<<8|a[this.a++])>>>0;var c=i;if("string"===typeof c){var j,f,g=c.split("");for(j=0,f=g.length;j<f;j++)g[j]=(255&g[j].charCodeAt(0))>>>0;c=g}for(var e,l=1,h=0,k=c.length,m=0;0<k;){e=1024<k?1024:k,k-=e;do l+=c[m++],h+=l;while(--e);l%=65521,h%=65521}if(d!==(h<<16|l)>>>0)throw Error("invalid adler-32 checksum")}return i};var H=8;a("Zlib.Inflate",b),a("Zlib.Inflate.prototype.decompress",b.prototype.k);var I,J,K,L,M={ADAPTIVE:c.s,BLOCK:c.t};if(Object.keys)I=Object.keys(M);else for(J in I=[],K=0,M)I[K++]=J;for(K=0,L=I.length;K<L;++K)J=I[K],a("Zlib.Inflate.BufferType."+J,M[J])}.call(this),a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2/libs/GLTFLoader",[],function(a){return a.exports=function(a){function b(){var a={};return{get:function(b){return a[b]},add:function(b,c){a[b]=c},remove:function(b){delete a[b]},removeAll:function(){a={}}}}function c(){if(!a.DDSLoader)throw new Error("THREE.GLTFLoader: Attempting to load .dds texture without importing THREE.DDSLoader");this.name=y.MSFT_TEXTURE_DDS,this.ddsLoader=new a.DDSLoader}function d(b){this.name=y.KHR_LIGHTS,this.lights={};var c=b.extensions&&b.extensions[y.KHR_LIGHTS]||{},d=c.lights||{};for(var e in d){var f,g=d[e],h=new a.Color().fromArray(g.color);switch(g.type){case"directional":f=new a.DirectionalLight(h),f.target.position.set(0,0,1),f.add(f.target);break;case"point":f=new a.PointLight(h);break;case"spot":f=new a.SpotLight(h),g.spot=g.spot||{},g.spot.innerConeAngle=void 0===g.spot.innerConeAngle?0:g.spot.innerConeAngle,g.spot.outerConeAngle=void 0===g.spot.outerConeAngle?Math.PI/4:g.spot.outerConeAngle,f.angle=g.spot.outerConeAngle,f.penumbra=1-g.spot.innerConeAngle/g.spot.outerConeAngle,f.target.position.set(0,0,1),f.add(f.target);break;case"ambient":f=new a.AmbientLight(h);}f&&(f.decay=2,void 0!==g.intensity&&(f.intensity=g.intensity),f.name=g.name||"light_"+e,this.lights[e]=f)}}function e(){this.name=y.KHR_MATERIALS_UNLIT}function f(b){this.name=y.KHR_BINARY_GLTF,this.content=null,this.body=null;var c=new DataView(b,0,A);if(this.header={magic:a.LoaderUtils.decodeText(new Uint8Array(b.slice(0,4))),version:c.getUint32(4,!0),length:c.getUint32(8,!0)},this.header.magic!==z)throw new Error("THREE.GLTFLoader: Unsupported glTF-Binary header.");else if(2>this.header.version)throw new Error("THREE.GLTFLoader: Legacy binary file detected. Use LegacyGLTFLoader instead.");for(var d,e=new DataView(b,A),f=0;f<e.byteLength;){d=e.getUint32(f,!0),f+=4;var g=e.getUint32(f,!0);if(f+=4,g===B.JSON){var h=new Uint8Array(b,A+f,d);this.content=a.LoaderUtils.decodeText(h)}else if(g===B.BIN){var i=A+f;this.body=b.slice(i,i+d)}f+=d}if(null===this.content)throw new Error("THREE.GLTFLoader: JSON content not found.")}function g(a,b){if(!b)throw new Error("THREE.GLTFLoader: No DRACOLoader instance provided.");this.name=y.KHR_DRACO_MESH_COMPRESSION,this.json=a,this.dracoLoader=b}function h(){return{name:y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS,specularGlossinessParams:["color","map","lightMap","lightMapIntensity","aoMap","aoMapIntensity","emissive","emissiveIntensity","emissiveMap","bumpMap","bumpScale","normalMap","displacementMap","displacementScale","displacementBias","specularMap","specular","glossinessMap","glossiness","alphaMap","envMap","envMapIntensity","refractionRatio"],getMaterialType:function(){return a.ShaderMaterial},extendParams:function(b,c,d){var e=c.extensions[this.name],f=a.ShaderLib.standard,g=a.UniformsUtils.clone(f.uniforms),h=f.fragmentShader.replace("uniform float roughness;","uniform vec3 specular;").replace("uniform float metalness;","uniform float glossiness;").replace("#include <roughnessmap_pars_fragment>","#ifdef USE_SPECULARMAP\n\tuniform sampler2D specularMap;\n#endif").replace("#include <metalnessmap_pars_fragment>","#ifdef USE_GLOSSINESSMAP\n\tuniform sampler2D glossinessMap;\n#endif").replace("#include <roughnessmap_fragment>","vec3 specularFactor = specular;\n#ifdef USE_SPECULARMAP\n\tvec4 texelSpecular = texture2D( specularMap, vUv );\n\ttexelSpecular = sRGBToLinear( texelSpecular );\n\t// reads channel RGB, compatible with a glTF Specular-Glossiness (RGBA) texture\n\tspecularFactor *= texelSpecular.rgb;\n#endif").replace("#include <metalnessmap_fragment>","float glossinessFactor = glossiness;\n#ifdef USE_GLOSSINESSMAP\n\tvec4 texelGlossiness = texture2D( glossinessMap, vUv );\n\t// reads channel A, compatible with a glTF Specular-Glossiness (RGBA) texture\n\tglossinessFactor *= texelGlossiness.a;\n#endif").replace("#include <lights_physical_fragment>","PhysicalMaterial material;\nmaterial.diffuseColor = diffuseColor.rgb;\nmaterial.specularRoughness = clamp( 1.0 - glossinessFactor, 0.04, 1.0 );\nmaterial.specularColor = specularFactor.rgb;");delete g.roughness,delete g.metalness,delete g.roughnessMap,delete g.metalnessMap,g.specular={value:new a.Color().setHex(1118481)},g.glossiness={value:0.5},g.specularMap={value:null},g.glossinessMap={value:null},b.vertexShader=f.vertexShader,b.fragmentShader=h,b.uniforms=g,b.defines={STANDARD:""},b.color=new a.Color(1,1,1),b.opacity=1;var i=[];if(Array.isArray(e.diffuseFactor)){var j=e.diffuseFactor;b.color.fromArray(j),b.opacity=j[3]}if(void 0!==e.diffuseTexture&&i.push(d.assignTexture(b,"map",e.diffuseTexture.index)),b.emissive=new a.Color(0,0,0),b.glossiness=void 0===e.glossinessFactor?1:e.glossinessFactor,b.specular=new a.Color(1,1,1),Array.isArray(e.specularFactor)&&b.specular.fromArray(e.specularFactor),void 0!==e.specularGlossinessTexture){var k=e.specularGlossinessTexture.index;i.push(d.assignTexture(b,"glossinessMap",k)),i.push(d.assignTexture(b,"specularMap",k))}return Promise.all(i)},createMaterial:function(b){var c=new a.ShaderMaterial({defines:b.defines,vertexShader:b.vertexShader,fragmentShader:b.fragmentShader,uniforms:b.uniforms,fog:!0,lights:!0,opacity:b.opacity,transparent:b.transparent});return c.isGLTFSpecularGlossinessMaterial=!0,c.color=b.color,c.map=void 0===b.map?null:b.map,c.lightMap=null,c.lightMapIntensity=1,c.aoMap=void 0===b.aoMap?null:b.aoMap,c.aoMapIntensity=1,c.emissive=b.emissive,c.emissiveIntensity=1,c.emissiveMap=void 0===b.emissiveMap?null:b.emissiveMap,c.bumpMap=void 0===b.bumpMap?null:b.bumpMap,c.bumpScale=1,c.normalMap=void 0===b.normalMap?null:b.normalMap,b.normalScale&&(c.normalScale=b.normalScale),c.displacementMap=null,c.displacementScale=1,c.displacementBias=0,c.specularMap=void 0===b.specularMap?null:b.specularMap,c.specular=b.specular,c.glossinessMap=void 0===b.glossinessMap?null:b.glossinessMap,c.glossiness=b.glossiness,c.alphaMap=null,c.envMap=void 0===b.envMap?null:b.envMap,c.envMapIntensity=1,c.refractionRatio=0.98,c.extensions.derivatives=!0,c},cloneMaterial:function(a){var b=a.clone();b.isGLTFSpecularGlossinessMaterial=!0;for(var c=this.specularGlossinessParams,d=0,e=c.length;d<e;d++)b[c[d]]=a[c[d]];return b},refreshUniforms:function(a,b,c,d,e){if(!0===e.isGLTFSpecularGlossinessMaterial){var f=e.uniforms,g=e.defines;f.opacity.value=e.opacity,f.diffuse.value.copy(e.color),f.emissive.value.copy(e.emissive).multiplyScalar(e.emissiveIntensity),f.map.value=e.map,f.specularMap.value=e.specularMap,f.alphaMap.value=e.alphaMap,f.lightMap.value=e.lightMap,f.lightMapIntensity.value=e.lightMapIntensity,f.aoMap.value=e.aoMap,f.aoMapIntensity.value=e.aoMapIntensity;var h;if(e.map?h=e.map:e.specularMap?h=e.specularMap:e.displacementMap?h=e.displacementMap:e.normalMap?h=e.normalMap:e.bumpMap?h=e.bumpMap:e.glossinessMap?h=e.glossinessMap:e.alphaMap?h=e.alphaMap:e.emissiveMap&&(h=e.emissiveMap),void 0!==h){h.isWebGLRenderTarget&&(h=h.texture);var i,j;if(void 0!==h.matrix){if(!0===h.matrixAutoUpdate){i=h.offset,j=h.repeat;var k=h.rotation,l=h.center;h.matrix.setUvTransform(i.x,i.y,j.x,j.y,k,l.x,l.y)}f.uvTransform.value.copy(h.matrix)}else i=h.offset,j=h.repeat,f.offsetRepeat.value.set(i.x,i.y,j.x,j.y)}f.envMap.value=e.envMap,f.envMapIntensity.value=e.envMapIntensity,f.flipEnvMap.value=e.envMap&&e.envMap.isCubeTexture?-1:1,f.refractionRatio.value=e.refractionRatio,f.specular.value.copy(e.specular),f.glossiness.value=e.glossiness,f.glossinessMap.value=e.glossinessMap,f.emissiveMap.value=e.emissiveMap,f.bumpMap.value=e.bumpMap,f.normalMap.value=e.normalMap,f.displacementMap.value=e.displacementMap,f.displacementScale.value=e.displacementScale,f.displacementBias.value=e.displacementBias,null!==f.glossinessMap.value&&void 0===g.USE_GLOSSINESSMAP&&(g.USE_GLOSSINESSMAP="",g.USE_ROUGHNESSMAP=""),null===f.glossinessMap.value&&void 0!==g.USE_GLOSSINESSMAP&&(delete g.USE_GLOSSINESSMAP,delete g.USE_ROUGHNESSMAP)}}}}function i(b,c,d,e){a.Interpolant.call(this,b,c,d,e)}function j(a,b){return"string"!==typeof a||""===a?"":/^(https?:)?\/\//i.test(a)?a:/^data:.*,.*$/i.test(a)?a:/^blob:.*$/i.test(a)?a:b+a}function k(){return new a.MeshStandardMaterial({color:16777215,emissive:0,metalness:1,roughness:1,transparent:!1,depthTest:!0,side:a.FrontSide})}function l(a,b,c){for(var d in c.extensions)void 0===a[d]&&(b.userData.gltfExtensions=b.userData.gltfExtensions||{},b.userData.gltfExtensions[d]=c.extensions[d])}function m(a,b,c){for(var d,e=!1,f=!1,g=0,h=b.length;g<h&&(d=b[g],void 0!==d.POSITION&&(e=!0),void 0!==d.NORMAL&&(f=!0),!(e&&f));g++);if(e||f){for(var i=[],k=[],g=0,h=b.length;g<h;g++){var d=b[g],l="morphTarget"+g;if(e){if(void 0!==d.POSITION){var m=u(c[d.POSITION]);m.name=l;for(var n=a.attributes.position,o=0,j=m.count;o<j;o++)m.setXYZ(o,m.getX(o)+n.getX(o),m.getY(o)+n.getY(o),m.getZ(o)+n.getZ(o))}else m=a.attributes.position;i.push(m)}if(f){var p;if(void 0!==d.NORMAL){var p=u(c[d.NORMAL]);p.name=l;for(var q=a.attributes.normal,o=0,j=p.count;o<j;o++)p.setXYZ(o,p.getX(o)+q.getX(o),p.getY(o)+q.getY(o),p.getZ(o)+q.getZ(o))}else p=a.attributes.normal;k.push(p)}}e&&(a.morphAttributes.position=i),f&&(a.morphAttributes.normal=k)}}function n(a,b){if(a.updateMorphTargets(),void 0!==b.weights)for(var c=0,d=b.weights.length;c<d;c++)a.morphTargetInfluences[c]=b.weights[c];if(b.extras&&Array.isArray(b.extras.targetNames)){var e=b.extras.targetNames;if(a.morphTargetInfluences.length===e.length){a.morphTargetDictionary={};for(var c=0,d=e.length;c<d;c++)a.morphTargetDictionary[e[c]]=c}else console.warn("THREE.GLTFLoader: Invalid extras.targetNames length. Ignoring names.")}}function o(c,a){return c.indices===a.indices&&p(c.attributes,a.attributes)}function p(c,a){if(Object.keys(c).length!==Object.keys(a).length)return!1;for(var b in c)if(c[b]!==a[b])return!1;return!0}function q(c,a){if(c.length!==a.length)return!1;for(var b=0,d=c.length;b<d;b++)if(c[b]!==a[b])return!1;return!0}function r(a,b){for(var c,d=0,e=a.length;d<e;d++)if(c=a[d],o(c.primitive,b))return c.promise;return null}function s(a,b){for(var c,d=0,e=a.length;d<e;d++)if(c=a[d],q(b,c.baseGeometries))return c.geometry;return null}function t(a,b,c){for(var d,e=0,f=a.length;e<f;e++)if(d=a[e],b===d.baseGeometry&&q(c,d.primitives))return d.geometry;return null}function u(b){if(b.isInterleavedBufferAttribute){for(var c=b.count,d=b.itemSize,e=b.array.slice(0,c*d),f=0;f<c;++f)e[f]=b.getX(f),2<=d&&(e[f+1]=b.getY(f)),3<=d&&(e[f+2]=b.getZ(f)),4<=d&&(e[f+3]=b.getW(f));return new a.BufferAttribute(e,d,b.normalized)}return b.clone()}function v(a){if(2>a.length)return!1;var b=a[0],c=b.targets||[];if(void 0===b.indices)return!1;for(var d,e=1,f=a.length;e<f;e++){if(d=a[e],b.mode!==d.mode)return!1;if(void 0===d.indices)return!1;if(!p(b.attributes,d.attributes))return!1;var g=d.targets||[];if(c.length!==g.length)return!1;for(var h=0,i=c.length;h<i;h++)if(!p(c[h],g[h]))return!1}return!0}function w(c,d,e){this.json=c||{},this.extensions=d||{},this.options=e||{},this.cache=new b,this.primitiveCache=[],this.multiplePrimitivesCache=[],this.multiPassGeometryCache=[],this.textureLoader=new a.TextureLoader(this.options.manager),this.textureLoader.setCrossOrigin(this.options.crossOrigin),this.fileLoader=new a.FileLoader(this.options.manager),this.fileLoader.setResponseType("arraybuffer")}function x(a,b,c){var d=b.attributes;for(var e in d){var f=O[e],g=c[d[e]];f&&!(f in a.attributes)&&a.addAttribute(f,g)}void 0===b.indices||a.index||a.setIndex(c[b.indices]),void 0!==b.targets&&m(a,b.targets,c),void 0!==b.extras&&(a.userData=b.extras)}a.GLTFLoader=function(b){this.manager=void 0===b?a.DefaultLoadingManager:b,this.dracoLoader=null},a.GLTFLoader.prototype={constructor:a.GLTFLoader,crossOrigin:"Anonymous",load:function(b,c,d,f){var e=this,g=void 0===this.path?a.LoaderUtils.extractUrlBase(b):this.path,h=new a.FileLoader(e.manager);h.setResponseType("arraybuffer"),h.load(b,function(a){try{e.parse(a,g,c,f)}catch(a){if(void 0!==f)f(a);else throw a}},d,f)},setCrossOrigin:function(a){return this.crossOrigin=a,this},setPath:function(a){return this.path=a,this},setDRACOLoader:function(a){return this.dracoLoader=a,this},parse:function(b,j,k,m){var n,o={};if("string"===typeof b)n=b;else{var p=a.LoaderUtils.decodeText(new Uint8Array(b,0,4));if(p===z){try{o[y.KHR_BINARY_GLTF]=new f(b)}catch(a){return void(m&&m(a))}n=o[y.KHR_BINARY_GLTF].content}else n=a.LoaderUtils.decodeText(new Uint8Array(b))}var q=JSON.parse(n);if(void 0===q.asset||2>q.asset.version[0])return void(m&&m(new Error("THREE.GLTFLoader: Unsupported asset. glTF versions >=2.0 are supported. Use LegacyGLTFLoader instead.")));if(q.extensionsUsed)for(var r=0;r<q.extensionsUsed.length;++r){var i=q.extensionsUsed[r],s=q.extensionsRequired||[];i===y.KHR_LIGHTS?o[i]=new d(q):i===y.KHR_MATERIALS_UNLIT?o[i]=new e(q):i===y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS?o[i]=new h:i===y.KHR_DRACO_MESH_COMPRESSION?o[i]=new g(q,this.dracoLoader):i===y.MSFT_TEXTURE_DDS?o[y.MSFT_TEXTURE_DDS]=new c:0<=s.indexOf(i)&&console.warn("THREE.GLTFLoader: Unknown extension \""+i+"\".")}var t=new w(q,o,{path:j||this.path||"",crossOrigin:this.crossOrigin,manager:this.manager});t.parse(function(a,b,c,d,e){var f={scene:a,scenes:b,cameras:c,animations:d,asset:e.asset,parser:t,userData:{}};l(o,f,e),k(f)},m)}};var y={KHR_BINARY_GLTF:"KHR_binary_glTF",KHR_DRACO_MESH_COMPRESSION:"KHR_draco_mesh_compression",KHR_LIGHTS:"KHR_lights",KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS:"KHR_materials_pbrSpecularGlossiness",KHR_MATERIALS_UNLIT:"KHR_materials_unlit",MSFT_TEXTURE_DDS:"MSFT_texture_dds"};e.prototype.getMaterialType=function(){return a.MeshBasicMaterial},e.prototype.extendParams=function(b,c,d){var e=[];b.color=new a.Color(1,1,1),b.opacity=1;var f=c.pbrMetallicRoughness;if(f){if(Array.isArray(f.baseColorFactor)){var g=f.baseColorFactor;b.color.fromArray(g),b.opacity=g[3]}void 0!==f.baseColorTexture&&e.push(d.assignTexture(b,"map",f.baseColorTexture.index))}return Promise.all(e)};var z="glTF",A=12,B={JSON:1313821514,BIN:5130562};g.prototype.decodePrimitive=function(a,b){var c=this.json,d=this.dracoLoader,e=a.extensions[this.name].bufferView,f=a.extensions[this.name].attributes,g={},h={},i={};for(var j in f)j in O&&(g[O[j]]=f[j]);for(j in a.attributes)if(void 0!==O[j]&&void 0!==f[j]){var k=c.accessors[a.attributes[j]],l=E[k.componentType];i[O[j]]=l,h[O[j]]=!0===k.normalized}return b.getDependency("bufferView",e).then(function(a){return new Promise(function(b){d.decodeDracoFile(a,function(a){for(var c in a.attributes){var d=a.attributes[c],e=h[c];void 0!==e&&(d.normalized=e)}b(a)},g,i)})})},i.prototype=Object.create(a.Interpolant.prototype),i.prototype.constructor=i,i.prototype.interpolate_=function(a,b,c,d){for(var e=this.resultBuffer,f=this.sampleValues,g=this.valueSize,h=3*g,j=d-b,k=(c-b)/j,l=k*k,m=l*k,n=a*h,o=n-h,p=0;p!==g;p++){var i=f[o+p+g],q=f[o+p+2*g]*j,r=f[n+p+g],s=f[n+p]*j;e[p]=(2*m-3*l+1)*i+(m-2*l+k)*q+(-2*m+3*l)*r+(m-l)*s}return e};var C={FLOAT:5126,FLOAT_MAT3:35675,FLOAT_MAT4:35676,FLOAT_VEC2:35664,FLOAT_VEC3:35665,FLOAT_VEC4:35666,LINEAR:9729,REPEAT:10497,SAMPLER_2D:35678,POINTS:0,LINES:1,LINE_LOOP:2,LINE_STRIP:3,TRIANGLES:4,TRIANGLE_STRIP:5,TRIANGLE_FAN:6,UNSIGNED_BYTE:5121,UNSIGNED_SHORT:5123},D={5126:Number,35675:a.Matrix3,35676:a.Matrix4,35664:a.Vector2,35665:a.Vector3,35666:a.Vector4,35678:a.Texture},E={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},F={9728:a.NearestFilter,9729:a.LinearFilter,9984:a.NearestMipMapNearestFilter,9985:a.LinearMipMapNearestFilter,9986:a.NearestMipMapLinearFilter,9987:a.LinearMipMapLinearFilter},G={33071:a.ClampToEdgeWrapping,33648:a.MirroredRepeatWrapping,10497:a.RepeatWrapping},H={6406:a.AlphaFormat,6407:a.RGBFormat,6408:a.RGBAFormat,6409:a.LuminanceFormat,6410:a.LuminanceAlphaFormat},I={5121:a.UnsignedByteType,32819:a.UnsignedShort4444Type,32820:a.UnsignedShort5551Type,33635:a.UnsignedShort565Type},J={1028:a.BackSide,1029:a.FrontSide},K={512:a.NeverDepth,513:a.LessDepth,514:a.EqualDepth,515:a.LessEqualDepth,516:a.GreaterEqualDepth,517:a.NotEqualDepth,518:a.GreaterEqualDepth,519:a.AlwaysDepth},L={32774:a.AddEquation,32778:a.SubtractEquation,32779:a.ReverseSubtractEquation},M={0:a.ZeroFactor,1:a.OneFactor,768:a.SrcColorFactor,769:a.OneMinusSrcColorFactor,770:a.SrcAlphaFactor,771:a.OneMinusSrcAlphaFactor,772:a.DstAlphaFactor,773:a.OneMinusDstAlphaFactor,774:a.DstColorFactor,775:a.OneMinusDstColorFactor,776:a.SrcAlphaSaturateFactor},N={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16},O={POSITION:"position",NORMAL:"normal",TEXCOORD_0:"uv",TEXCOORD0:"uv",TEXCOORD:"uv",TEXCOORD_1:"uv2",COLOR_0:"color",COLOR0:"color",COLOR:"color",WEIGHTS_0:"skinWeight",WEIGHT:"skinWeight",JOINTS_0:"skinIndex",JOINT:"skinIndex"},P={scale:"scale",translation:"position",rotation:"quaternion",weights:"morphTargetInfluences"},Q={CUBICSPLINE:a.InterpolateSmooth,LINEAR:a.InterpolateLinear,STEP:a.InterpolateDiscrete},R={OPAQUE:"OPAQUE",MASK:"MASK",BLEND:"BLEND"};w.prototype.parse=function(a,b){var c=this.json;this.cache.removeAll(),this.markDefs(),this.getMultiDependencies(["scene","animation","camera"]).then(function(b){var d=b.scenes||[],e=d[c.scene||0],f=b.animations||[],g=b.cameras||[];a(e,d,g,f,c)}).catch(b)},w.prototype.markDefs=function(){for(var a,b=this.json.nodes||[],c=this.json.skins||[],d=this.json.meshes||[],e={},f={},g=0,h=c.length;g<h;g++){a=c[g].joints;for(var j=0,i=a.length;j<i;j++)b[a[j]].isBone=!0}for(var k,l=0,m=b.length;l<m;l++)k=b[l],void 0!==k.mesh&&(void 0===e[k.mesh]&&(e[k.mesh]=f[k.mesh]=0),e[k.mesh]++,void 0!==k.skin&&(d[k.mesh].isSkinnedMesh=!0));this.json.meshReferences=e,this.json.meshUses=f},w.prototype.getDependency=function(a,b){var c=a+":"+b,d=this.cache.get(c);if(!d){switch(a){case"scene":d=this.loadScene(b);break;case"node":d=this.loadNode(b);break;case"mesh":d=this.loadMesh(b);break;case"accessor":d=this.loadAccessor(b);break;case"bufferView":d=this.loadBufferView(b);break;case"buffer":d=this.loadBuffer(b);break;case"material":d=this.loadMaterial(b);break;case"texture":d=this.loadTexture(b);break;case"skin":d=this.loadSkin(b);break;case"animation":d=this.loadAnimation(b);break;case"camera":d=this.loadCamera(b);break;default:throw new Error("Unknown type: "+a);}this.cache.add(c,d)}return d},w.prototype.getDependencies=function(a){var b=this.cache.get(a);if(!b){var c=this,d=this.json[a+("mesh"===a?"es":"s")]||[];b=Promise.all(d.map(function(b,d){return c.getDependency(a,d)})),this.cache.add(a,b)}return b},w.prototype.getMultiDependencies=function(a){for(var b={},c=[],d=0,e=a.length;d<e;d++){var f=a[d],g=this.getDependencies(f);g=g.then(function(a,c){b[a]=c}.bind(this,f+("mesh"===f?"es":"s"))),c.push(g)}return Promise.all(c).then(function(){return b})},w.prototype.loadBuffer=function(a){var b=this.json.buffers[a],c=this.fileLoader;if(b.type&&"arraybuffer"!==b.type)throw new Error("THREE.GLTFLoader: "+b.type+" buffer type is not supported.");if(void 0===b.uri&&0===a)return Promise.resolve(this.extensions[y.KHR_BINARY_GLTF].body);var d=this.options;return new Promise(function(a,e){c.load(j(b.uri,d.path),a,void 0,function(){e(new Error("THREE.GLTFLoader: Failed to load buffer \""+b.uri+"\"."))})})},w.prototype.loadBufferView=function(a){var b=this.json.bufferViews[a];return this.getDependency("buffer",b.buffer).then(function(a){var c=b.byteLength||0,d=b.byteOffset||0;return a.slice(d,d+c)})},w.prototype.loadAccessor=function(b){var c=this,d=this.json,e=this.json.accessors[b];if(void 0===e.bufferView&&void 0===e.sparse)return null;var f=[];return void 0===e.bufferView?f.push(null):f.push(this.getDependency("bufferView",e.bufferView)),void 0!==e.sparse&&(f.push(this.getDependency("bufferView",e.sparse.indices.bufferView)),f.push(this.getDependency("bufferView",e.sparse.values.bufferView))),Promise.all(f).then(function(b){var f,g,h=b[0],j=N[e.type],k=E[e.componentType],l=k.BYTES_PER_ELEMENT,m=e.byteOffset||0,n=d.bufferViews[e.bufferView].byteStride,o=!0===e.normalized;if(n&&n!==l*j){var p="InterleavedBuffer:"+e.bufferView+":"+e.componentType,q=c.cache.get(p);q||(f=new k(h),q=new a.InterleavedBuffer(f,n/l),c.cache.add(p,q)),g=new a.InterleavedBufferAttribute(q,j,m/l,o)}else f=null===h?new k(e.count*j):new k(h,m,e.count*j),g=new a.BufferAttribute(f,j,o);if(void 0!==e.sparse){var r=N.SCALAR,s=E[e.sparse.indices.componentType],t=e.sparse.indices.byteOffset||0,u=e.sparse.values.byteOffset||0,v=new s(b[1],t,e.sparse.count*r),w=new k(b[2],u,e.sparse.count*j);null!==h&&g.setArray(g.array.slice());for(var x,y=0,i=v.length;y<i;y++)if(x=v[y],g.setX(x,w[y*j]),2<=j&&g.setY(x,w[y*j+1]),3<=j&&g.setZ(x,w[y*j+2]),4<=j&&g.setW(x,w[y*j+3]),5<=j)throw new Error("THREE.GLTFLoader: Unsupported itemSize in sparse BufferAttribute.")}return g})},w.prototype.loadTexture=function(b){var c,d=this,e=this.json,f=this.options,g=this.textureLoader,h=window.URL||window.webkitURL,i=e.textures[b],k=i.extensions||{};c=k[y.MSFT_TEXTURE_DDS]?e.images[k[y.MSFT_TEXTURE_DDS].source]:e.images[i.source];var l=c.uri,m=!1;return void 0!==c.bufferView&&(l=d.getDependency("bufferView",c.bufferView).then(function(a){m=!0;var b=new Blob([a],{type:c.mimeType});return l=h.createObjectURL(b),l})),Promise.resolve(l).then(function(b){var c=a.Loader.Handlers.get(b);return c||(c=k[y.MSFT_TEXTURE_DDS]?d.extensions[y.MSFT_TEXTURE_DDS].ddsLoader:g),new Promise(function(a,d){c.load(j(b,f.path),a,void 0,d)})}).then(function(b){!0===m&&h.revokeObjectURL(l),b.flipY=!1,void 0!==i.name&&(b.name=i.name),k[y.MSFT_TEXTURE_DDS]||(b.format=void 0===i.format?a.RGBAFormat:H[i.format]),void 0!==i.internalFormat&&b.format!==H[i.internalFormat]&&console.warn("THREE.GLTFLoader: Three.js does not support texture internalFormat which is different from texture format. internalFormat will be forced to be the same value as format."),b.type=void 0===i.type?a.UnsignedByteType:I[i.type];var c=e.samplers||{},d=c[i.sampler]||{};return b.magFilter=F[d.magFilter]||a.LinearFilter,b.minFilter=F[d.minFilter]||a.LinearMipMapLinearFilter,b.wrapS=G[d.wrapS]||a.RepeatWrapping,b.wrapT=G[d.wrapT]||a.RepeatWrapping,b})},w.prototype.assignTexture=function(a,b,c){return this.getDependency("texture",c).then(function(c){a[b]=c})},w.prototype.loadMaterial=function(b){var c,d=this,e=this.json,f=this.extensions,g=this.json.materials[b],h={},i=g.extensions||{},j=[];if(i[y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS]){var k=f[y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS];c=k.getMaterialType(g),j.push(k.extendParams(h,g,d))}else if(i[y.KHR_MATERIALS_UNLIT]){var m=f[y.KHR_MATERIALS_UNLIT];c=m.getMaterialType(g),j.push(m.extendParams(h,g,d))}else{c=a.MeshStandardMaterial;var n=g.pbrMetallicRoughness||{};if(h.color=new a.Color(1,1,1),h.opacity=1,Array.isArray(n.baseColorFactor)){var o=n.baseColorFactor;h.color.fromArray(o),h.opacity=o[3]}if(void 0!==n.baseColorTexture&&j.push(d.assignTexture(h,"map",n.baseColorTexture.index)),h.metalness=void 0===n.metallicFactor?1:n.metallicFactor,h.roughness=void 0===n.roughnessFactor?1:n.roughnessFactor,void 0!==n.metallicRoughnessTexture){var p=n.metallicRoughnessTexture.index;j.push(d.assignTexture(h,"metalnessMap",p)),j.push(d.assignTexture(h,"roughnessMap",p))}}!0===g.doubleSided&&(h.side=a.DoubleSide);var q=g.alphaMode||R.OPAQUE;return q===R.BLEND?h.transparent=!0:(h.transparent=!1,q===R.MASK&&(h.alphaTest=void 0===g.alphaCutoff?0.5:g.alphaCutoff)),void 0!==g.normalTexture&&c!==a.MeshBasicMaterial&&(j.push(d.assignTexture(h,"normalMap",g.normalTexture.index)),h.normalScale=new a.Vector2(1,1),void 0!==g.normalTexture.scale&&h.normalScale.set(g.normalTexture.scale,g.normalTexture.scale)),void 0!==g.occlusionTexture&&c!==a.MeshBasicMaterial&&(j.push(d.assignTexture(h,"aoMap",g.occlusionTexture.index)),void 0!==g.occlusionTexture.strength&&(h.aoMapIntensity=g.occlusionTexture.strength)),void 0!==g.emissiveFactor&&c!==a.MeshBasicMaterial&&(h.emissive=new a.Color().fromArray(g.emissiveFactor)),void 0!==g.emissiveTexture&&c!==a.MeshBasicMaterial&&j.push(d.assignTexture(h,"emissiveMap",g.emissiveTexture.index)),Promise.all(j).then(function(){var b;return b=c===a.ShaderMaterial?f[y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].createMaterial(h):new c(h),void 0!==g.name&&(b.name=g.name),b.normalScale&&(b.normalScale.y=-b.normalScale.y),b.map&&(b.map.encoding=a.sRGBEncoding),b.emissiveMap&&(b.emissiveMap.encoding=a.sRGBEncoding),b.specularMap&&(b.specularMap.encoding=a.sRGBEncoding),g.extras&&(b.userData=g.extras),g.extensions&&l(f,b,g),b})},w.prototype.loadGeometries=function(b){var c,d=this,e=this.extensions,f=this.primitiveCache,g=v(b);return g&&(c=b,b=[b[0]]),this.getDependencies("accessor").then(function(h){for(var j=[],k=0,i=b.length;k<i;k++){var l=b[k],m=r(f,l);if(m)j.push(m);else if(l.extensions&&l.extensions[y.KHR_DRACO_MESH_COMPRESSION]){var n=e[y.KHR_DRACO_MESH_COMPRESSION].decodePrimitive(l,d).then(function(a){return x(a,l,h),a});f.push({primitive:l,promise:n}),j.push(n)}else{var o=new a.BufferGeometry;x(o,l,h);var n=Promise.resolve(o);f.push({primitive:l,promise:n}),j.push(n)}}return Promise.all(j).then(function(e){if(g){var f=e[0],k=d.multiPassGeometryCache,l=t(k,f,c);if(null!==l)return[l.geometry];var m=new a.BufferGeometry;for(var n in m.name=f.name,m.userData=f.userData,f.attributes)m.addAttribute(n,f.attributes[n]);for(var n in f.morphAttributes)m.morphAttributes[n]=f.morphAttributes[n];for(var o,p=[],q=0,r=0,i=c.length;r<i;r++){o=h[c[r].indices];for(var u=0,j=o.count;u<j;u++)p.push(o.array[u]);m.addGroup(q,o.count,r),q+=o.count}return m.setIndex(p),k.push({geometry:m,baseGeometry:f,primitives:c}),[m]}if(1<e.length&&void 0!==a.BufferGeometryUtils){for(var r=1,i=b.length;r<i;r++)if(b[0].mode!==b[r].mode)return e;var k=d.multiplePrimitivesCache,l=s(k,e);if(!l){var m=a.BufferGeometryUtils.mergeBufferGeometries(e,!0);if(k.push({geometry:m,baseGeometries:e}),null!==m)return[m]}else if(null!==l.geometry)return[l.geometry]}return e})})},w.prototype.loadMesh=function(b){var c=this,d=this.json,e=this.extensions,f=this.json.meshes[b];return this.getMultiDependencies(["accessor","material"]).then(function(d){for(var g=f.primitives,h=[],j=0,i=g.length;j<i;j++)h[j]=void 0===g[j].material?k():d.materials[g[j].material];return c.loadGeometries(g).then(function(d){for(var k=1===d.length&&0<d[0].groups.length,l=[],m=0,i=d.length;m<i;m++){var o,p=d[m],q=g[m],r=k?h:h[m];if(q.mode===C.TRIANGLES||q.mode===C.TRIANGLE_STRIP||q.mode===C.TRIANGLE_FAN||void 0===q.mode)o=!0===f.isSkinnedMesh?new a.SkinnedMesh(p,r):new a.Mesh(p,r),q.mode===C.TRIANGLE_STRIP?o.drawMode=a.TriangleStripDrawMode:q.mode===C.TRIANGLE_FAN&&(o.drawMode=a.TriangleFanDrawMode);else if(q.mode===C.LINES)o=new a.LineSegments(p,r);else if(q.mode===C.LINE_STRIP)o=new a.Line(p,r);else if(q.mode===C.LINE_LOOP)o=new a.LineLoop(p,r);else if(q.mode===C.POINTS)o=new a.Points(p,r);else throw new Error("THREE.GLTFLoader: Primitive mode unsupported: "+q.mode);0<Object.keys(o.geometry.morphAttributes).length&&n(o,f),o.name=f.name||"mesh_"+b,1<d.length&&(o.name+="_"+m),void 0!==f.extras&&(o.userData=f.extras),l.push(o);for(var r,s=k?o.material:[o.material],t=void 0!==p.attributes.color,u=void 0===p.attributes.normal,v=!0===o.isSkinnedMesh,w=0<Object.keys(p.morphAttributes).length,x=w&&void 0!==p.morphAttributes.normal,z=0,j=s.length;z<j;z++){if(r=s[z],o.isPoints){var A="PointsMaterial:"+r.uuid,B=c.cache.get(A);B||(B=new a.PointsMaterial,a.Material.prototype.copy.call(B,r),B.color.copy(r.color),B.map=r.map,B.lights=!1,c.cache.add(A,B)),r=B}else if(o.isLine){var A="LineBasicMaterial:"+r.uuid,D=c.cache.get(A);D||(D=new a.LineBasicMaterial,a.Material.prototype.copy.call(D,r),D.color.copy(r.color),D.lights=!1,c.cache.add(A,D)),r=D}if(t||u||v||w){var A="ClonedMaterial:"+r.uuid+":";r.isGLTFSpecularGlossinessMaterial&&(A+="specular-glossiness:"),v&&(A+="skinning:"),t&&(A+="vertex-colors:"),u&&(A+="flat-shading:"),w&&(A+="morph-targets:"),x&&(A+="morph-normals:");var E=c.cache.get(A);E||(E=r.isGLTFSpecularGlossinessMaterial?e[y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].cloneMaterial(r):r.clone(),v&&(E.skinning=!0),t&&(E.vertexColors=a.VertexColors),u&&(E.flatShading=!0),w&&(E.morphTargets=!0),x&&(E.morphNormals=!0),c.cache.add(A,E)),r=E}s[z]=r,r.aoMap&&void 0===p.attributes.uv2&&void 0!==p.attributes.uv&&(console.log("THREE.GLTFLoader: Duplicating UVs to support aoMap."),p.addAttribute("uv2",new a.BufferAttribute(p.attributes.uv.array,2))),r.isGLTFSpecularGlossinessMaterial&&(o.onBeforeRender=e[y.KHR_MATERIALS_PBR_SPECULAR_GLOSSINESS].refreshUniforms)}o.material=k?s:s[0]}if(1===l.length)return l[0];for(var F=new a.Group,m=0,i=l.length;m<i;m++)F.add(l[m]);return F})})},w.prototype.loadCamera=function(b){var c,d=this.json.cameras[b],e=d[d.type];return e?("perspective"===d.type?c=new a.PerspectiveCamera(a.Math.radToDeg(e.yfov),e.aspectRatio||1,e.znear||1,e.zfar||2e6):"orthographic"===d.type&&(c=new a.OrthographicCamera(e.xmag/-2,e.xmag/2,e.ymag/2,e.ymag/-2,e.znear,e.zfar)),void 0!==d.name&&(c.name=d.name),d.extras&&(c.userData=d.extras),Promise.resolve(c)):void console.warn("THREE.GLTFLoader: Missing camera parameters.")},w.prototype.loadSkin=function(a){var b=this.json.skins[a],c={joints:b.joints};return void 0===b.inverseBindMatrices?Promise.resolve(c):this.getDependency("accessor",b.inverseBindMatrices).then(function(a){return c.inverseBindMatrices=a,c})},w.prototype.loadAnimation=function(b){var c=this.json,d=this.json.animations[b];return this.getMultiDependencies(["accessor","node"]).then(function(c){for(var e=[],f=0,g=d.channels.length;f<g;f++){var h=d.channels[f],k=d.samplers[h.sampler];if(k){var l=h.target,m=void 0===l.node?l.id:l.node,n=void 0===d.parameters?k.input:d.parameters[k.input],o=void 0===d.parameters?k.output:d.parameters[k.output],p=c.accessors[n],q=c.accessors[o],r=c.nodes[m];if(r){r.updateMatrix(),r.matrixAutoUpdate=!0;var s;switch(P[l.path]){case P.weights:s=a.NumberKeyframeTrack;break;case P.rotation:s=a.QuaternionKeyframeTrack;break;case P.position:case P.scale:default:s=a.VectorKeyframeTrack;}var t=r.name?r.name:r.uuid,u=void 0===k.interpolation?a.InterpolateLinear:Q[k.interpolation],v=[];P[l.path]===P.weights?r.traverse(function(a){!0===a.isMesh&&a.morphTargetInfluences&&v.push(a.name?a.name:a.uuid)}):v.push(t);for(var w,x=0,j=v.length;x<j;x++)w=new s(v[x]+"."+P[l.path],a.AnimationUtils.arraySlice(p.array,0),a.AnimationUtils.arraySlice(q.array,0),u),"CUBICSPLINE"===k.interpolation&&(w.createInterpolant=function(a){return new i(this.times,this.values,this.getValueSize()/3,a)},w.createInterpolant.isInterpolantFactoryMethodGLTFCubicSpline=!0),e.push(w)}}}var m=void 0===d.name?"animation_"+b:d.name;return new a.AnimationClip(m,void 0,e)})},w.prototype.loadNode=function(b){var c=this.json,d=this.extensions,e=this.json.meshReferences,f=this.json.meshUses,g=this.json.nodes[b];return this.getMultiDependencies(["mesh","skin","camera","light"]).then(function(b){var c;if(!0===g.isBone)c=new a.Bone;else if(void 0!==g.mesh){var h=b.meshes[g.mesh];if(c=h.clone(),!0===h.isGroup)for(var j,k=0,i=h.children.length;k<i;k++)j=h.children[k],j.material&&!0===j.material.isGLTFSpecularGlossinessMaterial&&(c.children[k].onBeforeRender=j.onBeforeRender);else h.material&&!0===h.material.isGLTFSpecularGlossinessMaterial&&(c.onBeforeRender=h.onBeforeRender);1<e[g.mesh]&&(c.name+="_instance_"+f[g.mesh]++)}else if(void 0!==g.camera)c=b.cameras[g.camera];else if(g.extensions&&g.extensions[y.KHR_LIGHTS]&&void 0!==g.extensions[y.KHR_LIGHTS].light){var m=d[y.KHR_LIGHTS].lights;c=m[g.extensions[y.KHR_LIGHTS].light]}else c=new a.Object3D;if(void 0!==g.name&&(c.name=a.PropertyBinding.sanitizeNodeName(g.name)),g.extras&&(c.userData=g.extras),g.extensions&&l(d,c,g),void 0!==g.matrix){var n=new a.Matrix4;n.fromArray(g.matrix),c.applyMatrix(n)}else void 0!==g.translation&&c.position.fromArray(g.translation),void 0!==g.rotation&&c.quaternion.fromArray(g.rotation),void 0!==g.scale&&c.scale.fromArray(g.scale);return c})},w.prototype.loadScene=function(){function b(c,d,e,f,g){var h=f[c],k=e.nodes[c];if(void 0!==k.skin)for(var l=!0===h.isGroup?h.children:[h],m=0,i=l.length;m<i;m++){for(var n=l[m],o=g[k.skin],p=[],q=[],r=0,j=o.joints.length;r<j;r++){var s=o.joints[r],t=f[s];if(t){p.push(t);var u=new a.Matrix4;void 0!==o.inverseBindMatrices&&u.fromArray(o.inverseBindMatrices.array,16*r),q.push(u)}else console.warn("THREE.GLTFLoader: Joint \"%s\" could not be found.",s)}n.bind(new a.Skeleton(p,q),n.matrixWorld)}if(d.add(h),k.children)for(var v,w=k.children,m=0,i=w.length;m<i;m++)v=w[m],b(v,h,e,f,g)}return function(c){var d=this.json,e=this.extensions,f=this.json.scenes[c];return this.getMultiDependencies(["node","skin"]).then(function(c){var g=new a.Scene;void 0!==f.name&&(g.name=f.name),f.extras&&(g.userData=f.extras),f.extensions&&l(e,g,f);for(var h=f.nodes||[],j=0,i=h.length;j<i;j++)b(h[j],g,d,c.nodes,c.skins);if(f.extensions&&f.extensions[y.KHR_LIGHTS]&&void 0!==f.extensions[y.KHR_LIGHTS].light){var k=e[y.KHR_LIGHTS].lights;g.add(k[f.extensions[y.KHR_LIGHTS].light])}return g})}}()},a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2/libs/FBXLoader",[],function(a,b,c){return c("datav:/com/datav-expo-models/1.0.2/libs/dependencies/inflate.min"),a.exports=function(a){function b(a){var b=new Map;if("Connections"in a)for(var c,d=a.Connections.properties.connections,e=0,f=d.length;e<f;++e){c=d[e],b.has(c[0])||b.set(c[0],{parents:[],children:[]});var g={ID:c[1],relationship:c[2]};b.get(c[0]).parents.push(g),b.has(c[1])||b.set(c[1],{parents:[],children:[]});var h={ID:c[0],relationship:c[2]};b.get(c[1]).children.push(h)}return b}function c(a){var b=new Map;if("Video"in a.Objects.subNodes){var c=a.Objects.subNodes.Video;for(var e in c){var f=c[e];if("Content"in f.properties){var g=d(c[e]);b.set(parseInt(e),g)}}}return b}function d(a){var b,c=a.properties.Content,d=a.properties.RelativeFilename||a.properties.Filename,e=d.slice(d.lastIndexOf(".")+1).toLowerCase();switch(e){case"bmp":b="image/bmp";break;case"jpg":case"jpeg":b="image/jpeg";break;case"png":b="image/png";break;case"tif":b="image/tiff";break;default:return void console.warn("FBXLoader: Image type \""+e+"\" is not supported.");}if("string"===typeof c)return"data:"+b+";base64,"+c;var f=new Uint8Array(c);return window.URL.createObjectURL(new Blob([f],{type:b}))}function e(a,b,c,d){var e=new Map;if("Texture"in a.Objects.subNodes){var g=a.Objects.subNodes.Texture;for(var h in g){var i=f(g[h],b,c,d);e.set(parseInt(h),i)}}return e}function f(b,c,d,e){var f,g=b.id,h=b.attrName,i=b.properties.FileName,j=b.properties.RelativeFilename,k=e.get(g).children;if(void 0!==k&&0<k.length&&d.has(k[0].ID))f=d.get(k[0].ID);else if(void 0!==j&&"/"!==j[0]&&null===j.match(/^[a-zA-Z]:/))f=j;else{var l=i.split(/[\\\/]/);f=0<l.length?l[l.length-1]:i}var m=c.path;(0===f.indexOf("blob:")||0===f.indexOf("data:"))&&c.setPath(void 0);var n=c.load(f);n.name=h,n.FBX_ID=g;var o=b.properties.WrapModeU,p=b.properties.WrapModeV,q=void 0===o?0:o.value,r=void 0===p?0:p.value;if(n.wrapS=0===q?a.RepeatWrapping:a.ClampToEdgeWrapping,n.wrapT=0===r?a.RepeatWrapping:a.ClampToEdgeWrapping,"Scaling"in b.properties){var s=b.properties.Scaling.value;n.repeat.x=s[0],n.repeat.y=s[1]}return c.setPath(m),n}function g(a,b,c){var d=new Map;if("Material"in a.Objects.subNodes){var e=a.Objects.subNodes.Material;for(var f in e){var g=h(e[f],b,c);null!==g&&d.set(parseInt(f),g)}}return d}function h(b,c,d){var e=b.id,f=b.attrName,g=b.properties.ShadingModel;if("object"===typeof g&&(g=g.value),!d.has(e))return null;var h,j=d.get(e).children,k=i(b.properties,c,j);switch(g.toLowerCase()){case"phong":h=new a.MeshPhongMaterial;break;case"lambert":h=new a.MeshLambertMaterial;break;default:console.warn("THREE.FBXLoader: unknown material type \"%s\". Defaulting to MeshPhongMaterial.",g),h=new a.MeshPhongMaterial({color:3342591});}return h.setValues(k),h.name=f,h}function i(b,c,d){var e={};b.BumpFactor&&(e.bumpScale=b.BumpFactor.value),b.Diffuse&&(e.color=R(b.Diffuse)),b.DisplacementFactor&&(e.displacementScale=b.DisplacementFactor.value),b.ReflectionFactor&&(e.reflectivity=b.ReflectionFactor.value),b.Specular&&(e.specular=R(b.Specular)),b.Shininess&&(e.shininess=b.Shininess.value),b.Emissive&&(e.emissive=R(b.Emissive)),b.EmissiveFactor&&(e.emissiveIntensity=parseFloat(b.EmissiveFactor.value)),b.Opacity&&(e.opacity=parseFloat(b.Opacity.value)),1>e.opacity&&(e.transparent=!0);for(var f=0,g=d.length;f<g;++f){var h=d[f],i=h.relationship;switch(i){case"Bump":e.bumpMap=c.get(h.ID);break;case"DiffuseColor":e.map=c.get(h.ID);break;case"DisplacementColor":e.displacementMap=c.get(h.ID);break;case"EmissiveColor":e.emissiveMap=c.get(h.ID);break;case"NormalMap":e.normalMap=c.get(h.ID);break;case"ReflectionColor":e.envMap=c.get(h.ID),e.envMap.mapping=a.EquirectangularReflectionMapping;break;case"SpecularColor":e.specularMap=c.get(h.ID);break;case"TransparentColor":e.alphaMap=c.get(h.ID),e.transparent=!0;break;case"AmbientColor":case"ShininessExponent":case"SpecularFactor":case"VectorDisplacementColor":default:console.warn("THREE.FBXLoader: %s map is not supported in three.js, skipping texture.",i);}}return e}function j(a,b){var c={};if("Deformer"in a.Objects.subNodes){var d=a.Objects.subNodes.Deformer;for(var e in d){var f=d[e];if("Skin"===f.attrType){var g=b.get(parseInt(e)),h=k(g,d);h.FBX_ID=parseInt(e),c[e]=h}}}return c}function k(b,c){for(var d={},e=b.children,f=0,g=e.length;f<g;++f){var h=e[f],j=c[h.ID],k={FBX_ID:h.ID,index:f,indices:[],weights:[],transform:new a.Matrix4().fromArray(j.subNodes.Transform.properties.a),transformLink:new a.Matrix4().fromArray(j.subNodes.TransformLink.properties.a),linkMode:j.properties.Mode};"Indexes"in j.subNodes&&(k.indices=j.subNodes.Indexes.properties.a,k.weights=j.subNodes.Weights.properties.a),d[h.ID]=k}return{map:d,bones:[]}}function l(a,b,c){var d=new Map;if("Geometry"in a.Objects.subNodes){var e=a.Objects.subNodes.Geometry;for(var f in e){var g=b.get(parseInt(f)),h=m(e[f],g,c);d.set(parseInt(f),h)}}return d}function m(a,b,c){switch(a.attrType){case"Mesh":return n(a,b,c);break;case"NurbsCurve":return u(a);}}function n(a,b,c){for(var d,e=0;e<b.children.length&&(d=c[b.children[e].ID],void 0===d);++e);return o(a,d)}function o(b,c){var d=b.subNodes,e=d.Vertices.properties.a,f=d.PolygonVertexIndex.properties.a,g=[],h=[],k=[],l=[],m=[],n=[],o=[];if(d.LayerElementColor)var u=r(d.LayerElementColor[0]);if(d.LayerElementMaterial)var v=s(d.LayerElementMaterial[0]);if(d.LayerElementNormal)var w=p(d.LayerElementNormal[0]);if(d.LayerElementUV)for(var x=[],y=0;d.LayerElementUV[y];)x.push(q(d.LayerElementUV[y])),y++;var i={};if(c){var z=c.map;for(var A in z)for(var B=z[A],C=B.indices,D=0;D<C.length;D++){var j=C[D],E=B.weights[D];void 0===i[j]&&(i[j]=[]),i[j].push({id:B.index,weight:E})}}for(var F=0,G=0,H=!1,I=[],J=[],K=[],L=[],M=[],N=[],O=0;O<f.length;O++){var P=f[O],Q=!1;0>P&&(P^=-1,f[O]=P,Q=!0);var R=[],S=[];if(I.push(3*P,3*P+1,3*P+2),u){var T=t(O,F,P,u);K.push(T[0],T[1],T[2])}if(c){if(void 0!==i[P])for(var U=i[P],D=0,V=U.length;D<V;D++)S.push(U[D].weight),R.push(U[D].id);if(4<S.length){H||(console.warn("THREE.FBXLoader: Vertex has more than 4 skinning weights assigned to vertex. Deleting additional weights."),H=!0);var W=[0,0,0,0],X=[0,0,0,0];S.forEach(function(a,b){var c=a,d=R[b];X.forEach(function(a,b,e){if(c>a){e[b]=c,c=a;var f=W[b];W[b]=d,d=f}})}),R=W,S=X}for(var y=S.length;4>y;++y)S[y]=0,R[y]=0;for(var y=0;4>y;++y)M.push(S[y]),N.push(R[y])}if(w){var T=t(O,F,P,w);J.push(T[0],T[1],T[2])}for(var T,y=0;y<x.length;y++)T=t(O,F,P,x[y]),void 0===L[y]&&(L[y]=[]),L[y].push(T[0],T[1]);if(G++,Q){for(var y=2;y<G;y++)g.push(e[I[0]]),g.push(e[I[1]]),g.push(e[I[2]]),g.push(e[I[3*(y-1)]]),g.push(e[I[3*(y-1)+1]]),g.push(e[I[3*(y-1)+2]]),g.push(e[I[3*y]]),g.push(e[I[3*y+1]]),g.push(e[I[3*y+2]]);if(c)for(var y=2;y<G;y++)n.push(M[0]),n.push(M[1]),n.push(M[2]),n.push(M[3]),n.push(M[4*(y-1)]),n.push(M[4*(y-1)+1]),n.push(M[4*(y-1)+2]),n.push(M[4*(y-1)+3]),n.push(M[4*y]),n.push(M[4*y+1]),n.push(M[4*y+2]),n.push(M[4*y+3]),o.push(N[0]),o.push(N[1]),o.push(N[2]),o.push(N[3]),o.push(N[4*(y-1)]),o.push(N[4*(y-1)+1]),o.push(N[4*(y-1)+2]),o.push(N[4*(y-1)+3]),o.push(N[4*y]),o.push(N[4*y+1]),o.push(N[4*y+2]),o.push(N[4*y+3]);if(w)for(var y=2;y<G;y++)h.push(J[0]),h.push(J[1]),h.push(J[2]),h.push(J[3*(y-1)]),h.push(J[3*(y-1)+1]),h.push(J[3*(y-1)+2]),h.push(J[3*y]),h.push(J[3*y+1]),h.push(J[3*y+2]);for(var D=0;D<x.length;D++){void 0===l[D]&&(l[D]=[]);for(var y=2;y<G;y++)l[D].push(L[D][0]),l[D].push(L[D][1]),l[D].push(L[D][2*(y-1)]),l[D].push(L[D][2*(y-1)+1]),l[D].push(L[D][2*y]),l[D].push(L[D][2*y+1])}if(u)for(var y=2;y<G;y++)k.push(K[0]),k.push(K[1]),k.push(K[2]),k.push(K[3*(y-1)]),k.push(K[3*(y-1)+1]),k.push(K[3*(y-1)+2]),k.push(K[3*y]),k.push(K[3*y+1]),k.push(K[3*y+2]);if(v&&"AllSame"!==v.mappingType)for(var Y=t(O,F,P,v)[0],y=2;y<G;y++)m.push(Y),m.push(Y),m.push(Y);F++,Q=!1,G=0,I=[],J=[],K=[],L=[],M=[],N=[]}}var Z=new a.BufferGeometry;if(Z.name=b.name,Z.addAttribute("position",new a.Float32BufferAttribute(g,3)),0<k.length&&Z.addAttribute("color",new a.Float32BufferAttribute(k,3)),c&&(Z.addAttribute("skinIndex",new a.Float32BufferAttribute(o,4)),Z.addAttribute("skinWeight",new a.Float32BufferAttribute(n,4)),Z.FBX_Deformer=c),0<h.length&&Z.addAttribute("normal",new a.Float32BufferAttribute(h,3)),0<l.length)for(var $,y=0;y<l.length;y++)$="uv"+(y+1).toString(),0==y&&($="uv"),Z.addAttribute($,new a.Float32BufferAttribute(l[y],2));if(v&&"AllSame"!==v.mappingType){for(var _=m[0],aa=0,y=0;y<m.length;++y)m[y]!==_&&(Z.addGroup(aa,y-aa,_),_=m[y],aa=y);if(0<Z.groups.length){var ba=Z.groups[Z.groups.length-1],ca=ba.start+ba.count;ca!==m.length&&Z.addGroup(ca,m.length-ca,_)}0===Z.groups.length&&Z.addGroup(0,m.length,m[0])}return Z}function p(a){var b=a.properties.MappingInformationType,c=a.properties.ReferenceInformationType,d=a.subNodes.Normals.properties.a,e=[];return"IndexToDirect"===c&&("NormalIndex"in a.subNodes?e=a.subNodes.NormalIndex.properties.a:"NormalsIndex"in a.subNodes&&(e=a.subNodes.NormalsIndex.properties.a)),{dataSize:3,buffer:d,indices:e,mappingType:b,referenceType:c}}function q(a){var b=a.properties.MappingInformationType,c=a.properties.ReferenceInformationType,d=a.subNodes.UV.properties.a,e=[];return"IndexToDirect"===c&&(e=a.subNodes.UVIndex.properties.a),{dataSize:2,buffer:d,indices:e,mappingType:b,referenceType:c}}function r(a){var b=a.properties.MappingInformationType,c=a.properties.ReferenceInformationType,d=a.subNodes.Colors.properties.a,e=[];return"IndexToDirect"===c&&(e=a.subNodes.ColorIndex.properties.a),{dataSize:4,buffer:d,indices:e,mappingType:b,referenceType:c}}function s(a){var b=a.properties.MappingInformationType,c=a.properties.ReferenceInformationType;if("NoMappingInformation"===b)return{dataSize:1,buffer:[0],indices:[0],mappingType:"AllSame",referenceType:c};for(var d=a.subNodes.Materials.properties.a,e=[],f=0,g=d.length;f<g;++f)e.push(f);return{dataSize:1,buffer:d,indices:e,mappingType:b,referenceType:c}}function t(a,b,c,d){return X[d.mappingType][d.referenceType](a,b,c,d)}function u(b){if(void 0===a.NURBSCurve)return console.error("THREE.FBXLoader: The loader relies on THREE.NURBSCurve for any nurbs present in the model. Nurbs will show up as empty geometry."),new a.BufferGeometry;var c=parseInt(b.properties.Order);if(isNaN(c))return console.error("THREE.FBXLoader: Invalid Order %s given for geometry ID: %s",b.properties.Order,b.id),new a.BufferGeometry;for(var d=c-1,e=b.subNodes.KnotVector.properties.a,f=[],g=b.subNodes.Points.properties.a,h=0,i=g.length;h<i;h+=4)f.push(new a.Vector4().fromArray(g,h));var j,k;if("Closed"===b.properties.Form)f.push(f[0]);else if("Periodic"===b.properties.Form){j=d,k=e.length-1-j;for(var h=0;h<d;++h)f.push(f[h])}for(var l=new a.NURBSCurve(d,e,f,j,k),m=l.getPoints(7*f.length),n=new Float32Array(3*m.length),h=0,i=m.length;h<i;++h)m[h].toArray(n,3*h);var o=new a.BufferGeometry;return o.addAttribute("position",new a.BufferAttribute(n,3)),o}function v(c,d,e,f,h){var j=new a.Group,k=c.Objects.subNodes.Model,l=[],m=new Map;for(var n in k){for(var o=parseInt(n),p=k[n],q=d.get(o),s=null,t=0;t<q.parents.length;++t)for(var i in e){var u=e[i],v=u.map,x=v[q.parents[t].ID];if(x){var y=s;s=new a.Bone,u.bones[x.index]=s,null!==y&&s.add(y)}}if(!s)switch(p.attrType){case"Camera":for(var z,A=0,B=q.children.length;A<B;++A){var D=q.children[A].ID,E=c.Objects.subNodes.NodeAttribute[D];void 0!==E&&void 0!==E.properties&&(z=E.properties)}if(void 0===z)s=new a.Object3D;else{var F=0;void 0!==z.CameraProjectionType&&1===z.CameraProjectionType.value&&(F=1);var G=1;void 0!==z.NearPlane&&(G=z.NearPlane.value/1e3);var H=1e3;void 0!==z.FarPlane&&(H=z.FarPlane.value/1e3);var I=window.innerWidth,J=window.innerHeight;void 0!==z.AspectWidth&&void 0!==z.AspectHeight&&(I=z.AspectWidth.value,J=z.AspectHeight.value);var K=I/J,L=45;switch(void 0!==z.FieldOfView&&(L=z.FieldOfView.value),F){case 0:s=new a.PerspectiveCamera(L,K,G,H);break;case 1:s=new a.OrthographicCamera(-I/2,I/2,J/2,-J/2,G,H);break;default:console.warn("THREE.FBXLoader: Unknown camera type "+F+"."),s=new a.Object3D;}}break;case"Light":for(var M,A=0,B=q.children.length;A<B;++A){var D=q.children[A].ID,E=c.Objects.subNodes.NodeAttribute[D];void 0!==E&&void 0!==E.properties&&(M=E.properties)}if(void 0===M)s=new a.Object3D;else{var F=void 0===M.LightType?0:M.LightType.value;var N=16777215;void 0!==M.Color&&(N=R(M.Color.value));var O=void 0===M.Intensity?1:M.Intensity.value/100;void 0!==M.CastLightOnObject&&0===M.CastLightOnObject.value&&(O=0);var P=0;void 0!==M.FarAttenuationEnd&&(void 0!==M.EnableFarAttenuation&&0===M.EnableFarAttenuation.value?P=0:P=M.FarAttenuationEnd.value/1e3);var Q=1;switch(F){case 0:s=new a.PointLight(N,O,P,Q);break;case 1:s=new a.DirectionalLight(N,O);break;case 2:var S=Math.PI/3;void 0!==M.InnerAngle&&(S=a.Math.degToRad(M.InnerAngle.value));var U=0;void 0!==M.OuterAngle&&(U=a.Math.degToRad(M.OuterAngle.value),U=Math.max(U,1)),s=new a.SpotLight(N,O,P,S,U,Q);break;default:console.warn("THREE.FBXLoader: Unknown light type "+M.LightType.value+", defaulting to a THREE.PointLight."),s=new a.PointLight(N,O);}void 0!==M.CastShadows&&1===M.CastShadows.value&&(s.castShadow=!0)}break;case"Mesh":for(var V,W=null,X=null,Y=[],A=0,B=q.children.length;A<B;++A)V=q.children[A],f.has(V.ID)&&(W=f.get(V.ID)),h.has(V.ID)&&Y.push(h.get(V.ID));if(1<Y.length?X=Y:0<Y.length?X=Y[0]:(X=new a.MeshPhongMaterial({color:13421772}),Y.push(X)),"color"in W.attributes)for(var Z=0,$=Y.length;Z<$;++Z)Y[Z].vertexColors=a.VertexColors;if(W.FBX_Deformer){for(var _=0,aa=Y.length;_<aa;++_)Y[_].skinning=!0;s=new a.SkinnedMesh(W,X)}else s=new a.Mesh(W,X);break;case"NurbsCurve":for(var V,W=null,A=0,B=q.children.length;A<B;++A)V=q.children[A],f.has(V.ID)&&(W=f.get(V.ID));X=new a.LineBasicMaterial({color:3342591,linewidth:5}),s=new a.Line(W,X);break;default:s=new a.Group;}s.name=a.PropertyBinding.sanitizeNodeName(p.attrName),s.FBX_ID=o,l.push(s),m.set(o,s)}for(var ba=0,ca=l.length;ba<ca;++ba){var s=l[ba],p=k[s.FBX_ID];if("Lcl_Translation"in p.properties&&s.position.fromArray(p.properties.Lcl_Translation.value),"Lcl_Rotation"in p.properties){var da=p.properties.Lcl_Rotation.value.map(a.Math.degToRad);da.push("ZYX"),s.rotation.fromArray(da)}if("Lcl_Scaling"in p.properties&&s.scale.fromArray(p.properties.Lcl_Scaling.value),"PreRotation"in p.properties){var ea=p.properties.PreRotation.value.map(a.Math.degToRad);ea[3]="ZYX";var fa=new a.Euler().fromArray(ea);fa=new a.Quaternion().setFromEuler(fa);var ga=new a.Quaternion().setFromEuler(s.rotation);fa.multiply(ga),s.rotation.setFromQuaternion(fa,"ZYX")}if("GeometricTranslation"in p.properties){var ea=p.properties.GeometricTranslation.value;s.traverse(function(a){a.geometry&&a.geometry.translate(ea[0],ea[1],ea[2])})}if("LookAtProperty"in p.properties)for(var V,q=d.get(s.FBX_ID),A=0,B=q.children.length;A<B;++A)if(V=q.children[A],"LookAtProperty"===V.relationship){var ha=c.Objects.subNodes.Model[V.ID];if("Lcl_Translation"in ha.properties){var ia=ha.properties.Lcl_Translation.value;void 0===s.target?s.lookAt(new a.Vector3(ia[0],ia[1],ia[2])):(s.target.position.set(ia[0],ia[1],ia[2]),j.add(s.target))}}for(var ja,q=d.get(s.FBX_ID),ka=0;ka<q.parents.length;ka++)if(ja=T(l,function(a){return a.FBX_ID===q.parents[ka].ID}),-1<ja){l[ja].add(s);break}null===s.parent&&j.add(s)}j.updateMatrixWorld(!0);var la=new Map;if("Pose"in c.Objects.subNodes){var ma=c.Objects.subNodes.Pose;for(var n in ma)if("BindPose"===ma[n].attrType){ma=ma[n];break}for(var na=ma.subNodes.PoseNode,oa=0,pa=na.length;oa<pa;++oa){var p=na[oa],qa=new a.Matrix4().fromArray(p.subNodes.Matrix.properties.a);la.set(parseInt(p.properties.Node),qa)}}for(var i in e){var u=e[i],v=u.map;for(var ra in v){var x=v[ra],sa=x.index,ta=u.bones[sa];if(!la.has(ta.FBX_ID))break;var ua=la.get(ta.FBX_ID);ta.matrixWorld.copy(ua)}u.skeleton=new a.Skeleton(u.bones);for(var va,q=d.get(u.FBX_ID),wa=q.parents,xa=0,ya=wa.length;xa<ya;++xa)if(va=wa[xa],f.has(va.ID))for(var za=va.ID,Aa=d.get(za),t=0;t<Aa.parents.length;++t)if(m.has(Aa.parents[t].ID)){var s=m.get(Aa.parents[t].ID);s.bind(u.skeleton,s.matrixWorld);break}}j.updateMatrixWorld(!0),j.skeleton={bones:l};var Ba=w(c,d,j);if(C(j,Ba),"GlobalSettings"in c&&"AmbientColor"in c.GlobalSettings.properties){var Ca=c.GlobalSettings.properties.AmbientColor.value,Da=Ca[0],r=Ca[1],g=Ca[2];if(0!==Da||0!==r||0!==g){var N=new a.Color(Da,r,g);j.add(new a.AmbientLight(N,1))}}return j}function w(b,c,d){var e=b.Objects.subNodes.AnimationCurveNode,f=b.Objects.subNodes.AnimationCurve,g=b.Objects.subNodes.AnimationLayer,h=b.Objects.subNodes.AnimationStack,i=30;if("GlobalSettings"in b&&"TimeMode"in b.GlobalSettings.properties){var j=b.GlobalSettings.properties.TimeMode.value;14===j?"CustomFrameRate"in b.GlobalSettings.properties&&(i=b.GlobalSettings.properties.CustomFrameRate.value,i=-1===i?30:i):17>=j&&(i=[30,120,100,60,50,48,30,30,29.97,29.97,25,24,1,23.976,30,96,72,59.94][j])}var k={curves:new Map,layers:{},stacks:{},length:0,fps:i,frames:0},l=[];for(var m in e)if(m.match(/\d+/)){var n=x(b,e[m],c,d);l.push(n)}for(var o=new Map,p=0;p<l.length;++p)null!==l[p]&&o.set(l[p].id,l[p]);var q=[];for(m in f)if(m.match(/\d+/)){var r=y(f[m]);if(!c.has(r.id))continue;q.push(r);var s=c.get(r.id).parents[0],t=s.ID,u=s.relationship,v="";if(u.match(/X/))v="x";else if(u.match(/Y/))v="y";else if(u.match(/Z/))v="z";else continue;o.get(t).curves[v]=r}for(var m in o.forEach(function(b){var c=b.containerBoneID;if(k.curves.has(c)||k.curves.set(c,{T:null,R:null,S:null}),k.curves.get(c)[b.attr]=b,"R"===b.attr){var d=b.curves;if(null===d.x&&(d.x={version:null,times:[0],values:[0]}),null===d.y&&(d.y={version:null,times:[0],values:[0]}),null===d.z&&(d.z={version:null,times:[0],values:[0]}),d.x.values=d.x.values.map(a.Math.degToRad),d.y.values=d.y.values.map(a.Math.degToRad),d.z.values=d.z.values.map(a.Math.degToRad),null!==b.preRotations){var e=new a.Euler().setFromVector3(b.preRotations,"ZYX");e=new a.Quaternion().setFromEuler(e);for(var f=new a.Euler,g=new a.Quaternion,h=0;h<d.x.times.length;++h)f.set(d.x.values[h],d.y.values[h],d.z.values[h],"ZYX"),g.setFromEuler(f).premultiply(e),f.setFromQuaternion(g,"ZYX"),d.x.values[h]=f.x,d.y.values[h]=f.y,d.z.values[h]=f.z}}}),g){for(var w=[],A=c.get(parseInt(m)).children,B=0;B<A.length;B++)if(o.has(A[B].ID)){var C=o.get(A[B].ID),D=C.containerBoneID;void 0===w[D]&&(w[D]={T:null,R:null,S:null}),w[D][C.attr]=C}k.layers[m]=w}for(var m in h){for(var E,F=[],A=c.get(parseInt(m)).children,G={max:0,min:Number.MAX_VALUE},B=0;B<A.length;++B)if(E=k.layers[A[B].ID],void 0!==E){F.push(E);for(var w,H=0,I=E.length;H<I;++H)w=E[H],w&&z(w,G)}G.max>G.min&&(k.stacks[m]={name:h[m].attrName,layers:F,length:G.max-G.min,frames:(G.max-G.min)*k.fps})}return k}function x(a,b,c,d){var e=a.Objects.subNodes.Model,f={id:b.id,attr:b.attrName,internalID:b.id,attrX:!1,attrY:!1,attrZ:!1,containerBoneID:-1,containerID:-1,curves:{x:null,y:null,z:null},preRotations:null};if(f.attr.match(/S|R|T/))for(var g in b.properties)g.match(/X/)&&(f.attrX=!0),g.match(/Y/)&&(f.attrY=!0),g.match(/Z/)&&(f.attrZ=!0);else return null;for(var h,i=c.get(f.id),j=i.parents,k=j.length-1;0<=k;--k)if(h=T(d.skeleton.bones,function(a){return a.FBX_ID===j[k].ID}),-1<h){f.containerBoneID=h,f.containerID=j[k].ID;var l=e[f.containerID.toString()];"PreRotation"in l.properties&&(f.preRotations=Q(l.properties.PreRotation).multiplyScalar(Math.PI/180));break}return f}function y(a){return{version:null,id:a.id,internalID:a.id,times:a.subNodes.KeyTime.properties.a.map(O),values:a.subNodes.KeyValueFloat.properties.a,attrFlag:a.subNodes.KeyAttrFlags.properties.a,attrData:a.subNodes.KeyAttrDataFloat.properties.a}}function z(a,b){a.R&&A(a.R.curves,b),a.S&&A(a.S.curves,b),a.T&&A(a.T.curves,b)}function A(a,b){a.x&&B(a.x,b),a.y&&B(a.y,b),a.z&&B(a.z,b)}function B(a,b){b.max=a.times[a.times.length-1]>b.max?a.times[a.times.length-1]:b.max,b.min=a.times[0]<b.min?a.times[0]:b.min}function C(b,c){void 0===b.animations&&(b.animations=[]);var d=c.stacks;for(var e in d){for(var f=d[e],g={name:f.name,fps:c.fps,length:f.length,hierarchy:[]},h=b.skeleton.bones,i=0,j=h.length;i<j;++i){var k=h[i],l=k.name.replace(/.*:/,""),m=T(h,function(a){return k.parent===a});g.hierarchy.push({parent:m,name:l,keys:[]})}for(var n=0;n<=f.frames;n++)for(var i=0,j=h.length;i<j;++i)for(var o,k=h[i],p=i,q=f.layers[0][p],r=0,s=g.hierarchy.length;r<s;++r)o=g.hierarchy[r],o.name===k.name&&o.keys.push(D(c,q,k,n));b.animations.push(a.AnimationClip.parseAnimation(g,h))}}function D(a,b,c,d){var e={time:d/a.fps,pos:c.position.toArray(),rot:c.quaternion.toArray(),scl:c.scale.toArray()};if(void 0===b)return e;Y.setFromQuaternion(c.quaternion,"ZYX",!1);try{E(b,"T")&&F(b.T,d)&&(b.T.curves.x.values[d]&&(e.pos[0]=b.T.curves.x.values[d]),b.T.curves.y.values[d]&&(e.pos[1]=b.T.curves.y.values[d]),b.T.curves.z.values[d]&&(e.pos[2]=b.T.curves.z.values[d])),E(b,"R")&&F(b.R,d)&&(b.R.curves.x.values[d]&&(Y.x=b.R.curves.x.values[d]),b.R.curves.y.values[d]&&(Y.y=b.R.curves.y.values[d]),b.R.curves.z.values[d]&&(Y.z=b.R.curves.z.values[d]),Z.setFromEuler(Y),e.rot=Z.toArray()),E(b,"S")&&F(b.S,d)&&(b.T.curves.x.values[d]&&(e.scl[0]=b.S.curves.x.values[d]),b.T.curves.y.values[d]&&(e.scl[1]=b.S.curves.y.values[d]),b.T.curves.z.values[d]&&(e.scl[2]=b.S.curves.z.values[d]))}catch(a){console.log("THREE.FBXLoader: ",c),console.log("THREE.FBXLoader: ",a)}return e}function E(a,b){if(void 0===a)return!1;var c=a[b];return!!c&&$.every(function(a){return null!==c.curves[a]})}function F(a,b){return $.every(function(c){return G(a.curves[c],b)})}function G(a,b){return void 0!==a.values[b]}function H(){}function I(){}function J(a,b){this.dv=new DataView(a),this.offset=0,this.littleEndian=void 0===b||b}function K(){}function L(a){var b="Kaydara FBX Binary  \0";return a.byteLength>=b.length&&b===S(a,0,b.length)}function M(a){function b(b){var c=a[b-1];return a=a.slice(e+b),e++,c}for(var c,d=["K","a","y","d","a","r","a","\\","F","B","X","\\","B","i","n","a","r","y","\\","\\"],e=0,f=0;f<d.length;++f)if(c=b(1),c===d[f])return!1;return!0}function N(a){var b=/FBXVersion: (\d+)/,c=a.match(b);if(c){var d=parseInt(c[1]);return d}throw new Error("THREE.FBXLoader: Cannot find the version number for the file given.")}function O(a){return a/46186158000}function P(a){for(var b=a.split(","),c=0,d=b.length;c<d;c++)b[c]=parseFloat(b[c]);return b}function Q(b){return new a.Vector3().fromArray(b.value)}function R(b){return new a.Color().fromArray(b.value)}function S(a,b,c){void 0===b&&(b=0),void 0===c&&(c=a.byteLength);var d=new Uint8Array(a,b,c);if(void 0!==window.TextDecoder)return new TextDecoder().decode(d);for(var e="",f=0,g=d.length;f<g;f++)e+=String.fromCharCode(d[f]);return e}function T(a,b){for(var c=0,d=a.length;c<d;c++)if(b(a[c]))return c;return-1}function U(c,a){for(var b=0,d=c.length,e=a.length;b<e;b++,d++)c[d]=a[b]}function V(c,a,b,d){for(var e=b,f=0;e<d;e++,f++)c[f]=a[e];return c}a.FBXLoader=function(b){this.manager=void 0===b?a.DefaultLoadingManager:b},Object.assign(a.FBXLoader.prototype,{load:function(b,c,d,e){var f=this,g=a.Loader.prototype.extractUrlBase(b),h=new a.FileLoader(this.manager);h.setResponseType("arraybuffer"),h.load(b,function(a){try{var d=f.parse(a,g);c(d)}catch(a){window.setTimeout(function(){e&&e(a),f.manager.itemError(b)},0)}},d,e)},parse:function(d,f){var h;if(L(d))h=new I().parse(d);else{var i=S(d);if(!M(i))throw new Error("THREE.FBXLoader: Unknown format.");if(7e3>N(i))throw new Error("THREE.FBXLoader: FBX version not supported, FileVersion: "+N(i));h=new H().parse(i)}var k=b(h),m=c(h),n=e(h,new a.TextureLoader(this.manager).setPath(f),m,k),o=g(h,n,k),p=j(h,k),q=l(h,k,p),r=v(h,k,p,q,o);return r}});var W=[],X={ByPolygonVertex:{Direct:function(a,b,c,d){var e=a*d.dataSize,f=a*d.dataSize+d.dataSize;return V(W,d.buffer,e,f)},IndexToDirect:function(a,b,c,d){var e=d.indices[a],f=e*d.dataSize,g=e*d.dataSize+d.dataSize;return V(W,d.buffer,f,g)}},ByPolygon:{Direct:function(a,b,c,d){var e=b*d.dataSize,f=b*d.dataSize+d.dataSize;return V(W,d.buffer,e,f)},IndexToDirect:function(a,b,c,d){var e=d.indices[b],f=e*d.dataSize,g=e*d.dataSize+d.dataSize;return V(W,d.buffer,f,g)}},ByVertice:{Direct:function(a,b,c,d){var e=c*d.dataSize,f=c*d.dataSize+d.dataSize;return V(W,d.buffer,e,f)}},AllSame:{IndexToDirect:function(a,b,c,d){var e=d.indices[0]*d.dataSize,f=d.indices[0]*d.dataSize+d.dataSize;return V(W,d.buffer,e,f)}}},Y=new a.Euler,Z=new a.Quaternion,$=["x","y","z"];Object.assign(H.prototype,{getPrevNode:function(){return this.nodeStack[this.currentIndent-2]},getCurrentNode:function(){return this.nodeStack[this.currentIndent-1]},getCurrentProp:function(){return this.currentProp},pushStack:function(a){this.nodeStack.push(a),this.currentIndent+=1},popStack:function(){this.nodeStack.pop(),this.currentIndent-=1},setCurrentProp:function(a,b){this.currentProp=a,this.currentPropName=b},parse:function(a){this.currentIndent=0,this.allNodes=new K,this.nodeStack=[],this.currentProp=[],this.currentPropName="";for(var b,c=a.split("\n"),d=0,e=c.length;d<e;d++)if((b=c[d],!b.match(/^[\s\t]*;/))&&!b.match(/^[\s\t]*$/)){var f=new RegExp("^\\t{"+this.currentIndent+"}(\\w+):(.*){",""),g=b.match(f);if(g){for(var h=g[1].trim().replace(/^"/,"").replace(/"$/,""),j=g[2].split(","),k=0,b=j.length;k<b;k++)j[k]=j[k].trim().replace(/^"/,"").replace(/"$/,"");this.parseNodeBegin(b,h,j||null);continue}var i=new RegExp("^\\t{"+this.currentIndent+"}(\\w+):[\\s\\t\\r\\n](.*)"),g=b.match(i);if(g){var l=g[1].replace(/^"/,"").replace(/"$/,"").trim(),m=g[2].replace(/^"/,"").replace(/"$/,"").trim();"Content"===l&&","===m&&(m=c[++d].replace(/"/g,"").replace(/,$/,"").trim()),this.parseNodeProperty(b,l,m);continue}var n=new RegExp("^\\t{"+(this.currentIndent-1)+"}}");if(b.match(n)){this.nodeEnd();continue}b.match(/^[^\s\t}]/)&&this.parseNodePropertyContinued(b)}return this.allNodes},parseNodeBegin:function(a,b,c){var d={name:b,properties:{},subNodes:{}},e=this.parseNodeAttr(c),f=this.getCurrentNode();if(0===this.currentIndent)this.allNodes.add(b,d);else if(b in f.subNodes){var g=f.subNodes[b];this.isFlattenNode(f.subNodes[b])&&(""===e.id?(f.subNodes[b]=[],f.subNodes[b].push(g)):(f.subNodes[b]={},f.subNodes[b][g.id]=g)),""===e.id?f.subNodes[b].push(d):f.subNodes[b][e.id]=d}else"number"===typeof e.id||e.id.match(/^\d+$/)?(f.subNodes[b]={},f.subNodes[b][e.id]=d):f.subNodes[b]=d;c&&(d.id=e.id,d.attrName=e.name,d.attrType=e.type),this.pushStack(d)},parseNodeAttr:function(a){var b=a[0];""!==a[0]&&(b=parseInt(a[0]),isNaN(b)&&(b=a[0]));var c="",d="";return 1<a.length&&(c=a[1].replace(/^(\w+)::/,""),d=a[2]),{id:b,name:c,type:d}},parseNodeProperty:function(a,b,c){var d=this.getCurrentNode(),e=d.name;if(void 0!==e){var f=e.match(/Properties(\d)+/);if(f)return void this.parseNodeSpecialProperty(a,b,c)}if("C"===b){var g=c.split(",").slice(1),h=parseInt(g[0]),i=parseInt(g[1]),j=c.split(",").slice(3);j=j.map(function(a){return a.trim().replace(/^"/,"")}),b="connections",c=[h,i],U(c,j),void 0===d.properties[b]&&(d.properties[b]=[])}if("Node"===b){var k=parseInt(c);d.properties.id=k,d.id=k}b in d.properties?Array.isArray(d.properties[b])?d.properties[b].push(c):d.properties[b]+=c:Array.isArray(d.properties[b])?d.properties[b].push(c):d.properties[b]=c,this.setCurrentProp(d.properties,b),"a"===b&&","!==c.slice(-1)&&(d.properties.a=P(c))},parseNodePropertyContinued:function(a){if(this.currentProp[this.currentPropName]+=a,","!==a.slice(-1)){var b=this.getCurrentNode();b.properties.a=P(b.properties.a)}},parseNodeSpecialProperty:function(a,b,c){for(var d=c.split("\","),e=0,f=d.length;e<f;e++)d[e]=d[e].trim().replace(/^\"/,"").replace(/\s/,"_");var g=d[0],h=d[1],i=d[2],j=d[3],k=d[4];"int"===h||"enum"===h||"bool"===h||"ULongLong"===h?k=parseInt(k):"double"===h||"Number"===h||"FieldOfView"===h?k=parseFloat(k):"ColorRGB"===h||"Vector3D"===h||"Lcl_Translation"===h||"Lcl_Rotation"===h||"Lcl_Scaling"===h?k=P(k):void 0,this.getPrevNode().properties[g]={type:h,type2:i,flag:j,value:k},this.setCurrentProp(this.getPrevNode().properties,g)},nodeEnd:function(){this.popStack()},isFlattenNode:function(a){return"subNodes"in a&&"properties"in a}}),Object.assign(I.prototype,{parse:function(a){var b=new J(a);b.skip(23);var c=b.getUint32();console.log("THREE.FBXLoader: FBX binary version: "+c);for(var d,e=new K;!this.endOfContent(b);)d=this.parseNode(b,c),null!==d&&e.add(d.name,d);return e},endOfContent:function(a){return 0===a.size()%16?(-16&a.getOffset()+160+16)>=a.size():a.getOffset()+160+16>=a.size()},parseNode:function(a,b){var c=7500<=b?a.getUint64():a.getUint32(),d=7500<=b?a.getUint64():a.getUint32(),e=7500<=b?a.getUint64():a.getUint32(),f=a.getUint8(),g=a.getString(f);if(0===c)return null;for(var h=[],j=0;j<d;j++)h.push(this.parseProperty(a));var i=0<h.length?h[0]:"",k=1<h.length?h[1]:"",l=2<h.length?h[2]:"",m={},n={},o=!1;for(1===d&&a.getOffset()===c&&(o=!0);c>a.getOffset();){var p=this.parseNode(a,b);if(null!==p){if(!0===p.singleProperty){var q=p.propertyList[0];Array.isArray(q)?(m[p.name]=p,p.properties.a=q):n[p.name]=q;continue}if("Connections"===g&&"C"===p.name){for(var r=[],j=1,s=p.propertyList.length;j<s;j++)r[j-1]=p.propertyList[j];void 0===n.connections&&(n.connections=[]),n.connections.push(r);continue}if(p.name.match(/^Properties\d+$/)){for(var t,u=Object.keys(p.properties),j=0,s=u.length;j<s;j++)t=u[j],n[t]=p.properties[t];continue}if(g.match(/^Properties\d+$/)&&"P"===p.name){var v,w=p.propertyList[0],x=p.propertyList[1],y=p.propertyList[2],z=p.propertyList[3];0===w.indexOf("Lcl ")&&(w=w.replace("Lcl ","Lcl_")),0===x.indexOf("Lcl ")&&(x=x.replace("Lcl ","Lcl_")),v="ColorRGB"===x||"Vector"===x||"Vector3D"===x||0===x.indexOf("Lcl_")?[p.propertyList[4],p.propertyList[5],p.propertyList[6]]:p.propertyList[4],n[w]={type:x,type2:y,flag:z,value:v};continue}void 0===m[p.name]?"number"===typeof p.id?(m[p.name]={},m[p.name][p.id]=p):m[p.name]=p:""===p.id?(!Array.isArray(m[p.name])&&(m[p.name]=[m[p.name]]),m[p.name].push(p)):void 0===m[p.name][p.id]?m[p.name][p.id]=p:(!Array.isArray(m[p.name][p.id])&&(m[p.name][p.id]=[m[p.name][p.id]]),m[p.name][p.id].push(p))}}return{singleProperty:o,id:i,attrName:k,attrType:l,name:g,properties:n,propertyList:h,subNodes:m}},parseProperty:function(a){var b=a.getChar();switch(b){case"C":return a.getBoolean();case"D":return a.getFloat64();case"F":return a.getFloat32();case"I":return a.getInt32();case"L":return a.getInt64();case"R":var c=a.getUint32();return a.getArrayBuffer(c);case"S":var c=a.getUint32();return a.getString(c);case"Y":return a.getInt16();case"b":case"c":case"d":case"f":case"i":case"l":var d=a.getUint32(),e=a.getUint32(),f=a.getUint32();if(0===e)switch(b){case"b":case"c":return a.getBooleanArray(d);case"d":return a.getFloat64Array(d);case"f":return a.getFloat32Array(d);case"i":return a.getInt32Array(d);case"l":return a.getInt64Array(d);}if(void 0===window.Zlib)throw new Error("THREE.FBXLoader: External library Inflate.min.js required, obtain or import from https://github.com/imaya/zlib.js");var g=new Zlib.Inflate(new Uint8Array(a.getArrayBuffer(f))),h=new J(g.decompress().buffer);switch(b){case"b":case"c":return h.getBooleanArray(d);case"d":return h.getFloat64Array(d);case"f":return h.getFloat32Array(d);case"i":return h.getInt32Array(d);case"l":return h.getInt64Array(d);}default:throw new Error("THREE.FBXLoader: Unknown property type "+b);}}}),Object.assign(J.prototype,{getOffset:function(){return this.offset},size:function(){return this.dv.buffer.byteLength},skip:function(a){this.offset+=a},getBoolean:function(){return 1===(1&this.getUint8())},getBooleanArray:function(b){for(var c=[],a=0;a<b;a++)c.push(this.getBoolean());return c},getInt8:function(){var a=this.dv.getInt8(this.offset);return this.offset+=1,a},getInt8Array:function(b){for(var c=[],a=0;a<b;a++)c.push(this.getInt8());return c},getUint8:function(){var a=this.dv.getUint8(this.offset);return this.offset+=1,a},getUint8Array:function(b){for(var c=[],a=0;a<b;a++)c.push(this.getUint8());return c},getInt16:function(){var a=this.dv.getInt16(this.offset,this.littleEndian);return this.offset+=2,a},getInt16Array:function(b){for(var c=[],a=0;a<b;a++)c.push(this.getInt16());return c},getUint16:function(){var a=this.dv.getUint16(this.offset,this.littleEndian);return this.offset+=2,a},getUint16Array:function(b){for(var c=[],a=0;a<b;a++)c.push(this.getUint16());return c},getInt32:function(){var a=this.dv.getInt32(this.offset,this.littleEndian);return this.offset+=4,a},getInt32Array:function(b){for(var c=[],a=0;a<b;a++)c.push(this.getInt32());return c},getUint32:function(){var a=this.dv.getUint32(this.offset,this.littleEndian);return this.offset+=4,a},getUint32Array:function(b){for(var c=[],a=0;a<b;a++)c.push(this.getUint32());return c},getInt64:function(){var a,b;return this.littleEndian?(a=this.getUint32(),b=this.getUint32()):(b=this.getUint32(),a=this.getUint32()),2147483648&b?(b=4294967295&~b,a=4294967295&~a,4294967295===a&&(b=4294967295&b+1),a=4294967295&a+1,-(4294967296*b+a)):4294967296*b+a},getInt64Array:function(b){for(var c=[],a=0;a<b;a++)c.push(this.getInt64());return c},getUint64:function(){var a,b;return this.littleEndian?(a=this.getUint32(),b=this.getUint32()):(b=this.getUint32(),a=this.getUint32()),4294967296*b+a},getUint64Array:function(b){for(var c=[],a=0;a<b;a++)c.push(this.getUint64());return c},getFloat32:function(){var a=this.dv.getFloat32(this.offset,this.littleEndian);return this.offset+=4,a},getFloat32Array:function(b){for(var c=[],a=0;a<b;a++)c.push(this.getFloat32());return c},getFloat64:function(){var a=this.dv.getFloat64(this.offset,this.littleEndian);return this.offset+=8,a},getFloat64Array:function(b){for(var c=[],a=0;a<b;a++)c.push(this.getFloat64());return c},getArrayBuffer:function(a){var b=this.dv.buffer.slice(this.offset,this.offset+a);return this.offset+=a,b},getChar:function(){return String.fromCharCode(this.getUint8())},getString:function(a){for(var b,c="";0<a&&(b=this.getUint8(),a--,0!==b);)c+=String.fromCharCode(b);return c=decodeURIComponent(escape(c)),this.skip(a),c}}),Object.assign(K.prototype,{add:function(a,b){this[a]=b}})},a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2/libs/pmrem/PMREMGenerator",[],function(a){return a.exports=function(a){a.PMREMGenerator=function(b,c,d){this.sourceTexture=b,this.resolution=void 0===d?256:d,this.samplesPerLevel=void 0===c?16:c;var e=b.encoding===a.LinearEncoding||b.encoding===a.GammaEncoding||b.encoding===a.sRGBEncoding;this.sourceTexture.minFilter=e?a.LinearFilter:a.NearestFilter,this.sourceTexture.magFilter=e?a.LinearFilter:a.NearestFilter,this.sourceTexture.generateMipmaps=this.sourceTexture.generateMipmaps&&e,this.cubeLods=[];var f=this.resolution,g={format:this.sourceTexture.format,magFilter:this.sourceTexture.magFilter,minFilter:this.sourceTexture.minFilter,type:this.sourceTexture.type,generateMipmaps:this.sourceTexture.generateMipmaps,anisotropy:this.sourceTexture.anisotropy,encoding:this.sourceTexture.encoding};this.numLods=Math.log(f)/Math.log(2)-2;for(var h,j=0;j<this.numLods;j++)h=new a.WebGLRenderTargetCube(f,f,g),h.texture.name="PMREMGenerator.cube"+j,this.cubeLods.push(h),f=Math.max(16,f/2);this.camera=new a.OrthographicCamera(-1,1,1,-1,0,1e3),this.shader=this.getShader(),this.shader.defines.SAMPLES_PER_LEVEL=this.samplesPerLevel,this.planeMesh=new a.Mesh(new a.PlaneBufferGeometry(2,2,0),this.shader),this.planeMesh.material.side=a.DoubleSide,this.scene=new a.Scene,this.scene.add(this.planeMesh),this.scene.add(this.camera),this.shader.uniforms.envMap.value=this.sourceTexture,this.shader.envMap=this.sourceTexture},a.PMREMGenerator.prototype={constructor:a.PMREMGenerator,update:function(b){this.shader.uniforms.envMap.value=this.sourceTexture,this.shader.envMap=this.sourceTexture;var c=b.gammaInput,d=b.gammaOutput,e=b.toneMapping,f=b.toneMappingExposure,g=b.getRenderTarget();b.toneMapping=a.LinearToneMapping,b.toneMappingExposure=1,b.gammaInput=!1,b.gammaOutput=!1;for(var h,j=0;j<this.numLods;j++){h=j/(this.numLods-1),this.shader.uniforms.roughness.value=0.9*h,this.shader.uniforms.queryScale.value.x=0==j?-1:1;var i=this.cubeLods[j].width;this.shader.uniforms.mapSize.value=i,this.renderToCubeMapTarget(b,this.cubeLods[j]),5>j&&(this.shader.uniforms.envMap.value=this.cubeLods[j].texture)}b.setRenderTarget(g),b.toneMapping=e,b.toneMappingExposure=f,b.gammaInput=c,b.gammaOutput=d},renderToCubeMapTarget:function(a,b){for(var c=0;6>c;c++)this.renderToCubeMapTargetFace(a,b,c)},renderToCubeMapTargetFace:function(a,b,c){b.activeCubeFace=c,this.shader.uniforms.faceIndex.value=c,a.render(this.scene,this.camera,b,!0)},getShader:function(){var b=new a.ShaderMaterial({defines:{SAMPLES_PER_LEVEL:20},uniforms:{faceIndex:{value:0},roughness:{value:0.5},mapSize:{value:0.5},envMap:{value:null},queryScale:{value:new a.Vector3(1,1,1)},testColor:{value:new a.Vector3(1,1,1)}},vertexShader:"varying vec2 vUv;\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvUv = uv;\n\t\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\n\t\t\t\t\t}",fragmentShader:"#include <common>\n\t\t\t\t\tvarying vec2 vUv;\n\t\t\t\t\tuniform int faceIndex;\n\t\t\t\t\tuniform float roughness;\n\t\t\t\t\tuniform samplerCube envMap;\n\t\t\t\t\tuniform float mapSize;\n\t\t\t\t\tuniform vec3 testColor;\n\t\t\t\t\tuniform vec3 queryScale;\n\t\t\t\t\t\n\t\t\t\t\tfloat GGXRoughnessToBlinnExponent( const in float ggxRoughness ) {\n\t\t\t\t\t\tfloat a = ggxRoughness + 0.0001;\n\t\t\t\t\t\ta *= a;\n\t\t\t\t\t\treturn ( 2.0 / a - 2.0 );\n\t\t\t\t\t}\n\t\t\t\t\tvec3 ImportanceSamplePhong(vec2 uv, mat3 vecSpace, float specPow) {\n\t\t\t\t\t\tfloat phi = uv.y * 2.0 * PI;\n\t\t\t\t\t\tfloat cosTheta = pow(1.0 - uv.x, 1.0 / (specPow + 1.0));\n\t\t\t\t\t\tfloat sinTheta = sqrt(1.0 - cosTheta * cosTheta);\n\t\t\t\t\t\tvec3 sampleDir = vec3(cos(phi) * sinTheta, sin(phi) * sinTheta, cosTheta);\n\t\t\t\t\t\treturn vecSpace * sampleDir;\n\t\t\t\t\t}\n\t\t\t\t\tvec3 ImportanceSampleGGX( vec2 uv, mat3 vecSpace, float Roughness )\n\t\t\t\t\t{\n\t\t\t\t\t\tfloat a = Roughness * Roughness;\n\t\t\t\t\t\tfloat Phi = 2.0 * PI * uv.x;\n\t\t\t\t\t\tfloat CosTheta = sqrt( (1.0 - uv.y) / ( 1.0 + (a*a - 1.0) * uv.y ) );\n\t\t\t\t\t\tfloat SinTheta = sqrt( 1.0 - CosTheta * CosTheta );\n\t\t\t\t\t\treturn vecSpace * vec3(SinTheta * cos( Phi ), SinTheta * sin( Phi ), CosTheta);\n\t\t\t\t\t}\n\t\t\t\t\tmat3 matrixFromVector(vec3 n) {\n\t\t\t\t\t\tfloat a = 1.0 / (1.0 + n.z);\n\t\t\t\t\t\tfloat b = -n.x * n.y * a;\n\t\t\t\t\t\tvec3 b1 = vec3(1.0 - n.x * n.x * a, b, -n.x);\n\t\t\t\t\t\tvec3 b2 = vec3(b, 1.0 - n.y * n.y * a, -n.y);\n\t\t\t\t\t\treturn mat3(b1, b2, n);\n\t\t\t\t\t}\n\t\t\t\t\t\n\t\t\t\t\tvec4 testColorMap(float Roughness) {\n\t\t\t\t\t\tvec4 color;\n\t\t\t\t\t\tif(faceIndex == 0)\n\t\t\t\t\t\t\tcolor = vec4(1.0,0.0,0.0,1.0);\n\t\t\t\t\t\telse if(faceIndex == 1)\n\t\t\t\t\t\t\tcolor = vec4(0.0,1.0,0.0,1.0);\n\t\t\t\t\t\telse if(faceIndex == 2)\n\t\t\t\t\t\t\tcolor = vec4(0.0,0.0,1.0,1.0);\n\t\t\t\t\t\telse if(faceIndex == 3)\n\t\t\t\t\t\t\tcolor = vec4(1.0,1.0,0.0,1.0);\n\t\t\t\t\t\telse if(faceIndex == 4)\n\t\t\t\t\t\t\tcolor = vec4(0.0,1.0,1.0,1.0);\n\t\t\t\t\t\telse\n\t\t\t\t\t\t\tcolor = vec4(1.0,0.0,1.0,1.0);\n\t\t\t\t\t\tcolor *= ( 1.0 - Roughness );\n\t\t\t\t\t\treturn color;\n\t\t\t\t\t}\n\t\t\t\t\tvoid main() {\n\t\t\t\t\t\tvec3 sampleDirection;\n\t\t\t\t\t\tvec2 uv = vUv*2.0 - 1.0;\n\t\t\t\t\t\tfloat offset = -1.0/mapSize;\n\t\t\t\t\t\tconst float a = -1.0;\n\t\t\t\t\t\tconst float b = 1.0;\n\t\t\t\t\t\tfloat c = -1.0 + offset;\n\t\t\t\t\t\tfloat d = 1.0 - offset;\n\t\t\t\t\t\tfloat bminusa = b - a;\n\t\t\t\t\t\tuv.x = (uv.x - a)/bminusa * d - (uv.x - b)/bminusa * c;\n\t\t\t\t\t\tuv.y = (uv.y - a)/bminusa * d - (uv.y - b)/bminusa * c;\n\t\t\t\t\t\tif (faceIndex==0) {\n\t\t\t\t\t\t\tsampleDirection = vec3(1.0, -uv.y, -uv.x);\n\t\t\t\t\t\t} else if (faceIndex==1) {\n\t\t\t\t\t\t\tsampleDirection = vec3(-1.0, -uv.y, uv.x);\n\t\t\t\t\t\t} else if (faceIndex==2) {\n\t\t\t\t\t\t\tsampleDirection = vec3(uv.x, 1.0, uv.y);\n\t\t\t\t\t\t} else if (faceIndex==3) {\n\t\t\t\t\t\t\tsampleDirection = vec3(uv.x, -1.0, -uv.y);\n\t\t\t\t\t\t} else if (faceIndex==4) {\n\t\t\t\t\t\t\tsampleDirection = vec3(uv.x, -uv.y, 1.0);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tsampleDirection = vec3(-uv.x, -uv.y, -1.0);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tmat3 vecSpace = matrixFromVector(normalize(sampleDirection * queryScale));\n\t\t\t\t\t\tvec3 rgbColor = vec3(0.0);\n\t\t\t\t\t\tconst int NumSamples = SAMPLES_PER_LEVEL;\n\t\t\t\t\t\tvec3 vect;\n\t\t\t\t\t\tfloat weight = 0.0;\n\t\t\t\t\t\tfor( int i = 0; i < NumSamples; i ++ ) {\n\t\t\t\t\t\t\tfloat sini = sin(float(i));\n\t\t\t\t\t\t\tfloat cosi = cos(float(i));\n\t\t\t\t\t\t\tfloat r = rand(vec2(sini, cosi));\n\t\t\t\t\t\t\tvect = ImportanceSampleGGX(vec2(float(i) / float(NumSamples), r), vecSpace, roughness);\n\t\t\t\t\t\t\tfloat dotProd = dot(vect, normalize(sampleDirection));\n\t\t\t\t\t\t\tweight += dotProd;\n\t\t\t\t\t\t\tvec3 color = envMapTexelToLinear(textureCube(envMap,vect)).rgb;\n\t\t\t\t\t\t\trgbColor.rgb += color;\n\t\t\t\t\t\t}\n\t\t\t\t\t\trgbColor /= float(NumSamples);\n\t\t\t\t\t\t//rgbColor = testColorMap( roughness ).rgb;\n\t\t\t\t\t\tgl_FragColor = linearToOutputTexel( vec4( rgbColor, 1.0 ) );\n\t\t\t\t\t}",blending:a.NoBlending});return b.type="PMREMGenerator",b},dispose:function(){for(var a=0,b=this.cubeLods.length;a<b;a++)this.cubeLods[a].dispose();this.planeMesh.geometry.dispose(),this.planeMesh.material.dispose()}}},a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2/libs/DRACOLoader",[],function(a){return a.exports=function(a){a.DRACOLoader=function(b){this.timeLoaded=0,this.manager=b||a.DefaultLoadingManager,this.materials=null,this.verbosity=0,this.attributeOptions={},this.drawMode=a.TrianglesDrawMode,this.nativeAttributeMap={position:"POSITION",normal:"NORMAL",color:"COLOR",uv:"TEX_COORD"}},a.DRACOLoader.prototype={constructor:a.DRACOLoader,load:function(b,c,d,e){var f=this,g=new a.FileLoader(f.manager);g.setPath(this.path),g.setResponseType("arraybuffer"),void 0!==this.crossOrigin&&(g.crossOrigin=this.crossOrigin),g.load(b,function(a){f.decodeDracoFile(a,c)},d,e)},setPath:function(a){return this.path=a,this},setCrossOrigin:function(a){return this.crossOrigin=a,this},setVerbosity:function(a){return this.verbosity=a,this},setDrawMode:function(a){return this.drawMode=a,this},setSkipDequantization:function(a,b){var c=!0;return"undefined"!==typeof b&&(c=b),this.getAttributeOptions(a).skipDequantization=c,this},decodeDracoFile:function(b,c,d,e){var f=this;a.DRACOLoader.getDecoderModule().then(function(a){f.decodeDracoFileInternal(b,a.decoder,c,d||{},e||{})})},decodeDracoFileInternal:function(a,b,c,d,e){var f=new b.DecoderBuffer;f.Init(new Int8Array(a),a.byteLength);var g=new b.Decoder,h=g.GetEncodedGeometryType(f);if(h==b.TRIANGULAR_MESH)0<this.verbosity&&console.log("Loaded a mesh.");else if(h==b.POINT_CLOUD)0<this.verbosity&&console.log("Loaded a point cloud.");else{var i="THREE.DRACOLoader: Unknown geometry type.";throw console.error(i),new Error(i)}c(this.convertDracoGeometryTo3JS(b,g,h,f,d,e))},addAttributeToGeometry:function(b,c,d,e,f,g,h,j){if(0===g.ptr){var k="THREE.DRACOLoader: No attribute "+e;throw console.error(k),new Error(k)}var l,m,n=g.num_components(),o=d.num_points(),p=o*n;switch(f){case Float32Array:l=new b.DracoFloat32Array,c.GetAttributeFloatForAllPoints(d,g,l),j[e]=new Float32Array(p),m=a.Float32BufferAttribute;break;case Int8Array:l=new b.DracoInt8Array,c.GetAttributeInt8ForAllPoints(d,g,l),j[e]=new Int8Array(p),m=a.Int8BufferAttribute;break;case Int16Array:l=new b.DracoInt16Array,c.GetAttributeInt16ForAllPoints(d,g,l),j[e]=new Int16Array(p),m=a.Int16BufferAttribute;break;case Int32Array:l=new b.DracoInt32Array,c.GetAttributeInt32ForAllPoints(d,g,l),j[e]=new Int32Array(p),m=a.Int32BufferAttribute;break;case Uint8Array:l=new b.DracoUInt8Array,c.GetAttributeUInt8ForAllPoints(d,g,l),j[e]=new Uint8Array(p),m=a.Uint8BufferAttribute;break;case Uint16Array:l=new b.DracoUInt16Array,c.GetAttributeUInt16ForAllPoints(d,g,l),j[e]=new Uint16Array(p),m=a.Uint16BufferAttribute;break;case Uint32Array:l=new b.DracoUInt32Array,c.GetAttributeUInt32ForAllPoints(d,g,l),j[e]=new Uint32Array(p),m=a.Uint32BufferAttribute;break;default:var k="THREE.DRACOLoader: Unexpected attribute type.";throw console.error(k),new Error(k);}for(var q=0;q<p;q++)j[e][q]=l.GetValue(q);h.addAttribute(e,new m(j[e],n)),b.destroy(l)},convertDracoGeometryTo3JS:function(b,c,d,e,f,g){!0===this.getAttributeOptions("position").skipDequantization&&c.SkipAttributeTransform(b.POSITION);var h,j;const k=performance.now();if(d===b.TRIANGULAR_MESH?(h=new b.Mesh,j=c.DecodeBufferToMesh(e,h)):(h=new b.PointCloud,j=c.DecodeBufferToPointCloud(e,h)),!j.ok()||0==h.ptr){var l="THREE.DRACOLoader: Decoding failed: ";throw l+=j.error_msg(),console.error(l),b.destroy(c),b.destroy(h),new Error(l)}var m=performance.now();b.destroy(e);var n;d==b.TRIANGULAR_MESH?(n=h.num_faces(),0<this.verbosity&&console.log("Number of faces loaded: "+n.toString())):n=0;var o=h.num_points(),p=h.num_attributes();0<this.verbosity&&(console.log("Number of points loaded: "+o.toString()),console.log("Number of attributes loaded: "+p.toString()));var q=c.GetAttributeId(h,b.POSITION);if(-1==q){var l="THREE.DRACOLoader: No position attribute found.";throw console.error(l),b.destroy(c),b.destroy(h),new Error(l)}var r=c.GetAttribute(h,q),s={},t=new a.BufferGeometry;for(var u in this.nativeAttributeMap)if(void 0===f[u]){var v=c.GetAttributeId(h,b[this.nativeAttributeMap[u]]);if(-1!==v){0<this.verbosity&&console.log("Loaded "+u+" attribute.");var w=c.GetAttribute(h,v);this.addAttributeToGeometry(b,c,h,u,Float32Array,w,t,s)}}for(var u in f){var x=g[u]||Float32Array,y=f[u],w=c.GetAttributeByUniqueId(h,y);this.addAttributeToGeometry(b,c,h,u,x,w,t,s)}if(d==b.TRIANGULAR_MESH)if(this.drawMode===a.TriangleStripDrawMode){var z=new b.DracoInt32Array,A=c.GetTriangleStripsFromMesh(h,z);s.indices=new Uint32Array(z.size());for(var B=0;B<z.size();++B)s.indices[B]=z.GetValue(B);b.destroy(z)}else{var i=3*n;s.indices=new Uint32Array(i);for(var C=new b.DracoInt32Array,B=0;B<n;++B){c.GetFaceFromMesh(h,B,C);var D=3*B;s.indices[D]=C.GetValue(0),s.indices[D+1]=C.GetValue(1),s.indices[D+2]=C.GetValue(2)}b.destroy(C)}t.drawMode=this.drawMode,d==b.TRIANGULAR_MESH&&t.setIndex(new(65535<s.indices.length?a.Uint32BufferAttribute:a.Uint16BufferAttribute)(s.indices,1));var E=new b.AttributeQuantizationTransform;if(E.InitFromAttribute(r)){t.attributes.position.isQuantized=!0,t.attributes.position.maxRange=E.range(),t.attributes.position.numQuantizationBits=E.quantization_bits(),t.attributes.position.minValues=new Float32Array(3);for(var B=0;3>B;++B)t.attributes.position.minValues[B]=E.min_value(B)}return b.destroy(E),b.destroy(c),b.destroy(h),this.decode_time=m-k,this.import_time=performance.now()-m,0<this.verbosity&&(console.log("Decode time: "+this.decode_time),console.log("Import time: "+this.import_time)),t},isVersionSupported:function(b,c){a.DRACOLoader.getDecoderModule().then(function(a){c(a.decoder.isVersionSupported(b))})},getAttributeOptions:function(a){return"undefined"===typeof this.attributeOptions[a]&&(this.attributeOptions[a]={}),this.attributeOptions[a]}},a.DRACOLoader.decoderPath="./",a.DRACOLoader.decoderConfig={},a.DRACOLoader.decoderModulePromise=null,a.DRACOLoader.setDecoderPath=function(b){a.DRACOLoader.decoderPath=b},a.DRACOLoader.setDecoderConfig=function(b){var c=a.DRACOLoader.decoderConfig.wasmBinary;a.DRACOLoader.decoderConfig=b||{},a.DRACOLoader.releaseDecoderModule(),c&&(a.DRACOLoader.decoderConfig.wasmBinary=c)},a.DRACOLoader.releaseDecoderModule=function(){a.DRACOLoader.decoderModulePromise=null},a.DRACOLoader.getDecoderModule=function(){var b=this,c=a.DRACOLoader.decoderPath,d=a.DRACOLoader.decoderConfig,e=a.DRACOLoader.decoderModulePromise;return e?e:("undefined"===typeof DracoDecoderModule?"object"!==typeof WebAssembly||"js"===d.type?e=a.DRACOLoader._loadScript(c+"draco_decoder.js"):(d.wasmBinaryFile=c+"draco_decoder.wasm",e=a.DRACOLoader._loadScript(c+"draco_wasm_wrapper.js").then(function(){return a.DRACOLoader._loadArrayBuffer(d.wasmBinaryFile)}).then(function(a){d.wasmBinary=a})):e=Promise.resolve(),e=e.then(function(){return new Promise(function(a){d.onModuleLoaded=function(c){b.timeLoaded=performance.now(),a({decoder:c})},DracoDecoderModule(d)})}),a.DRACOLoader.decoderModulePromise=e,e)},a.DRACOLoader._loadScript=function(a){var b=document.getElementById("decoder_script");null!==b&&b.parentNode.removeChild(b);var c=document.getElementsByTagName("head")[0],d=document.createElement("script");return d.id="decoder_script",d.type="text/javascript",d.src=a,new Promise(function(a){d.onload=a,c.appendChild(d)})},a.DRACOLoader._loadArrayBuffer=function(b){var c=new a.FileLoader;return c.setResponseType("arraybuffer"),new Promise(function(a,d){c.load(b,a,void 0,d)})}},a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2/libs/pmrem/PMREMCubeUVPacker",[],function(a){return a.exports=function(a){a.PMREMCubeUVPacker=function(b){this.cubeLods=b;var d=4*b[0].width,e=b[0].texture,f={format:e.format,magFilter:e.magFilter,minFilter:e.minFilter,type:e.type,generateMipmaps:e.generateMipmaps,anisotropy:e.anisotropy,encoding:e.encoding===a.RGBEEncoding?a.RGBM16Encoding:e.encoding};f.encoding===a.RGBM16Encoding&&(f.magFilter=a.LinearFilter,f.minFilter=a.LinearFilter),this.CubeUVRenderTarget=new a.WebGLRenderTarget(d,d,f),this.CubeUVRenderTarget.texture.name="PMREMCubeUVPacker.cubeUv",this.CubeUVRenderTarget.texture.mapping=a.CubeUVReflectionMapping,this.camera=new a.OrthographicCamera(0.5*-d,0.5*d,0.5*-d,0.5*d,0,1),this.scene=new a.Scene,this.objects=[];var g=new a.PlaneBufferGeometry(1,1),h=[];h.push(new a.Vector2(0,0)),h.push(new a.Vector2(1,0)),h.push(new a.Vector2(2,0)),h.push(new a.Vector2(0,1)),h.push(new a.Vector2(1,1)),h.push(new a.Vector2(2,1));var l=d;d=b[0].width;var m=0,n=4;this.numLods=Math.log(b[0].width)/Math.log(2)-2;for(var c,o=0;o<this.numLods;o++){c=0.5*(l-l/n),16<d&&(n*=2);for(var i=16<d?6:1,p=0,q=0,r=d,s=0;s<i;s++){for(var j,t=0;6>t;t++){j=this.getShader(),j.uniforms.envMap.value=this.cubeLods[o].texture,j.envMap=this.cubeLods[o].texture,j.uniforms.faceIndex.value=t,j.uniforms.mapSize.value=r;var k=new a.Mesh(g,j);k.position.x=h[t].x*r-c+p,k.position.y=h[t].y*r-c+m+q,k.material.side=a.BackSide,k.scale.setScalar(r),this.scene.add(k),this.objects.push(k)}q+=1.75*r,p+=1.25*r,r/=2}m+=2*d,16<d&&(d/=2)}},a.PMREMCubeUVPacker.prototype={constructor:a.PMREMCubeUVPacker,update:function(b){var c=b.gammaInput,d=b.gammaOutput,e=b.toneMapping,f=b.toneMappingExposure,g=b.getRenderTarget();b.gammaInput=!1,b.gammaOutput=!1,b.toneMapping=a.LinearToneMapping,b.toneMappingExposure=1,b.render(this.scene,this.camera,this.CubeUVRenderTarget,!1),b.setRenderTarget(g),b.toneMapping=e,b.toneMappingExposure=f,b.gammaInput=c,b.gammaOutput=d},getShader:function(){var b=new a.ShaderMaterial({uniforms:{faceIndex:{value:0},mapSize:{value:0},envMap:{value:null},testColor:{value:new a.Vector3(1,1,1)}},vertexShader:"precision highp float;\t\t\t\t\tvarying vec2 vUv;\t\t\t\t\tvoid main() {\t\t\t\t\t\tvUv = uv;\t\t\t\t\t\tgl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );\t\t\t\t\t}",fragmentShader:"precision highp float;\t\t\t\t\tvarying vec2 vUv;\t\t\t\t\tuniform samplerCube envMap;\t\t\t\t\tuniform float mapSize;\t\t\t\t\tuniform vec3 testColor;\t\t\t\t\tuniform int faceIndex;\t\t\t\t\t\t\t\t\t\tvoid main() {\t\t\t\t\t\tvec3 sampleDirection;\t\t\t\t\t\tvec2 uv = vUv;\t\t\t\t\t\tuv = uv * 2.0 - 1.0;\t\t\t\t\t\tuv.y *= -1.0;\t\t\t\t\t\tif(faceIndex == 0) {\t\t\t\t\t\t\tsampleDirection = normalize(vec3(1.0, uv.y, -uv.x));\t\t\t\t\t\t} else if(faceIndex == 1) {\t\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, 1.0, uv.y));\t\t\t\t\t\t} else if(faceIndex == 2) {\t\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, uv.y, 1.0));\t\t\t\t\t\t} else if(faceIndex == 3) {\t\t\t\t\t\t\tsampleDirection = normalize(vec3(-1.0, uv.y, uv.x));\t\t\t\t\t\t} else if(faceIndex == 4) {\t\t\t\t\t\t\tsampleDirection = normalize(vec3(uv.x, -1.0, -uv.y));\t\t\t\t\t\t} else {\t\t\t\t\t\t\tsampleDirection = normalize(vec3(-uv.x, uv.y, -1.0));\t\t\t\t\t\t}\t\t\t\t\t\tvec4 color = envMapTexelToLinear( textureCube( envMap, sampleDirection ) );\t\t\t\t\t\tgl_FragColor = linearToOutputTexel( color );\t\t\t\t\t}",blending:a.NoBlending});return b.type="PMREMCubeUVPacker",b},dispose:function(){for(var a=0,b=this.objects.length;a<b;a++)this.objects[a].material.dispose();this.objects[0].geometry.dispose()}}},a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2/libs/HDRCubeTextureLoader",[],function(a){return a.exports=function(a){a.HDRCubeTextureLoader=function(b){this.manager=void 0===b?a.DefaultLoadingManager:b,this.hdrLoader=new a.RGBELoader},a.HDRCubeTextureLoader.prototype.load=function(b,c,d,e,f){function g(d,e,f,g){var i=new a.FileLoader(this.manager);i.setResponseType("arraybuffer"),i.load(c[d],function(c){n++;var f=m._parser(c);if(f){if(b===a.FloatType){for(var g=3*(f.data.length/4),i=new Float32Array(g),o=0;o<g;o++)h(f.data,4*o,i,3*o);f.data=i}else if(b===a.HalfFloatType){for(var g=3*(f.data.length/4),j=new Uint16Array(g),o=0;o<g;o++)k(f.data,4*o,j,3*o);f.data=j}if(void 0!==f.image)l[d].images=f.image;else if(void 0!==f.data){var p=new a.DataTexture(f.data,f.width,f.height);p.format=l.format,p.type=l.type,p.encoding=l.encoding,p.minFilter=l.minFilter,p.magFilter=l.magFilter,p.generateMipmaps=l.generateMipmaps,l.images[d]=p}6===n&&(l.needsUpdate=!0,e&&e(l))}},f,g)}var h=function(a,b,c,d){var f=a[b+3],e=Math.pow(2,f-128)/255;c[d+0]=a[b+0]*e,c[d+1]=a[b+1]*e,c[d+2]=a[b+2]*e},k=function(){function a(a){b[0]=a;var d=c[0],f=32768&d>>16,g=2047&d>>12,h=255&d>>23;return 103>h?f:142<h?(f|=31744,f|=(255==h?0:1)&&8388607&d,f):113>h?(g|=2048,f|=(g>>114-h)+(1&g>>113-h),f):(f|=h-112<<10|g>>1,f+=1&g,f)}var b=new Float32Array(1),c=new Int32Array(b.buffer);return function(b,c,d,f){var g=b[c+3],e=Math.pow(2,g-128)/255;d[f+0]=a(b[c+0]*e),d[f+1]=a(b[c+1]*e),d[f+2]=a(b[c+2]*e)}}(),l=new a.CubeTexture;l.type=b,l.encoding=b===a.UnsignedByteType?a.RGBEEncoding:a.LinearEncoding,l.format=b===a.UnsignedByteType?a.RGBAFormat:a.RGBFormat,l.minFilter=l.encoding===a.RGBEEncoding?a.NearestFilter:a.LinearFilter,l.magFilter=l.encoding===a.RGBEEncoding?a.NearestFilter:a.LinearFilter,l.generateMipmaps=l.encoding!==a.RGBEEncoding,l.anisotropy=0;for(var m=this.hdrLoader,n=0,j=0;j<c.length;j++)g(j,d,e,f);return l}},a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2/libs/ColladaLoader2",[],function(a){return a.exports=function(e){e.ColladaLoader=function(a){this.manager=void 0===a?e.DefaultLoadingManager:a},e.ColladaLoader.prototype={constructor:e.ColladaLoader,load:function(a,b,c,d){var f=this,g=new e.FileLoader(f.manager);g.load(a,function(a){b(f.parse(a))},c,d)},options:{set convertUpAxis(a){console.log("ColladaLoder.options.convertUpAxis: TODO")}},setCrossOrigin:function(a){this.crossOrigin=a},parse:function(a){function b(a,b){for(var c,d=[],e=a.childNodes,f=0,g=e.length;f<g;f++)c=e[f],c.nodeName===b&&d.push(c);return d}function c(a){if(0===a.length)return[];for(var b=a.trim().split(/\s+/),c=Array(b.length),d=0,e=b.length;d<e;d++)c[d]=parseFloat(b[d]);return c}function d(a){if(0===a.length)return[];for(var b=a.trim().split(/\s+/),c=Array(b.length),d=0,e=b.length;d<e;d++)c[d]=parseInt(b[d]);return c}function f(a){return a.substring(1)}function g(a){return void 0===a?1:parseFloat(a.getAttribute("meter"))}function h(a){return void 0===a?"Y_UP":a.textContent}function i(a,c,d,e){var f=b(a,c)[0];if(void 0!==f)for(var g=b(f,d),h=0;h<g.length;h++)e(g[h])}function j(a,b){for(var c in a){var d=a[c];d.build=b(a[c])}}function k(a,b){return void 0===a.build?(a.build=b(a),a.build):a.build}function l(a){return void 0===a.build?new Image:a.build}function m(a){return k(ca.images[a],l)}function n(a){for(var b,c={surfaces:{},samplers:{}},d=0,e=a.childNodes.length;d<e;d++)if(b=a.childNodes[d],1===b.nodeType)switch(b.nodeName){case"newparam":o(b,c);break;case"technique":c.technique=r(b);}return c}function o(a,b){for(var c,d=a.getAttribute("sid"),e=0,f=a.childNodes.length;e<f;e++)if(c=a.childNodes[e],1===c.nodeType)switch(c.nodeName){case"surface":b.surfaces[d]=p(c);break;case"sampler2D":b.samplers[d]=q(c);}}function p(a){for(var b,c={},d=0,e=a.childNodes.length;d<e;d++)if(b=a.childNodes[d],1===b.nodeType)switch(b.nodeName){case"init_from":c.init_from=b.textContent;}return c}function q(a){for(var b,c={},d=0,e=a.childNodes.length;d<e;d++)if(b=a.childNodes[d],1===b.nodeType)switch(b.nodeName){case"source":c.source=b.textContent;}return c}function r(a){for(var b,c={},d=0,e=a.childNodes.length;d<e;d++)if(b=a.childNodes[d],1===b.nodeType)switch(b.nodeName){case"constant":case"lambert":case"blinn":case"phong":c.type=b.nodeName,c.parameters=s(b);}return c}function s(a){for(var b,c={},d=0,e=a.childNodes.length;d<e;d++)if(b=a.childNodes[d],1===b.nodeType)switch(b.nodeName){case"emission":case"diffuse":case"specular":case"shininess":case"transparent":case"transparency":c[b.nodeName]=t(b);}return c}function t(a){for(var b,d={},e=0,f=a.childNodes.length;e<f;e++)if(b=a.childNodes[e],1===b.nodeType)switch(b.nodeName){case"color":d[b.nodeName]=c(b.textContent);break;case"float":d[b.nodeName]=parseFloat(b.textContent);break;case"texture":d[b.nodeName]={id:b.getAttribute("texture"),extra:u(b)};}return d}function u(a){for(var b,c={},d=0,e=a.childNodes.length;d<e;d++)if(b=a.childNodes[d],1===b.nodeType)switch(b.nodeName){case"extra":c=v(b);}return c}function v(a){for(var b,c={},d=0,e=a.childNodes.length;d<e;d++)if(b=a.childNodes[d],1===b.nodeType)switch(b.nodeName){case"technique":c[b.nodeName]=w(b);}return c}function w(a){for(var b,c={},d=0,e=a.childNodes.length;d<e;d++)if(b=a.childNodes[d],1===b.nodeType)switch(b.nodeName){case"repeatU":case"repeatV":case"offsetU":case"offsetV":c[b.nodeName]=parseFloat(b.textContent);break;case"wrapU":case"wrapV":c[b.nodeName]=parseInt(b.textContent);}return c}function x(a){return a}function y(a){return k(ca.effects[a],x)}function z(a){function b(a){var b=d.profile.samplers[a.id];if(void 0!==b){var c=d.profile.surfaces[b.source],f=new e.Texture(m(c.init_from)),g=a.extra;if(void 0!==g&&void 0!==g.technique){var h=g.technique;f.wrapS=h.wrapU?e.RepeatWrapping:e.ClampToEdgeWrapping,f.wrapT=h.wrapV?e.RepeatWrapping:e.ClampToEdgeWrapping,f.offset.set(h.offsetU,h.offsetV),f.repeat.set(h.repeatU,h.repeatV)}else f.wrapS=e.RepeatWrapping,f.wrapT=e.RepeatWrapping;return f.needsUpdate=!0,f}return console.error("ColladaLoder: Undefined sampler",a.id),null}var c,d=y(a.url),f=d.profile.technique;switch(f.type){case"phong":case"blinn":c=new e.MeshPhongMaterial;break;case"lambert":c=new e.MeshLambertMaterial;break;default:c=new e.MeshBasicMaterial;}c.name=a.name;var g=f.parameters;for(var h in g){var i=g[h];"diffuse"===h?(i.color&&c.color.fromArray(i.color),i.texture&&(c.map=b(i.texture))):"specular"===h?i.color&&c.specular&&c.specular.fromArray(i.color):"shininess"===h?i.float&&c.shininess&&(c.shininess=i.float):"emission"===h?i.color&&c.emissive&&c.emissive.fromArray(i.color):"transparent"===h?c.transparent=!0:"transparency"===h?(void 0!==i.float&&(c.opacity=i.float),c.transparent=!0):void 0}return c}function A(a){return k(ca.materials[a],z)}function B(a){for(var b,c=0;c<a.childNodes.length;c++)switch(b=a.childNodes[c],b.nodeName){case"technique_common":return C(b);}return{}}function C(a){for(var b,c={},d=0;d<a.childNodes.length;d++)switch(b=a.childNodes[d],b.nodeName){case"perspective":case"orthographic":c.technique=b.nodeName,c.parameters=D(b);}return c}function D(a){for(var b,c={},d=0;d<a.childNodes.length;d++)switch(b=a.childNodes[d],b.nodeName){case"xfov":case"yfov":case"xmag":case"ymag":case"znear":case"zfar":case"aspect_ratio":c[b.nodeName]=parseFloat(b.textContent);}return c}function E(a){var b;switch(a.optics.technique){case"perspective":b=new e.PerspectiveCamera(a.optics.parameters.yfov,a.optics.parameters.aspect_ratio,a.optics.parameters.znear,a.optics.parameters.zfar);break;case"orthographic":b=new e.OrthographicCamera;break;default:b=new e.PerspectiveCamera;}return b.name=a.name,b}function F(a){return k(ca.cameras[a],E)}function G(a){for(var b,c={},d=0,e=a.childNodes.length;d<e;d++)if(b=a.childNodes[d],1===b.nodeType)switch(b.nodeName){case"directional":case"point":case"spot":case"ambient":c.technique=b.nodeName,c.parameters=H(b);}return c}function H(a){for(var b,d={},g=0,h=a.childNodes.length;g<h;g++)if(b=a.childNodes[g],1===b.nodeType)switch(b.nodeName){case"color":var i=c(b.textContent);d.color=new e.Color().fromArray(i);break;case"falloff_angle":d.falloffAngle=parseFloat(b.textContent);break;case"quadratic_attenuation":var j=parseFloat(b.textContent);d.distance=j?Math.sqrt(1/j):0;}return d}function I(a){var b;switch(a.technique){case"directional":b=new e.DirectionalLight;break;case"point":b=new e.PointLight;break;case"spot":b=new e.SpotLight;break;case"ambient":b=new e.AmbientLight;}return a.parameters.color&&b.color.copy(a.parameters.color),a.parameters.distance&&(b.distance=a.parameters.distance),b}function J(a){return k(ca.lights[a],I)}function K(a){for(var d,e={array:[],stride:3},f=0;f<a.childNodes.length;f++)if(d=a.childNodes[f],1===d.nodeType)switch(d.nodeName){case"float_array":e.array=c(d.textContent);break;case"technique_common":var g=b(d,"accessor")[0];void 0!==g&&(e.stride=parseInt(g.getAttribute("stride")));break;default:console.log(d);}return e}function L(a){for(var b,c={},d=0;d<a.childNodes.length;d++)b=a.childNodes[d],1===b.nodeType&&(c[b.getAttribute("semantic")]=f(b.getAttribute("source")));return c}function M(a){for(var b,c={type:a.nodeName,material:a.getAttribute("material"),inputs:{},stride:0},e=0,g=a.childNodes.length;e<g;e++)if(b=a.childNodes[e],1===b.nodeType)switch(b.nodeName){case"input":var h=f(b.getAttribute("source")),i=b.getAttribute("semantic"),j=parseInt(b.getAttribute("offset"));c.inputs[i]={id:h,offset:j},c.stride=Math.max(c.stride,j+1);break;case"vcount":c.vcount=d(b.textContent);break;case"p":c.p=d(b.textContent);}return c}function N(a){var b={},c=a.sources,d=a.vertices,f=a.primitives;if(0===f.length)return b;for(var g=0;g<f.length;g++){var h=f[g],i=h.inputs,j=new e.BufferGeometry;for(var k in a.name&&(j.name=a.name),i){var l=i[k];switch(k){case"VERTEX":for(var m in d)j.addAttribute(m.toLowerCase(),O(h,c[d[m]],l.offset));break;case"NORMAL":j.addAttribute("normal",O(h,c[l.id],l.offset));break;case"COLOR":j.addAttribute("color",O(h,c[l.id],l.offset));break;case"TEXCOORD":j.addAttribute("uv",O(h,c[l.id],l.offset));}}var n;switch(h.type){case"lines":n=new e.LineSegments(j,W);break;case"linestrips":n=new e.Line(j,W);break;case"triangles":case"polylist":n=new e.Mesh(j,X);}b[h.material]=n}return b}function O(f,g,h){function j(a){for(var b=k[a+h]*q,c=b+q;b<c;b++)r.push(p[b])}var k=f.p,m=f.stride,n=f.vcount,o=0,p=g.array,q=g.stride,r=[];if(void 0!==f.vcount){for(var s,t=0,u=0,i=n.length;u<i;u++){if(s=n[u],4===s){var l=t+0*m,a=t+1*m,b=t+2*m,c=t+3*m;j(l),j(a),j(c),j(a),j(b),j(c)}else if(3===s){var l=t+0*m,a=t+1*m,b=t+2*m;j(l),j(a),j(b)}else o=Math.max(o,s);t+=m*s}0<o&&console.log("ColladaLoader: Geometry has faces with more than 4 vertices.")}else for(var u=0,i=k.length;u<i;u+=m)j(u);return new e.Float32BufferAttribute(r,q)}function P(a){return k(ca.geometries[a],N)}function Q(a){for(var b,d={name:a.getAttribute("name"),matrix:new e.Matrix4,nodes:[],instanceCameras:[],instanceLights:[],instanceGeometries:[],instanceNodes:[]},g=0;g<a.childNodes.length;g++)if(b=a.childNodes[g],1===b.nodeType)switch(b.nodeName){case"node":b.hasAttribute("id")&&(d.nodes.push(b.getAttribute("id")),Q(b));break;case"instance_camera":d.instanceCameras.push(f(b.getAttribute("url")));break;case"instance_light":d.instanceLights.push(f(b.getAttribute("url")));break;case"instance_geometry":d.instanceGeometries.push(R(b));break;case"instance_node":d.instanceNodes.push(f(b.getAttribute("url")));break;case"matrix":var h=c(b.textContent);d.matrix.multiply(Y.fromArray(h).transpose());break;case"translate":var h=c(b.textContent);Z.fromArray(h),d.matrix.multiply(Y.makeTranslation(Z.x,Z.y,Z.z));break;case"rotate":var h=c(b.textContent),i=e.Math.degToRad(h[3]);d.matrix.multiply(Y.makeRotationAxis(Z.fromArray(h),i));break;case"scale":var h=c(b.textContent);d.matrix.scale(Z.fromArray(h));break;case"extra":break;default:console.log(b);}return a.hasAttribute("id")&&(ca.nodes[a.getAttribute("id")]=d),d}function R(a){for(var b,c={id:f(a.getAttribute("url")),materials:{}},d=0;d<a.childNodes.length;d++)if(b=a.childNodes[d],"bind_material"===b.nodeName){for(var e=b.getElementsByTagName("instance_material"),g=0;g<e.length;g++){var h=e[g],i=h.getAttribute("symbol"),j=h.getAttribute("target");c.materials[i]=f(j)}break}return c}function S(a){for(var b=[],c=a.matrix,d=a.nodes,f=a.instanceCameras,g=a.instanceLights,h=a.instanceGeometries,j=a.instanceNodes,k=0,i=d.length;k<i;k++)b.push(T(d[k]).clone());for(var k=0,i=f.length;k<i;k++)b.push(F(f[k]).clone());for(var k=0,i=g.length;k<i;k++)b.push(J(g[k]).clone());for(var k=0,i=h.length;k<i;k++){var l=h[k],m=P(l.id);for(var n in m){var o=m[n].clone();void 0!==l.materials[n]&&(o.material=A(l.materials[n])),b.push(o)}}for(var k=0,i=j.length;k<i;k++)b.push(T(j[k]).clone());var o;if(0===d.length&&1===b.length)o=b[0];else{o=new e.Group;for(var k=0;k<b.length;k++)o.add(b[k])}return o.name=a.name,c.decompose(o.position,o.quaternion,o.scale),o}function T(a){return k(ca.nodes[a],S)}function U(a){var b=new e.Group;b.name=a.name;for(var c=a.children,d=0;d<c.length;d++)b.add(S(c[d]));return b}function V(a){return k(ca.visualScenes[a],U)}var W=new e.LineBasicMaterial,X=new e.MeshPhongMaterial,Y=new e.Matrix4,Z=new e.Vector3;if(console.time("ColladaLoader"),0===a.length)return{scene:new e.Scene};console.time("ColladaLoader: DOMParser");var $=new DOMParser().parseFromString(a,"application/xml");console.timeEnd("ColladaLoader: DOMParser");var _=b($,"COLLADA")[0],aa=_.getAttribute("version");console.log("ColladaLoader: File version",aa);var ba=function(a){return{unit:g(b(a,"unit")[0]),upAxis:h(b(a,"up_axis")[0])}}(b(_,"asset")[0]),ca={images:{},effects:{},materials:{},cameras:{},lights:{},geometries:{},nodes:{},visualScenes:{}};console.time("ColladaLoader: Parse"),i(_,"library_images","image",function(a){var c={init_from:b(a,"init_from")[0].textContent};ca.images[a.getAttribute("id")]=c}),i(_,"library_effects","effect",function(a){for(var b,c={},d=0,e=a.childNodes.length;d<e;d++)if(b=a.childNodes[d],1===b.nodeType)switch(b.nodeName){case"profile_COMMON":c.profile=n(b);}ca.effects[a.getAttribute("id")]=c}),i(_,"library_materials","material",function(a){for(var b,c={name:a.getAttribute("name")},d=0,e=a.childNodes.length;d<e;d++)if(b=a.childNodes[d],1===b.nodeType)switch(b.nodeName){case"instance_effect":c.url=f(b.getAttribute("url"));}ca.materials[a.getAttribute("id")]=c}),i(_,"library_cameras","camera",function(a){for(var b,c={name:a.getAttribute("name")},d=0,e=a.childNodes.length;d<e;d++)if(b=a.childNodes[d],1===b.nodeType)switch(b.nodeName){case"optics":c.optics=B(b);}ca.cameras[a.getAttribute("id")]=c}),i(_,"library_lights","light",function(a){for(var b,c={},d=0,e=a.childNodes.length;d<e;d++)if(b=a.childNodes[d],1===b.nodeType)switch(b.nodeName){case"technique_common":c=G(b);}ca.lights[a.getAttribute("id")]=c}),i(_,"library_geometries","geometry",function(a){for(var c,d={name:a.getAttribute("name"),sources:{},vertices:{},primitives:[]},e=b(a,"mesh")[0],f=0;f<e.childNodes.length;f++)if(c=e.childNodes[f],1===c.nodeType){var g=c.getAttribute("id");switch(c.nodeName){case"source":d.sources[g]=K(c);break;case"vertices":d.vertices=L(c);break;case"polygons":console.warn("ColladaLoader: Unsupported primitive type: ",c.nodeName);break;case"lines":case"linestrips":case"polylist":case"triangles":d.primitives.push(M(c));break;default:console.log(c);}}ca.geometries[a.getAttribute("id")]=d}),i(_,"library_nodes","node",Q),i(_,"library_visual_scenes","visual_scene",function(a){for(var c={name:a.getAttribute("name"),children:[]},d=b(a,"node"),e=0;e<d.length;e++)c.children.push(Q(d[e]));ca.visualScenes[a.getAttribute("id")]=c}),console.timeEnd("ColladaLoader: Parse"),console.time("ColladaLoader: Build"),j(ca.images,l),j(ca.effects,x),j(ca.materials,z),j(ca.cameras,E),j(ca.lights,I),j(ca.geometries,N),j(ca.visualScenes,U),console.timeEnd("ColladaLoader: Build");var da=function(a){var c=b(a,"instance_visual_scene")[0];return V(f(c.getAttribute("url")))}(b(_,"scene")[0]);return"Z_UP"===ba.upAxis&&(da.rotation.x=-Math.PI/2),da.scale.multiplyScalar(ba.unit),console.timeEnd("ColladaLoader"),{animations:[],kinematics:{joints:[]},library:ca,scene:da}}}},a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2/libs/RGBELoader",[],function(a){return a.exports=function(a){a.HDRLoader=a.RGBELoader=function(b){this.manager=void 0===b?a.DefaultLoadingManager:b},a.RGBELoader.prototype=Object.create(a.DataTextureLoader.prototype),a.RGBELoader.prototype._parser=function(b){var c=-1,d=1,e=3,f=4,g=function(a,b){switch(a){case d:console.error("THREE.RGBELoader Read Error: "+(b||""));break;case 2:console.error("THREE.RGBELoader Write Error: "+(b||""));break;case e:console.error("THREE.RGBELoader Bad File Format: "+(b||""));break;default:case f:console.error("THREE.RGBELoader: Error: "+(b||""));}return c},i=2,j=4,k=function(a,b,c){b=b?b:1024;for(var d=a.pos,e=-1,f=0,g="",h=128,i=String.fromCharCode.apply(null,new Uint16Array(a.subarray(d,d+h)));0>(e=i.indexOf("\n"))&&f<b&&d<a.byteLength;)g+=i,f+=i.length,d+=h,i+=String.fromCharCode.apply(null,new Uint16Array(a.subarray(d,d+h)));return!!(-1<e)&&(!1!==c&&(a.pos+=f+e+1),g+i.slice(0,e))},l=function(a,b,c){var h,j,k,m,n,o,p,q,r,i,l,s,t,u=b,v=c;if(8>u||32767<u||2!==a[0]||2!==a[1]||128&a[2])return new Uint8Array(a);if(u!==(a[2]<<8|a[3]))return g(e,"wrong scanline width");if(h=new Uint8Array(4*b*c),!h||!h.length)return g(f,"unable to allocate buffer space");for(j=0,k=0,q=4*u,t=new Uint8Array(4),o=new Uint8Array(q);0<v&&k<a.byteLength;){if(k+4>a.byteLength)return g(d);if(t[0]=a[k++],t[1]=a[k++],t[2]=a[k++],t[3]=a[k++],2!=t[0]||2!=t[1]||(t[2]<<8|t[3])!=u)return g(e,"bad rgbe scanline format");for(p=0;p<q&&k<a.byteLength;){if(m=a[k++],s=128<m,s&&(m-=128),0===m||p+m>q)return g(e,"bad scanline data");if(s)for(n=a[k++],r=0;r<m;r++)o[p++]=n;else o.set(a.subarray(k,k+m),p),p+=m,k+=m}for(i=u,r=0;r<i;r++)l=0,h[j]=o[r+l],l+=u,h[j+1]=o[r+l],l+=u,h[j+2]=o[r+l],l+=u,h[j+3]=o[r+l],j+=4;v--}return h},m=new Uint8Array(b),n=m.byteLength;m.pos=0;var o=function(a){var b,c,f=/^#\?(\S+)$/,h=/^\s*GAMMA\s*=\s*(\d+(\.\d+)?)\s*$/,l=/^\s*EXPOSURE\s*=\s*(\d+(\.\d+)?)\s*$/,m=/^\s*FORMAT=(\S+)\s*$/,n=/^\s*\-Y\s+(\d+)\s+\+X\s+(\d+)\s*$/,o={valid:0,string:"",comments:"",programtype:"RGBE",format:"",gamma:1,exposure:1,width:0,height:0};if(a.pos>=a.byteLength||!(b=k(a)))return g(d,"no header found");if(!(c=b.match(f)))return g(e,"bad initial token");for(o.valid|=1,o.programtype=c[1],o.string+=b+"\n";b=k(a),!1!==b;){if(o.string+=b+"\n","#"===b.charAt(0)){o.comments+=b+"\n";continue}if((c=b.match(h))&&(o.gamma=parseFloat(c[1],10)),(c=b.match(l))&&(o.exposure=parseFloat(c[1],10)),(c=b.match(m))&&(o.valid|=i,o.format=c[1]),(c=b.match(n))&&(o.valid|=j,o.height=parseInt(c[1],10),o.width=parseInt(c[2],10)),o.valid&i&&o.valid&j)break}return o.valid&i?o.valid&j?o:g(e,"missing image size specifier"):g(e,"missing format specifier")}(m);if(c!==o){var p=o.width,q=o.height,r=l(m.subarray(m.pos),p,q);if(c!==r)return{width:p,height:q,data:r,header:o.string,gamma:o.gamma,exposure:o.exposure,format:a.RGBEFormat,type:a.UnsignedByteType}}return null}},a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2/libs/OBJLoader",[],function(a){return a.exports=function(a){a.OBJLoader=function(){function b(){var a={objects:[],object:{},vertices:[],normals:[],uvs:[],materialLibraries:[],startObject:function(a,b){if(this.object&&!1===this.object.fromDeclaration)return this.object.name=a,void(this.object.fromDeclaration=!1!==b);var c=this.object&&"function"===typeof this.object.currentMaterial?this.object.currentMaterial():void 0;if(this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0),this.object={name:a||"",fromDeclaration:!1!==b,geometry:{vertices:[],normals:[],uvs:[]},materials:[],smooth:!0,startMaterial:function(a,b){var c=this._finalize(!1);c&&(c.inherited||0>=c.groupCount)&&this.materials.splice(c.index,1);var d={index:this.materials.length,name:a||"",mtllib:Array.isArray(b)&&0<b.length?b[b.length-1]:"",smooth:void 0===c?this.smooth:c.smooth,groupStart:void 0===c?0:c.groupEnd,groupEnd:-1,groupCount:-1,inherited:!1,clone:function(a){var b={index:"number"===typeof a?a:this.index,name:this.name,mtllib:this.mtllib,smooth:this.smooth,groupStart:0,groupEnd:-1,groupCount:-1,inherited:!1};return b.clone=this.clone.bind(b),b}};return this.materials.push(d),d},currentMaterial:function(){return 0<this.materials.length?this.materials[this.materials.length-1]:void 0},_finalize:function(a){var b=this.currentMaterial();if(b&&-1===b.groupEnd&&(b.groupEnd=this.geometry.vertices.length/3,b.groupCount=b.groupEnd-b.groupStart,b.inherited=!1),a&&1<this.materials.length)for(var c=this.materials.length-1;0<=c;c--)0>=this.materials[c].groupCount&&this.materials.splice(c,1);return a&&0===this.materials.length&&this.materials.push({name:"",smooth:this.smooth}),b}},c&&c.name&&"function"===typeof c.clone){var d=c.clone(0);d.inherited=!0,this.object.materials.push(d)}this.objects.push(this.object)},finalize:function(){this.object&&"function"===typeof this.object._finalize&&this.object._finalize(!0)},parseVertexIndex:function(a,b){var c=parseInt(a,10);return 3*(0<=c?c-1:c+b/3)},parseNormalIndex:function(a,b){var c=parseInt(a,10);return 3*(0<=c?c-1:c+b/3)},parseUVIndex:function(a,b){var c=parseInt(a,10);return 2*(0<=c?c-1:c+b/2)},addVertex:function(d,a,b){var c=this.vertices,e=this.object.geometry.vertices;e.push(c[d+0],c[d+1],c[d+2]),e.push(c[a+0],c[a+1],c[a+2]),e.push(c[b+0],c[b+1],c[b+2])},addVertexLine:function(b){var a=this.vertices,c=this.object.geometry.vertices;c.push(a[b+0],a[b+1],a[b+2])},addNormal:function(d,a,b){var c=this.normals,e=this.object.geometry.normals;e.push(c[d+0],c[d+1],c[d+2]),e.push(c[a+0],c[a+1],c[a+2]),e.push(c[b+0],c[b+1],c[b+2])},addUV:function(d,a,b){var c=this.uvs,e=this.object.geometry.uvs;e.push(c[d+0],c[d+1]),e.push(c[a+0],c[a+1]),e.push(c[b+0],c[b+1])},addUVLine:function(b){var a=this.uvs,c=this.object.geometry.uvs;c.push(a[b+0],a[b+1])},addFace:function(d,a,b,c,e,f,g,h,i){var j=this.vertices.length,k=this.parseVertexIndex(d,j),l=this.parseVertexIndex(a,j),m=this.parseVertexIndex(b,j);if(this.addVertex(k,l,m),void 0!==c){var n=this.uvs.length;k=this.parseUVIndex(c,n),l=this.parseUVIndex(e,n),m=this.parseUVIndex(f,n),this.addUV(k,l,m)}if(void 0!==g){var o=this.normals.length;k=this.parseNormalIndex(g,o),l=g===h?k:this.parseNormalIndex(h,o),m=g===i?k:this.parseNormalIndex(i,o),this.addNormal(k,l,m)}},addLineGeometry:function(a,b){this.object.geometry.type="Line";for(var c=this.vertices.length,d=this.uvs.length,e=0,f=a.length;e<f;e++)this.addVertexLine(this.parseVertexIndex(a[e],c));for(var g=0,f=b.length;g<f;g++)this.addUVLine(this.parseUVIndex(b[g],d))}};return a.startObject("",!1),a}function c(b){this.manager=void 0===b?a.DefaultLoadingManager:b,this.materials=null}var d=/^[og]\s*(.+)?/,e=/^mtllib /,f=/^usemtl /;return c.prototype={constructor:c,load:function(b,c,d,e){var f=this,g=new a.FileLoader(f.manager);g.setPath(this.path),g.load(b,function(a){c(f.parse(a))},d,e)},setPath:function(a){this.path=a},setMaterials:function(a){return this.materials=a,this},parse:function(c){console.time("OBJLoader");var g=new b;-1!==c.indexOf("\r\n")&&(c=c.replace(/\r\n/g,"\n")),-1!==c.indexOf("\\\n")&&(c=c.replace(/\\\n/g,""));for(var h=c.split("\n"),k="",m="",n=0,o=[],p="function"===typeof"".trimLeft,q=0,i=h.length;q<i;q++)if(k=h[q],k=k.trimLeft(),n=k.length,0!==n&&(m=k.charAt(0),"#"!==m))if("v"===m){var l=k.split(/\s+/);switch(l[0]){case"v":g.vertices.push(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]));break;case"vn":g.normals.push(parseFloat(l[1]),parseFloat(l[2]),parseFloat(l[3]));break;case"vt":g.uvs.push(parseFloat(l[1]),parseFloat(l[2]));}}else if("f"===m){for(var r,s=k.substr(1).trim(),t=s.split(/\s+/),u=[],v=0,j=t.length;v<j;v++)if(r=t[v],0<r.length){var w=r.split("/");u.push(w)}for(var x=u[0],v=1,j=u.length-1;v<j;v++){var y=u[v],z=u[v+1];g.addFace(x[0],y[0],z[0],x[1],y[1],z[1],x[2],y[2],z[2])}}else if("l"===m){var A=k.substring(1).trim().split(" "),B=[],C=[];if(-1===k.indexOf("/"))B=A;else for(var D,E=0,F=A.length;E<F;E++)D=A[E].split("/"),""!==D[0]&&B.push(D[0]),""!==D[1]&&C.push(D[1]);g.addLineGeometry(B,C)}else if(null!==(o=d.exec(k))){var G=(" "+o[0].substr(1).trim()).substr(1);g.startObject(G)}else if(f.test(k))g.object.startMaterial(k.substring(7).trim(),g.materialLibraries);else if(e.test(k))g.materialLibraries.push(k.substring(7).trim());else if("s"===m){if(o=k.split(" "),1<o.length){var H=o[1].trim().toLowerCase();g.object.smooth="0"!==H&&"off"!==H}else g.object.smooth=!0;var I=g.object.currentMaterial();I&&(I.smooth=g.object.smooth)}else{if("\0"===k)continue;throw new Error("Unexpected line: '"+k+"'")}g.finalize();var J=new a.Group;J.materialLibraries=[].concat(g.materialLibraries);for(var q=0,i=g.objects.length;q<i;q++){var K=g.objects[q],L=K.geometry,M=K.materials,N="Line"===L.type;if(0!==L.vertices.length){var O=new a.BufferGeometry;O.addAttribute("position",new a.BufferAttribute(new Float32Array(L.vertices),3)),0<L.normals.length?O.addAttribute("normal",new a.BufferAttribute(new Float32Array(L.normals),3)):O.computeVertexNormals(),0<L.uvs.length&&O.addAttribute("uv",new a.BufferAttribute(new Float32Array(L.uvs),2));for(var P=[],Q=0,R=M.length;Q<R;Q++){var S=M[Q],I=void 0;if(null!==this.materials&&(I=this.materials.create(S.name),N&&I&&!(I instanceof a.LineBasicMaterial))){var T=new a.LineBasicMaterial;T.copy(I),I=T}I||(I=N?new a.LineBasicMaterial:new a.MeshPhongMaterial,I.name=S.name),I.flatShading=!S.smooth,P.push(I)}var U;if(1<P.length){for(var S,Q=0,R=M.length;Q<R;Q++)S=M[Q],O.addGroup(S.groupStart,S.groupCount,Q);U=N?new a.LineSegments(O,P):new a.Mesh(O,P)}else U=N?new a.LineSegments(O,P[0]):new a.Mesh(O,P[0]);U.name=K.name,J.add(U)}}return console.timeEnd("OBJLoader"),J}},c}()},a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2/libs/MTLLoader",[],function(a){return a.exports=function(a){a.MTLLoader=function(b){this.manager=void 0===b?a.DefaultLoadingManager:b},a.MTLLoader.prototype={constructor:a.MTLLoader,load:function(b,c,d,e){var f=this,g=new a.FileLoader(this.manager);g.setPath(this.path),g.load(b,function(a){c(f.parse(a))},d,e)},setPath:function(a){this.path=a},setTexturePath:function(a){this.texturePath=a},setBaseUrl:function(a){console.warn("THREE.MTLLoader: .setBaseUrl() is deprecated. Use .setTexturePath( path ) for texture path or .setPath( path ) for general base path instead."),this.setTexturePath(a)},setCrossOrigin:function(a){this.crossOrigin=a},setMaterialOptions:function(a){this.materialOptions=a},parse:function(b){for(var c,d=b.split("\n"),e={},f=/\s+/,g={},h=0;h<d.length;h++)if(c=d[h],c=c.trim(),0!==c.length&&"#"!==c.charAt(0)){var i=c.indexOf(" "),j=0<=i?c.substring(0,i):c;j=j.toLowerCase();var k=0<=i?c.substring(i+1):"";if(k=k.trim(),"newmtl"===j)e={name:k},g[k]=e;else if(e)if("ka"===j||"kd"===j||"ks"===j){var l=k.split(f,3);e[j]=[parseFloat(l[0]),parseFloat(l[1]),parseFloat(l[2])]}else e[j]=k}var m=new a.MTLLoader.MaterialCreator(this.texturePath||this.path,this.materialOptions);return m.setCrossOrigin(this.crossOrigin),m.setManager(this.manager),m.setMaterials(g),m}},a.MTLLoader.MaterialCreator=function(b,c){this.baseUrl=b||"",this.options=c,this.materialsInfo={},this.materials={},this.materialsArray=[],this.nameLookup={},this.side=this.options&&this.options.side?this.options.side:a.FrontSide,this.wrap=this.options&&this.options.wrap?this.options.wrap:a.RepeatWrapping},a.MTLLoader.MaterialCreator.prototype={constructor:a.MTLLoader.MaterialCreator,crossOrigin:"Anonymous",setCrossOrigin:function(a){this.crossOrigin=a},setManager:function(a){this.manager=a},setMaterials:function(a){this.materialsInfo=this.convert(a),this.materials={},this.materialsArray=[],this.nameLookup={}},convert:function(a){if(!this.options)return a;var b={};for(var c in a){var d=a[c],e={};for(var f in b[c]=e,d){var g=!0,h=d[f],i=f.toLowerCase();switch(i){case"kd":case"ka":case"ks":this.options&&this.options.normalizeRGB&&(h=[h[0]/255,h[1]/255,h[2]/255]),this.options&&this.options.ignoreZeroRGBs&&0===h[0]&&0===h[1]&&0===h[2]&&(g=!1);break;default:}g&&(e[i]=h)}}return b},preload:function(){for(var a in this.materialsInfo)this.create(a)},getIndex:function(a){return this.nameLookup[a]},getAsArray:function(){var a=0;for(var b in this.materialsInfo)this.materialsArray[a]=this.create(b),this.nameLookup[b]=a,a++;return this.materialsArray},create:function(a){return void 0===this.materials[a]&&this.createMaterial_(a),this.materials[a]},createMaterial_:function(b){function c(a,b){return"string"!==typeof b||""===b?"":/^https?:\/\//i.test(b)?b:a+b}function d(a,b){if(!g[a]){var d=e.getTextureParams(b,g),f=e.loadTexture(c(e.baseUrl,d.url));f.repeat.copy(d.scale),f.offset.copy(d.offset),f.wrapS=e.wrap,f.wrapT=e.wrap,g[a]=f}}var e=this,f=this.materialsInfo[b],g={name:b,side:this.side};for(var h in f){var i,j=f[h];if(""!==j)switch(h.toLowerCase()){case"kd":g.color=new a.Color().fromArray(j);break;case"ks":g.specular=new a.Color().fromArray(j);break;case"map_kd":d("map",j);break;case"map_ks":d("specularMap",j);break;case"norm":d("normalMap",j);break;case"map_bump":case"bump":d("bumpMap",j);break;case"ns":g.shininess=parseFloat(j);break;case"d":i=parseFloat(j),1>i&&(g.opacity=i,g.transparent=!0);break;case"tr":i=parseFloat(j),0<i&&(g.opacity=1-i,g.transparent=!0);break;default:}}return this.materials[b]=new a.MeshPhongMaterial(g),this.materials[b]},getTextureParams:function(b,c){var d,e={scale:new a.Vector2(1,1),offset:new a.Vector2(0,0)},f=b.split(/\s+/);return d=f.indexOf("-bm"),0<=d&&(c.bumpScale=parseFloat(f[d+1]),f.splice(d,2)),d=f.indexOf("-s"),0<=d&&(e.scale.set(parseFloat(f[d+1]),parseFloat(f[d+2])),f.splice(d,4)),d=f.indexOf("-o"),0<=d&&(e.offset.set(parseFloat(f[d+1]),parseFloat(f[d+2])),f.splice(d,4)),e.url=f.join(" ").trim(),e},loadTexture:function(b,c,d,e,f){var g,h=a.Loader.Handlers.get(b),i=void 0===this.manager?a.DefaultLoadingManager:this.manager;return null===h&&(h=new a.TextureLoader(i)),h.setCrossOrigin&&h.setCrossOrigin(this.crossOrigin),g=h.load(b,d,e,f),void 0!==c&&(g.mapping=c),g}}},a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2/loaders",[],function(a,b,c){let d=null;return a.exports=class{constructor(a){d=a,c("datav:/com/datav-expo-models/1.0.2/libs/MTLLoader")(d),c("datav:/com/datav-expo-models/1.0.2/libs/OBJLoader")(d),c("datav:/com/datav-expo-models/1.0.2/libs/GLTFLoader")(d),c("datav:/com/datav-expo-models/1.0.2/libs/FBXLoader")(d),c("datav:/com/datav-expo-models/1.0.2/libs/ColladaLoader2")(d),c("datav:/com/datav-expo-models/1.0.2/libs/DRACOLoader")(d),d.DRACOLoader.setDecoderPath("./libs/dependencies/draco")}fetchModel(a,b){let c=this.getType(a);"dae"===c?this.fetchDAE(a,b):"obj"===c||"mtl"===c?this.fetchOBJ(a,b):"gltf"===c||"glb"===c?this.fetchGLTF(a,b):"fbx"===c?this.fetchFBX(a,b):b&&b(null)}fetchFBX(a,b){const c=new d.FBXLoader;c.load(a,(a)=>{let c={};c.scene=a,c.animations=a.animations,b&&b(c)},this.onProgress,this.onError)}fetchGLTF(a,b){const c=new d.GLTFLoader;c.setCrossOrigin("*"),c.setDRACOLoader(new d.DRACOLoader),c.load(a,(a)=>{let c={};c.scene=a.scene,c.animations=a.animations,b&&b(c)},this.onProgress,this.onError)}fetchOBJ(a,b){const c=new d.MTLLoader,e=new d.OBJLoader;c.setCrossOrigin("*"),c.setMaterialOptions({side:d.DoubleSide});let f=a.lastIndexOf("/"),g=a.substr(0,f)+"/",h=a.substr(0,f)+"/";c.setPath(g),e.setPath(h);let i=a.lastIndexOf("."),j=a.substring(f+1,i),k=j+".obj";c.load(j+".mtl",(a)=>{a.preload(),e.setMaterials(a),e.load(k,(a)=>{let c={};c.scene=a,c.animations=[],b&&b(c)},this.onProgress,this.onError)},this.onProgress,()=>{e.load(k,(a)=>{let c={};c.scene=a,b&&b(c)})})}fetchDAE(a,b){const c=new d.ColladaLoader;c.options.convertUpAxis=!0,c.load(a,function(a){b&&b(a)},this.onProgress,this.onError)}onProgress(a){console.log("\u6A21\u578B\u52A0\u8F7D\u4E2D\uFF1A "+Math.round(100*(a.loaded/a.total),2)+"% loaded")}onError(a){console.error(a)}getType(a){let b=a.lastIndexOf("."),c=a.substr(b+1).toLowerCase();return c}},a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2/actions_manager",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(a,b,c){let d=null,e=null;const f=c("datav:/npm/eventemitter3/3.0.0"),g=c("datav:/npm/safely-merge/1.0.1");class h extends f{constructor(a,b){super(),d=a,e=b,this.playAnimation=!0}getCenter(){return this.model?new d.Box3().setFromObject(this.model).getCenter():void 0}set isPlayAnimation(a){this.playAnimation=a,this.toggleAnimations()}set center(a){this.originalCenter=a}bind(a,b){this.model=a,this.animations=b||[],this.startAnimation()}toggleAnimations(){if(this.mixer&&this.animations.length)for(let a=0;a<this.animations.length;a++){const b=this.animations[a],c=this.mixer.existingAction(b);this.playAnimation?c.play():c.stop()}}startAnimation(){this.mixer=new d.AnimationMixer(this.model);for(let a=0;a<this.animations.length;a++){const b=this.animations[a],c=this.mixer.clipAction(b);this.playAnimation?c.play():c.stop()}}doAnimation(a){this.mixer&&this.mixer.update(a)}scale(a,b,c){this.model&&this.model.scale.set(a,b,c)}autoScale(){}position(a,b,c){const d=a-this.originalCenter.x,e=b-this.originalCenter.y,f=c-this.originalCenter.z;this.model&&this.model.position.set(d,e,f),this.recordPosition()}recordPosition(){this.model&&this.model.traverse((a)=>{"Mesh"===a.type&&(a.initialPosition=a.position.clone())})}rotation(a,b,c){const d=a*Math.PI,e=b*Math.PI,f=c*Math.PI;this.model&&this.model.rotation.set(d,e,f)}createEaseFunc(a,b,c){new e.TWEEN.Tween({value:0}).to({value:a},b).delay(0).onStart(function(){}).easing(e.TWEEN.Easing.Linear.None).onUpdate(function(){c&&c(this.value)}).onComplete(function(){e.TWEEN.remove(),console.log("its done")}).start()}translateById(a,b,c,f){f=f||0.5;const g=this.model.getObjectById(a);g&&g.traverse((a)=>{if("Mesh"===a.type){const g=a.initialPosition;this.createEaseFunc(c,f,(c)=>{const f=e.axisOffset(b,c,g);a.position.copy(new d.Vector3(f.x,f.y,f.z))})}})}restoreById(a){const b=this.model.getObjectByName(a);b&&b.traverse((a)=>{"Mesh"===a.type&&a.position.copy(a.initialPosition)})}translateAll(a,b,c){this.model&&this.model.traverse((f)=>{if("Mesh"===f.type){const g=f.initialPosition;this.createEaseFunc(b,c,(b)=>{const c=e.axisOffset(a,b,g);f.position.copy(new d.Vector3(c.x,c.y,c.z))})}})}restoreAll(){this.model&&this.model.traverse((a)=>{"Mesh"===a.type&&a.position.copy(a.initialPosition)})}explodedByDis(a){const b=new d.Box3,c=this.getCenter();this.model&&this.model.children.length&&this.model.children.forEach((d)=>{d.oriposition||(d.oriposition=d.position.clone());const e=b.setFromObject(d).getCenter(),f=e.sub(c).multiplyScalar(a),g=d.oriposition.clone().add(f);d.position.copy(g)})}dispose(){this.model=null,this.animations=null,this.mixer=null}}return a.exports=h,a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2/materials_manager",[],function(a,b,c){let d=null,e=null;const f=c("datav:/com/datav-expo-models/1.0.2/loaders");return a.exports=class{constructor(a,b){this.viewer=a,this.options=b,d=a.three,e=a.Utils,c("datav:/com/datav-expo-models/1.0.2/libs/RGBELoader")(d),c("datav:/com/datav-expo-models/1.0.2/libs/HDRCubeTextureLoader")(d),c("datav:/com/datav-expo-models/1.0.2/libs/pmrem/PMREMGenerator")(d),c("datav:/com/datav-expo-models/1.0.2/libs/pmrem/PMREMCubeUVPacker")(d),this.modelLoader=new f(d),this.whiteMaterial=new d.MeshStandardMaterial({transparent:!0,opacity:1}),this.sourceMaterials={},this.enableFloatTexture=!1,this.hdrCubeRenderTarget=null}fetch(a,b){this.dispose(),this.modelLoader.fetchModel(a,(a)=>{this.model=a,a&&a.scene&&(this.initMaterial(),this.initWriteMaterial(),this.createEnvMap().then(()=>{this.cloneAllMaterial(),b&&b(a)}))})}initMaterial(){this.model.scene.traverse((a)=>{"Mesh"===a.type&&e.materialTraverse(a.material,(b,c)=>{const d=e.getCurrentMaterial(b,c),f=d.clone();f.transparent=!0,f.alphaTest=0.01,f.sourceOpacity=f.opacity,Array.isArray(a.material)?a.material[c]=f:a.material=f,this.disposeMaterial(d)})})}initWriteMaterial(){}createEnvMap(){const a=[this.options.hdr_px,this.options.hdr_nx,this.options.hdr_py,this.options.hdr_ny,this.options.hdr_pz,this.options.hdr_nz];return new Promise((b)=>{new d.HDRCubeTextureLoader().load(d.UnsignedByteType,a,(a)=>{const c=new d.PMREMGenerator(a);c.update(this.viewer.renderer);const e=new d.PMREMCubeUVPacker(c.cubeLods);e.update(this.viewer.renderer),this.hdrCubeRenderTarget=e.CubeUVRenderTarget,a.dispose(),c.dispose(),e.dispose(),b()})})}toggleEnvMap(a){a?this.model.scene.traverse((a)=>{"Mesh"===a.type&&e.materialTraverse(a.material,(a,b)=>{const c=e.getCurrentMaterial(a,b);c instanceof d.MeshPhongMaterial||(c.envMap=this.hdrCubeRenderTarget.texture,c.needsUpdate=!0)})}):this.model.scene.traverse((a)=>{"Mesh"===a.type&&e.materialTraverse(a.material,(a,b)=>{const c=e.getCurrentMaterial(a,b);c instanceof d.MeshPhongMaterial||(c.envMap=null,c.needsUpdate=!0)})})}disposeMaterial(a){a&&a.dispose&&a.dispose()}cloneAllMaterial(){this.model.scene.traverse((a)=>{"Mesh"===a.type&&(this.sourceMaterials[a.uuid]=[],e.materialTraverse(a.material,(b,c)=>{const d=e.getCurrentMaterial(b,c);d.envMap=this.hdrCubeRenderTarget.texture,d.needsUpdate=!0,this.sourceMaterials[a.uuid].push(d)}))})}colorifyGlobal(a,b,c){this.model.scene.traverse((d)=>{"Mesh"===d.type&&e.materialTraverse(d.material,(f,g)=>{const h=e.getCurrentMaterial(f,g);h.opacity=a*h.sourceOpacity,h._opacity=h.opacity,h.depthWrite=b,h.wireframe=c;const i=this.sourceMaterials[d.uuid][null===g?0:g];e.syncMaterials(h,i)})})}colorifyByData(a){if(a&&this.model&&this.model.scene)for(let b=0;b<a.length;b++){let f=a[b],c=this.model.scene.getObjectByName(f.id);c&&c.traverse((a)=>{"Mesh"===a.type&&(a.visible=f.visible,e.materialTraverse(a.material,(b,d)=>{if("source"===f.type){const c=e.getCurrentMaterial(b,d),f=this.sourceMaterials[a.uuid][null===d?0:d];e.syncMaterials(f,c)}else if("bloom"===f.type){this.checkFloatTextureExist();const a=e.getCurrentMaterial(b,d);a=this.floatTextureMaterial.clone(),a.needsUpdate=!0}else{const a=e.Chroma(f.color).gl(),c=e.getCurrentMaterial(b,d);c.color.setRGB(a[0],a[1],a[2])}}))})}}createEaseFunc(a,b,c,d){new e.TWEEN.Tween({value:a}).to({value:b},c).delay(0).onStart(function(){}).easing(e.TWEEN.Easing.Linear.None).onUpdate(function(){d&&d(this.value)}).onComplete(function(){e.TWEEN.remove()}).start()}highlightById(a,b,c){const d=e.traverseInverseChildsByName(this.model.scene,a);this.createEaseFunc(1,b,c,(a)=>{d.forEach((c)=>{e.materialTraverse(c.material,(c,d)=>{const f=e.getCurrentMaterial(c,d),g=f.opacity;b!==g&&(f.opacity=f._opacity*a)})})});const f=e.traverseAllChildsByName(this.model.scene,a);this.createEaseFunc(b,1,c,(a)=>{f.forEach((b)=>{e.materialTraverse(b.material,(b,c)=>{const d=e.getCurrentMaterial(b,c);d._opacity!==d.opacity&&(d.opacity=d._opacity*a)})})})}checkFloatTextureExist(){this.enableFloatTexture||(this.floatTextureMaterial=this.createSingleFloatTextureMaterial(),this.enableFloatTexture=!0)}createSingleFloatTextureMaterial(){const a=this.sceneRtt=new d.Scene,b=this.cameraRtt=new d.OrthographicCamera(-256,256,256,-256,-1e4,1e4);b.position.z=10;const c=this.rtTexture=new d.WebGLRenderTarget(512,512,{minFilter:d.LinearFilter,magFilter:d.LinearFilter,format:d.RGBAFormat,type:d.FloatType}),e=this.createFloatTextureMesh();a.add(e);const f=new d.MeshBasicMaterial({color:16777215,map:c.texture,side:d.DoubleSide});return f}doRender(a){this.enableFloatTexture&&this.rtTexture&&this.sceneRtt&&this.cameraRtt&&a&&a.render(this.sceneRtt,this.cameraRtt,this.rtTexture,!0)}createFloatTextureMesh(){const a=new d.PlaneBufferGeometry(512,512),b=new d.ShaderMaterial({uniforms:{uColor:{value:new d.Vector3(1.4,4.1,5.34)}},vertexShader:`
        void main() {
          gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );
        }
      `,fragmentShader:`
        #ifdef GL_ES
          precision highp float;
        #endif
        
        uniform vec3 uColor;
        void main() {
          gl_FragColor = vec4(uColor, 1.0);
          gl_FragColor *= vec4(1.0, 1.5, 2.1, 1.0);
        }
      `,transparent:!0,opacity:1}),c=new d.Mesh(a,b);return c}setGlobalType(a){"source"===a?this.colorifySource():"white"===a?this.colorifyWhite():void 0}colorifySource(){this.model.scene.traverse((a)=>{"Mesh"===a.type&&e.materialTraverse(a.material,(b,c)=>{const d=this.sourceMaterials[a.uuid][null===c?0:c];Array.isArray(a.material)?(a.material[c]=d,a.material[c].needsUpdate=!0):(a.material=d,a.material.needsUpdate=!0)})})}colorifyWhite(){this.model.scene.traverse((a)=>{"Mesh"===a.type&&(a.material=this.whiteMaterial.clone(),a.material.alphaTest=0.01,a.material.sourceOpacity=1,a.material.needsUpdate=!0)})}dispose(){this.model&&e.disposeNode(this.model.scene),this.sceneRtt&&e.disposeNode(this.sceneRtt),this.floatTextureMaterial=null,this.sceneRtt=null,this.cameraRtt=null,this.rtTexture=null}},a.exports});;
Cube("datav:/com/datav-expo-models/1.0.2",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1","datav:/npm/lodash/4.17.4/isEqual","datav:/npm/lodash/4.17.4/cloneDeep"],function(a,b,c){let d=null,e=null;const f=c("datav:/npm/eventemitter3/3.0.0"),g=c("datav:/npm/safely-merge/1.0.1"),h=c("datav:/npm/lodash/4.17.4/isEqual"),i=c("datav:/npm/lodash/4.17.4/cloneDeep"),j=c("datav:/com/datav-expo-models/1.0.2/materials_manager"),k=c("datav:/com/datav-expo-models/1.0.2/actions_manager"),l={playAnimation:!1,modelUrl:"http://sh-conf.oss-cn-shanghai.aliyuncs.com/korea-model.dae",style:{isWireFrame:!0,depthWrite:!1,scale:0.01,opacity:1},explosionEffect:{isExplode:!1,explodeLevel:100},clippingEffect:{isCliped:!1,clipX:0,clipY:-1,clipZ:0,clipConstant:0},position:{offsetX:0,offsetY:0,offsetZ:0,rotationX:0,rotationY:0,rotationZ:0}};return a.exports=class extends f{constructor(a,b){super(),this.options=g(l,b||{})}addTo(a){this.viewer=a,d=a.three,e=a.Utils,this.scene=a.scene,this.renderer=a.renderer,this.materialsManager=new j(a,this.options),this.actionsManager=new k(d,e),this.render(),this.clock=new d.Clock,this.animation=this.animation.bind(this),this.viewer.on("animationFrame",this.animation),this.viewer.on("projChanged",this.updatePostions.bind(this))}setData(a){Array.isArray(a)&&(this.data=a,this.materialsManager.colorifyByData(a))}render(){this.dispose();const a=this.options,b=a.style,c=a.position;this.materialsManager.fetch(this.options.modelUrl,(a)=>{this.model=a,this.scene.add(a.scene),this.actionsManager.bind(a.scene,a.animations),this.actionsManager.scale(b.scale,b.scale,b.scale),this.actionsManager.rotation(c.rotationX,c.rotationY,c.rotationZ),this.actionsManager.center=this.actionsManager.getCenter(),this.updatePostions(),this.actionsManager.isPlayAnimation=this.options.playAnimation,this.toggleModelClipping(),this.toggleModelExplosion(),this.colorify()})}getProjPos(a,b,c){return this.viewer.Projection([a,b,c])}updatePostions(){const a=this.options.position,b=this.getProjPos(a.offsetX,a.offsetY,a.offsetZ);this.actionsManager&&this.actionsManager.position(b[0],b[1],b[2])}colorify(){const a=this.options.style;this.materialsManager.toggleEnvMap(a.isEnvMap),this.materialsManager.setGlobalType(a.materialType),this.materialsManager.colorifyGlobal(a.opacity,a.depthWrite,a.isWireFrame),this.materialsManager.colorifyByData(this.data)}toggleModelClipping(){let a=this.options.clippingEffect;a.isCliped&&this.setClipPlane(),this.toggleRendererClip(),this.model&&this.model.scene.traverse((a)=>{"Mesh"===a.type&&this.toggleMeshClip(a)})}toggleRendererClip(){this.renderer.localClippingEnabled=this.options.clippingEffect.isCliped}toggleMeshClip(a){this.options.clippingEffect.isCliped?(a.material.clippingPlanes=[this.localPlane],a.material.clipShadows=!0):(a.material.clippingPlanes=null,a.material.clipShadows=!1)}setClipPlane(){let a=this.options.clippingEffect,b=new d.Vector3(a.clipX,a.clipY,a.clipZ).normalize();this.localPlane=new d.Plane(b,a.clipConstant)}toggleModelExplosion(){let a=this.options.explosionEffect;if(a.isExplode){let b=a.explodeLevel;this.actionsManager.explodedByDis(b)}else this.actionsManager.explodedByDis(0)}animation(){this.actionsManager&&this.actionsManager.doAnimation(this.clock.getDelta()),this.materialsManager&&this.materialsManager.doRender(this.viewer.renderer,this.viewer.scene)}updateModel(){this.render()}updateOptions(a){const b=i(this.options);this.options=g(this.options,a||{});const c=a.style,d=a.position;b.modelUrl!==a.modelUrl&&this.updateModel(),h(b.position,a.position)||(this.actionsManager.rotation(d.rotationX,d.rotationY,d.rotationZ),this.updatePostions()),h(b.style,a.style)||this.colorify(),h(b.style.scale,a.style.scale)||this.actionsManager.scale(c.scale,c.scale,c.scale),h(b.clippingEffect,a.clippingEffect)||this.toggleModelClipping(),h(b.explosionEffect,a.explosionEffect)||this.toggleModelExplosion(),b.playAnimation!==a.playAnimation&&(this.actionsManager.isPlayAnimation=a.playAnimation)}dispose(){this.model&&this.scene.remove(this.model.scene),this.materialsManager.dispose(),this.actionsManager.dispose()}remove(){this.viewer.off("animationFrame",this.animation),this.dispose()}},a.exports});