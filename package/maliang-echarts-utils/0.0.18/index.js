// env=undefined => env=publish 
Cube("datav:/com/maliang-echarts-utils/0.0.18",["datav:/npm/lodash/4.13.1","datav:/npm/echarts/3.4.0"],function(a,b,c){function d(a,b){if(void 0===a)return b;var d=b,f=e(a),g=Math.sin(f),h=Math.cos(f),c=Math.sin(e(45));return 0<h&&Math.abs(g)<c?d=[1,0.5+0.5*Math.tan(f)]:0<g&&Math.abs(h)<=c?d=[0.5+0.5*Math.cot(f),1]:0>h&&Math.abs(g)<c?d=[0,0.5-0.5*Math.tan(f)]:0>g&&Math.abs(h)<=c?d=[0.5-0.5*Math.cot(f),0]:console.log("error  u!"),d}function e(a){return 2*k*a/360}function f(a,b){for(var c=[],d=0,e=b.length;d<e;d++){if(d<a){c.push("-");continue}for(var f=0,g=0;g<a;g++)f+=h.toNumber(b[d-g][0]);c.push(f/a)}return c}var g="function"===typeof Symbol&&"symbol"===typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&"function"===typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?"symbol":typeof a},h=c("datav:/npm/lodash/4.13.1"),i=c("datav:/npm/echarts/3.4.0"),j={};j.data2echartsAxis=function(a,b){var d={series:[]},c="category"===b.yAxis.type?"yAxis":"xAxis",e=h.cloneDeep(a),f=h.uniq(h.map(e,"x"));d[c]={data:f};var g=h.groupBy(e,"s");return h.map(b.series,function(a){var b=g[a.name];b?3<h.keys(b[0]).length?d.series.push({data:h.map(f,function(a){var c=h.find(b,{x:a});return c&&(c.value=c.y,delete c.s,delete c.x,delete c.y),c||null})}):d.series.push({data:h.map(f,function(a){var c=h.find(b,{x:a});return c?c.y:null})}):d.series.push({data:null})}),d},j.data2echartsBar=j.data2echartsAxis,j.data2echartsLine=j.data2echartsAxis,j.data2echartsCandlestick=function(a,b){var c={series:[],xAxis:{data:h.uniq(h.map(h.clone(a),"x"))}},d=h.map(a,function(a){return[a.open,a.close,a.lowest,a.highest]});return b.series.forEach(function(a){if("candlestick"===a.type)c.series.push({data:d});else{var b=a.name.match(/\d+/g)[0],e=h.isNumber(parseInt(b))?parseInt(b):5;c.series.push({data:f(e,d)})}}),c},j.data2echartsPictorialBar=function(a,b){var c={series:[]},d="category"===b.yAxis.type?"yAxis":"xAxis";return c[d]={data:h.uniq(h.map(h.clone(a),"x"))},h.map(h.groupBy(a,"s"),function(a){c.series.push({data:h.map(a,function(a){return a.symbol&&""!=a.symbol||delete a.symbol,a.value=a.y,delete a.s,delete a.x,delete a.y,a})})}),c},j.data2echartsScatter=function(a){var b={series:[]};return h.map(h.groupBy(a,"s"),function(a){b.series.push({data:h.map(a,function(a){return[a.x,a.y]})})}),b},j.data2echartsEffectscatter=function(a){var b={series:[]};return h.map(h.groupBy(a,"s"),function(a){b.series.push({data:h.map(a,function(a){return[a.name,a.value]})})}),b},j.data2echartsPie=function(a){var b={series:[]};return h.map(h.groupBy(a,"s"),function(a){b.series.push({data:h.map(a,function(a){return{name:a.x,value:a.y}})})}),b},j.data2echartsHeatmap=function(a){var b={series:[]},c=h.uniq(h.map(h.clone(a),"x")),d=h.uniq(h.map(h.clone(a),"y"));return b.xAxis={data:c},b.yAxis={data:d},h.map(h.groupBy(a,"s"),function(a){b.series.push({data:h.map(a,function(a){return[h.indexOf(c,a.x),h.indexOf(d,a.y),a.value]})})}),b},j.data2echartsFunnel=function(a){return{series:[{data:a}]}},j.data2echartsGauge=j.data2echartsFunnel,j.data2echartsGraph=function(a){return{series:[{data:a[0].nodes,links:a[0].links}]}},j.isMultiColor=function(a){return a&&a.style&&(a.value||a.from&&a.to)},j.config2echartsOptions=function(a){if(j.isMultiColor(a)){if("single"===a.style)return a.value;var b=d(a.angle+180,[0,0]).concat(d(a.angle,[0,1]));return new i.graphic.LinearGradient(b[0],b[1],b[2],b[3],[{offset:0,color:a.from},{offset:1,color:a.to}])}return"object"===("undefined"===typeof a?"undefined":g(a))&&h.forIn(a,function(b,c){a[c]=j.config2echartsOptions(b)}),a&&a.series&&!Array.isArray(a.series)&&(a.series=[a.series]),a},Math.cot=function(a){return Math.cos(a)/Math.sin(a)};var k=3.14;return a.exports=j,a.exports});