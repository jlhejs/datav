// env=undefined => env=publish 
Cube("datav:/com/datavmap-canvas2d-stream-popups/2.0.42/src/streamPopupsLayer",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1","datav:/npm/lodash/4.6.1"],function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"===typeof b||"function"===typeof b)?b:a}function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c("datav:/npm/eventemitter3/3.0.0"),i=c("datav:/npm/safely-merge/1.0.1"),j=c("datav:/npm/lodash/4.6.1"),k=function(a){function b(a,c){d(this,b);var f=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return f.options=i({zoomRange:[0,18],minZoom:0,maxZoom:22,defaultStyle:{iconUrl:"https://datav.oss-cn-hangzhou.aliyuncs.com/uploads/images/c865cb8f92f3c885350970f64c299a2e.png",iconSize:{width:20,height:20},offset:{x:0,y:0},popupOffset:{x:15,y:15},circleStyle:{show:!0,fillColor:"rgba(50, 50, 250, 0)",strokeColor:"rgba(30, 180, 230, 1)",radius:3,weight:2}},popupStyle:{textAlign:"left",lineHeight:1.4,margin:{top:10,right:20,bottom:10,left:20},textStyle:{fontFamily:"Microsoft Yahei",fontSize:12,color:"#FFFFFF",fontWeight:"normal"},contentStyle:{width:100,radius:5,background:"rgba(50, 50, 250, 0.6)"},shadow:{shadowColor:"rgba(100, 250, 100, 0.4)",shadowBlur:5,shadowOffsetX:5,shadowOffsetY:5}},animateStyle:{isCache:!1,cacheCount:300,isOrder:!1,popupNum:5,spreadTime:1,keepTime:3,fadeTime:1},mappingSeries:{}},c),f.options.minZoom=c.zoomRange[0],f.options.maxZoom=c.zoomRange[1],f.options.visibility=!0,f.map=a,f.data=[],f.init(),f}return f(b,a),g(b,[{key:"init",value:function(){var a=this.randomKeyframesCode=this.getRandomCode(10);this.paneName="streamPopups_"+a+"Pane",this.pane=this.map.createPane(this.paneName),this.render=this.render.bind(this),this.random=this.random.bind(this),this.update=this.update.bind(this),this.createMarkers=this.createMarkers.bind(this),this.randomIndex=1,this.streamPopups1=[],this.streamPopups2=[];var b=this.map.L;this.layerGroup1=b.featureGroup(),this.layerGroup1.addTo(this.map),this.layerGroup2=b.featureGroup(),this.layerGroup2.addTo(this.map),this.setKeyframes()}},{key:"setKeyframes",value:function(){var a=document.getElementsByTagName("head")[0],b=document.createElement("style");b.innerHTML="\n      @keyframes show_"+this.randomKeyframesCode+" {\n        0% {\n          clip: rect(0, 0, 999px, 0);\n          opacity: 0;\n        }\n        100% {\n          clip: rect(0, 600px, 999px, 0 );\n          opacity: 1;\n        }\n      }\n      @keyframes hide_"+this.randomKeyframesCode+" {\n        0% {\n          opacity: 0.8;\n        }\n        100% {\n          opacity: 0;\n        }\n      }\n    ",a.appendChild(b)}},{key:"getRandomCode",value:function(a){if(0<a){for(var b,c=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],d="",e=0;e<a;e++)b=parseInt(61*Math.random()),d+=c[b];return d}return!1}},{key:"setZIndex",value:function(a){this.pane&&(this.pane.style.zIndex=600+a)}},{key:"render",value:function(a,b){var c=this.options,d=c.animateStyle;return(this.streamPopups1=[],this.streamPopups2=[],this.layerGroup1&&this.layerGroup1.clearLayers(),this.layerGroup2&&this.layerGroup2.clearLayers(),this.timer&&clearTimeout(this.timer),!a||0===a.length)?void(this.data=[]):void(b&&"updateOptions"===b?this.data=a||[]:d.isCache?(!this.data&&(this.data=[]),[].push.apply(this.data,a),this.data=j.slice(this.data,0,d.cacheCount)):this.data=a,c.visibility&&(this.createMarkers(this.streamPopups1,this.layerGroup1),this.createMarkers(this.streamPopups2,this.layerGroup2),this.pane&&this.pane.querySelector("svg")&&(this.pane.querySelector("svg").style.zIndex=0),this.random()))}},{key:"createMarkers",value:function(a,b){var c=this,d=c.map.L,e=c.options,f=e.defaultStyle,g=f.circleStyle,h=e.animateStyle,j=e.popupStyle,k=j.margin,l=j.contentStyle,m=j.textStyle,n=j.shadow,o=h.popupNum;c.data.length<o&&(o=c.data.length);for(var p=-180,q=-90,r=n.shadowOffsetX+"px "+n.shadowOffsetY+"px "+n.shadowBlur+"px "+n.shadowColor,s=k.top+"px "+k.right+"px "+k.bottom+"px "+k.left+"px",t="<div style = \"\n      position: absolute;\n      background: "+l.background+";\n      border-radius: "+l.radius+"px;\n      box-shadow: "+r+";\">\n        <div class=\"popupContent\" style=\"\n          margin: "+s+";\n          min-width: "+l.width+"px;\n          word-wrap: break-word;\n          display: inline-block;\n          text-align: "+j.textAlign+";\n          text-overflow: ellipsis;\n          font-family: "+m.fontFamily+";\n          color: "+m.color+";\n          font-size: "+m.fontSize+"px;\n          line-height: "+j.lineHeight+";\">\n        </div></div>",u=0;u<o;u++)a[u]={},0<g.radius&&0<g.weight&&(a[u].circleMarker=d.circleMarker([q,p],{pane:this.paneName,radius:g.radius,fill:!0,fillColor:g.fillColor,stroke:!0,color:g.strokeColor,weight:g.weight,opacity:0,fillOpacity:0}).addTo(b)),a[u].marker=d.marker([q,p],{icon:d.icon({iconUrl:f.iconUrl||"data:image/png;base64,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",iconSize:[f.iconSize.width,f.iconSize.height],iconAnchor:[-f.offset.x+f.iconSize.width/2,f.offset.y+f.iconSize.height]}),pane:this.paneName,opacity:0}).addTo(b),a[u].popup=d.marker([q,p],{icon:d.divIcon({iconSize:null,iconAnchor:[-f.popupOffset.x,f.popupOffset.y],html:t}),pane:this.paneName,zIndexOffset:1e3,opacity:0}).addTo(b),a[u].popup._icon.style.border="0px solid #666"}},{key:"random",value:function(){var a=this,b=this.options.animateStyle,c=b.popupNum,d=[];b.isOrder?(d=this.data.splice(0,c),[].push.apply(this.data,d)):d=j.slice(j.shuffle(this.data),0,c);var e=[];this.data.length<c&&(c=this.data.length);for(var f=0;f<c;f++)e.push(d[f]);this.randomIndex=1===this.randomIndex?2:1,this.update(e),b.popupNum>=this.data.length||(this.timer=setTimeout(function(){var c=1===a.randomIndex?a.layerGroup1:a.layerGroup2;for(var d in c._layers){var e=c._layers[d];if(e){var f=e._path||e._icon;f.style.animation="hide_"+a.randomKeyframesCode+" "+b.fadeTime+"s",f.style.animationFillMode="forwards"}}a.random()},1e3*(Math.max(b.spreadTime,b.fadeTime)+b.keepTime)))}},{key:"update",value:function(a){for(var b=1===this.randomIndex?this.streamPopups1:this.streamPopups2,c=this.options,e=c.animateStyle,f=c.defaultStyle,g=f.circleStyle,h=0;h<a.length;h++){var i=a[h],d=+i.lng,j=+i.lat;if(!(isNaN(d)||isNaN(j))){if(g.show&&0<g.radius&&0<g.weight&&b[h]&&b[h].circleMarker&&(b[h].circleMarker.setLatLng([j,d]),b[h].circleMarker.setStyle({opacity:1,fillOpacity:1}),b[h].circleMarker._path.style.animation="show_"+this.randomKeyframesCode+" "+e.spreadTime+"s"),!b[h]||!b[h].marker)break;b[h].marker.setLatLng([j,d]),b[h].marker.setOpacity(1),b[h].marker._icon.style.animation="show_"+this.randomKeyframesCode+" "+e.spreadTime+"s",i.iconUrl&&(b[h].marker._icon.src=i.iconUrl),b[h].popup.setLatLng([j,d]),b[h].popup.setOpacity(1),b[h].popup._icon.querySelector(".popupContent").innerHTML=i.info||"\u8BF7\u8865\u5145info\u5B57\u6BB5",b[h].popup._icon.style.animation="show_"+this.randomKeyframesCode+" "+e.spreadTime+"s"}}}},{key:"updateOptions",value:function(a){this.options=i(this.options,a),this.options.minZoom=a.zoomRange[0],this.options.maxZoom=a.zoomRange[1];var b=this.map.getZoom();b<this.options.minZoom||b>this.options.maxZoom?this.pane&&(this.pane.style.display="none"):this.pane&&(this.pane.style.display="block"),this.render(this.data,"updateOptions")}},{key:"show",value:function(){this.options.visibility=!0,this.timer&&clearTimeout(this.timer);var a=this.map.getZoom();a<this.options.minZoom||a>this.options.maxZoom?this.pane&&(this.pane.style.display="none"):(this.pane&&(this.pane.style.display="block"),this.data&&this.data.length&&this.render(this.data))}},{key:"hide",value:function(){this.options.visibility=!1,this.pane&&(this.pane.style.display="none"),this.timer&&clearTimeout(this.timer),this.streamPopups1=[],this.streamPopups2=[],this.layerGroup1&&this.layerGroup1.clearLayers(),this.layerGroup2&&this.layerGroup2.clearLayers()}},{key:"destroy",value:function(){this.timer&&clearTimeout(this.timer),this.streamPopups1=[],this.streamPopups2=[],this.layerGroup1&&this.layerGroup1.clearLayers(),this.layerGroup2&&this.layerGroup2.clearLayers(),this.map.removeLayer(this.layerGroup1),this.map.removeLayer(this.layerGroup2),this.pane=null,this.options=null,this.container=null,this.data=null,delete this.layerGroup1,this.layerGroup2,this.pane,this.options,this.data}}]),b}(h);return a.exports=k,a.exports});;
Cube("datav:/com/datavmap-canvas2d-stream-popups/2.0.42",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"===typeof b||"function"===typeof b)?b:a}function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c("datav:/npm/eventemitter3/3.0.0"),i=c("datav:/npm/safely-merge/1.0.1"),j=c("datav:/com/datavmap-canvas2d-stream-popups/2.0.42/src/streamPopupsLayer"),k=function(a){function b(a,c){d(this,b);var f=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return f.options=i({renderer:"topinfo"},c),f.options.minZoom=c.zoomRange[0],f.options.maxZoom=c.zoomRange[1],f.options.visibility=!0,f}return f(b,a),g(b,[{key:"addTo",value:function(a){this.layer=new j(a,this.options)}},{key:"setZIndex",value:function(a){this.layer&&this.layer.setZIndex&&this.layer.setZIndex(a)}},{key:"render",value:function(a){this.layer&&this.layer.render&&this.layer.render(a)}},{key:"updateOptions",value:function(a){this.options=i(this.options,a),this.options.minZoom=a.zoomRange[0],this.options.maxZoom=a.zoomRange[1],this.layer&&this.layer.updateOptions&&this.layer.updateOptions(a)}},{key:"show",value:function(){this.options.visibility=!0,this.layer&&this.layer.show&&this.layer.show()}},{key:"hide",value:function(){this.options.visibility=!1,this.layer&&this.layer.hide&&this.layer.hide()}},{key:"destroy",value:function(){this.layer&&this.layer.destroy&&this.layer.destroy(),this.layer=null,this.options=null,delete this.options,this.layer}}]),b}(h);return a.exports=k,a.exports});