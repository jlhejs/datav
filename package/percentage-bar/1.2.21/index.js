// env=undefined => env=publish 
Cube("datav:/com/percentage-bar/1.2.21/template.html",[],function(i,t,e,o,r,d){return i.exports=function(){return'<div class="percentage-bar">\n  <div class="percent" style="padding-bottom: <%= component.paddingBottom %>px;">\n    <div class="percent-tooltip" style="display: inline-block; margin: 0px auto; position: relative; padding: 5px; opacity: 1;">\n      <div class="border tooltip-border" style="display: flex; height: 100%; width: 100%; position: absolute; top: 0px; left: 0px; border-top: 1px solid rgba(255, 255, 255, 0.6); border-right: 1px solid rgba(255, 255, 255, 0.6); border-bottom: none; border-left: 1px solid rgba(255, 255, 255, 0.6); border-image: initial; border-radius: 1px;">\n        <div class="left-border tooltip-border" style="width: 60%; border-bottom: 1px solid rgba(255, 255, 255, 0.6);"></div>\n        <div class="top-m-border" style="width: 15px;">\n          <div class="arrow tooltip-border" style="position: absolute; bottom: -5px; border-bottom: 1px solid rgba(255, 255, 255, 0.6); border-right: 1px solid rgba(255, 255, 255, 0.6); width: 11px; height: 11px; border-radius: 0px 0px 1px; transform: rotate(45deg) skew(10deg, 10deg);"></div>\n        </div>\n        <div class="right-border tooltip-border" style="width: 60%; border-bottom: 1px solid rgba(255, 255, 255, 0.6);"></div>\n      </div>\n      <div  class="text"><%= percentage %>%</div>\n      <div class="text-hide" style="visibility: hidden;position: absolute;">100%</div>\n    </div>\n  </div>\n  <div class="bar-box" style="padding: 0px 62px;">\n    <span class="right" style="position: relative; width: 1.5%; float: right;"><i class="right-before" style="position: absolute; width: 100%; height: 100%; border: 1px solid rgba(255, 255, 255, 0.6); border-radius: 1px; box-sizing: border-box;"></i></span>\n    <span class="left" style="position: relative; width: 1.5%; float: left;"><i class="left-before" style="position: absolute; width: 100%; height: 100%; border: 1px solid rgba(255, 255, 255, 0.6); border-radius: 1px; box-sizing: border-box;"></i></span>\n    <div class="bar" style="width: 97%; margin: 0px auto;">\n      <div class="inner" style="border-radius: 1px; border: 1px solid rgba(255, 255, 255, 0.6); padding: 2px; position: relative; margin: 0px 3px; box-sizing: content-box;">\n        <svg class="dotted-line" style="width: 100%; height: 100%; display: inherit;">\n          <defs>\n            <linearGradient id="<%= \'gradient\' + id %>" x1="0" y1="0" x2="100%" y2="0">\n              <stop offset="0%" stop-color="<%= percentageBar.startColor %>"/>\n              <stop offset="100%" stop-color="<%= percentageBar.endColor %>"/>\n            </linearGradient>\n            <clipPath id="<%= id %>">\n            </clipPath>\n          </defs>\n          <rect id="rect" x="0" y="0" width="100%" height="100%" fill="url(#<%= \'gradient\' + id %>)" clip-path="url(#<%= id %>)"/>\n        </svg>\n      </div>\n    </div>\n  </div>\n</div>'},i.exports});;
Cube("datav:/com/percentage-bar/1.2.21",["datav:/npm/bcore/0.0.18/event","datav:/npm/jquery/2.1.4","datav:/npm/lodash/4.6.1"],function(t,e,i,r,o,n){var a=i("datav:/npm/bcore/0.0.18/event"),g=i("datav:/npm/jquery/2.1.4"),s=i("datav:/npm/lodash/4.6.1"),h=i("datav:/com/percentage-bar/1.2.21/template.html")();return t.exports=a.extend(function(t,e){this.config={tip:{border:{show:!0,bordercolor:"rgba(255, 255, 255, 0.6)"}},percentageBar:{border:{show:!0,bordercolor:"rgba(255, 255, 255, 0.6)"}}},this.container=g(t),this.apis=e.apis,this._data=null,this.chart=null,this.id="svg-path-"+Math.random().toString(36).substr(2),this.init(e)},{init:function(t){this.mergeConfig(t),this.updateLayout()},render:function(t,e){t=this.data(t);e=this.mergeConfig(e);if(!t||!t.length){if(!e.emptyUpdate)return;t=[{value:0}]}t=this.getPercentage(t,e),t=s.assign(e,{percentage:t,id:this.id}),t=s.template(h)(t);this.container.html(t),g(".bar-box",this.container).css({padding:"0 "+e.component.barPadding+"px"}),this.updateStyle()},getSumVal:function(){var t=s.toNumber(s.get(this._data,["0","sum"])),e=s.toNumber(s.get(this.config,"sum"));return t||e},updateStyle:function(){var t=this.config;this.container.css({fontFamily:'"'+t.component.fontFamily+'"'}),this.updateTooltip(),this.updateBar()},updateTooltip:function(t){t?t.color!=this.config.tip.color||t.border.show!=this.config.tip.border.show||t.border.borderColor!=this.config.tip.border.borderColor?(this.config.tip=t,this.updateTooltipStyle(t)):(this.config.tip=t,this.updateTooltipLayout(t)):(t=this.config.tip,this.updateTooltipLayout(t),this.updateTooltipStyle(t))},updateBar:function(t){var e;t?(e=this.config.percentageBar,t.startColor!=e.startColor||t.endColor!=e.endColor||t.gradientRange!=e.gradientRange||t.border.show!=e.border.show||t.border.borderColor!=e.border.borderColor?(this.config.percentageBar=t,this.updateBarStyle(t)):(this.config.percentageBar=t,this.updateBarLayout(t))):(t=this.config.percentageBar,this.updateBarLayout(t),this.updateBarStyle(t))},updateBarLayout:function(t){var e,i=this.container,r=this.getRectScale().height,o=i.find("#"+this.id),n=this.getSegments().segments,a=this.getSegments().perBarWidth,s=g(".dotted-line",i),h=g(".bar-box",i),d=g(".bar",h),c=g(".left",h),i=c.siblings(".right"),h=g("#rect",s),s=this.getPercentage(),r=parseFloat(r);if(c.height(r),i.height(r),d.find(".inner").height(r-6),h.width((100<s?100:s)+"%"),o.html(""),n)for(var u=0,l=n.length;u<l;u++)e=n.length-1!==u?0<=n[u]-1?n[u]-1:0:0<=n[u]?n[u]:0,o.append(this.getRectDom(a*u,0,e,"100%"))},updateBarStyle:function(t){var e=this.container.find("#gradient"+this.id),i=e.children(),r=this.getSumVal();i.length&&(i.eq(0).attr("stop-color",t.startColor),i.eq(1).attr("stop-color",t.endColor)),"all"===this.config.percentageBar.gradientRange?0!==Number(this._data[0].value)&&e.attr("x2",100*r/Number(this._data[0].value)+"%"):e.attr("x2","100%");t=t.border.show?t.border.borderColor:"transparent";g(".right-before",this.container).css("border","1px solid "+t),g(".left-before",this.container).css("border","1px solid "+t),g(".inner",this.container).css("border","1px solid "+t)},updateTooltipStyle:function(t){var e=this.container,i=g(".text",e),r=t.color;g(".tooltip-border",e).css({opacity:t.border.show?1:0,"border-color":t.border.borderColor}),i.css({color:r})},updateTooltipLayout:function(t){var e=this.container,i=g(".text",e),r=g(".text-hide",e),o=this.getPercentage(),n=g(".percent-tooltip",e),a=this.container.width(),s=g(".bar-box",e),h=(g(".dotted-line",e),g(".border",n),g(".left",s),g(".right",s),g(".inner",s),t.fontSize),d=t.fontWeight,e=t.decimal,s=e.decimalPoint;e.decimalNum;0<i.length&&(e=void 0,e=t.trueValue?(this.data()[0].value||0)+t.sufUnit:o+"%",i.text(e)),n.css({fontSize:h,fontWeight:d,transform:"translate3d(-50%, 0, 0)"}),r.text(this.toDecimal(100,s)+"%");s=.97*this.container.width()-12-2*this.config.component.barPadding;n.css({marginLeft:(a-s)/2+(100<o?100:o)/100*s}),this.updateBarLayout()},getSegments:function(){var t=this.container,e=this.config.percentageBar.density,i=this.getPercentage(),t=(g(".dotted-line",t),.97*this.container.outerWidth()-12),r=[];if(!i)return 0;for(var o,n,e=(e=i/100*t/(o=t/e))-(n=Math.floor(e)),a=0;a<n;a++)r.push(o);return 0!=e&&r.push(e*o),{segments:r,perBarWidth:o}},getRectDom:function(t,e,i,r){var o=document.createElementNS("http://www.w3.org/2000/svg","rect");return o.setAttributeNS(null,"x",t),o.setAttributeNS(null,"y",e),o.setAttributeNS(null,"width",i),o.setAttributeNS(null,"height",r),o},getRectScale:function(){var t=this.config,e=this.container,i=t.width,r=t.height;return{width:i=0!==i&&!i?e.width():i,height:t=(t=(r=0!==r&&!r?e.height():r)-t.tip.fontSize-5-2-10-t.component.paddingBottom)<=0?1:t}},getPercentage:function(t,e){t=t||this.data();var i=(e=e||this.config).tip.decimal,r=this.getSumVal(),o=i.decimalPoint,e=i.decimalNum,i=0;return 0===(i=t&&s.isArray(t)&&0<t.length&&t[0]?t[0].value:i)||0===r?this.toDecimal(0,e):this.isSafeNum(i)&&this.isSafeNum(r)?(100<(r=i/r*100)?r=100:r<0&&(r=0),r=o?this.toDecimal(r,e):Math.round(parseFloat(r))):0},toDecimal:function(t,e){var i=parseFloat(t);if(isNaN(i))return!1;var r=(i=Math.round(100*t)/100).toString(),o=r.indexOf(".");for(o<0&&(o=r.length,r+=".");r.length<=o+e;)r+="0";return r},resize:function(t,e){this.mergeConfig({width:t,height:e}),this.updateStyle(),this.updateLayout(t,e)},setColors:function(){},data:function(t){return t&&(this._data=t),this._data},mergeConfig:function(t){return t&&(this.config.theme=s.defaultsDeep(t.theme||{},this.config.theme),this.setColors(),this.config=s.defaultsDeep(t||{},this.config)),this.config},updateLayout:function(t,e){},isSafeNum:function(t){return"string"==typeof t&&(t=Number(t)),s.isNumber(t)&&!s.isNaN(t)&&s.isFinite(t)?t:null},destroy:function(){this.container&&this.container.empty()},clear:function(){}}),t.exports});