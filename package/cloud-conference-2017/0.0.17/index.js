// env=undefined => env=publish 
Cube("datav:/com/cloud-conference-2017/0.0.17/controls/config.js",[],function(a){return a.exports=function(){return[{name:"overview",position:{x:-71.43,y:-193.88,z:183.67,lookAtX:91.48,lookAtY:-81.63,lookAtZ:20.41},duration:6e3,delay:2e3,onStart:function(){console.log("\u603B\u89C8 start")},onComplete:function(){console.log("\u603B\u89C8 complete")}},{name:"AB",position:{x:163.27,y:-183.67,z:122.45,lookAtX:581.63,lookAtY:-183.6,lookAtZ:-387.76},duration:6e3,delay:2e3,onStart:function(){console.log("AB\u533A start")},onComplete:function(){console.log("AB\u533A complete")}},{name:"C",position:{x:173.47,y:-163.2,z:112.24,lookAtX:-214.25,lookAtY:-163.42,lookAtZ:-744.9},duration:6e3,delay:2e3,onStart:function(){console.log("C\u533A start")},onComplete:function(){console.log("C\u533A complete")}},{name:"D",position:{x:173.47,y:183.67,z:95.84,lookAtX:-326.53,lookAtY:183.67,lookAtZ:-1e3},duration:6e3,delay:2e3,onStart:function(){console.log("D\u533A start")},onComplete:function(){console.log("D\u533A complete")}},{name:"E",position:{x:102.04,y:330.73,z:61.22,lookAtX:102.04,lookAtY:826.53,lookAtZ:-1e3},duration:6e3,delay:2e3,onStart:function(){console.log("E\u533A start")},onComplete:function(){console.log("E\u533A complete")}}]},a.exports});;
Cube("datav:/com/cloud-conference-2017/0.0.17/controls/scene-controls.js",["datav:/npm/lodash/4.16.4","datav:/npm/async/2.5.0","datav:/npm/three/0.83.0","datav:/npm/tween.js/16.6.0","datav:/npm/bcore/0.0.21/event","datav:/npm/bcore/0.0.21/utils"],function(a,b,c){const d=c("datav:/npm/lodash/4.16.4"),e=c("datav:/npm/async/2.5.0"),f=c("datav:/npm/three/0.83.0"),g=c("datav:/npm/tween.js/16.6.0"),h=c("datav:/npm/bcore/0.0.21/event"),i=c("datav:/npm/bcore/0.0.21/utils"),j={};return a.exports=class extends h{constructor(a,b,c){super(),this.options=i.deepMerge(j,a||{}),this.camera=b,this.orbitControls=c,this.isStop=!1,this.repeating=!1,this.prePos=null,this.currentPos=null,this.currentTween=null,this.getAllCameraPos(),this.initEvents()}initEvents(){this.on("switch-camera-position",this.switchCameraPositionByName.bind(this))}repeat(){if(!(1>this.cameraPos.length)){this.repeating=!0,this.prePos=this.cameraPos[0],this.currentPos||(this.currentPos=d.cloneDeep(this.prePos)),this.isStop=!1;let a=this.cameraPos[0].delay;this.cameraPos[0].delay=0,this.cameraPos.push(this.cameraPos.shift()),this.doSceneSwitch(),this.cameraPos[0].delay=a}}stop(){this.repeating=!1,this.prePos=d.cloneDeep(this.currentPos),this.currentTween&&this.currentTween.stop(),this.currentTween&&g.remove(this.currentTween),this.currentTween=null,this.isStop=!0}doSceneSwitch(){let a=this;e.eachSeries(this.cameraPos,this.doTween.bind(this),function(){console.log("done once..."),a.isStop||a.doSceneSwitch()})}doTween(a,b){let c=this.genTween(a,b);this.isStop?b("stop"):(this.currentTween=c,c.start())}getAllCameraPos(){this.cameraPos=c("datav:/com/cloud-conference-2017/0.0.17/controls/config.js")()}getCameraPosByName(a){let b=d.findIndex(this.cameraPos,function(b){return b.name==a});return this.cameraPos[b]}genTween(a,b){let c=this,e=this.camera,h=this.orbitControls,i=new g.Tween({x:c.prePos.position.x,y:c.prePos.position.y,z:c.prePos.position.z,lookAtX:c.prePos.position.lookAtX,lookAtY:c.prePos.position.lookAtY,lookAtZ:c.prePos.position.lookAtZ}).to(a.position,a.duration||4e3).delay(a.delay||1e3).onStart(function(){a.onStart&&a.onStart()}).easing(g.Easing.Quadratic.In).onUpdate(function(){c.currentPos&&(c.currentPos.position={x:this.x,y:this.y,z:this.z,lookAtX:this.lookAtX,lookAtY:this.lookAtY,lookAtZ:this.lookAtZ});let a=new f.Vector3(this.lookAtX,this.lookAtY,this.lookAtZ);h.target.copy(a),e.position.set(this.x,this.y,this.z),e.lookAt(a)}).onComplete(function(){a.onComplete&&a.onComplete(),c.prePos=d.cloneDeep(a),g.remove(),b&&b()});return i}removeLivingTween(){this.currentPos=null,this.currentTween&&this.currentTween.stop(),this.currentTween&&g.remove(this.currentTween),this.currentTween=null}switchCameraPositionByName(a){if("stop"===a)return this.stop();if("repeat"===a)return this.repeating?void 0:this.repeat();this.stop();let b=this.getCameraPosByName(a);if(b){this.currentPos||(this.currentPos=d.cloneDeep(b)),this.prePos||(this.prePos=d.cloneDeep(this.currentPos));let a=b.delay;b.delay=0;let c=this.genTween(b);c.start(),this.currentTween=c,b.delay=a}}updateOptions(a){this.options=i.deepMerge(this.options,a||{})}},a.exports});;
Cube("datav:/com/cloud-conference-2017/0.0.17",["datav:/npm/jquery/3.1.0","datav:/npm/tween.js/16.6.0","datav:/npm/three/0.83.0","datav:/npm/stats.js/0.17.0","datav:/npm/bcore/0.0.21/utils","datav:/npm/bcore/0.0.21/event","datav:/npm/three-orbit-controls/82.1.0"],function(a,b,c){const d=c("datav:/npm/jquery/3.1.0"),e=c("datav:/npm/tween.js/16.6.0"),f=c("datav:/npm/three/0.83.0"),g=c("datav:/npm/stats.js/0.17.0"),h=c("datav:/npm/bcore/0.0.21/utils"),i=c("datav:/npm/bcore/0.0.21/event"),j=c("datav:/npm/three-orbit-controls/82.1.0")(f),k=c("datav:/com/cloud-conference-2017/0.0.17/controls/scene-controls.js"),l={showStats:!0,camera:{x:0,y:0,z:100,lookAtX:0,lookAtY:0,lookAtZ:0}};return a.exports=class extends i{constructor(a,b){super(),this.container="string"===typeof a?document.querySelector(a):a,this.apis=b.apis,this.options=h.deepMerge(l,b),this.subcoms={},this.init(),this.initSceneControl(),this.switchScene(),this.loop()}init(){let a=this.options,b=this.container,c=b.offsetWidth,d=b.offsetHeight,e=this.scene=new f.Scene,h=this.camera=new f.PerspectiveCamera(75,c/d,0.1,1e8),i=a.camera,k=new f.Vector3(i.lookAtX,i.lookAtY,i.lookAtZ);h.up=new f.Vector3(0,0,1);let l=this.renderer=new f.WebGLRenderer({alpha:!0,antialias:!0,logarithmicDepthBuffer:!0});l.setSize(c,d),b.appendChild(l.domElement);let m=this.controls=new j(h,l.domElement);m.minDistance=0,m.maxDistance=4e4,m.target.copy(k),h.position.set(i.x,i.y,i.z),h.lookAt(k);let n=this.stats=new g;n.showPanel(0),b.appendChild(n.dom),n.dom.style.visibility=a.showStats?"visible":"hidden"}resize(a,b){this.renderer.setSize(a,b)}get(a){return this.coms[a]}add(a,b){return a?void(a.addTo&&a.addTo(this.scene),this.subcoms[b]=a):console.log("layer \u6CA1\u6709\u5B9A\u4E49")}remove(a,b){a.remove&&a.remove(),delete this.subcoms[b]}updateOptions(a){this.options=h.deepMerge(this.options,a||{}),this.updateThreeMap(),this.updateStats(),this.switchScene()}updateStats(){this.stats.dom.style.visibility=this.options.showStats?"visible":"hidden"}updateThreeMap(a){this.options=h.deepMerge(this.options,a||{});let b=this.options.camera,c=new f.Vector3(b.lookAtX,b.lookAtY,b.lookAtZ);this.controls.target.copy(c),this.camera.position.set(b.x,b.y,b.z),this.camera.lookAt(c)}initSceneControl(){this.sceneControl=new k({},this.camera,this.controls)}switchScene(a){let b=a||this.options.cameraPositionName;this.sceneControl&&this.sceneControl.emit("switch-camera-position",b)}loop(){this.options.showStats&&this.stats.update(),this.controls&&this.controls.update(),this.renderer.render(this.scene,this.camera),e.update(),window.requestAnimationFrame(this.loop.bind(this))}},a.exports});