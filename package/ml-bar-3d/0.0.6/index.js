// env=undefined => env=publish 
Cube("datav:/com/ml-bar-3d/0.0.6/utils",["datav:/npm/lodash/4.6.1","datav:/npm/moment/2.27.0"],function(t,e,n,i,l,s){var u=n("datav:/npm/lodash/4.6.1"),o="linear",c=n("datav:/npm/moment/2.27.0"),m=function(t){return u.includes(t+="",".")||(t+="."),u.replace(u.replace(t,/(\d)(?=(\d{3})+\.)/g,"$1,"),/\.$/,"")};return t.exports={transNumberFormatter:function(t){var e,n,i,l,s=t.v,r=t.type,d=t.format,a=t.prefix,t=t.suffix;return("d"===d||/.[0-9]f/.test(d)||/.[0-9]%/.test(d)||"th"===d||/.[0-9]t/.test(d))&&r===o?(e=u.toNumber(s),i=a,l=t,(n=d)?n.includes(".")&&n.includes("t")?i+m((+e).toFixed(n.split(".")[1].split("t")[0]))+l:n.includes("th")?i+m(u.floor(e))+l:n.includes(".")&&n.includes("f")?i+(+e).toFixed(n.split(".")[1].split("f")[0])+l:n.includes("%")?i+"".concat((100*e).toFixed(+n.split("%")[0].split(".")[1]),"%")+l:n.includes("d")?i+u.floor(e)+l:e:e):r===o&&"null"===d?a+u.toNumber(s)+t:"time"===r&&"null"!==d?a+c(s).format(d)+t:a+s+t},isValid:function(t){return!u.isUndefined(t)&&!u.isNull(t)&&!u.isNaN(t)}},t.exports});;
Cube("datav:/com/ml-bar-3d/0.0.6",["datav:/npm/bcore/0.0.18/event","datav:/npm/jquery/2.1.4","datav:/npm/lodash/4.6.1","datav:/npm/echarts/4.1.0","datav:/npm/datav-echartsgl-adaptor/0.0.3"],function(t,e,i,n,a,o){function l(e,t){var i,n=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)),n}function Oe(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?l(Object(i),!0).forEach(function(t){r(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function r(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var s=i("datav:/npm/bcore/0.0.18/event"),h=i("datav:/npm/jquery/2.1.4"),Ae=i("datav:/npm/lodash/4.6.1"),c=i("datav:/npm/echarts/4.1.0"),i=(i("datav:/npm/datav-echartsgl-adaptor/0.0.3"),i("datav:/com/ml-bar-3d/0.0.6/utils")),Pe=i.transNumberFormatter,je=i.isValid;return t.exports=s.extend(function(t,e){this.config={bar3D:{axis:{xaxis:{label:{interval:{show:!1,number:0}}},yaxis:{label:{interval:{show:!1,number:0}}}}}},this.container=h(t),this.apis=e.apis,this._data=null,this.chart=null,this.dataLists=null,this.init(e)},{init:function(t){this.mergeConfig(t),this.chart=c.init(this.container[0]),this.container.css({padding:"8px"})},render:function(t,e){var i=this,e=this.mergeConfig(e);!(t=this.data(t,e))||t.length<=0||(this.chart&&this.chart.clear(),this.chart=c.init(this.container[0]),this.setEChartsOptions(e),this.chart.on("click",function(t){t=t.value,t={x:i.dataLists.xAxis[t[0]],y:i.dataLists.yAxis[t[1]],z:t[2]};i.emit("itemSelect",t)}))},getEChartsData:function(t){var e=this.handleData(t,"x"),i=this.handleData(t,"y"),t=Ae.map(t,function(t){return[e.keyMap[t.x],i.keyMap[t.y],t.z]});return{xAxis:e.keyArr,yAxis:i.keyArr,zAxis:t}},handleData:function(t,e){t=Ae.uniqBy(t,e),t=Ae.map(t,function(t){return t[e]});return{keyArr:t,keyMap:Ae.reduce(t,function(t,e,i){return Oe(Oe({},t),{},r({},e,i))},{})}},setEChartsOptions:function(t){var i=this,t=t.bar3D,e=t.chart,n=e.boxSize,N=n.boxWidth,E=n.boxHeight,_=n.boxDepth,n=n.distance,a=e.fill,G=e.bevel,B=G.bevelSize,G=G.bevelSmoothness,H=e.projection,I=e.view,M=I.alpha,I=I.beta,o=e.center,q=o.x,Q=o.y,o=o.z,e=e.label,V=e.show,K=e.textStyle,X=e.distance,Y=e.labelContent,J=e.valueFormat,l=e.describe,e=t.axis,r=e.xaxis,U=r.isShow,s=r.type,h=r.label,Z=h.show,$=h.timeFormat,tt=h.valueFormat,et=h.interval,c=h.display,it=c.offset,nt=c.prefix,at=c.suffix,c=h.textStyle,h=r.title,d=r.axisLine,p=r.tickLine,x=r.axisPointer,ot=x.show,lt=x.margin,rt=x.lineStyle,st=rt.color,rt=rt.width,x=x.label,r=r.grid,f=e.yaxis,ht=f.isShow,ct=f.type,m=f.label,dt=m.show,pt=m.valueFormat,xt=m.timeFormat,ft=m.interval,u=m.display,mt=u.offset,ut=u.prefix,yt=u.suffix,u=m.textStyle,m=f.title,bt=f.axisLine,y=f.tickLine,b=f.axisPointer,wt=b.show,gt=b.margin,St=b.lineStyle,vt=St.color,St=St.width,b=b.label,f=f.grid,e=e.zaxis,Lt=e.isShow,w=e.extent,g=e.label,zt=g.show,kt=g.valueFormat,S=g.display,Ct=S.offset,Dt=S.prefix,Ot=S.suffix,S=g.textStyle,g=e.title,At=e.axisLine,v=e.tickLine,L=e.axisPointer,Pt=L.show,jt=L.margin,Wt=L.lineStyle,Tt=Wt.color,Wt=Wt.width,L=L.label,e=e.grid,z=t.animation.autoRotate,Ft=z.show,Rt=z.autoRotateDirection,z=z.autoRotateSpeed,k=t.legend,Nt=k.isShow,Et=k.textStyle,_t=k.orient,Gt=k.horAlignment,Bt=k.verAlignment,Ht=k.dimension,It=k.legendType,Mt=k.inverse,C=k.cateLegend,qt=C.markerSpace,Qt=qt.itemGap,qt=qt.textGap,Vt=C.marker,C=C.splitNumber,k=k.continuousLegend,D=k.handler,Kt=k.trackHor,k=k.trackVer,O=t.tooltip,A=O.mouse,Xt=A.xSensitivitySet,Yt=Xt.show,Xt=Xt.xSensitivity,Jt=A.ySensitivitySet,Ut=Jt.show,Jt=Jt.ySensitivity,Zt=A.zoomSensitivitySet,$t=Zt.show,Zt=Zt.zoomSensitivity,A=A.dampingSet,te=A.show,A=A.damping,P=O.tooltipSet,ee=P.show,j=P.titleTextStyle,W=P.contentTextStyle,ie=P.trigger,ne=P.titleSpace,ae=P.contentSpace,T=P.bgBox,oe=T.padding,le=T.backgroundColor,T=T.border,re=P.series,P=O.active,O=P.show,P=P.barColor,t=t.special,se=t.shading,F=t.postEffect,he=F.show,ce=F.bloom,de=ce.show,ce=ce.bloomIntensity,F=F.depthOfField,pe=F.show,xe=F.fstop,F=F.blurRadius,t=t.light,fe=t.show,R=t.main,me=R.show,ue=R.color,ye=R.intensity,be=R.isShadow,we=R.shadowQuality,ge=R.beta,R=R.alpha,t=t.ambient,Se=t.show,ve=t.color,t=t.intensity,Le=this.data(),ze=(this.dataLists=this.getEChartsData(Le),a.fixed),ke=a.mapping,a=a.scale,ke=ke?Ae.get(a,"range"):ze,a=Ae.map(this.dataLists.zAxis,function(t){return t[Ht]}),ze=d.show?{axisLine:{lineStyle:{color:d.line.lineColor,width:d.line.lineWidth}}}:{axisLine:{lineStyle:{width:0}}},d=h.show?{name:h.text,nameGap:h.offset,nameTextStyle:Oe({},h.textStyle)}:{name:null},Ce="value"===s?tt:$,h=Z?{axisLabel:{interval:et.show?et.number:"auto",margin:it,textStyle:Oe({},c),formatter:function(t){return Pe({v:t,type:s,format:Ce,prefix:nt,suffix:at})}}}:{axisLabel:{show:!1}},tt=U?Oe(Oe(Oe(Oe({},d),ze),{},{axisTick:{show:p.show,length:p.line.length,lineStyle:{color:p.line.lineColor,width:p.line.lineWidth}},splitLine:{show:r.show,lineStyle:{color:r.line.lineColor,width:r.line.lineWidth}}},h),{},{axisPointer:{show:ot,lineStyle:{color:st,width:rt},label:{show:ot,margin:lt,textStyle:Oe({backgroundColor:"rgba(0, 0, 0, 0)"},x)}}}):{axisLabel:{show:!1},axisTick:{lineStyle:{width:0}},axisLine:{lineStyle:{width:0}},splitLine:{lineStyle:{width:0}},name:null,axisPointer:{show:!1}},$=bt.show?{axisLine:{lineStyle:{color:bt.line.lineColor,width:bt.line.lineWidth}}}:{axisLine:{lineStyle:{width:0}}},Z=m.show?{name:m.text,nameGap:m.offset,nameTextStyle:Oe({},m.textStyle)}:{name:null},De="value"===ct?pt:xt,et=dt?{axisLabel:{interval:ft.show?ft.number:"auto",margin:mt,textStyle:Oe({},u),formatter:function(t){return Pe({v:t,type:ct,format:De,prefix:ut,suffix:yt})}}}:{axisLabel:{show:!1}},it=ht?Oe(Oe(Oe(Oe({},Z),$),{},{axisTick:{show:y.show,length:y.line.length,lineStyle:{color:y.line.lineColor,width:y.line.lineWidth}},splitLine:{show:f.show,lineStyle:{color:f.line.lineColor,width:f.line.lineWidth}}},et),{},{axisPointer:{show:wt,lineStyle:{color:vt,width:St},label:{show:wt,margin:gt,textStyle:Oe({backgroundColor:"rgba(0, 0, 0, 0)"},b)}}}):{axisLabel:{show:!1},axisTick:{lineStyle:{width:0}},axisLine:{lineStyle:{width:0}},splitLine:{lineStyle:{width:0}},name:"",axisPointer:{show:!1}},c=At.show?{axisLine:{lineStyle:{color:At.line.lineColor,width:At.line.lineWidth}}}:{axisLine:{lineStyle:{width:0}}},U=g.show?{name:g.text,nameGap:g.offset,nameTextStyle:Oe({},g.textStyle)}:{name:null},d=zt?{axisLabel:{margin:Ct,textStyle:Oe({},S),formatter:function(t){return Pe({v:t,type:"linear",format:kt,prefix:Dt,suffix:Ot})}}}:{axisLabel:{show:!1}},ze=Lt?Oe(Oe(Oe(Oe({},U),c),{},{axisTick:{show:v.show,length:v.line.length,lineStyle:{color:v.line.lineColor,width:v.line.lineWidth}},splitLine:{show:e.show,lineStyle:{color:e.line.lineColor,width:e.line.lineWidth}}},d),{},{axisPointer:{show:Pt,lineStyle:{color:Tt,width:Wt},label:{show:Pt,margin:jt,textStyle:Oe({backgroundColor:"rgba(0, 0, 0, 0)"},L)}}}):{axisLabel:{show:!1},axisTick:{lineStyle:{width:0}},axisLine:{lineStyle:{width:0}},splitLine:{lineStyle:{width:0}},name:null,axisPointer:{show:!1}},p=Se?{ambient:{color:ve,intensity:t}}:{},r="color"!==se&&fe?{light:Oe(Oe({},me?{main:{color:ue,intensity:ye,shadow:be,shadowQuality:we,alpha:R,beta:ge}}:{}),p)}:{},h=O?{emphasis:{itemStyle:{color:P}}}:{};this.chart.setOption({grid3D:Oe(Oe({show:!0,boxWidth:N,boxHeight:E,boxDepth:_,postEffect:{enable:he,bloom:{enable:de,bloomIntensity:ce},depthOfField:{enable:pe,fstop:xe,blurRadius:F}}},r),{},{viewControl:{projection:H,distance:n,alpha:M,beta:I,center:[q,Q,o],autoRotate:Ft,autoRotateDirection:Rt,autoRotateSpeed:z,rotateSensitivity:[Yt?Xt:0,Ut?Jt:0],zoomSensitivity:$t?Zt:0,damping:te?A:0}}),xAxis3D:Oe({type:"category",data:this.dataLists.xAxis},tt),yAxis3D:Oe({data:this.dataLists.yAxis,type:"category"},it),zAxis3D:Oe({type:"value",data:this.dataLists.zAxis,min:"min"===w.min?null:w.min,max:"max"===w.max?null:w.max},ze),tooltip:{show:ee,triggerOn:ie,backgroundColor:le,padding:[oe.paddingY,oe.paddingX],borderColor:T.borderColor,borderWidth:T.borderWidth,borderRadius:T.borderRadius,textStyle:Oe({},W),formatter:function(t){var a,e,o,l,r=Ae.uniqBy(re,"columnName");if(r&&0<r.length)return e=t.value,a=t.color,t=Ae.find(Le,{x:i.dataLists.xAxis[e[0]],y:i.dataLists.yAxis[e[1]],z:e[2]}),e=Pe({v:t.x,type:s,format:Ce,prefix:nt,suffix:at}),o=Ae.map(r,function(t){return t.columnName}),t=Ae.pick(t,o),l="",Ae.mapKeys(t,function(t,e){"x"===e&&(t=Pe({v:t,type:s,format:Ce,prefix:nt,suffix:at})),"y"===e&&(t=Pe({v:t,type:ct,format:De,prefix:ut,suffix:yt})),"z"===e&&(t=Pe({v:t,type:"linear",format:kt,prefix:Dt,suffix:Ot}));var i=Ae.findIndex(o,function(t){return t===e}),n=Ae.find(r,function(t){return t.columnName===e}),n=n.displayName||n.columnName;l+='\n                  <div style="margin-bottom: '.concat(ae,'px">\n                    <span style="\n                      display: inline-block;\n                      opacity: ').concat(0===i?1:0,";margin-right: 5px; width: 10px; height: 10px; background-color: ").concat(a,';\n                    "></span>\n                    <span\n                      style="\n                        font-size: ').concat(W.fontSize,"px;\n                        line-height: ").concat(W.fontSize,"px;\n                        color: ").concat(W.color,";\n                        font-weight: ").concat(W.fontWeight,";\n                        font-family: ").concat(W.fontFamily,';\n                      "\n                    >').concat(n,"：").concat(t,"</span>\n                  </div>\n                ")}),'\n                  <div style="margin-bottom: -'.concat(ae,'px">\n                    <div\n                      style="\n                        font-size: ').concat(j.fontSize,"px;\n                        line-height: ").concat(j.fontSize,"px;\n                        color: ").concat(j.color,";\n                        font-weight: ").concat(j.fontWeight,";\n                        font-family: ").concat(j.fontFamily,";\n                        margin-bottom: ").concat(ne,'px;\n                      "\n                    >').concat(e,"</div>\n                    ").concat(l,"\n                  </div>\n              ")}},visualMap:{show:Nt,type:It,orient:_t,left:Gt,top:Bt,textStyle:Oe(Oe({},Et),{},{fontStyle:"normal"}),itemWidth:"piecewise"===It?Vt.width:"horizontal"===_t?Kt.height:k.width,itemHeight:"piecewise"===It?Vt.height:"horizontal"===_t?Kt.width:k.height,itemGap:Qt,textGap:qt,splitNumber:C,dimension:Ht,inRange:{color:ke,symbol:Vt.shape},indicatorSiz:10,min:"auto"===D.min?Ae.minBy(a):parseInt(D.min),max:"auto"===D.max?Ae.maxBy(a):parseInt(D.max),calculable:!0,realtime:!0,hoverLink:!0,inverse:Mt},series:[Oe({type:"bar3D",coordinateSystem:"cartesian3D",bevelSize:B,bevelSmoothness:G,shading:se,data:this.dataLists.zAxis.map(function(t,e){return{name:t[2],value:[t[0],t[1],t[2]]}}),label:{show:V,textStyle:Oe(Oe({},K),{},{backgroundColor:"transparent"}),distance:X,formatter:function(t){t=t.value,t={x:i.dataLists.xAxis[t[0]],y:i.dataLists.yAxis[t[1]],z:t[2]},t=Ae.get(t,Y);if(je(t))return"z"===Y?Pe({v:t,type:"linear",format:J,prefix:l.prefix,suffix:l.suffix}):l.prefix+t+l.suffix}}},h)]},!0)},resize:function(t,e){this.chart.resize({width:t,height:e})},setColors:function(){},data:function(t){return t&&(this.__data=t),this._data=Ae.cloneDeep(this.__data),Ae.isArray(this._data)&&this._data.filter(function(t){return je(t.x)&&je(t.y)&&je(t.z)}).map(function(t){return t.z&&(t.z=Ae.toNumber(t.z)),t})},mergeConfig:function(t){return t&&(this.config.theme=Ae.defaultsDeep(t.theme||{},this.config.theme),this.setColors(),Ae.get(t,"bar3D.chart.fill")&&Ae.set(this.config,"bar3D.chart.fill",Ae.get(t,"bar3D.chart.fill")),Ae.get(t,"bar3D.tooltip.tooltipSet.series")&&Ae.set(this.config,"bar3D.tooltip.tooltipSet.series",Ae.get(t,"bar3D.tooltip.tooltipSet.series")),this.config=Ae.defaultsDeep(t||{},this.config)),this.config},updateLayout:function(){},updateStyle:function(){var t=this.config;this.container.css({"font-size":t.size+"px",color:t.color||"#fff"})},clear:function(){this.chart&&this.chart.clear&&this.chart.clear()},destroy:function(){this.chart&&this.chart.dispose&&this.chart.dispose(),this.chart=null,this.container&&(this.container.innerHTML="")}}),t.exports});