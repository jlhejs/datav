Cube('datav:/com/map2d-layer-tile/0.0.38',['datav:/npm/ldmap/0.1.42','datav:/npm/ldmap/0.1.42/core/utils','datav:/npm/bcore/0.0.21/event'],function(f,j,b,i,h,g){function a(){var b=arguments[arguments.length-1];this.options=d.deepMerge(a.options,b)}var c=b('datav:/npm/ldmap/0.1.42'),d=b('datav:/npm/ldmap/0.1.42/core/utils'),e=b('datav:/npm/bcore/0.0.21/event');return a.options={url:'GeoQBlue',hueRotate:0,saturate:100,contrast:100,brightness:100,opacity:1,invert:0,isFilter:!1,isAutoRefresh:!0,refreshTime:.1},a=e.extend(a,{addTo:function(a){a._map&&(a=a._map),this._map=a,this.initCom()},getOptions:function(){var a=this.options;return a.filter.opacity=a.opacity,a.isFilter?{url:a.url,filter:{hueRotate:a.filter.hueRotate*180,saturate:a.filter.saturate*200,brightness:a.filter.brightness*300,contrast:a.filter.contrast*200,opacity:a.opacity,invert:a.filter.invert*100}}:{url:a.url,filter:{hueRotate:0,saturate:100,brightness:100,contrast:100,opacity:a.opacity,invert:0}}},updateOptions:function(a){var b=this.options.url;a=this.options=d.deepMerge(this.options,a),a=this.getOptions(a);var c=this.filter;this.filter.updateOptions(a.filter),b!==a.url&&this.layer.update(a.url),this.options.isAutoRefresh&&this.autoRefresh(),this.options.isAutoRefresh||this.stopAutoRefresh()},get:function(a){return this.coms[a]},initCom:function(){var a=this.options;a=this.getOptions(a);var b=this.layer=c.dmap.tileLayer(a.url);b.addTo(this._map);var d=this.filter=c.dmap.filter(b,a.filter);this.options.isAutoRefresh&&this.autoRefresh()},autoRefresh:function(){this.options.url.indexOf('//')!==-1?(this.layer&&this.options.url.indexOf('?')!==-1&&this.layer.update(this.options.url+'&random='+Math.random()),this.layer&&this.options.url.indexOf('?')===-1&&this.layer.update(this.options.url+'?random='+Math.random())):this.layer&&this.layer.update(this.options.url);var a=this.options.refreshTime;this.timer=setTimeout(function(){this.autoRefresh()}.bind(this),a*1e3*60)},stopAutoRefresh:function(){this.timer&&clearTimeout(this.timer)},render:function(a){},destory:function(){this.stopAutoRefresh(),this._map.removeLayer(this.layer)}}),f.exports=a,f.exports})