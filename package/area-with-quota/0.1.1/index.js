Cube('datav:/com/area-with-quota/0.1.1',['datav:/com/area-with-quota/0.1.1/default.css.js','datav:/npm/bcore/0.0.9/event','datav:/npm/dchart-core/1.1.19/area/areaMulti','datav:/com/main-title/0.0.14','datav:/com/counter/0.0.2','datav:/npm/lodash/4.0.1','datav:/npm/jquery/2.1.4'],function(h,o,b,n,p,m){function l(a){return d[a]?d[a]:d[a]=c[a]()}var c={},d={};c['coms/area-with-quota/0.1.1/template.html']=c['coms/area-with-quota/0.1.1/template.html']=function(){return function(){return'<div class="sub-header">\n  <div class="sub-title"></div>\n  <div class="legend" style="position: absolute; right: 1em; top: 0;display: flex; align-items: center;line-height: 1.3;">\n    <div class="legend1 legend-item" style="margin: 0 5px;text-align: center;">\n      <div class="legend-rect" style="display: inline-block;"></div>\n      <div class="legend-label"></div>\n    </div>\n    <div class="legend2 legend-item" style="margin: 0 5px;text-align: center;">\n      <div class="legend-rect" style="display: inline-block;"></div>\n      <div class="legend-label"></div>\n    </div>\n  </div>\n</div>\n<div class="col" style="display: flex;align-items: center;text-indent: 1em;">\n  <div class="counter counter1" style="display: inline-block;  margin-right: 1em;"></div>\n  <div class="counter counter2" style="display: inline-block;  margin-right: 1em;"></div>\n</div>\n<div class="chart arear-quota"></div>\n'}},b('datav:/com/area-with-quota/0.1.1/default.css.js','');var i=b('datav:/npm/bcore/0.0.9/event'),g=b('datav:/npm/dchart-core/1.1.19/area/areaMulti'),j=b('datav:/com/main-title/0.0.14'),e=b('datav:/com/counter/0.0.2'),a=b('datav:/npm/lodash/4.0.1'),k=l('coms/area-with-quota/0.1.1/template.html'),f=b('datav:/npm/jquery/2.1.4');return h.exports=i.extend(function a(c,d){this.container=f(c).css({position:'absolute'});var b=this.config=f.extend(!0,{title:{value:'副标题',color:'#fff','background-color':'#000','font-size':'15px','text-align':'left','inner-style':{}},chart:{size:30,margin:{right:20,top:10,bottom:25,left:45},interpolate:null,xaxis:{color:'#fff',dy:8,show:!1,type:'category',padding:[.3,0]},yaxis:{color:'#fff',dy:8,show:!0}},series:{serie1:{'serie-color':'rgba(32, 108, 187, 0.7)',legend:{'font-size':10,color:'#fff',value:'系列1'},quota:{color:'#fff',prefix:'',suffix:'人','font-size':20,separate:!1}},serie2:{show:!0,'serie-color':'rgba(0, 253, 249, 0.7)',legend:{'font-size':10,color:'#fff',value:'系列2'},quota:{color:'#fff',prefix:'',suffix:'人','font-size':20,separate:!1}}},titleDom:'.sub-title',chartDom:'.chart',legendDom:'.legend',number1Dom:'.counter1',number2Dom:'.counter2'},d);this.chart=null,this.container.append(k),this.legendDom=this.container.find(b.legendDom),this.titleCon=this.container.find('.sub-header'),this.titleDom=this.container.find(b.titleDom),this.chartDom=this.container.find(b.chartDom),this.colDom=this.container.find('.col'),this.co1Dom=this.colDom.find(b.number1Dom),this.co2Dom=this.colDom.find(b.number2Dom),this._data=[],this.init()},{initLayout:function(){var c=this.config,b=this.container.height()||600,a=b*.15,d=b*.15,e=b*.7;this.titleCon.outerHeight(a),this.titleDom.outerHeight(a),this.colDom.outerHeight(d),this.chartDom.outerHeight(e),this.legendDom.outerHeight(a),c.title.height=a},init:function(){this.initLayout();var a=this.config;this.chart=new g(this.chartDom[0],a.chart||{}),this.title=new j(this.titleDom[0],a.title||{}),this.counter1=new e(this.co1Dom[0],a.series.serie1.quota),this.counter2=new e(this.co2Dom[0],a.series.serie2.quota),this.updateStyle()},updateStyle:function(){var c=this.config,b=c.series.serie1,a=c.series.serie2;this.co1Dom.css('color',b.quota.color),this.co2Dom.css('color',a.quota.color);var i=this.legendDom.find('.legend1'),j=this.legendDom.height(),g=(j-b.legend['font-size'])*.4,h=(j-a.legend['font-size'])*.4;i.find('.legend-rect').css({'background-color':b['serie-color'],height:g+'px',width:g+'px'}),i.find('.legend-label').css({color:b.legend.color,'font-size':b.legend['font-size']+'px'}).html(b.legend.value);var d=this.legendDom.find('.legend2');if(d.find('.legend-rect').css({'background-color':a['serie-color'],height:h+'px',width:h+'px'}),d.find('.legend-label').css({color:a.legend.color,'font-size':a.legend['font-size']+'px'}).html(a.legend.value),this.chart.el.select('.con-svg').style('background','transparent'),this.chart.svg&&this.chart.svg.selectAll('.serie1').style({fill:b['serie-color'],stroke:'none'}),a.show?(d.show(),this.counter2.container.show(),this.chart.svg&&this.chart.svg.selectAll('.serie2').style({fill:a['serie-color'],stroke:'none',display:'block'})):(d.hide(),this.counter2.container.hide(),this.chart.svg&&this.chart.svg.selectAll('.serie2').style('display','none')),this.chart.svg){var f=this.chart.svg.selectAll('.axis1'),e=this.chart.svg.selectAll('.axis2');c.chart.xaxis.show?(f.style('display','block'),f.selectAll('.tick text, .domain').style('fill',c.chart.xaxis.color)):f.style('display','none'),c.chart.yaxis.show?(e.style('display','block'),e.selectAll('.tick text, .domain').style('fill',c.chart.yaxis.color)):e.style('display','none')}},createArr:function(e){var c=[],d=this.config.series.serie2.show?2:1;for(var b=0;b<e;b++)c.push({x:'x'+b,y:a.fill(Array(d),0)});return c},dealData:function(c){c=c||this._data;var e=this.config,d=e.chart.size,b=this.createArr(d);return b=a.concat(b,a.dropRight(c,c.length-d)),a.drop(b,b.length-d)},data:function(a){return a&&(this._data=a),this._data},render:function(b,g){var c=this.config=a.defaultsDeep(g||{},this.config),d=this,e=c.series.serie1,f=c.series.serie2;b=a.cloneDeep(this.data(b)),b=this.dealData(b),this.title.render(null,c.title||{}),b&&this.counter1.render([{value:a.last(b).y[0]||''}],e.quota),c.chart.height=this.container.height()-this.titleCon.height()-this.colDom.height(),c.chart.xaxis.tickFormat=function(a,b){return b<c.chart.size-d._data.length?'':a},this.chart.render(b,c.chart),b&&this.counter2.render([{value:a.last(b).y[1]||''}],f.quota),this.updateStyle()},resize:function(a,b){this.initLayout(),this.chart.render(null,{width:a})}}),h.exports})