// env=undefined => env=publish 
Cube("datav:/com/countdown/0.0.13",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1","datav:/npm/lodash/4.6.1","datav:/npm/jquery/2.1.4"],function(t,e,i,n,o,s){var a=function(t,e,i){return e&&r(t.prototype,e),i&&r(t,i),t};function r(t,e){for(var i=0;i<e.length;i++){var n=e[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}var c=i("datav:/npm/eventemitter3/3.0.0"),f=i("datav:/npm/safely-merge/1.0.1"),h=i("datav:/npm/lodash/4.6.1"),u=i("datav:/npm/jquery/2.1.4"),a=(function(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function, not "+typeof e);t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,enumerable:!1,writable:!0,configurable:!0}}),e&&(Object.setPrototypeOf?Object.setPrototypeOf(t,e):t.__proto__=e)}(p,c),a(p,[{key:"init",value:function(){this.container.html('<span class="date dayNumbers"></span><span class="date dayUnit">天</span><span class="date time"></span>'),this.updateOptions(this.options),this.container.css({overflow:"hidden","text-overflow":"ellipsis","white-space":"nowrap",display:"flex","align-items":"center","justify-content":"center"})}},{key:"render",value:function(t){var e;t&&t.length?(this.data=t,this.timeout&&clearTimeout(this.timeout),this.container.find(".dayNumbers").text(0),this.container.find(".time").text("00:00:00"),e=(new Date).getTime()/1e3,t=this.parserDate(t[0].endTime)/1e3,this.secondsLeft=t-e,this.secondsLeft<=0||this.doTick()):console.log("数据配置不正确")}},{key:"doTick",value:function(){this.secondsLeft<=0&&(this.isFired||(this.isFired=!0),this.daysLeft=0,this.hoursLeft=0,this.minutesLeft=0,this.secondsLeft=0);var t=(new Date).getTime()/1e3,e=this.parserDate(this.data[0].endTime)/1e3;this.secondsLeft=e-t+1;var i=e-t+1,n=Math.floor(i/86400),e=Math.floor(i%86400/3600),t=Math.floor(i%86400%3600/60),i=Math.floor(i%86400%3600%60%60);this.container.find(".dayNumbers").text(n);for(var o=this.options.time.padding,s="",a=0;a<o;a++)s+=" ";i=this.numberFormate(e)+s+":"+s+this.numberFormate(t)+s+":"+s+this.numberFormate(i);this.container.find(".time").text(i),0==n&&"00:00:00"==i||(this.timeout=setTimeout(this.doTick,1e3),this.secondsLeft--)}},{key:"parserDate",value:function(t){var e=Date.parse(t);return isNaN(e)?new Date:new Date(Date.parse(t.replace(/-/g,"/")))}},{key:"numberFormate",value:function(t){return t<10?"0"+t:t}},{key:"updateOptions",value:function(t){this.options=f(this.options,t),this.container.find(".dayNumbers").css(h.pick(this.options.dayNumbers.textStyle,["fontSize","color","fontWeight","fontFamily"])),this.container.find(".dayUnit").css(h.pick(this.options.dayUnit.textStyle,["fontSize","color","fontWeight","fontFamily"])).css({"margin-left":this.options.dayUnit.marginLeft+"px","margin-right":this.options.dayUnit.marginRight+"px"}),this.container.css(h.pick(this.options.time.textStyle,["fontSize","color","fontWeight","fontFamily"]))}},{key:"remove",value:function(){this.timeout&&clearTimeout(this.timeout),window.removeEventListener(this.doTick),this.container.remove()}}]),p);function p(t,e){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,p);var i=function(t,e){if(!t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!e||"object"!=typeof e&&"function"!=typeof e?t:e}(this,(p.__proto__||Object.getPrototypeOf(p)).call(this));return i.options=Object.assign({},e),i.container="string"==typeof t?document.querySelector(t):t,i.container=u(t),i.daysLeft=0,i.hoursLeft=0,i.minutesLeft=0,i.secondsLeft=0,i.isFired=!1,i.doTick=i.doTick.bind(i),i.init(),i}return t.exports=a,t.exports});