// env=undefined => env=publish 
Cube("datav:/com/datav-2dmap-tile/3.0.9/src/libs/tileData",[],function(o,a,t,e,n,r){function i(o,a,t){a in o?Object.defineProperty(o,a,{value:t,enumerable:!0,configurable:!0,writable:!0}):o[a]=t}var m='&copy; <a href="#">高德地图</a>',p='&copy; <a href="#">腾讯地图</a>',s="Map tiles by Stamen Design";return o.exports=(i(p={SatelliteAMap:{url:"//webst02.is.autonavi.com/appmaptile?style=6&x={x}&y={y}&z={z}",options:{attribution:m,minZoom:2,maxZoom:18,name:"卫星(高德)"}},NormalGoogle:{url:"http://www.google.cn/maps/vt?lyrs=m@189&gl=cn&x={x}&y={y}&z={z}",options:{attribution:m,minZoom:2,maxZoom:18,name:"普通(谷歌)"}},"ESRI-World-Street":{url:"http://services.arcgisonline.com/arcgis/rest/services/World_Street_Map/MapServer/tile/{z}/{y}/{x}",options:{attribution:'&copy; <a href="./">ESRI</a>',minZoom:0,maxZoom:20,maxNativeZoom:18,name:"ESRI World Street"}},"ESRI-World-Dark":{url:"http://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Dark_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{attribution:'&copy; <a href="./">ESRI</a>',minZoom:0,maxZoom:20,maxNativeZoom:18,name:"ESRI World Dark"}},"ESRI-World-Light":{url:"http://services.arcgisonline.com/arcgis/rest/services/Canvas/World_Light_Gray_Base/MapServer/tile/{z}/{y}/{x}",options:{attribution:'&copy; <a href="./">ESRI</a>',minZoom:0,maxZoom:20,maxNativeZoom:18,name:"ESRI World Light"}},"Mapbox-World-Light":{url:"https:{s}.tiles.mapbox.com/v3/mapbox.world-light/{z}/{x}/{y}.png",options:{subdomains:"abc",attribution:'&copy; <a href="./">Mapbox</a>',minZoom:0,maxZoom:20,maxNativeZoom:18,name:"Mapbox World Light"}},"Mapbox-World-Dark":{url:"https:{s}.tiles.mapbox.com/v3/mapbox.world-dark/{z}/{x}/{y}.png",options:{subdomains:"abc",attribution:'&copy; <a href="./">Mapbox</a>',minZoom:0,maxZoom:20,maxNativeZoom:18,name:"Mapbox World Dark"}},"Mapbox-World-Blue":{url:"https:{s}.tiles.mapbox.com/v3/mapbox.world-blue/{z}/{x}/{y}.png",options:{subdomains:"abc",attribution:'&copy; <a href="./">Mapbox</a>',minZoom:0,maxZoom:20,maxNativeZoom:18,name:"Mapbox World Blue"}},OpenStreetMap:{url:"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:'&copy; <a href="http://www.openstreetmap.org/copyright">OpenStreetMap</a>',minZoom:2,name:"OpenStreetMap"}},"CartoDB-World-Light":{url:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/light_all/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:'&copy; <a href="http://cartodb.com/attributions">CartoDB</a>',subdomains:"abcd",minZoom:2,name:"CartoDB"}},"CartoDB-World-Dark":{url:"https://cartodb-basemaps-{s}.global.ssl.fastly.net/dark_all/{z}/{x}/{y}.png",options:{maxZoom:19,attribution:'&copy; <a href="http://cartodb.com/attributions">CartoDB</a>',subdomains:"abcd",minZoom:2,name:"CartoDB"}},AMapRoad:{url:function(o){var a=o.x,t=o.y,o=o.z;return"http://tm.amap.com/trafficengine/mapabc/traffictile?v=1.0&t=1&x=".concat(a,"&y=").concat(t,"&z=").concat(o,"&random=").concat(Math.random())},options:{attribution:m,minZoom:2,maxZoom:18,name:"路网(高德)"}},HeatmapAMap:{url:function(o){function a(o,a){return 0<(a-=o.toString().length)?new Array(a+(/\./.test(o)?2:1)).join("0")+o:"".concat(o)}var t=o.x,e=o.y,o=o.z,n=new Date,r=(n.setHours(n.getHours()-1),n.getFullYear()),i=a(n.getMonth()+1,2),m=a(n.getDate(),2),n=a(n.getHours(),2),r="".concat(r).concat(i).concat(m).concat(n);return"http://heatmap.amap.com/api/showmap/pvheatmap?x=".concat(t,"&y=").concat(e,"&z=").concat(o,"&showmap=equal&htime=").concat(r)},options:{attribution:m,minZoom:2,maxZoom:18,timeout:60,name:"热力图(高德)",expandPiexl:0}},SatelliteTMap:{url:function(o){var a=o.x,t=o.y,o=o.z,t=Math.pow(2,o)-t-1;return"http://p".concat(Math.floor(4*Math.random()),".map.gtimg.com/sateTiles/").concat(o,"/").concat(Math.floor(a/16),"/").concat(Math.floor(t/16),"/").concat(a,"_").concat(t,".jpg")},options:{attribution:p,minZoom:2,maxZoom:18,name:"卫星(腾讯)"}},SatelliteGoogle:{url:"http://mt3.google.cn/vt/lyrs=s&hl=zh-CN&gl=cn&x={x}&y={y}&z={z}",options:{attribution:m,minZoom:2,maxZoom:18,name:"卫星(谷歌)"}},TMapTerrain:{url:function(o){var a=o.x,t=o.y,o=o.z,t=Math.pow(2,o)-t-1;return"http://p".concat(Math.floor(4*Math.random()),".map.gtimg.com/demTiles/").concat(o,"/").concat(Math.floor(a/16),"/").concat(Math.floor(t/16),"/").concat(a,"_").concat(t,".jpg")},options:{attribution:p,minZoom:2,maxZoom:18,name:"地形(腾讯)"}},TianDiMap:{url:"//t0.tianditu.com/DataServer?T=vec_w&x={x}&y={y}&l={z}",options:{minZoom:2,maxZoom:18,name:"天地图"}},SatelliteEsri:{url:"//server.arcgisonline.com/arcgis/rest/services/world_imagery/mapserver/tile/{z}/{y}/{x}",options:{attribution:'&copy; <a href="//maps.esri.com/">esri</a>',minZoom:0,maxZoom:20,name:"卫星(esri)"}},TMapRoad:{url:function(o){var a=o.x,t=o.y,o=o.z,e="".concat(Date.parse(new Date)),n="abc".charAt(~~(3*Math.random())),a=a.toString(),t=t.toString(),o=o.toString();return"//rtt2".concat(n,".map.qq.com/rtt/?z=").concat(o,"&x=").concat(a,"&y=").concat(Math.pow(2,+o)-1-t,"&timeKey=").concat(e.substring(0,e.length-4))},options:{attribution:p,minZoom:2,maxZoom:18,name:"路网(腾讯)"}},NormalAMap1:{url:"//webrd03.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=7&x={x}&y={y}&z={z}",options:{attribution:m,minZoom:2,maxZoom:18,name:"简单(高德)"}},NormalAMap:{url:"//webrd03.is.autonavi.com/appmaptile?lang=zh_cn&size=1&scale=1&style=8&x={x}&y={y}&z={z}",options:{attribution:m,minZoom:2,maxZoom:18,name:"普通(高德)"}},GeoQBlue:{url:"//map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetPurplishBlue/MapServer/tile/{z}/{y}/{x}",options:{attribution:'&copy; <a href="./">geoq</a>',minZoom:0,maxZoom:20,maxNativeZoom:16,name:"蓝色(geoQ)"}},GeoQGray:{url:"//map.geoq.cn/ArcGIS/rest/services/ChinaOnlineStreetGray/MapServer/tile/{z}/{y}/{x}",options:{attribution:'&copy; <a href="./">geoq</a>',minZoom:0,maxZoom:20,maxNativeZoom:16,name:"灰色(geoQ)"}},GeoQBound:{url:"//thematic.geoq.cn/arcgis/rest/services/ThematicMaps/administrative_division_boundaryandlabel/MapServer/tile/{z}/{y}/{x}",options:{attribution:'&copy; <a href="./">geoq</a>',minZoom:0,maxZoom:11,maxNativeZoom:11,name:"边界(geoQ)"}},GeoQColorplate:{url:"//map.geoq.cn/ArcGIS/rest/services/ChinaOnlineCommunity/MapServer/tile/{z}/{y}/{x}",options:{attribution:'&copy; <a href="./">geoq</a>',minZoom:0,maxZoom:20,maxNativeZoom:16,name:"彩色(geoQ)"}},GeoQBoundOnly:{url:"http://30.9.160.123:8887/v2/tiles/{z}/{x}/{y}.pbf",options:{attribution:'&copy; <a href="./">geoq</a>',minZoom:0,maxZoom:20,maxNativeZoom:16,name:"仅边界(geoQ)"}},GeoQWater:{url:"//thematic.geoq.cn/arcgis/rest/services/ThematicMaps/WorldHydroMap/MapServer/tile/{z}/{y}/{x}",options:{attribution:'&copy; <a href="./">geoq</a>',minZoom:0,maxZoom:20,name:"水系(geoQ)"}},GeoQRailway:{url:"//thematic.geoq.cn/arcgis/rest/services/ThematicMaps/Subway/MapServer/tile/{z}/{y}/{x}",options:{attribution:'&copy; <a href="./">geoq</a>',minZoom:0,maxZoom:20,maxNativeZoom:16,name:"地铁(geoQ)"}}},"OpenStreetMap",{disable:!0,url:"//{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",options:{attribution:'&copy; <a href="//www.openstreetmap.org/copyright">OpenStreetMap</a>',name:"OSM"},variants:{Mapnik:{},BlackAndWhite:{url:"//{s}.tiles.wmflabs.org/bw-mapnik/{z}/{x}/{y}.png"},DE:{url:"//{s}.tile.openstreetmap.de/tiles/osmde/{z}/{x}/{y}.png"},HOT:{url:"//{s}.tile.openstreetmap.fr/hot/{z}/{x}/{y}.png",options:{attribution:'{attribution.OpenStreetMap}, Tiles courtesy of <a href="//hot.openstreetmap.org/" target="_blank">Humanitarian OpenStreetMap Team</a>'}}}}),i(p,"StamenToner",{url:"//{s}.tile.stamen.com/toner/{z}/{x}/{y}.png",options:{attribution:s,subdomains:"abcd",minZoom:0,maxZoom:20,name:"木刻(stamen)"}}),i(p,"StamenWaterColor",{url:"//{s}.tile.stamen.com/watercolor/{z}/{x}/{y}.png",options:{attribution:s,subdomains:"abcd",minZoom:1,maxZoom:16,name:"水彩(stamen)"}}),i(p,"OpenTopoMap",{url:"//{s}.tile.opentopomap.org/{z}/{x}/{y}.png",options:{attribution:'&copy; <a href="//opentopomap.org/">opentopomap</a>',subdomains:"abcd",minZoom:0,maxZoom:20,name:"高程(OTM)",desc:"免费地图，数据来自OpenStreetMap和SRTM高程数据"}}),p),o.exports});;
Cube("datav:/com/datav-2dmap-tile/3.0.9/src/libs/wms",[],function(t,e,r,n,o,i){function s(t){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var c=["translateX","translateY"];function a(e,t){var r,n=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)),n}function u(n){for(var t=1;t<arguments.length;t++){var o=null!=arguments[t]?arguments[t]:{};t%2?a(Object(o),!0).forEach(function(t){var e,r;e=n,r=o[t=t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(o,t))})}return n}function l(t,e){if(null==t)return{};var r,n=function(t,e){if(null==t)return{};var r,n,o={},i=Object.keys(t);for(n=0;n<i.length;n++)r=i[n],0<=e.indexOf(r)||(o[r]=t[r]);return o}(t,e);if(Object.getOwnPropertySymbols)for(var o=Object.getOwnPropertySymbols(t),i=0;i<o.length;i++)r=o[i],0<=e.indexOf(r)||Object.prototype.propertyIsEnumerable.call(t,r)&&(n[r]=t[r]);return n}function f(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function p(t,e){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function y(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=b(r),e=(t=n?(t=b(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===s(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}return t.exports=function(i,s){var t=i.TileLayer.WMS,e=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&p(e,t);var r,n=y(o);function o(t,e,r){if(this instanceof o)return(t=n.call(this,t,e)).trans=r,t;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"getTileUrl",value:function(t){this.updateCrs(i.CRS[s.options.crsCode]);var e=this._tileCoordsToNwSe(t),r=this._crs,r=i.bounds(r.project(e[0]),r.project(e[1])),e=r.min,r=r.max,n=this.trans,o=n.translateX,n=n.translateY,o=(e.x+=o,r.x+=o,e.y+=n,r.y+=n,(1.3<=this._wmsVersion&&this._crs===EPSG4326?[e.y,e.x,r.y,r.x]:[e.x,e.y,r.x,r.y]).join(",")),n=i.TileLayer.prototype.getTileUrl.call(this,t);return n+i.Util.getParamString(this.wmsParams,n,this.options.uppercase)+(this.options.uppercase?"&BBOX=":"&bbox=")+o}},{key:"updateOptions",value:function(t){var e=t.url,t=t.options,e=(this.setUrl(e),t.translateX),r=t.translateY,t=l(t,c),n=Object.assign(this.options,u({},t));this.trans={translateX:e,translateY:r},this.updateCrs(t.crs),this.setParams(n)}},{key:"updateCrs",value:function(t){this._crs=t,this._wmsVersion=parseFloat(this.wmsParams.version);t=1.3<=this._wmsVersion?"crs":"srs";this.wmsParams[t]=this._crs.code}}])&&f(e.prototype,t),r&&f(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o},t.exports});;
Cube("datav:/com/datav-2dmap-tile/3.0.9/src/libs/filter",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(t,e,r,n,o,i){function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function s(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=f(r),e=(t=n?(t=f(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===c(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=r("datav:/npm/eventemitter3/3.0.0"),p=r("datav:/npm/safely-merge/1.0.1"),r=function(){var t=o,e=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=s(o);function o(t,e){var r;if(this instanceof o)return(r=n.call(this)).DEFAULTS={brightness:1,contrast:1,grayscale:0,hueRotate:0,invert:0,saturate:1,sepia:0,blur:0},r.options=p(r.DEFAULTS,e),r.container=t,r;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"reset",value:function(){this.updateFilter(this.DEFAULTS)}},{key:"updateFilter",value:function(t){this.container.style.transition="-webkit-filter .2s",this.container.style["-webkit-filter"]="brightness(".concat(this.toPercent(t.brightness),") contrast(").concat(this.toPercent(t.contrast),") grayscale(").concat(this.toPercent(t.grayscale),") hue-rotate(").concat(t.hueRotate,"deg) invert(").concat(this.toPercent(t.invert),") saturate(").concat(this.toPercent(t.saturate),") sepia(").concat(this.toPercent(t.sepia),") blur(").concat(t.blur,"px)")}},{key:"toPercent",value:function(t){return"".concat((Math.round(1e4*t)/100).toFixed(2),"%")}},{key:"updateOptions",value:function(t){this.options=p(this.options,t),this.updateFilter(this.options)}}])&&a(t.prototype,e),r&&a(t,r),Object.defineProperty(t,"prototype",{writable:!1}),o}();return t.exports=r,t.exports});;
Cube("datav:/com/datav-2dmap-tile/3.0.9/config",[],function(e,r,a,o,s,t){return e.exports={DEFAULT_OPTIONS:{renderer:"basemap",general:{zoomRange:[0,18],minZoom:0,maxZoom:18,opacity:100},graph:{tileType:"normalTile",normalTile:{url:"NormalAMap",tileSize:256,zoomOffset:0,tms:!1,errorTileUrl:"",subdomains:[],crossOrigin:!1},wmsTile:{url:"",layers:"",crs:"3857",format:"image/png",translateX:.2,translateY:.35},autoRefresh:{show:!1,refreshTime:10},mask:{show:!1,maskColor:"rgba(0,0,0,0)"},filter:{show:!1,brightness:1,contrast:1,grayscale:0,hueRotate:0,invert:0,saturate:1,sepia:0,blur:0}}}},e.exports});;
Cube("datav:/com/datav-2dmap-tile/3.0.9/src/wmsTileLayer",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(t,e,a,i,o,s){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var h=["translateX","translateY"],y=["translateX","translateY"];function n(e,t){var i,o=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,i)),o}function c(o){for(var t=1;t<arguments.length;t++){var s=null!=arguments[t]?arguments[t]:{};t%2?n(Object(s),!0).forEach(function(t){var e,i;e=o,i=s[t=t],t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(s)):n(Object(s)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(s,t))})}return o}function u(t,e){if(null==t)return{};var i,o=function(t,e){if(null==t)return{};var i,o,s={},r=Object.keys(t);for(o=0;o<r.length;o++)i=r[o],0<=e.indexOf(i)||(s[i]=t[i]);return s}(t,e);if(Object.getOwnPropertySymbols)for(var s=Object.getOwnPropertySymbols(t),r=0;r<s.length;r++)i=s[r],0<=e.indexOf(i)||Object.prototype.propertyIsEnumerable.call(t,i)&&(o[i]=t[i]);return o}function m(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function f(t,e){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function b(i){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l(i),e=(t=o?(t=l(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var d=a("datav:/npm/eventemitter3/3.0.0"),g=a("datav:/npm/safely-merge/1.0.1");return t.exports=function(t){var l=t.L,p=t.map,e=a("datav:/com/datav-2dmap-tile/3.0.9/src/libs/filter"),n=a("datav:/com/datav-2dmap-tile/3.0.9/src/libs/wms"),t=r,i=d;if("function"!=typeof i&&null!==i)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(i&&i.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),i&&f(t,i);var o,s=b(r);function r(t){var e;if(this instanceof r)return(e=s.call(this)).options=g({},t),e.options.general.minZoom=t.general.zoomRange[0],e.options.general.maxZoom=t.general.zoomRange[1],e.options.visibility=!0,e.init(),e;throw new TypeError("Cannot call a class as a function")}return t=r,(i=[{key:"init",value:function(){var e=this,t=this.tileOptions=this.getTileOptions(),i=t.options,o=i.translateX,s=i.translateY,i=u(i,h),r=n(l,p),r=(this.layer=new r(t.url,i,{translateX:o,translateY:s}),this.layer.addTo(p),this.initFilter(),this.updateFilter(this.options.graph),this.options.graph.autoRefresh.show&&this.autoRefresh(),this.mask=document.createElement("div")),t=p.getSize();r.style.width="".concat(t.x,"px"),r.style.height="".concat(t.y,"px"),r.style.position="absolute",r.style.top=0,r.style.left=0,r.style.zIndex=1,r.style.pointerEvents="none",r.style.background=this.options.graph.mask.maskColor||"rgba(0,0,0,0)",r.setAttribute("class","leaflet-mask"),this.options.graph.mask.show?r.style.display="block":r.style.display="none",p.getPane("tilePane").appendChild(r),p.on("move",function(){var t;e.mask&&(t=p.getSize(),e.mask.style.width="".concat(t.x,"px"),e.mask.style.height="".concat(t.y,"px"),(t=l.DomUtil.getPosition(p.getPane("mapPane")))&&l.DomUtil.setPosition(e.mask,{x:-t.x,y:-t.y}))},this),this.options.visibility?this.show():this.hide()}},{key:"getTileOptions",value:function(){var t=this.options,e=t.general,t=t.graph.wmsTile,i=t.url,o=t.layers,s=t.format,r=t.translateX,t=t.translateY,n=l.CRS[p.options.crsCode],a="China".concat("EPSG3857"===p.options.crsCode?"":"_4326"),a={url:"https://iserver.supermap.io/iserver/services/map-china400/wms111/".concat(a),options:{layers:a}},e={url:""===i?a.url:i,options:{minZoom:e.minZoom||0,maxZoom:e.maxZoom||20,maxNativeZoom:e.maxZoom||18,opacity:.01*+e.opacity||1,crs:n,transparent:!0,layers:o,format:s,translateX:r,translateY:t}};return""===i&&(e.options=Object.assign(e.options,a.options)),e}},{key:"initFilter",value:function(){this.filter=new e(this.layer.getContainer(),this.options.filter)}},{key:"autoRefresh",value:function(){var t=this,e=this.tileOptions.url,e=("string"==typeof e?this.layer&&this.layer.setUrl("".concat(e+(e.split("?")[1]?"&":"?"),"random=").concat(Math.random())):this.layer&&this.layer.setUrl(e),this.options.graph.autoRefresh.refreshTime);this.timer=setTimeout(function(){t.autoRefresh&&t.autoRefresh()},1e3*e*60)}},{key:"stopAutoRefresh",value:function(){this.timer&&clearTimeout(this.timer),this.timer=null}},{key:"isLayerUpdate",value:function(e){var i=this,t=e.url,o=e.options,s=(o.translateX,o.translateY,u(o,y)),o=Object.keys(s),r=Object.keys(this.layer.trans);return o.some(function(t){return i.layer.options[t]!==c({},s)[t]})||r.some(function(t){return i.layer.trans[t]!==e.options[t]})||this.layer._url!==t}},{key:"updateOptions",value:function(t){var e=g({},this.options.general),i=g({},this.options.graph),o=(this.options=g(this.options,t),this.options),s=o.general,r=o.graph,o=o.visibility;this.layer&&(JSON.stringify(e.zoomRange)!=JSON.stringify(s.zoomRange)&&(this.options.general.minZoom=s.zoomRange[0],this.options.general.maxZoom=s.zoomRange[1]),e=p.getZoom(),o&&e>=s.minZoom&&e<=s.maxZoom?(this.layer&&this.layer.setOpacity(.01*s.opacity),this.options.graph.mask.show?this.mask&&(this.mask.style.display="block"):this.mask&&(this.mask.style.display="none")):(this.layer&&this.layer.setOpacity(0),this.mask&&(this.mask.style.display="none")),o=this.tileOptions=this.getTileOptions(),this.isLayerUpdate(o)&&this.layer.updateOptions(o),i.mask.maskColor!=r.mask.maskColor&&(this.mask.style.background=t.graph.mask.maskColor),this.timer&&this.stopAutoRefresh(),this.options.isAutoRefresh&&this.autoRefresh(),this.updateFilter(t.graph))}},{key:"updateFilter",value:function(t){t.filter.show?this.filter.updateOptions(t.filter):this.filter&&this.filter.reset()}},{key:"setZIndex",value:function(t){this.layer&&this.layer.setZIndex(t),this.mask&&(this.mask.style.zIndex=t+1)}},{key:"onZoomEnd",value:function(t){var e=this.options,i=e.general,o=e.visibility;e.opacity;o&&t>=i.minZoom&&t<=i.maxZoom?(this.layer&&this.layer.setOpacity(.01*+i.opacity),this.mask&&this.options.graph.mask.show&&(this.mask.style.display="block")):(this.layer&&this.layer.setOpacity(0),this.mask&&!this.options.graph.mask.show&&(this.mask.style.display="none"))}},{key:"show",value:function(){this.options.visibility=!0,this.layer&&this.layer.setOpacity(.01*+this.options.general.opacity),this.mask&&this.options.graph.mask.show&&(this.mask.style.display="block")}},{key:"hide",value:function(){this.options.visibility=!1,this.layer&&this.layer.setOpacity(0),this.mask&&!this.options.graph.mask.show&&(this.mask.style.display="none")}},{key:"destroy",value:function(){this.stopAutoRefresh(),this.mask&&this.mask.remove(),this.mask=null,this.layer&&this.layer.remove(),this.layer=null,this.options=null,this.filter=null,this.tileOptions=null,delete this.options,this.mask,this.filter,this.tileOptions,this.layer}}])&&m(t.prototype,i),o&&m(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r},t.exports});;
Cube("datav:/com/datav-2dmap-tile/3.0.9/src/tileLayer",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(t,e,h,i,o,s){function n(t){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(t,e){for(var i=0;i<e.length;i++){var o=e[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function y(t,e){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function m(i){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=r(i),e=(t=o?(t=r(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===n(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function r(t){return(r=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=h("datav:/npm/eventemitter3/3.0.0"),c=h("datav:/npm/safely-merge/1.0.1");return t.exports=function(t){var o=t.L,r=t.map,i=h("datav:/com/datav-2dmap-tile/3.0.9/src/libs/tileData"),e=h("datav:/com/datav-2dmap-tile/3.0.9/src/libs/filter"),t=l,s=u;if("function"!=typeof s&&null!==s)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(s&&s.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),s&&y(t,s);var n,a=m(l);function l(t){var e;if(this instanceof l)return(e=a.call(this)).options=c({},t),e.options.general.minZoom=t.general.zoomRange[0],e.options.general.maxZoom=t.general.zoomRange[1],e.options.visibility=!0,e.init(),e;throw new TypeError("Cannot call a class as a function")}return t=l,(s=[{key:"init",value:function(){var e=this,t=this.tileOptions=this.getTileOptions(),t=(t.options.attribution="",this.layer=o.tileLayer(t.url,t.options),this.layer.addTo(r),this.layer._url=t.url,this.initFilter(),this.updateFilter(this.options.graph),this.options.graph.autoRefresh.show&&this.autoRefresh(),this.mask=document.createElement("div")),i=r.getSize();t.style.width="".concat(i.x,"px"),t.style.height="".concat(i.y,"px"),t.style.position="absolute",t.style.top=0,t.style.left=0,t.style.zIndex=1,t.style.pointerEvents="none",t.style.background=this.options.graph.mask.maskColor||"rgba(0,0,0,0)",t.setAttribute("class","leaflet-mask"),this.options.graph.mask.show?t.style.display="block":t.style.display="none",r.getPane("tilePane").appendChild(t),r.on("move",function(){var t;e.mask&&(t=r.getSize(),e.mask.style.width="".concat(t.x,"px"),e.mask.style.height="".concat(t.y,"px"),(t=o.DomUtil.getPosition(r.getPane("mapPane")))&&o.DomUtil.setPosition(e.mask,{x:-t.x,y:-t.y}))},this),this.options.visibility?this.show():this.hide()}},{key:"getTileOptions",value:function(){var t=this.options,e=t.general,t=t.graph,e=t.normalTile.url?i[t.normalTile.url]||{url:t.normalTile.url,options:{opacity:.01*+e.opacity||1,minZoom:e.minZoom||0,maxZoom:e.maxZoom||22,maxNativeZoom:e.maxZoom||18}}:i.NormalAMap;return e.options=c(e.options,{tms:t.normalTile.tms,tileSize:t.normalTile.tileSize||256,zoomOffset:t.normalTile.zoomOffset||0}),e}},{key:"initFilter",value:function(){this.filter=new e(this.layer.getContainer(),this.options.graph.filter)}},{key:"autoRefresh",value:function(){var t=this,e=this.tileOptions.url,e=("string"==typeof e?this.layer&&this.layer.setUrl("".concat(e+(e.split("?")[1]?"&":"?"),"random=").concat(Math.random())):this.layer&&this.layer.setUrl(e),this.options.graph.autoRefresh.refreshTime);this.timer=setTimeout(function(){t.autoRefresh&&t.autoRefresh()},1e3*e*60)}},{key:"stopAutoRefresh",value:function(){this.timer&&clearTimeout(this.timer),this.timer=null}},{key:"updateOptions",value:function(t){var e=c({},this.options.general),i=c({},this.options.graph),o=(this.options=c(this.options,t),this.options),s=o.general,n=o.graph,o=o.visibility;this.layer&&(JSON.stringify(e.zoomRange)!=JSON.stringify(s.zoomRange)&&(this.options.general.minZoom=s.zoomRange[0],this.options.general.maxZoom=s.zoomRange[1]),e=r.getZoom(),o&&e>=this.options.general.minZoom&&e<=this.options.general.maxZoom?(this.layer&&this.layer.setOpacity(.01*+this.options.general.opacity),this.options.graph.mask.show?this.mask&&(this.mask.style.display="block"):this.mask&&(this.mask.style.display="none")):(this.layer&&this.layer.setOpacity(0),this.mask&&(this.mask.style.display="none")),s=this.tileOptions=this.getTileOptions(),this.layer._url===s.url&&this.layer.options.tileSize===s.options.tileSize&&this.layer.options.zoomOffset===s.options.zoomOffset&&this.layer.options.tms===s.options.tms||(this.layer._url=s.url,this.layer.options=c(this.layer.options,s.options),this.layer.setUrl(s.url,!1)),i.mask.maskColor!=n.mask.maskColor&&(this.mask.style.background=t.graph.mask.maskColor),this.timer&&this.stopAutoRefresh(),n.autoRefresh.show&&this.autoRefresh(),this.updateFilter(t.graph))}},{key:"updateFilter",value:function(t){t.filter.show?this.filter.updateOptions(t.filter):this.filter&&this.filter.reset()}},{key:"setZIndex",value:function(t){this.layer&&this.layer.setZIndex(t),this.mask&&(this.mask.style.zIndex=t+1)}},{key:"onZoomEnd",value:function(t){var e=this.options,i=e.general;e.visibility&&t>=i.minZoom&&t<=i.maxZoom?(this.layer&&this.layer.setOpacity(.01*+i.opacity),this.mask&&this.options.graph.mask.show&&(this.mask.style.display="block")):(this.layer&&this.layer.setOpacity(0),this.mask&&!this.options.graph.mask.show&&(this.mask.style.display="none"))}},{key:"show",value:function(){this.options.visibility=!0,this.layer&&this.layer.setOpacity(.01*this.options.general.opacity),this.mask&&this.options.graph.mask.show&&(this.mask.style.display="block")}},{key:"hide",value:function(){this.options.visibility=!1,this.layer&&this.layer.setOpacity(0),this.mask&&!this.options.graph.mask.show&&(this.mask.style.display="none")}},{key:"destroy",value:function(){this.stopAutoRefresh(),this.mask&&this.mask.remove(),this.mask=null,this.layer&&this.layer.remove(),this.layer=null,this.options=null,this.filter=null,this.tileOptions=null,delete this.options,this.mask,this.filter,this.tileOptions,this.layer}}])&&p(t.prototype,s),n&&p(t,n),Object.defineProperty(t,"prototype",{writable:!1}),l},t.exports});;
Cube("datav:/com/datav-2dmap-tile/3.0.9",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(t,e,o,n,r,i){function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function p(o){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=y(o),e=(t=n?(t=y(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function y(t){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=o("datav:/npm/eventemitter3/3.0.0"),c=o("datav:/npm/safely-merge/1.0.1"),f=o("datav:/com/datav-2dmap-tile/3.0.9/src/tileLayer"),h=o("datav:/com/datav-2dmap-tile/3.0.9/src/wmsTileLayer"),d=o("datav:/com/datav-2dmap-tile/3.0.9/config").DEFAULT_OPTIONS,o=function(){var t=r,e=u;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var o,n=p(r);function r(t,e){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");var o=n.call(this),e=e.options;return o.options=c(d,e),o.options.general.minZoom=e.general.zoomRange[0],o.options.general.maxZoom=e.general.zoomRange[1],o.options.visibility=!0,o}return t=r,(e=[{key:"addTo",value:function(t,e){this.viewer=t,this.options.id=e;e=("normalTile"==this.options.graph.tileType?f:h)(t);this.layer=new e(this.options)}},{key:"updateOptions",value:function(t){var t=t.options,e=c({},this.options);this.options=c(this.options,t),this.options.general.minZoom=t.general.zoomRange[0],this.options.general.maxZoom=t.general.zoomRange[1],e.graph.tileType!=this.options.graph.tileType?(this.layer.destroy(),t=("normalTile"==this.options.graph.tileType?f:h)(this.viewer),this.layer=new t(this.options)):this.layer&&this.layer.updateOptions&&this.layer.updateOptions(this.options)}},{key:"setZIndex",value:function(t){this.layer&&this.layer.setZIndex&&this.layer.setZIndex(t)}},{key:"onZoomEnd",value:function(t){this.layer&&this.layer.onZoomEnd&&this.layer.onZoomEnd(t)}},{key:"show",value:function(){this.options.visibility=!0,this.layer&&this.layer.show&&this.layer.show()}},{key:"hide",value:function(){this.options.visibility=!1,this.layer&&this.layer.hide&&this.layer.hide()}},{key:"destroy",value:function(){this.layer&&this.layer.destroy&&this.layer.destroy(),this.layer=null,this.options=null}}])&&s(t.prototype,e),o&&s(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}();return t.exports=o,t.exports});