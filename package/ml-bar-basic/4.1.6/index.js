// env=undefined => env=publish 
Cube("datav:/com/ml-bar-basic/4.1.6/transform",["datav:/npm/lodash/4.17.11","datav:/npm/datav-g2plot-util/0.2.4"],function(a,b,c){function d(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var e=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},f=c("datav:/npm/lodash/4.17.11"),g=c("datav:/npm/datav-g2plot-util/0.2.4"),h=g.transformGUI2Props,i=g.getMarginOptions,j=g.getLegendOptions,k=g.getNumericalLabelOptions,l=g.getXAxisOptions,m=g.getYAxisOptions,n=g.getTooltipOptions,o=g.getAnimationOptions,p=g.getInteractionOptions,q=g.getAxisExtentOptions,r=g.getCustomS,s=g.setBasicSeriesColor,t=g.getGuideLine,u=g.hasS,v=g.getXAxisTypeOptions,w=e({},i(),j(),k(),p(),l(),m(),n(),o(),{"options.chart.numericalLabel.position":"label.position"},function(){var a,b="options.chart.connectedArea";return a={},d(a,b+".show","connectedArea.visible"),d(a,b+".lineStyleStroke","connectedArea.lineStyle.stroke"),d(a,b+".areaStyleFill","connectedArea.areaStyle.fill"),d(a,b+".triggerOn",{key:"connectedArea.triggerOn",handler:function(a){return"always"!==a&&a}}),a}(),function(){return{"options.chart.customBarWidth":{key:"columnSize",handler:function(a){return a.show?a.columnSize:0}}}}(),q("yaxis","yAxis","y"),v()),x="rgba(0,0,0,0)",y=function(a,b,c){return a?(100*b).toFixed(c)+"%":b.toFixed(c)},z=function(a){var b=a.seriesConfig,c=a.propsConfig,d=a.dataSeries,e=a.data;if(b){var g=b.series,h=b.seriesMapping,i=u(e);if(h&&i){var j={},k=[],l={};g.forEach(function(a){var b=a.mapping,c=b.fieldValue,d=b.serieName;f.isNull(c)||f.isUndefined(c)||""===c?k.push(a.color):(j[d||c]=a.color,l[c]=d)});var m=g.map(function(a){return f.get(a,"mapping.fieldValue")});e=e.sort(function(c,a){var b=m.indexOf(c.s),d=m.indexOf(a.s);return(-1===b?Infinity:b)-(-1===d?Infinity:d)}),e.forEach(function(a){a.__s=l[a.s]||a.s});var n=r(e);n.forEach(function(a,b){j[a]||(k.length?j[a]=k.shift():j[a]=g[b%g.length].color)});var o=Object.values(j)[0];c.color=Object.keys(j).length?function(a){return j[a]||o}:k,c.stackField=c.colorField="__s"}else{var p=g.map(function(a){return a.color});s({dataSeries:d,allColors:p,propsConfig:c}),c.stackField=c.colorField="s"}c.data=e}};return a.exports={transOptionKey:function(a,b,c){var d=f.cloneDeep(b)||{},g=f.cloneDeep(w);"linear"===f.get(a,"options.axis.xaxis.type")&&delete g["options.axis.xaxis.label.timeFormat"],h({guiConfig:a,guiOptPropMap:g,res:d,data:c});var i=[].concat(c).filter(function(a){return a}).map(function(a){return a.s});d.tooltip&&d.tooltip.domStyles&&(d.tooltip.domStyles["g2-tooltip"].boxShadow="none");var j=f.get(a,"options.series");z({seriesConfig:j,propsConfig:d,dataSeries:i,data:c}),f.get(a,"options.others.tooltip.axisPointer.show")||delete d.tooltip.crosshairs,d.xAxis.type="dateTime"===d.xAxis.type?"time":d.xAxis.type;var k=f.get(a,"options.axis.yaxis.valueFormat"),l=!!k&&/.[0-9]%/.test(k),m=k?k.match(/^.(\d{1})(\D)$/)[1]:0,n=f.get(a,"options.others.guideLine"),o=t(n);return d.guideLine=o&&n.show?[].concat(o):[],d=f.set(d,"xAxis.type","cat"),delete d.yAxis.max,e({},d,{label:e({},d.label,{formatter:function(a){return y(l,a,m)}}),tooltip:e({},d.tooltip,{formatter:function(a,b,c){return{name:c,value:y(l,b,m)}}})})},defaultProps:{title:{visible:!1},description:{visible:!1},xField:"x",yField:"y",colorField:"s",stackField:"s",padding:"auto",forceFit:!0,yAxis:{label:{formatter:function(a){return(""+a).replace(/\d{1,3}(?=(\d{3})+$)/g,function(a){return a+","})},style:{stroke:x}},grid:{style:{lineDash:[4,4]}},tickLine:{visible:!1},title:{visible:!1,text:"",style:{stroke:x}}},xAxis:{grid:{style:{lineDash:[4,4]}},tickLine:{visible:!1},title:{visible:!1,text:"",style:{stroke:x}},label:{style:{stroke:x}}},legend:{position:"bottom-center"},label:{position:"middle",adjustColor:!1,adjustPosition:!0,style:{stroke:x}},connectedArea:{triggerOn:!1,lineStyle:{opacity:1},areaStyle:{opacity:1}},guideLine:[]}},a.exports});;
Cube("datav:/com/ml-bar-basic/4.1.6",["datav:/npm/lodash/4.17.11","datav:/npm/bcore/0.0.22/event","datav:/npm/datav-g2plot-adaptor/1.1.6/g2plot.js","datav:/npm/datav-g2plot-util/0.2.4"],function(a,b,c){var d=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},e=c("datav:/npm/lodash/4.17.11"),f=e.get,g=e.isUndefined,h=e.clone,i=e.cloneDeep,j=c("datav:/npm/bcore/0.0.22/event"),k=c("datav:/npm/datav-g2plot-adaptor/1.1.6/g2plot.js"),l=c("datav:/npm/datav-g2plot-util/0.2.4"),m=l.getTransform,n=l.datavColor2G2Color,o=l.convertData,p=c("datav:/com/ml-bar-basic/4.1.6/transform"),q=p.transOptionKey,r=p.defaultProps;return a.exports=j.extend(function(a,b){this.container=a,this.chart=null,this.guiConfig={options:{chart:{legend:{marker:{shape:"hyphen",show:!1,size:4},textStyle:{color:"rgb(144, 160, 174)",fontFamily:"Microsoft Yahei",fontSize:12,fontWeight:"normal"}}},others:{tooltip:{textStyleList:{color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,fontWeight:"normal"},textStyleValue:{color:"#fff",fontFamily:"Microsoft Yahei",fontSize:14,fontWeight:"normal"}}}}},this.propsConfig=r,this.init(b)},{init:function(a){this.mergeConfig(a)},initChart:function(a){var b=a.chartConfig;this.chart=new k.StackedColumn(this.container,b),this.chart.render();var c=m(this.container);Object.values(c).length&&this.chart&&this.chart.canvas&&(this.chart.canvas.set("containerTransform",c),this.chart.canvas.set("supportCSSTransform",!0))},render:function(a,b){var c=this;return this.guiConfig=this.mergeConfig(b),a=this.data(a),a&&e.isArray(a)&&a.length?void o(e.cloneDeep(a),this.guiConfig,!1,{x:"x",y:"y"}).then(function(a){c.propsConfig=q(c.guiConfig,c.propsConfig,i(a)),c._bindEvent(c.propsConfig);var b=d({data:a},c.propsConfig);c.chart?(c.chart.updateConfig(b),c.chart.render()):c.initChart({chartConfig:b})}):(console.warn("--------- \u540C\u5B66\u4F60\u597D, \u8BF7\u786E\u4FDD\"\u5782\u76F4\u5806\u53E0\u67F1\u72B6\u56FE\"\u7EC4\u4EF6, \u6570\u636E\u7C7B\u578B\u4E3A\u6570\u7EC4 && \u6570\u636E\u5927\u4E8E\u7B49\u4E8E1\u6761 ---------"),void console.warn("--------- Hello classmates, please make sure that the \"Vertically stacked column chart\" component, the data type is an array && data is greater than or equal to 1 ---------"))},updateStyle:function(){},setColors:function(){var a=this.guiConfig;f(a,"options.series.series").forEach(function(a){var b=a.color;a.color=n(b)})},mergeConfig:function(a){if(!a)return this.guiConfig;var b=e.cloneDeep(e.get(a,"options.series.series"));return this.guiConfig=e.defaultsDeep(a||{},this.guiConfig),b&&e.set(this.guiConfig,"options.series.series",b),this.setColors(),this.guiConfig},data:function(a){return a&&(this._data=h(a)),this._data},getThemableConfig:function(a){if(!a)return{};var b=a.textColor,c=a.axisColor,e=a.palette,d=a.bgColor,g=(f(this.guiConfig,"options.series.series")||[]).map(function(a,b){return{color:e[b]||e[b%e.length]}}),h={label:{textarea:{color:b}},title:{textarea:{color:b}},axisLine:{color:c},tickLine:{stroke:c},grid:{color:c}};return{options:{chart:{numericalLabel:{textStyle:{color:b}}},axis:{xaxis:h,yaxis:h},series:{series:g},others:{tooltip:{textStyle:{color:b},bgBox:{backgroundColor:d}}}}}},resize:function(a,b){this.chart&&this.chart.updateConfig({width:a,height:b}),this.chart&&this.chart.render()},destroy:function(){this.chart&&this.chart.destroy(),this.chart=null,this._data=null},_bindEvent:function(a){var b=this;a.events={onPlotClick:function(a){var c=f(a,"target.cfg.origin._origin");c&&b.emit("click",c)},onLegendClick:function(a){var c=e.get(a,"target.cfg.delegateObject.item.value");c&&b.emit("onLegendClick",{value:c})}}},highlight:function(a){var b=a.data,c=a.style;if(this.chart&&b){var d=function(a){return Object.keys(b).every(function(c){return a[c]===b[c]})};this.chart.setActive(d,c)}},cancelHighlight:function(){this.chart&&this.chart.setActive({},{})}}),a.exports});