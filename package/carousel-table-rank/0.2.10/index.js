Cube('datav:/com/carousel-table-rank/0.2.10',['datav:/com/carousel-table-rank/0.2.10/default.css.js','datav:/npm/bcore/0.0.9/event','datav:/npm/lodash/3.10.1','datav:/npm/jquery/2.1.4','datav:/com/main-title/0.1.5'],function(i,o,a,n,m,l){function h(a){return e[a]?e[a]:e[a]=c[a]()}var c={},e={};c['coms/carousel-table-rank/0.2.10/template.html']=c['coms/carousel-table-rank/0.2.10/template.html']=function(){return function(){return'<div class="sub-header">\n  <div class="sub-title"></div>\n</div>\n<div class="rank"></div>\n'}},c['coms/carousel-table-rank/0.2.10/rank']=c['coms/carousel-table-rank/0.2.10/rank.js']=function(){var d={},c={exports:d};a('datav:/com/carousel-table-rank/0.2.10/default.css.js','');var e=a('datav:/npm/bcore/0.0.9/event'),b=a('datav:/npm/lodash/3.10.1'),f=a('datav:/npm/jquery/2.1.4');return c.exports=e.extend(function a(c,d){var c=f(c),e={width:c.width()||100,height:c.height()||100,rowCount:5,duration:2e4,contentMaxLength:15,loop:!0,'background-color':'transparent',hasIndex:!0,_hasIndex:!0,margin:{'margin-top':0,'margin-left':15,'margin-right':15,'margin-bottom':0},index:{'font-size':'0.4em',color:'#fff','background-color':'#44D3E4'},column:{color:'#fff','font-size':'0.8em','margin-top':0,'margin-left':5,'margin-right':0,'margin-bottom':0}};this.templateHead='<div class="line list-title" style="height: <%= height %>px;line-height: <%= height %>px; "><% if (hasIndex) {%><div class="index-list"></div><%}%><%= columns %></div>',this.templateLine='<div class="line column-content" style="height: <%= height %>px;line-height: <%= height %>px; "><% if (hasIndex) {%><div class="index-list"><div class="index"><%= index %></div></div><%}%><%= columns %></div>',this.templateColumn='<div class="column" style="width: <%=width%>px;"><%= content %></div>',this.container=c,this.config=b.defaultsDeep(d,e),this.apis=d.apis,this.startIndex=0,this.titleList=[],this.isFirst=!0},{init:function(i){var A=this.container,c=this.config,h=c.margin,d=[];for(var a=0;a<i.length;a++){var w=b.keys(i[a]);d=b.union(d,w)}var j=c.rowCount,q=d.length===0?j:j+1,t=c.height-h['margin-top']-h['margin-bottom'],g=Math.floor(t/q),o=i[0],e=[],p=c.contentMaxLength;if(o)for(var a=0;a<d.length;a++){var k=d[a],r=Math.max(o[k].toString().length,k.length);e.push(Math.min(r,p))}var s=b.reduce(e,function(a,b){return a+b},0),l=Math.floor(g*.25),u=c.width-c.margin['margin-left']-c.margin['margin-right'],m=u-l*2;e=b.map(e,function(a){return Math.round(a/s*m)});var n=b.template(this.templateColumn);if(!b.isEqual(d,this.titleList)||c.hasIndex!==c._hasIndex||this.dirty){c._hasIndex=c.hasIndex,this.container.empty(),this.container.css({overflow:'hidden','background-color':c['background-color']});var x=b.template(this.templateHead),y,f='';for(var a=0;a<d.length;a++)f+=n({width:e[a]-c.column['margin-left']-c.column['margin-right'],content:d[a]});y=x({height:g,hasIndex:c.hasIndex,columns:f}),this.container.append(y)}else this.container.find('.column-content:lt('+(i.length-c.rowCount)+')').slideUp();var v=b.template(this.templateLine),z,f='';for(var a=0;a<d.length;a++)f+=n({width:e[a]-c.column['margin-left']-c.column['margin-right'],content:'<%='+d[a]+'%>'});z=v({height:g,hasIndex:c.hasIndex,columns:f,index:'<%= index %>'}),this.container.css(h),this.template=b.template(z),this.columnWidth=m,this.columnHeight=g,this.indexRadius=l,this.widthList=e,this.titleList=d},addTimer:function(){var a=this,f=a.source||[];a.isFirst&&a.init(f);var h=a.config,i=h.rowCount,g=a.startIndex,n=a.template,q=a.widthList,r=a.columnHeight,d=a.indexRadius,k=a.container.find('.column-content:lt('+i+')');k.slideUp();var m=a.isFirst,j=m?i*2:i;for(var c=g;c<g+j;c++)if(c<f.length&&f[c]){var p=f[c],l=b.cloneDeep(p);l.index=c+1;var o=n(l);a.container.append(o)}a.container.find('.column').css(h.column);var e=h.index;e.width=d*2,a.container.find('.index-list').css({width:d*2}),e.height=d*2,e['line-height']=d*2+'px',e['border-radius']=d,a.container.find('.column-content .index-list').css(e),g+=j,g<f.length?a.startIndex=g:a.startIndex=0,setTimeout(function(){k.remove(),a.isFirst&&(a.isFirst=!1)},500),this.timer=setTimeout(a.addTimer.bind(a),h.duration)},render:function(a,d){var c=this.config;this.config=b.defaultsDeep(d,c),a&&(this.source=a),this.isFirst&&(this.timer&&clearTimeout(this.timer),this.addTimer(),this.isFirst=!1)},resize:function(a,b){this.config.width=a,this.config.height=b,this.isFirst=!0,this.dirty=!0,this.render(null,{}),this.dirty=!1}}),c.exports},a('datav:/com/carousel-table-rank/0.2.10/default.css.js','');var k=a('datav:/npm/bcore/0.0.9/event'),b=a('datav:/npm/lodash/3.10.1'),d=a('datav:/npm/jquery/2.1.4'),j=a('datav:/com/main-title/0.1.5'),f=h('coms/carousel-table-rank/0.2.10/rank'),g=h('coms/carousel-table-rank/0.2.10/template.html')(),b=a('datav:/npm/lodash/3.10.1'),d=a('datav:/npm/jquery/2.1.4');return i.exports=k.extend(function a(h,e){this.container=d(h);var f={theme:{bg:['#000','transparent'],font:['#eee','#252525'],colors:['#444547','#A0AAB3']},titleDom:'.sub-title',rankDom:'.rank','background-color':'transparent',title:{value:'我是标题','font-size':18,'text-align':'center','background-color':'transparent',color:'#fff','inner-style':{'line-height':2}},chart:{width:this.container.width()||100,rowCount:5,duration:5e3,loop:!0,titleList:['商品名称','金额'],contentMaxLength:30,'background-color':'transparent',hasIndex:!0,margin:{'margin-top':0,'margin-left':15,'margin-right':15,'margin-bottom':0},index:{'font-size':'0.4em',color:'#fff','background-color':'#44D3E4'},column:{color:'#fff','font-size':'0.8em','margin-top':0,'margin-left':5,'margin-right':0,'margin-bottom':0}}};this.apis=e.apis,this.config=this.initTheme(f,e);var c=this.config;this.container.append(b.template(g)),this.titleDom=this.container.find(c.titleDom),this.rankDom=this.container.find(c.rankDom),this.init()},{initColors:function(a){},initTheme:function(a,c){return c?(a.theme=b.defaultsDeep(c.theme||{},a.theme),this.initColors&&this.initColors(a),a=b.defaultsDeep(c||{},a),a):a},init:function(){var a=this.config,b=this.container.height();this.initLayout(),this.title=new j(this.titleDom[0],a.title||{}),this.rank=new f(this.rankDom[0],a.chart)},initLayout:function(e){var d=this.config,f=this.container.width()||200,c=this.container.height()||200,b=d.title.height||d.title['inner-style'].height,a=d.chart.height;e===!0&&(a=undefined),b||a?b?a||(a=c-b):b=c-a:(b=c*.2,a=c*.8),this.titleDom.outerHeight(b),this.rankDom.outerHeight(a),e&&this.rank.resize(f,a)},render:function(c,d){var a=this.config=b.defaultsDeep(d||{},this.config);this.container.css({'background-color':a['background-color']}),this.title.render(null,a.title||{}),this.rank.isFirst=!0,this.rank.render(c,a.chart||{}),this.initLayout(!0)},resize:function(a,b){this.initLayout(!0)}}),i.exports})