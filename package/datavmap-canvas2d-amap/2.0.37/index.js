// env=undefined => env=publish 
Cube("datav:/com/datavmap-canvas2d-amap/2.0.37/src/css.css", [], function(m){m.exports=".amap-indoormap-floorbar-control{position:absolute;margin:auto 0;bottom:165px;right:12px;width:35px;text-align:center;line-height:1.3em;overflow:hidden;padding:0 2px;z-index:10000}";return m.exports});;
Cube("datav:/com/datavmap-canvas2d-amap/2.0.37/src/amapLayer.js",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(t,e,i,a,o,n){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t,e,i){e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}function s(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function m(i){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c(i),e=(t=a?(t=c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return h(e)}}function h(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var u=i("datav:/npm/eventemitter3/3.0.0"),y=i("datav:/npm/safely-merge/1.0.1"),i=(i("datav:/com/datavmap-canvas2d-amap/2.0.37/src/css.css",""),function(){var t=o,e=u;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var i,a=m(o);function o(t,e){if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");var i;return(i=a.call(this)).options=y({amapVersion:"2.0",zoomRange:[0,18],minZoom:0,maxZoom:20,mapKey:"",mapSecurity:"",mapType:"normal",standardStyleTemplate:"normal",customMapStyle:"",amapFeatures:{bg:!0,road:!0,building:!0,point:!0},filter:{show:!1,brightness:1,contrast:1,grayscale:0,hueRotate:0,invert:0,saturate:1,sepia:0},isTraffic:!1},e),i.options.minZoom=e.zoomRange[0],i.options.maxZoom=e.zoomRange[1],i.options.visibility=!0,i.options.key=i.options.mapKey||"f6ce2bfb8de7c1ec5cbe49d47a7ac207",i.options.security=i.options.mapSecurity||"",window._AMapSecurityConfig={securityJsCode:i.options.security},i.map=t,i.map._animatingZoom=!1,i.map._zoomAnimated=!1,i.map.options.zoomAnimation=!1,i.onMapMove=i.onMapMove.bind(h(i)),i.setZoomAndCenter=i.setZoomAndCenter.bind(h(i)),i.initAMap=i.initAMap.bind(h(i)),i.updateFilter=i.updateFilter.bind(h(i)),i.initContainer(),i.init(),i}return t=o,(e=[{key:"init",value:function(){var e=this;window.AMap?(e.initAMap(),e.registerMapEvent()):this.map.AMapLoader&&this.map.AMapLoader.load({key:e.options.key,version:e.options.amapVersion,plugins:[]}).then(function(t){window.AMap=t,e.initAMap(),e.registerMapEvent()}).catch(function(t){console.log("高德在线底图地图加载失败！",t)})}},{key:"initContainer",value:function(){this.pane=this.map.getPane("tilePane");var t=this.map.getSize(),t=(this.amapContainer=document.createElement("div"),this.amapContainer.style.position="absolute",this.amapContainer.style.top=0,this.amapContainer.style.left=0,this.amapContainer.style.width=t.x+"px",this.amapContainer.style.height=t.y+"px",this.amapContainer.style.pointerEvents="none",this.amapContainer.style.zIndex=0,this.amapContainer.style.backgroundColor="rgba(0,0,0,0)",this.pane.appendChild(this.amapContainer),this.map.L.DomUtil.getPosition(this.map.getPane("mapPane")));t&&(t={x:-t.x,y:-t.y},this.map.L.Browser.any3d?this.map.L.DomUtil.setTransform(this.amapContainer,t):this.map.L.DomUtil.setPosition(this.amapContainer,t))}},{key:"initAMap",value:function(){var t,e=y({},this.options),i=this,a=i.map,o=a.getZoom(),n=a.getCenter(),r="amap://styles/".concat("normal"===e.mapType?e.standardStyleTemplate:e.customMapStyle),s=[],p=!1;for(t in e.amapFeatures){var m=e.amapFeatures[t];switch(m){case"bg":case"road":case"building":case"point":s.push(m);break;case"traffic":p=!0}}i.amap=new AMap.Map(i.amapContainer,(l(n={resizeEnable:!0,showIndoorMap:!0,layers:[],features:s,center:[n.lng,n.lat],showBuildingBlock:!0,expandZoomRange:!0,animateEnable:!1,jogEnable:!1,viewMode:"3D",zoom:o},"expandZoomRange",!0),l(n,"zooms",[3,20]),l(n,"detectRetina",1<a.devicePixelRatio),l(n,"mapStyle",r),n)),i.updateFilter(e.filter),i.traffic=new AMap.TileLayer.Traffic({autoRefresh:!0}),p&&i.amap.add(i.traffic),i.amap.on("complete",function(){i.currentControls=i.amapContainer.querySelector(".amap-controls"),i.map.getContainer().appendChild(i.currentControls),i.currentControls.onclick=function(t){i.parentIndex.emit("click",{indoormapFloor:t.target.innerText})},e.visibility?i.show():i.hide();var t=i.map.getZoom();t<e.minZoom||t>e.maxZoom?i.pane&&i.pane.style&&(i.pane.style.opacity=0):i.pane&&i.pane.style&&(i.pane.style.opacity=1)})}},{key:"setZoomAndCenter",value:function(){var t,e;this.amap&&(t=this.map.getZoom(),e=this.map.getCenter(),this.amap.setZoomAndCenter(t,[e.lng,e.lat]))}},{key:"onMapMove",value:function(t){var e;this.amapContainer&&(e=this.map.getSize(),this.amapContainer.style.width=e.x+"px",this.amapContainer.style.height=e.y+"px",e=this.map.getPane("mapPane"),(e=this.map.L.DomUtil.getPosition(e))&&(e={x:-e.x,y:-e.y},this.map.L.Browser.any3d?this.map.L.DomUtil.setTransform(this.amapContainer,e):this.map.L.DomUtil.setPosition(this.amapContainer,e)),this.setZoomAndCenter())}},{key:"registerMapEvent",value:function(){this.map.on("move",this.onMapMove)}},{key:"removeMapEvent",value:function(){this.map.off("move",this.onMapMove)}},{key:"updateOptions",value:function(t){var e=this;if(t.filter.show&&this.amapContainer&&(t.filter.show!=this.options.filter.show||t.filter.brightness!=this.options.filter.brightness||t.filter.contrast!=this.options.filter.contrast||t.filter.grayscale!=this.options.filter.grayscale||t.filter.hueRotate!=this.options.filter.hueRotate||t.filter.invert!=this.options.filter.invert||t.filter.saturate!=this.options.filter.saturate||t.filter.sepia!=this.options.filter.sepia))return this.updateFilter(t.filter),void(this.options=y(this.options,t));if(!t.filter.show&&t.filter.show!=this.options.filter.show)return this.amapContainer.style.filter="",void(this.options=y(this.options,t));this.options=y(this.options,t),this.options.minZoom=t.zoomRange[0],this.options.maxZoom=t.zoomRange[1],this.amap&&this.amap.clearMap&&this.amap.destroy&&(this.amap.clearMap(),this.amap.destroy(),this.currentControls&&this.map.getContainer&&this.map.getContainer().querySelector(".amap-controls")&&this.map.getContainer().removeChild(this.currentControls),delete window._AMapSecurityConfig),!this.options.mapKey&&!this.options.mapSecurity||this.options.key===this.options.mapKey&&this.options.security===this.options.mapSecurity?(this.initAMap(),this.registerMapEvent()):(this.options.key=this.options.mapKey,this.options.security=this.options.mapSecurity,this.map.AMapLoader&&(this.map.AMapLoader.reset(),window._AMapSecurityConfig={securityJsCode:this.options.mapSecurity},this.map.AMapLoader.load({key:this.options.key,version:this.options.amapVersion,plugins:[]}).then(function(t){window.AMap=t,e.initAMap(),e.registerMapEvent(),delete window._AMapSecurityConfig}).catch(function(t){console.log("高德在线底图地图加载失败！",t)})));var i,a=!1;for(i in t.amapFeatures)"traffic"===t.amapFeatures[i]&&(a=!0);a?this.amap.add(this.traffic):this.amap.remove(this.traffic)}},{key:"updateFilter",value:function(t){t.show&&this.amapContainer&&(t="brightness("+this.toPercent(t.brightness)+") contrast("+this.toPercent(t.contrast)+") grayscale("+this.toPercent(t.grayscale)+") hue-rotate("+t.hueRotate+"deg) invert("+this.toPercent(t.invert)+") saturate("+this.toPercent(t.saturate)+") sepia("+this.toPercent(t.sepia)+") blur(0px)",this.amapContainer.style.filter=t)}},{key:"toPercent",value:function(t){return(Math.round(1e4*t)/100).toFixed(2)+"%"}},{key:"setZIndex",value:function(t){this.amapContainer&&(this.amapContainer.style.zIndex=t)}},{key:"show",value:function(){this.options.visibility=!0,this.amapContainer&&this.amapContainer.style&&(this.amapContainer.style.opacity=1)}},{key:"hide",value:function(){this.options.visibility=!1,this.amapContainer&&this.amapContainer.style&&(this.amapContainer.style.opacity=0)}},{key:"destroy",value:function(){this.removeMapEvent(),this.amap&&this.amap.clearMap&&this.amap.destroy&&(this.amap.clearMap(),this.amap.destroy(),this.currentControls&&this.map.getContainer().removeChild(this.currentControls),this.amapContainer.remove()),this.map._animatingZoom=!0,this.map._zoomAnimated=!0,this.map.options.zoomAnimation=!0,this.pane=null,this.currentControls=null,this.amap=null,this.options=null}}])&&s(t.prototype,e),i&&s(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}());return t.exports=i,t.exports});;
Cube("datav:/com/datavmap-canvas2d-amap/2.0.37",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(t,e,o,n,r,i){function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function c(o){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l(o),e=(t=n?(t=l(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var p=o("datav:/npm/eventemitter3/3.0.0"),y=o("datav:/npm/safely-merge/1.0.1"),f=o("datav:/com/datavmap-canvas2d-amap/2.0.37/src/amapLayer.js"),o=function(){var t=r,e=p;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var o,n=c(r);function r(t,e){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");var o;return(o=n.call(this)).options=y({renderer:"basemap",basemapType:"amap"},e),o.options.minZoom=e.zoomRange[0],o.options.maxZoom=e.zoomRange[1],o.options.visibility=!0,o}return t=r,(e=[{key:"addTo",value:function(t){this.layer=new f(t,this.options)}},{key:"updateOptions",value:function(t){this.options=y(this.options,t),this.options.minZoom=t.zoomRange[0],this.options.maxZoom=t.zoomRange[1],this.layer&&this.layer.updateOptions(this.options)}},{key:"setZIndex",value:function(t){this.layer&&this.layer.setZIndex&&this.layer.setZIndex(t)}},{key:"show",value:function(){this.options.visibility=!0,this.layer&&this.layer.show&&this.layer.show()}},{key:"hide",value:function(){this.options.visibility=!1,this.layer&&this.layer.hide&&this.layer.hide()}},{key:"destroy",value:function(){this.layer&&this.layer.destroy&&this.layer.destroy(),this.layer=null,this.options=null}}])&&s(t.prototype,e),o&&s(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}();return t.exports=o,t.exports});