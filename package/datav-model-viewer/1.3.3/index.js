// env=undefined => env=publish 
Cube("datav:/com/datav-model-viewer/1.3.3/Light/Ground/shader/ground.frag.glsl",[],function(n,o,e,r,a,t){return n.exports="uniform vec3 groundColor;\nuniform vec3 shadowColor;\nuniform float opacity;\n\n#include <common>\n#include <packing>\n#include <fog_pars_fragment>\n#include <bsdfs>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n\nvarying vec3 vertex;\nuniform float u_boundary;\n\nvoid main() {\n\tvec3 outputColor = mix(groundColor, shadowColor, 1.0-getShadowMask());\n\tfloat f = smoothstep(1.0, 0.0, length(vertex)*u_boundary);\n\tgl_FragColor = vec4( outputColor, f*opacity);\n\n\t#include <premultiplied_alpha_fragment>\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n}",n.exports});;
Cube("datav:/com/datav-model-viewer/1.3.3/Light/Ground/shader/ground.vert.glsl",[],function(e,n,t,r,i,d){return e.exports="#include <common>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n\nvarying vec3 vertex;\n\nvoid main() {\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <project_vertex>\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n\tvertex = position;\n}",e.exports});;
Cube("datav:/com/datav-model-viewer/1.3.3/Light/Ground/groundMaterial",["datav:/npm/@ali/datav-vangogh-basic/1.0.3"],function(t,e,o,r,n,u){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var a=o("datav:/npm/@ali/datav-vangogh-basic/1.0.3"),f=c(o("datav:/com/datav-model-viewer/1.3.3/Light/Ground/shader/ground.vert.glsl")),l=c(o("datav:/com/datav-model-viewer/1.3.3/Light/Ground/shader/ground.frag.glsl"));function c(t){return t&&t.__esModule?t:{default:t}}function s(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function d(t,e){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function y(o){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=p(o),e=(t=r?(t=p(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function p(t){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var v=a.THREE.ShaderMaterial,h=a.THREE.UniformsLib,b=a.THREE.UniformsUtils,m=a.THREE.Color,g=a.THREE.CustomBlending,o=function(){var t=n,e=v;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e);var o,r=y(n);function n(){var t;if(this instanceof n)return(t=r.call(this,{uniforms:b.merge([h.lights,h.fog,{groundColor:{value:new m(16777215)},shadowColor:{value:new m(0)},opacity:{value:1},u_boundary:{value:1}}]),vertexShader:f.default,fragmentShader:l.default,lights:!0,blending:g,premultipliedAlpha:!0})).type="GroundMaterial",t;throw new TypeError("Cannot call a class as a function")}return t=n,(e=[{key:"groundColor",get:function(){return this.uniforms.groundColor.value},set:function(t){t&&this.uniforms.groundColor.value.copy(t)}},{key:"shadowColor",get:function(){return this.uniforms.shadowColor.value},set:function(t){t&&this.uniforms.shadowColor.value.copy(t)}},{key:"opacity",get:function(){return this.uniforms?this.uniforms.opacity.value:1},set:function(t){"number"==typeof t&&this.uniforms&&(this.uniforms.opacity.value=t)}},{key:"boundary",get:function(){return this.uniforms.u_boundary.value},set:function(t){this.uniforms.u_boundary.value=t}}])&&s(t.prototype,e),o&&s(t,o),Object.defineProperty(t,"prototype",{writable:!1}),n}();return e.default=o,t.exports});;
Cube("datav:/com/datav-model-viewer/1.3.3/immerseHook/style.css", [], function(m){m.exports=".datav-fab-immerse-toolbox{padding-top:6px}.datav-fab-immerse-toolbox .toolbox-control{display:flex;height:35px;padding:4px 0;align-items:center}.datav-fab-immerse-toolbox .toolbox-sub-title{font-size:14px;color:var(--datav-text-color);margin:8px 0 4px 0}.datav-fab-immerse-toolbox .toolbox-sub-title:first-child{margin-top:0}.datav-fab-immerse-toolbox .toolbox-control label{width:76px;font-size:12px;color:var(--datav-text-color)}.datav-fab-immerse-toolbox .toolbox-control .toolbox-control-content{flex:1}.datav-fab-immerse-toolbox .toolbox-control .toolbox-control-content .animation-option{display:flex;align-items:center;padding-right:4px;justify-content:space-between}.datav-fab-immerse-toolbox .toolbox-control .toolbox-control-content .animation-option .animation-option-copy{color:var(--datav-font-color);cursor:pointer}.datav-fab-immerse-toolbox .toolbox-control .toolbox-control-content .animation-option .animation-option-copy.--selected{color:var(--datav-main-color)}.datav-fab-immerse-toolbox .toolbox-control .toolbox-control-content .animation-option .animation-option-copy.--selected:hover,.datav-fab-immerse-toolbox .toolbox-control .toolbox-control-content .animation-option .animation-option-copy:hover{color:var(--datav-main-hover-color)}.datav-fab-immerse-toolbox .toolbox-control .toolbox-control-preview{width:22px;height:22px;line-height:22px;padding:0 3px}.datav-fab-immerse-toolbox .toolbox-control .toolbox-control-preview .datav-icon{font-size:12px}.datav-fab-immerse-toolbox .toolbox-control .toolbox-control-camera{height:22px;line-height:22px;padding:0 3px}";return m.exports});;
Cube("datav:/com/datav-model-viewer/1.3.3/RenderPipeline",["datav:/npm/@ali/datav-vangogh-basic/1.0.3"],function(e,t,i,n,o,r){function p(e){return(p="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=i("datav:/npm/@ali/datav-vangogh-basic/1.0.3");function a(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(i){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(i),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===p(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var i,n=u(o);function o(){var e=this,t=o;if(e instanceof t)return n.apply(this,arguments);throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"FXAA",get:function(){var e;return null==(e=this._pipelineCore)?void 0:e.pipeline.antialiasMethods.get("fxaa")}},{key:"MotionBlur",get:function(){var e;return null==(e=this._pipelineCore)?void 0:e.get("motionBlur")}},{key:"SharpenVignetteGrain",get:function(){var e;return null==(e=this._pipelineCore)?void 0:e.get("sharpenVignetteGrain")}},{key:"UEBloom",get:function(){var e;return null==(e=this._pipelineCore)?void 0:e.get("ueBloom")}},{key:"initPipelineCore",value:function(){this._pipelineCore=new s.PipelineCore(this._scene,this._camera,this._renderer,!1,this._options.needsLight),this.SSR.enabled=!1,this.SSAO.enabled=!1,this._pipelineCore.addHexBokehPass({enabled:!1},!1),this._pipelineCore.addMotionBlurPass({enabled:!1},!1),this._pipelineCore.addSharpenVignetteGrainPass({enabled:!1},!1),this._pipelineCore.addUEBloomPass({enabled:!1},!1),this._pipelineCore.addFilmicTonemapperPass({enabled:!0},!0),this.updateOptions()}},{key:"updateOptions",value:function(){this._options=Object.assign(this._options,(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})||{}),this._pipelineCore.pipeline.screenPercentage=this._options.screenPercentage,this._pipelineCore.pipeline.antialiasType!==this._options.antialiasType&&(this._pipelineCore.pipeline.antialiasMethods.get("taa").frame=0),this._pipelineCore.pipeline.antialiasType=this._options.antialiasType,this._pipelineCore.pipeline.aoPass.updateOptions(this._options.ssao),this._pipelineCore.pipeline.ssrPass&&this._pipelineCore.pipeline.ssrPass.updateOptions(this._options.ssr);var e=this._pipelineCore.pipeline.antialiasMethods.get("fxaa"),e=(e&&e.updateOptions(this._options.fxaa),this._pipelineCore.getPass("hexbokeh")),e=(e&&e.updateOptions(this._options.bokeh),this._pipelineCore.getPass("sharpenVignetteGrain")),e=(e&&e.updateOptions(this._options.sharpenVignetteGrain),this._pipelineCore.getPass("motionBlur")),e=(e&&e.updateOptions(this._options.motionBlur),this._pipelineCore.getPass("ueBloom")),e=(e&&e.updateOptions(this._options.ueBloom),this._pipelineCore.getPass("filmictonemapper"));e&&e.updateOptions(this._options.filmic)}}])&&a(t.prototype,e),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(s.RenderPipeline);return t.default=i,e.exports});;
Cube("datav:/com/datav-model-viewer/1.3.3/ModelViewer",["datav:/npm/@ali/datav-vangogh-basic/1.0.3"],function(e,t,i,a,r,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var l=i("datav:/npm/@ali/datav-vangogh-basic/1.0.3");function s(e,t){for(var i=0;i<t.length;i++){var a=t[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}(e,t);if(a)return a=Object.getOwnPropertyDescriptor(a,t),a.get?a.get.call(arguments.length<3?e:i):a.value}).apply(this,arguments)}function c(e,t){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(i){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=m(i),t=(e=a?(e=m(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}i=function(e){var t=r;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var i,a=u(r);function r(e){var t;if(this instanceof r)return(t=a.call(this,e.model)).animateOpts=Object.assign({autoRotate:{enable:!1,axis:"y",showAxis:!1,randomAxis:{x:0,y:1,z:0},direction:1,speed:.01}},e.animate),t.initGlobalAnimation(),t._needsBaryCentric=!0,t._currentAnimation={loopMode:"LoopRepeat",weight:1},t;throw new TypeError("Cannot call a class as a function")}return t=r,(e=[{key:"addToScene",value:function(e){f(m(r.prototype),"addToScene",this).call(this,e),this.globalWorldMatrix.copy(this.transformMatrix),this.setWireframe(1),this.setChannel(),this.updateGlobalRotateParameters(),this.animationNames=this.animationManager.actionsNames,0<this.animationNames.length&&(this._currentAnimation.name=this.animationNames[0]),this.setModelAnimation(this.animateOpts.modelAnimate)}},{key:"setChannel",value:function(){var e,t=this.options.viewMode.channel;this.materialsManager.setChannel(t),null!=(e=this.viewer.renderPipeline)&&e.Filmic.updateOptions({directOutputMode:"final"!==t})}},{key:"setModelAnimation",value:function(e){var t=e.autoPlay,e=e.defaultAnimation;-1!==this.animationNames.indexOf(e)&&(this._currentAnimation.name=e),this.animationManager.autoPlay=t,this.animationManager.actionsList=[this._currentAnimation]}},{key:"initGlobalAnimation",value:function(){this.globalWorldMatrix=new l.THREE.Matrix4,this.rotateMatrix=new l.THREE.Matrix4;var e=this.animateOpts.autoRotate,t=e.randomAxis,e=e.enable;this.rotateAxis={x:new l.THREE.Vector3(1,0,0),y:new l.THREE.Vector3(0,1,0),z:new l.THREE.Vector3(0,0,1),random:new l.THREE.Vector3(t.x,t.y,t.z).normalize()},this.enableGlobalAnimation=e}},{key:"animation",value:function(){f(m(r.prototype),"animation",this).call(this),this.model&&this.globalAnimation()}},{key:"globalAnimation",value:function(){this.enableGlobalAnimation&&this.transformMatrix.multiply(this.rotateMatrix)}},{key:"updateGlobalRotateParameters",value:function(){var e=this.animateOpts.autoRotate,t=e.enable,i=e.axis,a=e.randomAxis,r=e.direction,e=e.speed;"random"===i&&(this.rotateAxis.random.x=a.x,this.rotateAxis.random.y=a.y,this.rotateAxis.random.z=a.z,this.rotateAxis.random.normalize()),t&&this.rotateMatrix.makeRotationAxis(this.rotateAxis[i],r*e),this.enableGlobalAnimation=t}},{key:"updateOptions",value:function(e){var t=l.Utils.deepClone(this.options);this.options=l.Utils.mergeOptions(this.options,e||{}),l.Utils.easyDiff(t.url,e.url)||(this.setData({}),this._needsBaryCentric=!0),l.Utils.easyObjDiff(t.viewMode.channel,e.viewMode.channel)||this.setChannel(),l.Utils.easyDiff(t.viewMode.wireframe,e.viewMode.wireframe)&&l.Utils.easyDiff(t.viewMode.wireframeColor,e.viewMode.wireframeColor)&&l.Utils.easyDiff(t.viewMode.wireframeWidth,e.viewMode.wireframeWidth)&&l.Utils.easyDiff(t.viewMode.wireframeType,e.viewMode.wireframeType)||this.setWireframe(),l.Utils.easyDiff(t.renderEffect.opacity,e.renderEffect.opacity)||this.setOpacity(e.renderEffect.opacity),l.Utils.easyObjDiff(t.transform,e.transform)||this.updateTransformMatrix(),l.Utils.easyObjDiff(t.renderEffect.shadow,e.renderEffect.shadow)||this.updateShadow(e.renderEffect.shadow)}},{key:"updateAnimateOptions",value:function(e){l.Utils.easyObjDiff(this.options.scanner,e.scanner)||(void 0===e.scanner.enable&&(e.scanner.enable=e.scanner.show),this.updateScannerOpts(e.scanner)),l.Utils.easyDiff(this.options.animation,e.modelAnimate)||this.updateAnimationOpts(e.modelAnimate),l.Utils.easyDiff(this.animateOpts.autoRotate.axis,e.autoRotate.axis)||this.resetModelWorldMatrix(),this.animateOpts=l.Utils.mergeOptions(this.animateOpts,e),this.updateGlobalRotateParameters()}},{key:"setWireframe",value:function(){var t=this,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,i=this.options.viewMode,a=i.wireframe,r=i.wireframeType,n=void 0===r?"triangle":r,r=i.wireframeColor,o=i.wireframeWidth,s=l.Utils.Chroma(r).gl();this.model&&this.model.scene&&this.model.scene.traverse(function(e){e.isMesh&&(a?(t._needsBaryCentric&&(e.geometry=t.actionsManager.generateBarycentricAttribute(e.geometry)),e.material.defines.USE_BARYCENTRIC="",e.material.u_wireframeColor=s,e.material.u_wireframeWidth=o,e.material.u_wireframeType=n,e.customGBufferMaterial&&(e.customGBufferMaterial.defines.USE_BARYCENTRIC="",e.customGBufferMaterial.u_wireframeColor=s,e.customGBufferMaterial.u_wireframeWidth=o,e.customGBufferMaterial.u_wireframeType=n)):(delete e.material.defines.USE_BARYCENTRIC,e.customGBufferMaterial&&delete e.customGBufferMaterial.defines.USE_BARYCENTRIC),e.material.needsUpdate=!0,e.customGBufferMaterial&&(e.customGBufferMaterial.needsUpdate=!0))}),this._needsBaryCentric=!1,1===e&&!1===a&&(this._needsBaryCentric=!0)}},{key:"setOpacity",value:function(e){var t;null!=(t=this.materialsManager)&&t.colorifyGlobal(e,1===e)}},{key:"updateTransformMatrix",value:function(){var e=this.options.transform,t=e.scale,i=e.rotation,e=e.position;this.actionsManager.model&&(this.actionsManager.setScale(t.x,t.y,t.z),this.actionsManager.setRotation(i.x,i.y,i.z,this.romat),this.actionsManager.setPosition(e.x,e.y,e.z)),this.globalWorldMatrix.copy(this.transformMatrix)}},{key:"resetModelWorldMatrix",value:function(){this.transformMatrix.copy(this.globalWorldMatrix)}}])&&s(t.prototype,e),i&&s(t,i),Object.defineProperty(t,"prototype",{writable:!1}),r}(l.ModelViewerLayer);return t.default=i,e.exports});;
Cube("datav:/com/datav-model-viewer/1.3.3/Light",["datav:/npm/@ali/datav-vangogh-basic/1.0.3"],function(i,t,e,a,o,s){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var r=e("datav:/npm/@ali/datav-vangogh-basic/1.0.3"),n=(e=e("datav:/com/datav-model-viewer/1.3.3/Light/Ground/groundMaterial"))&&e.__esModule?e:{default:e};function h(i,t){for(var e=0;e<t.length;e++){var a=t[e];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(i,a.key,a)}}var d,l=new r.THREE.Color(16777215),g=new r.THREE.Color(0),u=(e=c,(u=[{key:"updateDistance",value:function(i){this.distance=i}},{key:"init",value:function(){this.lights=new r.THREE.Group,this.ambientLight=new r.THREE.AmbientLight(16777215,0),this.ambientLight.visible=!1,this.directionalLight1=new r.THREE.DirectionalLight(16777215,0),this.directionalLight1.visible=!1,this.directionalLight2=new r.THREE.DirectionalLight(16777215,0),this.directionalLight2.visible=!1,this.directionalLight3=new r.THREE.DirectionalLight(16777215,0),this.directionalLight3.visible=!1,this.lights.add(this.ambientLight),this.lights.add(this.directionalLight1),this.lights.add(this.directionalLight2),this.lights.add(this.directionalLight3),this.setAmbientLight(),this.setDirectionalLight()}},{key:"setAmbientLight",value:function(){var i,t=this.options.ambientLight;0<t.length?(i=(t=t[0]).color,t=t.intensity,i=r.Utils.Chroma(i).gl(),this.ambientLight.visible=!0,this.ambientLight.color.r=i[0],this.ambientLight.color.g=i[1],this.ambientLight.color.b=i[2],this.ambientLight.intensity=t):this.ambientLight.visible=!1}},{key:"setDirectionalLight",value:function(){var i,t,e,a=this.options.directionalLight;0<a.length&&void 0!==a[0]?(e=(t=a[0]).color,i=t.intensity,t=t.position,void 0!==e&&(e=r.Utils.Chroma(e).gl(),this.directionalLight1.visible=!0,this.directionalLight1.color.r=e[0],this.directionalLight1.color.g=e[1],this.directionalLight1.color.b=e[2],this.directionalLight1.intensity=i,this.directionalLight1.position.set(t.x,t.y,t.z),this.directionalLight1.castShadow=!0,this.updateDirectionalLightShadowCameraParameters(),e=a[0].shadowMap,this.updateDirectionalLightShadowMapParameters(e))):this.directionalLight1.visible=!1}},{key:"updateDirectionalLightShadowCameraParameters",value:function(){this.directionalLight1.shadow.camera.top=this.distance,this.directionalLight1.shadow.camera.bottom=-this.distance,this.directionalLight1.shadow.camera.left=-this.distance,this.directionalLight1.shadow.camera.right=this.distance,this.directionalLight1.shadow.camera.far=1e3,this.directionalLight1.shadow.camera.updateProjectionMatrix()}},{key:"updateDirectionalLightShadowMapParameters",value:function(i){void 0!==i?(this.directionalLight1.shadow.mapSize.width=i.width,this.directionalLight1.shadow.mapSize.height=i.height,this.directionalLight1.shadow.bias=i.bias):(this.directionalLight1.shadow.mapSize.width=2048,this.directionalLight1.shadow.mapSize.height=2048)}},{key:"updateShadowGround",value:function(i,t){var e,a;this.ground?(a=3*i/this.ground.geometry.parameters.radius,this.ground.scale.set(a,a,a),this.ground.position.set((t.min.x+t.max.x)/2,t.min.y,(t.min.z+t.max.z)/2)):(a=new r.THREE.CircleBufferGeometry(3*i,32),e=new n.default,this.boundary={value:.1/i},e.transparent=!0,(a=new r.THREE.Mesh(a,e)).rotation.x=-Math.PI/2,a.position.set((t.min.x+t.max.x)/2,t.min.y,(t.min.z+t.max.z)/2),a.receiveShadow=!0,this.ground=a,this.viewer.engine.scene.add(this.ground)),this.ground.userData.initAlpha=.1/i,this.ground.userData.initRadius=10*i*this.ground.scale.x,this.ground.userData.initPos=t.min.y,this.updateGroundConfig()}},{key:"updateGroundConfig",value:function(){this.groundConfig=r.Utils.mergeOptions(this.groundConfig,(0<arguments.length&&void 0!==arguments[0]?arguments[0]:{})||{});var i=this.groundConfig,t=i.show,e=i.groundColor,a=i.shadowColor,a=void 0===a?"#000000":a,o=i.boundary,s=i.height,n=i.size,i=i.opacity,h=this.ground.geometry.parameters.radius;l.fromArray(r.Utils.Chroma(void 0===e?"#ffffff":e).gl()),g.fromArray(r.Utils.Chroma(a).gl()),t?(this.ground.visible=!0,this.ground.scale.set(n/(h/this.ground.userData.initRadius),n/(h/this.ground.userData.initRadius),n/(h/this.ground.userData.initRadius)),this.ground.position.y=this.ground.userData.initPos+s,this.ground.updateMatrixWorld(!0),this.ground.material.opacity=i,this.ground.material.boundary=0===o?0:this.ground.userData.initAlpha*o,this.ground.material.groundColor=l,this.ground.material.shadowColor=g):this.ground.visible=!1}},{key:"updateOptions",value:function(i){var t=r.Utils.deepClone(this.options);this.options=r.Utils.mergeOptions(this.options,i),r.Utils.easyObjDiff(t.ambientLight,i.ambientLight)&&r.Utils.deepDiff(t.ambientLight,i.ambientLight)||this.setAmbientLight(),r.Utils.easyObjDiff(t.directionalLight,i.directionalLight)&&r.Utils.deepDiff(t.directionalLight,i.directionalLight)||this.setDirectionalLight()}},{key:"destroy",value:function(){this.lights=null,this.ground.geometry.dispose(),this.ground.material.dispose(),this.ground.dispose()}}])&&h(e.prototype,u),d&&h(e,d),Object.defineProperty(e,"prototype",{writable:!1}),c);function c(i,t){if(!(this instanceof c))throw new TypeError("Cannot call a class as a function");this.viewer=i,this.options=t,this.groundConfig=t.groundShadow,this.distance=100,this.init()}return t.default=u,i.exports});;
Cube("datav:/com/datav-model-viewer/1.3.3/Camera",["datav:/npm/@ali/datav-vangogh-basic/1.0.3"],function(t,e,i,a,r,o){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var n=i("datav:/npm/@ali/datav-vangogh-basic/1.0.3");function s(t,e){for(var i=0;i<e.length;i++){var a=e[i];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(t,a.key,a)}}var h,c=new n.THREE.Vector3,p=(i=g,(p=[{key:"modelConfig",set:function(t){var e=t.center,t=t.radius;this._center.copy(e),this._radius=t}},{key:"target",get:function(){return this._target}},{key:"init",value:function(){var t=this.options,e=t.fov,i=t.type,a=t.position,t=t.target;this.engine.createCamera({name:i,type:i,fov:e,near:.01,far:1e4}),this.engine.cameraMgr.activeCamera(i),this.engine.camera.up.set(0,1,0),this.engine.camera.updateProjectionMatrix(),this.setCameraPosition(a),this.setCameraTarget(t),c.set(a.px-t.tx,a.py-t.ty,a.pz-t.tz),this.resizeOrthographicCamera(c.length(),e),this.engine.camera.userData.pos={px:100,py:60,pz:100}}},{key:"setCameraPosition",value:function(t){t.isVector3?this.engine.camera.position.copy(t):this.engine.camera.position.set(t.px,t.py,t.pz)}},{key:"setCameraTarget",value:function(t){t.isVector3?(this.engine.camera.lookAt(t),this._target.copy(t)):(this.engine.camera.lookAt(t.tx,t.ty,t.tz),this._target.set(t.tx,t.ty,t.tz))}},{key:"autoFitTo",value:function(){var t,e,i=this.viewer.controls.object,a=10*this._radius,r=(a=a<999999?a:999999)/1e4<.01?.01:a/1e4,r=(i.far=a,i.near=r,i.updateProjectionMatrix(),this.viewer.controls.target.set(this._center.x,this._center.y,this._center.z),a=i.isPerspectiveCamera?(t=Math.tan(i.fov*n.THREE.Math.DEG2RAD*.5)*i.near,s=i.aspect*(e=-t),i.aspect*t):(t=i.top,e=i.bottom,s=i.left,i.right),i.near),o=this._radius,a=Math.abs(a-s)/r,s=Math.abs(t-e)/r;o/=Math.sin(Math.atan2(s<a?s:a,1)),i.position.set(this._center.x+o,this._center.y+o/2,this._center.z+o),i.isOrthographicCamera&&(c.copy(i.position).sub(this.viewer.controls.target),this.resizeOrthographicCamera(c.length(),this.options.fov)),this.viewer.controls.maxDistance=Math.ceil(10*this._radius),this.viewer.controls.updateTarget(),i.userData.initialPosition=[i.position.x,i.position.y,i.position.z]}},{key:"updateCamera",value:function(){var t=this.options,e=t.fov,t=t.type,i=this.viewer.controls.object.position,a=this.viewer.controls.target,r=this.viewer.controls.object,o=r.near,r=r.far;void 0===this.engine.cameraMgr.getCamera(t)&&(this.engine.createCamera({name:t,type:t,fov:e,near:o,far:r}),"orthographic"===t&&(o=c.copy(i).sub(a).length(),this.resizeOrthographicCamera(o,e))),this.engine.activeCamera(t),this.engine.camera.up.set(0,1,0),this.engine.camera.updateProjectionMatrix(),this.setCameraPosition(i),this.setCameraTarget(a),this.viewer.controls.object=this.engine.camera,this.viewer.controls.target.copy(this._target),this.viewer.controls.updateTarget()}},{key:"resizeOrthographicCamera",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:1,e=1<arguments.length&&void 0!==arguments[1]?arguments[1]:60,i=this.engine.cameraMgr.getCamera("orthographic");i&&(t=void 0===i.userData.top?i.top/(t*Math.atan(Math.PI/180*e/2)):i.top/i.userData.top,i.userData.top=i.top,i.zoom*=t,i.updateProjectionMatrix())}},{key:"updateOptions",value:function(t){var e=n.Utils.deepClone(this.options);this.options=n.Utils.mergeOptions(this.options,t),n.Utils.easyDiff(e.type,t.type)||this.updateCamera(),n.Utils.easyDiff(e.fov,t.fov)||(this.engine.camera.fov=t.fov,this.engine.camera.updateProjectionMatrix()),n.Utils.easyObjDiff(e.position,t.position)||this.setCameraPosition(t.position),n.Utils.easyObjDiff(e.target,t.target)||this.setCameraTarget(t.target)}},{key:"destroy",value:function(){var t;null!=(t=this.viewer.controls)&&t.remove()}}])&&s(i.prototype,p),h&&s(i,h),Object.defineProperty(i,"prototype",{writable:!1}),g);function g(t,e){if(!(this instanceof g))throw new TypeError("Cannot call a class as a function");this.viewer=t,this.engine=t.engine,this.options=e,this._target=new n.THREE.Vector3(0,0,0),this.init(),this._center=new n.THREE.Vector3(0,0,0),this._radius=1}return e.default=p,t.exports});;
Cube("datav:/com/datav-model-viewer/1.3.3/Config",[],function(o,e,a,n,r,t){Object.defineProperty(e,"__esModule",{value:!0}),e.MOUSE_STATE=e.DEFAULT_CONFIG=void 0;e.DEFAULT_CONFIG={sceneId:["scene1"],channel:"default",background:{type:"color",color:"RGBA(255, 0, 0, 1.0)",hdrUrl:"//sh-conf.oss-cn-shanghai.aliyuncs.com/datav-citypro/envmap/sky_citypro_001.hdr"},render:{preserveDrawingBuffer:!0,isGammaInput:!1,isGammaOutput:!0,outputEncoding:"sRGBEncoding",isPhysicallyCorrect:!1,isShadowMap:!0,logarithmicDepthBuffer:!1,clearColor:"rgba(0,0,0,0.0)",toneMapping:{tmType:"ACESFilmicToneMapping",exposure:1},fogColor:"#fff",fogDensity:0,maxFPS:60,alpha:!0,antialias:!0},model:{transform:{position:{x:0,y:0,z:0},rotation:{x:0,y:0,z:0},scale:{x:1,y:1,z:1}}}};return e.MOUSE_STATE={PAN:{mouseButton:2,keyboard:null},ZOOM:{mouseButton:1,keyboard:null},ROTATE:{mouseButton:0,keyboard:null}},o.exports});;
Cube("datav:/com/datav-model-viewer/1.3.3/immerseHook",[],function(t,e,o,n,a,i){function l(t){return(l="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var y=r(o("react")),c=r(o("react-dom"));function r(t){return t&&t.__esModule?t:{default:t}}function s(t,e){return function(t){if(Array.isArray(t))return t}(t)||function(t,e){var o=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=o){var n,a,i=[],l=!0,r=!1;try{for(o=o.call(t);!(l=(n=o.next()).done)&&(i.push(n.value),!e||i.length!==e);l=!0);}catch(t){r=!0,a=t}finally{try{l||null==o.return||o.return()}finally{if(r)throw a}}return i}}(t,e)||function(t,e){if(t){if("string"==typeof t)return u(t,e);var o=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(o="Object"===o&&t.constructor?t.constructor.name:o)||"Set"===o?Array.from(t):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?u(t,e):void 0}}(t,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(t,e){(null==e||e>t.length)&&(e=t.length);for(var o=0,n=new Array(e);o<e;o++)n[o]=t[o];return n}function b(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function v(t,e){return(v=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function h(o){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=f(o),e=(t=n?(t=f(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===l(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return g(e)}}function g(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}function A(t,e,o){e in t?Object.defineProperty(t,e,{value:o,enumerable:!0,configurable:!0,writable:!0}):t[e]=o}o("datav:/com/datav-model-viewer/1.3.3/immerseHook/style.css","");var w={animationCopied:"动画名复制成功",cameraFitSetting:"相机位置校准设置",cameraAutoFit:"自动校准",modelAnimationSetting:"模型自身动画设置",autoplay:"自动播放",defaultAnimation:"默认动画",noAnimation:"当前模型无动画",animationPreview:"动画预览",play:"播放",stop:"停止"};function m(t,a){function n(t){var e=t.children,o=t.value,n=t.isSelected;return y.default.createElement("div",{className:"animation-option"},y.default.createElement(m.Option,t,e),y.default.createElement(r,{className:"animation-option-copy ".concat(n?"--selected":""),type:"copy",onClick:function(){var t=o,e=document.createElement("textarea");e.style.position="fixed",e.style.left=0,e.style.top=0,e.style.height="2em",e.style.width="2em",e.style.border="none",e.style.outline="none",e.style.boxShadow="none",e.style.userSelect="auto",e.style.background="transparent",e.value=t,document.body.appendChild(e),e.focus(),e.select();try{document.execCommand("copy")}catch(t){console.warn("Copy failed:",t)}e.remove(),u.success((null==a?void 0:a.get("animationCopied"))||w.animationCopied)}}))}var i=t.Select,e=t.Radio,l=t.Switch,r=t.Icon,u=t.Notify,c=t.Button,s=e.Button,f=e.Group,m=i.components,t=y.default.PureComponent,e=p;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&v(e,t);var o,d=h(p);function p(t){var e;if(!(this instanceof p))throw new TypeError("Cannot call a class as a function");A(g(e=d.call(this,t)),"setAutoplay",function(t){e.setState({autoPlay:t})}),A(g(e),"setDefaultAnimation",function(t){e.setState({defaultAnimation:t.value},function(){e.state.playing&&(e.stop(),e.play())})}),A(g(e),"togglePlay",function(t){e.setState({playing:t},function(){t?e.play():e.stop()})}),A(g(e),"play",function(){e.state.defaultAnimation&&e.props.play&&e.props.play(e.state.defaultAnimation)}),A(g(e),"stop",function(){e.props.stop&&e.props.stop()}),A(g(e),"onClickAutoFitTo",function(){e.props.autoFitTo&&e.props.autoFitTo()});var o=t.autoPlay,n=t.defaultAnimation,t=t.animationList,t=void 0===t?[]:t;return e.state={autoPlay:o,defaultAnimation:n,playing:!1},e.animationListOptions=t.map(function(t){return{label:t,value:t}}),e}return e=p,(t=[{key:"render",value:function(){var t=this.state,e=t.autoPlay,o=t.defaultAnimation,t=t.playing;return y.default.createElement("div",{className:"datav-fab-immerse-toolbox"},y.default.createElement("div",{className:"toolbox-sub-title"},(null==a?void 0:a.get("cameraFitSetting"))||w.cameraFitSetting),y.default.createElement("div",{className:"toolbox-control"},y.default.createElement(c,{className:"toolbox-control-camera",onClick:this.onClickAutoFitTo},(null==a?void 0:a.get("cameraAutoFit"))||w.cameraAutoFit)),y.default.createElement("div",{className:"toolbox-sub-title"},(null==a?void 0:a.get("modelAnimationSetting"))||w.modelAnimationSetting),y.default.createElement("div",{className:"toolbox-control"},y.default.createElement("label",null,(null==a?void 0:a.get("autoplay"))||w.autoplay),y.default.createElement(l,{className:"toolbox-control-content",checked:e,onChange:this.setAutoplay})),y.default.createElement("div",{className:"toolbox-control"},y.default.createElement("label",null,(null==a?void 0:a.get("defaultAnimation"))||w.defaultAnimation),y.default.createElement(i,{outerClassName:"toolbox-control-content",isClearable:!1,isSearchable:!1,placeholder:(null==a?void 0:a.get("noAnimation"))||w.noAnimation,value:this.animationListOptions.find(function(t){return t.value===o}),onChange:this.setDefaultAnimation,options:this.animationListOptions,menuPosition:"absolute",components:{Option:n}})),y.default.createElement("div",{className:"toolbox-control"},y.default.createElement("label",null,(null==a?void 0:a.get("animationPreview"))||w.animationPreview),y.default.createElement(f,{className:"toolbox-control-content",value:t,onChange:this.togglePlay},y.default.createElement(s,{className:"toolbox-control-preview",title:(null==a?void 0:a.get("play"))||w.play,value:!0},y.default.createElement(r,{type:"play-new"})),y.default.createElement(s,{className:"toolbox-control-preview",title:(null==a?void 0:a.get("stop"))||w.stop,value:!1},y.default.createElement(r,{type:"stop-new"})))))}}])&&b(e.prototype,t),o&&b(e,o),Object.defineProperty(e,"prototype",{writable:!1}),p}function d(t,e,o){var t=t.componentData,n=t.instance,t=t.config,a=e.quitCallback,i=e.toolboxContainer,e=e.i18n,o=m(o.UI,e),l=n.getAnimationList(),e=void 0!==t.options.animate&&void 0!==t.options.animate.modelAnimate?t.options.animate.modelAnimate:t.options.model.animation,t=e.autoPlay,e=e.defaultAnimation,r=null,u=(l&&l.length&&(r=e&&l.includes(e)?e:s(l,1)[0]),null);return c.default.render(y.default.createElement(o,{ref:function(t){u=t},autoPlay:t,defaultAnimation:r,animationList:l,play:n.play.bind(n),stop:n.stop.bind(n),autoFitTo:n.autoFitTo.bind(n)}),i),function(){var t=n.getCameraInfo(),e={autoPlay:u.state.autoPlay,defaultAnimation:u.state.defaultAnimation,animationList:l};return c.default.unmountComponentAtNode(i),a&&a(),{config:{options:{camera:t,animate:{modelAnimate:e}}}}}}return d.config={enterText:"相机位置及动画设置",quitText:"退出并保存设置",toolbox:{width:300,title:"设置"}},e.default=d,t.exports});;
Cube("datav:/com/datav-model-viewer/1.3.3/Viewer",["datav:/npm/@ali/datav-vangogh-basic/1.0.3"],function(e,t,i,n,o,r){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var s=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!==a(e)&&"function"!=typeof e)return{default:e};t=f(t);if(t&&t.has(e))return t.get(e);var i,n={},o=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(i in e){var r;"default"!==i&&Object.prototype.hasOwnProperty.call(e,i)&&((r=o?Object.getOwnPropertyDescriptor(e,i):null)&&(r.get||r.set)?Object.defineProperty(n,i,r):n[i]=e[i])}n.default=e,t&&t.set(e,n);return n}(i("datav:/npm/@ali/datav-vangogh-basic/1.0.3")),l=i("datav:/com/datav-model-viewer/1.3.3/Config"),c=h(i("datav:/com/datav-model-viewer/1.3.3/Camera")),p=h(i("datav:/com/datav-model-viewer/1.3.3/Light")),u=h(i("datav:/com/datav-model-viewer/1.3.3/ModelViewer")),d=h(i("datav:/com/datav-model-viewer/1.3.3/RenderPipeline"));function h(e){return e&&e.__esModule?e:{default:e}}function f(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,i=new WeakMap;return(f=function(e){return e?i:t})(e)}function g(e,t){for(var i=0;i<t.length;i++){var n=t[i];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}(e,t);if(n)return n=Object.getOwnPropertyDescriptor(n,t),n.get?n.get.call(arguments.length<3?e:i):n.value}).apply(this,arguments)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(i){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=b(i),t=(e=n?(e=b(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var w=s.THREE,O=s.Utils,i=function(e){var t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var i,n=m(o);function o(e,t,i){if(this instanceof o)return(e=n.call(this,e,O.mergeOptions(l.DEFAULT_CONFIG,t))).mode=i.env,e.initLights(),e.initModel(),e;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"initEngine",value:function(){this.engine=new s.Engine,this.engine.createRenderer(this.options.renderer,this.container),this.engine.createScene("main"),this.engine.sceneMgr.activeScene("main"),this.initCamera(),this.engine.createRenderPipelineManager(),this.initRenderPipeline()}},{key:"initCamera",value:function(){this.camera=new c.default(this,this.options.camera)}},{key:"initControls",value:function(){v(b(o.prototype),"initControls",this).call(this),this.controls.target.copy(this.camera.target),this.controls.updateTarget(),this.controls.setMouseStates(l.MOUSE_STATE)}},{key:"initSuperWorker",value:function(){this.superWorker=new s.SuperWorker,this.engine.superWorker=this.superWorker}},{key:"initTrigger",value:function(){}},{key:"initRenderPipeline",value:function(){this.engine.renderer.shadowMap.enabled=!0,this.engine.renderer.shadowMap.autoUpdate=!0,this.engine.renderer.shadowMap.type=2;var e=this.refractorPostProcessingOption(this.options.postprocessing);this.renderPipeline=new d.default(e),this.addRenderPipeline(this.renderPipeline),this.pipeline=this.renderPipeline._pipelineCore.pipeline,this.pipeline.lightingPass.fsQuad.quad.receiveShadow=this.options.model.renderEffect.shadow.receiveShadow,this.pipeline.skyPass.enabled=!1}},{key:"initLights",value:function(){this.envMap={url:"",properties:1,value:null,angle:0},this.setEnvironmentLight(),this.light=new p.default(this,this.options.lights),this.engine.scene.add(this.light.lights)}},{key:"initModel",value:function(){var o=this,e=this.refractorOptions(this.options);this.modelViewer=new u.default(e),this.addLayer("model",this.modelViewer),this.modelViewer.on("loaded",function(){var e,t,i,n;o.modelViewer.model&&((e=o.modelViewer.actionsManager.bbox).applyMatrix4(o.modelViewer.transformMatrix),n=(new w.Vector3).copy(e.max),t=(new w.Vector3).copy(e.min),(i=new w.Vector3).addVectors(t,n),i.multiplyScalar(.5),n=n.sub(t).length()/2,n=Math.min(n,999999),n=Math.max(n,1),o.camera.modelConfig={center:i,radius:n},o.light.updateDistance(n),o.light.updateDirectionalLightShadowCameraParameters(),o.light.updateShadowGround(n,e))})}},{key:"setData",value:function(e){this.modelViewer&&this.modelViewer.setData(e)}},{key:"resize",value:function(e,t){v(b(o.prototype),"resize",this).call(this,e,t),this.camera.resizeOrthographicCamera()}},{key:"refractorOptions",value:function(e){var t=Object.assign({},e),i=t.model,t=t.animate;return i&&(i.sceneId=e.sceneId,this.refractorModelOption(i)),this.refractorAnimateOption(t||{},i),i.enableGBuffer=!0,{model:i,animate:t}}},{key:"refractorModelOption",value:function(e){var t=e.transform,i=e.url;i.match(/(http|https):\/\/([\w.]+\/?)\S*/)||(e.url=location.origin+i),t&&(e=t.position,i=t.rotation,t=t.scale,void 0===e.offsetX&&void 0===e.offsetY&&void 0===e.offsetZ||(e.x=e.offsetX,e.y=e.offsetY,e.z=e.offsetZ,void 0!==e.offsetX&&delete e.offsetX,void 0!==e.offsetY&&delete e.offsetY,void 0!==e.offsetZ&&delete e.offsetZ),void 0===i.rotationX&&void 0===i.rotationY&&void 0===i.rotationZ||(i.x=i.rotationX/180,i.y=i.rotationY/180,i.z=i.rotationZ/180,void 0!==i.rotationX&&delete i.rotationX,void 0!==i.rotationY&&delete i.rotationY,void 0!==i.rotationZ&&delete i.rotationZ),void 0===t.scaleX&&void 0===t.scaleY&&void 0===t.scaleZ||(t.x=t.scaleX,t.y=t.scaleY,t.z=t.scaleZ,void 0!==t.scaleX&&delete t.scaleX,void 0!==t.scaleY&&delete t.scaleY,void 0!==t.scaleZ&&delete t.scaleZ))}},{key:"refractorAnimateOption",value:function(e,t){t.scanner=Object.assign(t.scanner||{},e.scanner),void 0===t.scanner.enable&&(t.scanner.enable=t.scanner.show),t.animation=Object.assign(t.animation||{},e.modelAnimate)}},{key:"refractorPostProcessingOption",value:function(t){var i=Object.assign({needsLight:!1,screenPercentage:1,fxaa:{edgeDetectionQuality:.001},filmic:{colorGrading:{hueShift:0,saturation:1,exposure:0,contrast:1,colorFilter:"#ffffff"}}},t);return Object.keys(t).forEach(function(e){void 0!==t[e].show&&(i[e].enabled=t[e].show)}),t.ssr&&(i.ssr.maxStep=50),t.colorCorrection&&(i.filmic.colorGrading.hueShift=t.colorCorrection.hue,i.filmic.colorGrading.saturation=t.colorCorrection.saturation,i.filmic.colorGrading.exposure=t.colorCorrection.brightness,i.filmic.colorGrading.contrast=t.colorCorrection.contrast,delete i.colorCorrection),i.antialiasType=i.antialiasType.toLowerCase(),i}},{key:"getHDRMap",value:function(e){var o=this;return new Promise(function(n){(new s.RGBELoader).load(e,function(e){var t=new w.PMREMGenerator(o.engine.renderer),i=(t.compileEquirectangularShader(),t.fromEquirectangular(e).texture);t.dispose(),e.dispose(),n(i)})})}},{key:"setEnvironmentLight",value:function(){var t=this,e=this.options.lights.environmentLight,i=e.show,n=e.hdrUrl,o=e.hdrOrientation,r=e.hdrIntensity;i?this.envMap.url!==n?(this.envMap.url=n,this.getHDRMap(n).then(function(e){t.envMap.properties=r,t.envMap.value=e,t.envMap.angle=o/180*Math.PI,t.pipeline&&(t.pipeline.envMap=e,t.pipeline.envMapIntensity=r,t.pipeline.envMapOrientation=o/180*Math.PI),t.updateModelViewEnvMap(),t.updateSkybox()})):""!==n?(this.envMap.properties=r,this.envMap.angle=o/180*Math.PI,this.pipeline&&(this.pipeline.envMapIntensity=r,this.pipeline.envMapOrientation=o/180*Math.PI),this.updateModelViewEnvMap(),this.updateSkybox()):console.log("当前未提供环境贴图"):(this.envMap.value=null,this.envMap.url="",this.pipeline&&(this.pipeline.envMap=null),this.updateModelViewEnvMap(),this.updateSkybox())}},{key:"updateSkybox",value:function(){var e=this.options.lights.background,t=e.show,i=e.type,n=e.color;if(t)switch(i){case"black":this.pipeline.backgroundPass.background.opacity=0;break;case"color":var o=O.Chroma(n).gl();this.pipeline.backgroundPureColor=(new w.Color).fromArray(o),this.pipeline.backgroundPass.background.opacity=o[3];break;case"hdr":this.pipeline.backgroundTexture=this.envMap.value,this.pipeline.backgroundPass.background.envMapOrientation=this.envMap.angle,this.pipeline.backgroundPass.background.opacity=1}else this.pipeline.backgroundPass.background.opacity=0}},{key:"updateModelViewEnvMap",value:function(){this.modelViewer&&this.modelViewer.setEnvMap(this.envMap)}},{key:"updateOptions",value:function(e){var t,i=O.deepClone(this.options);this.options=O.mergeOptions(this.options,e||{}),O.easyObjDiff(i.camera,e.camera)||this.camera.updateOptions(e.camera),O.easyObjDiff(i.model,e.model)||this.updateModelOptions(e.model),O.easyObjDiff(i.animate,e.animate)||this.modelViewer.updateAnimateOptions(e.animate),O.easyObjDiff(i.lights.background,e.lights.background)||this.updateSkybox(),O.easyObjDiff(i.lights.environmentLight,e.lights.environmentLight)||this.setEnvironmentLight(),O.easyObjDiff(i.lights.ambientLight,e.lights.ambientLight)&&O.easyObjDiff(i.lights.directionalLight,e.lights.directionalLight)&&O.deepDiff(i.lights.ambientLight,e.lights.ambientLight)&&O.deepDiff(i.lights.directionalLight,e.lights.directionalLight)||this.light&&this.light.updateOptions(e.lights),O.easyObjDiff(i.lights.groundShadow,e.lights.groundShadow)||null!=(t=this.light)&&t.ground&&this.light.updateGroundConfig(e.lights.groundShadow),O.easyObjDiff(i.postprocessing,e.postprocessing)||this.updatePostProcessing(e.postprocessing)}},{key:"updateModelOptions",value:function(e){e=Object.assign({},e);this.refractorModelOption(e),this.modelViewer.updateOptions(e),this.pipeline&&(this.pipeline.lightingPass.fsQuad.quad.receiveShadow=e.renderEffect.shadow.receiveShadow)}},{key:"updatePostProcessing",value:function(e){var t,e=this.refractorPostProcessingOption(e);null!=(t=this.renderPipeline)&&t.updateOptions(e)}},{key:"autoFitTo",value:function(){var e;null!=(e=this.camera)&&e.autoFitTo()}},{key:"getCameraInfo",value:function(){var e=this.controls,t=e.object,e=e.target;return{position:{px:t.position.x,py:t.position.y,pz:t.position.z},target:{tx:e.x,ty:e.y,tz:e.z}}}},{key:"getAnimationList",value:function(){if(this.modelViewer)return this.modelViewer.animationNames}},{key:"play",value:function(e){this.modelViewer&&this.modelViewer.setAnimation(!0,{name:e,weight:1,loopMode:"LoopRepeat"})}},{key:"stop",value:function(){this.modelViewer&&this.modelViewer.setAnimation(!1)}}])&&g(t.prototype,e),i&&g(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o}(s.Viewer);return t.default=i,e.exports});;
Cube("datav:/com/datav-model-viewer/1.3.3",["datav:/npm/eventemitter3/3.0.0"],function(e,t,n,r,o,i){function u(e){return(u="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}var a=s(n("datav:/npm/eventemitter3/3.0.0")),c=s(n("datav:/com/datav-model-viewer/1.3.3/Viewer")),n=s(n("datav:/com/datav-model-viewer/1.3.3/immerseHook"));function s(e){return e&&e.__esModule?e:{default:e}}function f(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=p(n),t=(e=r?(e=p(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===u(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function p(e){return(p=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}a=function(e){var t=u;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var n,i=v(u);function u(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{env:"editor"},r=this,o=u;if(r instanceof o)return(r=i.call(this)).apis=t.apis,r.container="string"==typeof e?document.querySelector(e):e,e.addEventListener("contextmenu",function(e){return e.preventDefault()}),r.options=t.options,r.data={},r.url="",r.status=n,r.viewer=new c.default(r.container,r.options,n),r.viewer.startRendering(),r;throw new TypeError("Cannot call a class as a function")}return t=u,(e=[{key:"resize",value:function(e,t){this.viewer&&this.viewer.resize(e,t)}},{key:"setData",value:function(e){this.viewer&&this.viewer.setData(e)}},{key:"updateOptions",value:function(e){this.viewer&&this.viewer.updateOptions(e.options)}},{key:"updatePostProcessing",value:function(e){this.viewer&&this.viewer.updatePostProcessing(e)}},{key:"autoFitTo",value:function(){this.viewer&&this.viewer.autoFitTo()}},{key:"getCameraInfo",value:function(){if(this.viewer)return this.viewer.getCameraInfo()}},{key:"getAnimationList",value:function(){if(this.viewer)return this.viewer.getAnimationList()}},{key:"play",value:function(e){this.viewer&&this.viewer.play(e)}},{key:"stop",value:function(){this.viewer&&this.viewer.stop()}},{key:"getSnapshot",value:function(){return this.container.querySelector("canvas").toDataURL()}},{key:"getBlob",value:function(e){return this.container.querySelector("canvas").toBlob(e)}},{key:"destroy",value:function(){this.viewer&&this.viewer.dispose&&this.viewer.dispose(),this.container&&(this.container.innerHTML="")}}])&&f(t.prototype,e),n&&f(t,n),Object.defineProperty(t,"prototype",{writable:!1}),u}(a.default);return a.editOnImmerse=n.default,e.exports=a,e.exports});