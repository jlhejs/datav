// env=undefined => env=publish 
Cube("datav:/com/datav-2dmap-amap/3.0.21/css/main.css", [], function(m){m.exports=".amap-indoormap-floorbar-control{position:absolute;margin:auto 0;bottom:165px;right:12px;width:35px;text-align:center;line-height:1.3em;overflow:hidden;padding:0 2px;z-index:10000}";return m.exports});;
Cube("datav:/com/datav-2dmap-amap/3.0.21/config",[],function(a,e,t,r,o,m){return a.exports={DEFAULT_OPTIONS:{renderer:"basemap",visibility:!0,general:{zoomRange:[0,18],minZoom:0,maxZoom:20},graph:{amapVersion:"2.0",mapKey_defalut:"f6ce2bfb8de7c1ec5cbe49d47a7ac207",mapKey:"",mapSecurity:"",mapType:"normal",standardStyleTemplate:"normal",customMapStyle:"",amapFeatures:{bg:!0,road:!0,building:!0,point:!0},filter:{show:!1,brightness:1,contrast:1,grayscale:0,hueRotate:0,invert:0,saturate:1,sepia:0},isTraffic:!1}}},a.exports});;
Cube("datav:/com/datav-2dmap-amap/3.0.21/src/amapLayer.js",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(t,e,a,n,o,i){function r(t){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function y(t,e,a){e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a}function s(t,e){for(var a=0;a<e.length;a++){var n=e[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function p(t,e){return(p=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function l(a){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=m(a),e=(t=n?(t=m(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===r(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return u(e)}}function u(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function m(t){return(m=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var h=a("datav:/npm/eventemitter3/3.0.0"),f=a("datav:/npm/safely-merge/1.0.1");return a("datav:/com/datav-2dmap-amap/3.0.21/css/main.css",""),t.exports=function(m){var a=m.L,c=m.map,t=i,e=h;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e);var n,o=l(i);function i(t){var e;if(this instanceof i)return(e=o.call(this)).options=f({},t),e.options.general.minZoom=t.general.zoomRange[0],e.options.general.maxZoom=t.general.zoomRange[1],e.options.visibility=!0,c._animatingZoom=!1,c._zoomAnimated=!1,c.options.zoomAnimation=!1,e.onMapMove=e.onMapMove.bind(u(e)),e.setZoomAndCenter=e.setZoomAndCenter.bind(u(e)),e.initAMap=e.initAMap.bind(u(e)),e.updateFilter=e.updateFilter.bind(u(e)),e.initContainer(),e.init(),e;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"initContainer",value:function(){this.pane=c.getPane("tilePane"),this.pane.style.zIndex=0;var t=c.getSize(),t=(this.amapContainer=document.createElement("div"),this.amapContainer.style.position="absolute",this.amapContainer.style.top=0,this.amapContainer.style.left=0,this.amapContainer.style.width="".concat(t.x,"px"),this.amapContainer.style.height="".concat(t.y,"px"),this.amapContainer.style.pointerEvents="none",this.amapContainer.style.backgroundColor="rgba(0,0,0,0)",this.amapContainer.style.opacity=this.options.visibility?.01*+this.options.general.opacity:0,this.pane.appendChild(this.amapContainer),a.DomUtil.getPosition(c.getPane("mapPane")));t&&(t={x:-t.x,y:-t.y},a.Browser.any3d?a.DomUtil.setTransform(this.amapContainer,t):a.DomUtil.setPosition(this.amapContainer,t))}},{key:"init",value:function(){var t,e,a,n,o,i=this;window.AMap?(i.initAMap(),i.registerMapEvent()):(t=(n=i.options.graph).amapVersion,o=n.mapType,e=n.mapKey_defalut,a=n.mapKey,n=n.mapSecurity,o="normal"===o?e:a,window._AMapSecurityConfig={securityJsCode:n||""},m.AMapLoader&&m.AMapLoader.load({key:o,version:t,plugins:[]}).then(function(t){window.AMap=t,i.initAMap(),i.registerMapEvent()}).catch(function(t){console.log("高德在线底图地图加载失败！",t)}))}},{key:"initAMap",value:function(){var t,e=this.options,a=e.general,n=e.graph,o=e.visibility,i=this,e=c.getZoom(),r=c.getCenter(),s="amap://styles/".concat("normal"===n.mapType?n.standardStyleTemplate:n.customMapStyle),p=[],l=!1;for(t in n.amapFeatures){var m=n.amapFeatures[t];switch(m){case"bg":case"road":case"building":case"point":p.push(m);break;case"traffic":l=!0}}i.amap=new AMap.Map(i.amapContainer,(y(r={resizeEnable:!0,showIndoorMap:!0,layers:[],features:p,center:[r.lng,r.lat],showBuildingBlock:!0,expandZoomRange:!0,animateEnable:!1,jogEnable:!1,viewMode:"3D",zoom:e},"expandZoomRange",!0),y(r,"zooms",[2,20]),y(r,"detectRetina",1<c.devicePixelRatio),y(r,"mapStyle",s),r)),i.updateFilter(n.filter),i.traffic=new AMap.TileLayer.Traffic({autoRefresh:!0}),l&&i.amap.add(i.traffic),i.amap.on("complete",function(){i.currentControls=i.amapContainer.querySelector(".amap-controls"),c.getContainer().appendChild(i.currentControls),i.currentControls.onclick=function(t){i.parentIndex.emit("click",{indoormapFloor:t.target.innerText})},o?i.show():i.hide();var t=c.getZoom();t<a.minZoom||t>a.maxZoom?i.pane&&i.pane.style&&(i.pane.style.opacity=0):i.pane&&i.pane.style&&(i.pane.style.opacity=.01*+i.options.general.opacity)})}},{key:"setZoomAndCenter",value:function(){var t,e;this.amap&&(t=c.getZoom(),e=c.getCenter(),this.amap.setZoomAndCenter(t,[e.lng,e.lat]))}},{key:"onMapMove",value:function(t){var e;this.amapContainer&&(e=c.getPane("mapPane"),(e=a.DomUtil.getPosition(e))&&(e={x:-e.x,y:-e.y},a.Browser.any3d?a.DomUtil.setTransform(this.amapContainer,e):a.DomUtil.setPosition(this.amapContainer,e)),this.setZoomAndCenter())}},{key:"registerMapEvent",value:function(){c.on("move",this.onMapMove)}},{key:"removeMapEvent",value:function(){c.off("move",this.onMapMove)}},{key:"updateOptions",value:function(t){var e,a,n,o=t.general,i=t.graph,r=f({},this.options.general),s=f({},this.options.graph);if(this.options=f(this.options,t),this.amap&&this.amapContainer){if(s.mapType!==i.mapType||s.mapKey!==i.mapKey||s.mapSecurity!==i.mapSecurity)return this.amap.clearMap&&this.amap.destroy&&(this.amap.clearMap(),this.amap.destroy(),this.currentControls&&c.getContainer&&c.getContainer().querySelector(".amap-controls")&&c.getContainer().removeChild(this.currentControls)),a=(t=(e=this).options.graph).amapVersion,p=t.mapType,l=t.mapKey_defalut,n=t.mapKey,p="normal"===p?l:n,l=t.mapSecurity||"",void(m.AMapLoader&&(m.AMapLoader.reset(),window._AMapSecurityConfig={securityJsCode:l},m.AMapLoader.load({key:p,version:a,plugins:[]}).then(function(t){window.AMap=t,e.initAMap(),e.registerMapEvent(),delete window._AMapSecurityConfig}).catch(function(t){console.log("高德在线底图地图加载失败！",t)})));s.standardStyleTemplate==i.standardStyleTemplate&&s.customMapStyle==i.customMapStyle||(n="amap://styles/".concat("normal"===i.mapType?i.standardStyleTemplate:i.customMapStyle),this.amap.setMapStyle(n));var p,t=s.amapFeatures.indexOf("traffic"),l=i.amapFeatures.indexOf("traffic");t!=l&&(-1<l?this.amap.add(this.traffic):this.amap.remove(this.traffic)),JSON.stringify(s.amapFeatures)!=JSON.stringify(i.amapFeatures)&&t==l&&this.amap.setFeatures(i.amapFeatures),JSON.stringify(r.zoomRange)!=JSON.stringify(o.zoomRange)&&(this.options.general.minZoom=o.zoomRange[0],this.options.general.maxZoom=o.zoomRange[1],(p=c.getZoom())<o.minZoom||p>o.maxZoom?this.amapContainer&&this.amapContainer.style&&(this.amapContainer.style.opacity=0):this.amapContainer&&this.amapContainer.style&&(this.amapContainer.style.opacity=.01*+this.options.general.opacity)),r.opacity!=o.opacity&&(this.amapContainer.style.opacity=.01*+o.opacity),!i.filter.show||i.filter.show==s.filter.show&&i.filter.brightness==s.filter.brightness&&i.filter.contrast==s.filter.contrast&&i.filter.grayscale==s.filter.grayscale&&i.filter.hueRotate==s.filter.hueRotate&&i.filter.invert==s.filter.invert&&i.filter.saturate==s.filter.saturate&&i.filter.sepia==s.filter.sepia?i.filter.show||i.filter.show==s.filter.show||(this.amapContainer.style.filter=""):this.updateFilter(i.filter)}}},{key:"updateFilter",value:function(t){t.show&&this.amapContainer&&(t="brightness(".concat(this.toPercent(t.brightness),") contrast(").concat(this.toPercent(t.contrast),") grayscale(").concat(this.toPercent(t.grayscale),") hue-rotate(").concat(t.hueRotate,"deg) invert(").concat(this.toPercent(t.invert),") saturate(").concat(this.toPercent(t.saturate),") sepia(").concat(this.toPercent(t.sepia),") blur(",0,"px)"),this.amapContainer.style.filter=t)}},{key:"toPercent",value:function(t){return"".concat((Math.round(1e4*t)/100).toFixed(2),"%")}},{key:"setZIndex",value:function(t){this.amapContainer&&(this.amapContainer.style.zIndex=t)}},{key:"onZoomEnd",value:function(t){var e=this.options,a=e.general;e.visibility&&t>=a.minZoom&&t<=a.maxZoom?this.amapContainer.style.opacity=.01*+a.opacity:this.amapContainer.style.opacity=0}},{key:"resize",value:function(){var t;this.amapContainer&&(t=c.getSize(),this.amapContainer.style.width="".concat(t.x,"px"),this.amapContainer.style.height="".concat(t.y,"px"),t=c.getPane("mapPane"),(t=a.DomUtil.getPosition(t))&&(t={x:-t.x,y:-t.y},a.Browser.any3d?a.DomUtil.setTransform(this.amapContainer,t):a.DomUtil.setPosition(this.amapContainer,t)))}},{key:"show",value:function(){this.options.visibility=!0;var t=this.options.general,e=c.getZoom();e<t.minZoom||e>t.maxZoom?this.amapContainer&&this.amapContainer.style&&(this.amapContainer.style.opacity=0):this.amapContainer&&this.amapContainer.style&&(this.amapContainer.style.opacity=.01*+this.options.general.opacity)}},{key:"hide",value:function(){this.options.visibility=!1,this.amapContainer&&this.amapContainer.style&&(this.amapContainer.style.opacity=0)}},{key:"destroy",value:function(){this.removeMapEvent(),this.amap&&this.amap.clearMap&&this.amap.destroy&&(this.amap.clearMap(),this.amap.destroy(),this.currentControls&&c.getContainer().removeChild(this.currentControls),this.amapContainer.remove()),c._animatingZoom=!0,c._zoomAnimated=!0,c.options.zoomAnimation=!0,this.amapContainer=null,this.currentControls=null,this.amap=null,this.options=null}}])&&s(t.prototype,e),n&&s(t,n),Object.defineProperty(t,"prototype",{writable:!1}),i},t.exports});;
Cube("datav:/com/datav-2dmap-amap/3.0.21",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(t,e,o,n,r,i){function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function s(t,e){for(var o=0;o<e.length;o++){var n=e[o];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,n.key,n)}}function l(t,e){return(l=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function u(o){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=c(o),e=(t=n?(t=c(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(t){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var y=o("datav:/npm/eventemitter3/3.0.0"),p=o("datav:/npm/safely-merge/1.0.1"),f=o("datav:/com/datav-2dmap-amap/3.0.21/src/amapLayer.js"),h=o("datav:/com/datav-2dmap-amap/3.0.21/config").DEFAULT_OPTIONS,o=function(){var t=r,e=y;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&l(t,e);var o,n=u(r);function r(t,e){if(!(this instanceof r))throw new TypeError("Cannot call a class as a function");var o=n.call(this),e=e.options;return o.options=p(h,e),o.options.general.minZoom=e.general.zoomRange[0],o.options.general.maxZoom=e.general.zoomRange[1],o.options.visibility=!0,o}return t=r,(e=[{key:"addTo",value:function(t){t=f(t);this.layer=new t(this.options)}},{key:"updateOptions",value:function(t){t=t.options;this.options=p(this.options,t),this.options.general.minZoom=t.general.zoomRange[0],this.options.general.maxZoom=t.general.zoomRange[1],this.layer&&this.layer.updateOptions(this.options)}},{key:"setZIndex",value:function(t){this.layer&&this.layer.setZIndex&&this.layer.setZIndex(t)}},{key:"onZoomEnd",value:function(t){this.layer&&this.layer.onZoomEnd&&this.layer.onZoomEnd(t)}},{key:"resize",value:function(){this.layer&&this.layer.resize&&this.layer.resize()}},{key:"show",value:function(){this.options.visibility=!0,this.layer&&this.layer.show&&this.layer.show()}},{key:"hide",value:function(){this.options.visibility=!1,this.layer&&this.layer.hide&&this.layer.hide()}},{key:"destroy",value:function(){this.layer&&this.layer.destroy&&this.layer.destroy(),this.layer=null,this.options=null}}])&&s(t.prototype,e),o&&s(t,o),Object.defineProperty(t,"prototype",{writable:!1}),r}();return t.exports=o,t.exports});