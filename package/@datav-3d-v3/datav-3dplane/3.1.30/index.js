// env=undefined => env=publish 
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/flyingline_frag.glsl",[],function(n,e,a,l,t,o){return n.exports="#define GLSLIFY 1\nuniform vec3 color;\nuniform float opacity;\n\n#ifdef USE_MAP\n  uniform sampler2D map;\n  uniform sampler2D map1;\n#endif\n\n#ifdef USE_ALPHA_MAP\n  uniform sampler2D alphaMap;\n#endif\n\nuniform float visibility;\nuniform uint useDash;\nuniform float dashOffset0;\nuniform float dashOffset1;\n\nvarying float v_brightSegCount;\n\nuniform float alphaTest;\nuniform vec2 uvScale0;\n\nin vec2 vUv;\nflat in float lineAspect;\n// flat in float v_symbolCount;\n\nvarying vec2 v_normal;\nvarying vec4 v_lineColor;\nvarying float v_blurWidthRatio;\nvarying float v_lineType;\n\nvarying vec4 v_lineHeadColor;\nvarying float v_lineHeadSpaceRatio;\n\nvarying vec4 v_symbolColor;\nvarying vec3 v_symbolParams;\n\n// varying float v_lineTextureNum;\n\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n#include <fog_pars_fragment>\n\nvoid main() {\n  #include <clipping_planes_fragment>\n  #include <logdepthbuf_fragment>\n    vec4 c = v_lineColor;\n\n    bool useMap = false;\n\n    // for line  \n    vec2 uv0 = vUv * uvScale0;\n    uv0.x *= v_brightSegCount;\n    uv0.x -= dashOffset0;\n\n    uv0.y = (v_lineType - 1.0 + vUv.y) * 0.2;\n   \n    // antialiase\n    // reference from https://blog.mapbox.com/drawing-antialiased-lines-with-opengl-8766f34192dc\n    float blur = 1.0;\n    // float featherLen = length(v_normal) - (1.0 - v_blurWidthRatio);\n    // if (featherLen > 0.0) {\n    //   blur =  1.0 - featherLen / v_blurWidthRatio;\n    // }\n    // blur *= blur;\n\n    vec4 texture1 = vec4(0.0);\n\n    float symbolLen = 1.0;\n    \n    #ifdef USE_MAP\n      vec4 texture0 = texture2D(map, uv0); //线条纹理\n\n      //使得不同长度的飞线上符号运动速度一致\n      float segU = mod(uv0.x + dashOffset0 - dashOffset1, 1.0);\n\n      symbolLen = v_symbolParams.z * 100.0 / lineAspect * v_brightSegCount; //保持符号贴图的纵横比\n      \n      if (segU < symbolLen) {\n        segU = segU / symbolLen;\n\n        vec2 uv1 = vec2( segU, vUv.y);\n        uv1.y = (v_symbolParams.x * 100.0 - 1.0 + vUv.y) / (v_symbolParams.y * 100.0);\n       \n        // 对每个分段的首尾两端做模糊处理\n        float endBlurLen = 0.08; //首尾两端模糊长度\n        float endBlurFactor = 1.0;\n        if(segU < endBlurLen){\n          endBlurFactor = pow((segU / endBlurLen), 3.0);\n        }else if(segU > 1.0 - endBlurLen){\n          endBlurFactor = pow((1.0 - segU) / endBlurLen, 3.0);\n        }\n        texture1 = v_symbolColor * texture2D(map1, uv1) * endBlurFactor;\n      }\n\n      texture0 *= blur; //仅对线条纹理做边缘模糊\n      texture0 = mix(vec4(.0), texture0, texture0.a);\n      texture1 = mix(texture1, vec4(1.0), texture1);\n\n      c = c * texture0;\n      if (v_symbolColor.w > 0.0) {\n        c += texture1;\n      }\n    #endif\n\n    #ifdef USE_ALPHA_MAP\n      // c.a *= texture2D(alphaMap, vUv * repeat).a;\n      c.a *= texture2D(alphaMap, uv0).a;\n\n      texture1.a *= texture2D(alphaMap, uv0).a;\n    #endif\n\n    #include <alphatest_fragment>\n\n    if (c.a < alphaTest) discard;\n\n    // 高亮线处理\n    float dist = 1.0;\n    float blurRange = 0.1;\n\n    float _spaceRatio = v_lineHeadSpaceRatio + blurRange;\n    float localSegLen = mod(uv0.x + v_lineHeadSpaceRatio, 1.0);\n    float localSegRatio = localSegLen;\n\n    if (v_lineHeadSpaceRatio == 0.0) {\n      dist = 0.0;\n      gl_FragColor = c;\n    } else {\n      if (localSegRatio > _spaceRatio) {\n        dist = pow((localSegRatio - _spaceRatio) / (1.0 - _spaceRatio), 4.0 );\n      } else if (localSegRatio > v_lineHeadSpaceRatio) {\n        // 对高亮线段的头部做模糊处理\n        dist = pow((localSegRatio - v_lineHeadSpaceRatio) * blurRange, 4.0 );\n      }\n    }\n    dist = saturate(dist);\n    \n    if (v_lineHeadColor.w > 0.0) {\n      gl_FragColor = mix(c, v_lineHeadColor, dist);\n    } else {\n      gl_FragColor = c;\n    }\n\n    gl_FragColor.a *= blur;\n    \n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n    #include <premultiplied_alpha_fragment>\n\n}",n.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/flyingline_vert.glsl",[],function(e,n,t,i,r,o){return e.exports="#define GLSLIFY 1\nattribute vec3 previous;\nattribute vec3 next;\nattribute float side;\nattribute float len;\n// attribute float lineLength;\n// attribute float lineWidth;\n// attribute vec4 lineColor;\n// attribute vec4 lineHeadColor;\n// attribute vec4 symbolColor;\nattribute vec4 lineParams;\nattribute vec3 symbolParams;\n\nuniform float lineLengthMax;\nuniform float lineLength;\nuniform float lineWidth;\nuniform vec4 lineColor;\nuniform vec4 lineHeadColor;\nuniform vec4 symbolColor;\n\nuniform vec2 resolution;\nuniform float near;\nuniform float far;\nuniform uint sizeAttenuation;\nuniform float dashOffset0;\nuniform float drawScale;\n\nout vec2 vUv;\n\nvarying vec4 v_lineColor;\nvarying vec2 v_normal;\nvarying float v_lineType;\nflat out float lineAspect;\n// flat out float v_symbolCount;\nvarying float v_blurWidthRatio;\n\nvarying vec4 v_lineHeadColor;\nvarying float v_lineHeadSpaceRatio;\nvarying float v_brightSegCount;\n// varying float v_lineTextureNum;\n\nvarying vec4 v_symbolColor;\nvarying vec3 v_symbolParams;\n\nvec2 fix(vec4 i, float aspect) {\n  vec2 res = i.xy / i.w;\n  res.x *= aspect;\n  return res;\n}\n\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#include <fog_pars_vertex>\n\nvoid main() {\n  v_lineColor = lineColor;\n  v_lineHeadColor = lineHeadColor;\n  v_symbolColor = symbolColor;\n\n  v_lineType = lineParams.x * 100.0;\n  v_blurWidthRatio = lineParams.y;\n  v_lineHeadSpaceRatio = lineParams.z;\n\n  // v_lineTextureNum = lineParams.w * 100.0;\n\n  v_symbolParams = symbolParams;\n\n  float len_step = (lineLengthMax - lineLength) / 100.0 * 0.5;\n\n  v_brightSegCount = len * len_step / drawScale * 0.0000001;\n\n  vUv = uv;\n  // vPick = pick;\n  // vUnPick = pick;\n  float aspect = resolution.x / resolution.y;\n  float pixelWidthRatio = 1. / (resolution.x * projectionMatrix[0][0]);\n  vec2 aspectVec = vec2(aspect, 1.0);\n\n  lineAspect = len / lineWidth / aspect;\n\n  mat4 mvp = projectionMatrix * modelViewMatrix;\n  // into clip space\n  vec4 currentProjected = mvp * vec4(position, 1.);\n  vec4 previousProjected = mvp * vec4(previous, 1.);\n  vec4 nextProjected = mvp * vec4(next, 1.);\n\n  // into NDC space [-1,1] and correct for aspect ratio(screenWidth/screenHeight)\n  vec2 currentScreen = currentProjected.xy / currentProjected.w * aspectVec;\n  vec2 previousScreen = previousProjected.xy / previousProjected.w * aspectVec;\n  vec2 nextScreen = nextProjected.xy / nextProjected.w * aspectVec;\n   \n  float pixelWidth = sizeAttenuation == 1u ? 1.0 : currentProjected.w * pixelWidthRatio;\n  \n  float width = lineWidth;\n\n  #ifdef USE_MAP\n\n  #else\n    float dist = 1.0;\n    float localSegLen = mod(uv.x - dashOffset0, 1.0 / v_brightSegCount);\n    float localSegRatio = localSegLen * v_brightSegCount;\n\n    \n    float blurRange = 0.1; \n    float spaceRatio = v_lineHeadSpaceRatio + blurRange;\n    if (localSegRatio > spaceRatio) {\n      dist = (localSegRatio - spaceRatio) / (1.0 - spaceRatio);\n    } else if (localSegRatio > spaceRatio - blurRange) {\n      //对高亮线段的头部做模糊处理\n      dist = pow((spaceRatio - localSegRatio) / blurRange, 3.0 );\n    }\n    width = mix(lineWidth, lineWidth, saturate(dist));\n  #endif\n\n  width *= 1.8 * pixelWidth;\n\n  // into NDC space [-1,1] and correct for aspect ratio(screenWidth/screenHeight)\n  // vec2 currentP = fix(currentProjected, aspect);\n  // vec2 prevP = fix(previousProjected, aspect);\n  // vec2 nextP = fix(nextProjected, aspect);\n\n  vec2 dir = vec2(0.0);\n  if (nextScreen == currentScreen) //next == position\n    dir = normalize(currentScreen - previousScreen);\n  else if (previousScreen == currentScreen) //previous == position\n    dir = normalize(nextScreen - currentScreen);\n  else {\n    vec2 dir1 = normalize(currentScreen - previousScreen);\n    vec2 dir2 = normalize(nextScreen - currentScreen);\n    dir = normalize(dir1 + dir2);\n\n    // vec2 perp = vec2(-dir1.y, dir1.x);\n    // vec2 miter = vec2(-dir.y, dir.x);\n    // width = clamp( width / dot( miter, perp ), width, 1.5 * width);\n  }\n\n  v_normal = normalize( vec2(-dir.y / aspect, dir.x) * side); //for antialiase line\n\n  vec4 normalVec4 = vec4( -dir.y, dir.x, 0., 1. );\n  normalVec4.xy *= .5 * width;\n  normalVec4 *= projectionMatrix;\n  vec2 normal = normalVec4.xy;\n\n  vec4 offset = vec4(normal * side, 0., 0.);\n\n  gl_Position = currentProjected + offset;\n\n  vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n  // v_symbolCount = len;\n\n  #include <logdepthbuf_vertex>\n  #include <clipping_planes_vertex>\n  #include <fog_vertex>\n\n}\n",e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/src/shader/line_frag.glsl",[],function(n,e,a,l,t,o){return n.exports="#define GLSLIFY 1\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n#include <fog_pars_fragment>\n\nuniform vec3 color;\nuniform float opacity;\n\n#ifdef USE_MAP\n  uniform sampler2D map;\n  uniform sampler2D map1;\n#endif\n\n#ifdef USE_ALPHA_MAP\n  uniform sampler2D alphaMap;\n#endif\n\nuniform float visibility;\nuniform uint useDash;\nuniform float dashOffset0;\nuniform float dashOffset1;\n\nvarying float v_brightSegCount;\n\nuniform float alphaTest;\nuniform vec2 uvScale0;\nuniform float drawScale;\n\nin vec2 vUv;\n// flat in float lineAspect;\n// flat in float v_symbolCount;\n\nvarying vec2 v_normal;\nvarying vec4 v_lineColor;\nvarying float v_blurWidthRatio;\nvarying float v_lineType;\n\nvarying vec4 v_lineHeadColor;\nvarying float v_lineHeadSpaceRatio;\n\n// varying vec4 v_symbolColor;\n// varying vec3 v_symbolParams;\n\n// varying float v_lineTextureNum;\n\nvoid main() {\n  #include <clipping_planes_fragment>\n  #include <logdepthbuf_fragment>\n    vec4 c = v_lineColor;\n\n    bool useMap = false;\n\n    // for line  \n    vec2 uv0 = vUv * uvScale0;\n    uv0.x *= v_brightSegCount;\n    uv0.x -= dashOffset0;\n\n    uv0.y = (v_lineType - 1.0 + vUv.y) * 0.2;\n   \n    // antialiase\n    // reference from https://blog.mapbox.com/drawing-antialiased-lines-with-opengl-8766f34192dc\n    float blur = 1.0;\n    float featherLen = length(v_normal) - (1.0 - v_blurWidthRatio);\n    if (featherLen > 0.0) {\n      blur =  1.0 - featherLen / v_blurWidthRatio;\n    }\n    blur *= blur;\n\n    vec4 texture1 = vec4(0.0);\n\n    // float symbolLen = 1.0;\n    \n    // #ifdef USE_MAP\n    //   vec4 texture0 = texture2D(map, uv0); //线条纹理\n\n    //   //使得不同长度的飞线上符号运动速度一致\n    //   float segU = mod(uv0.x + dashOffset0 - dashOffset1, 1.0);\n\n    //   symbolLen = v_symbolParams.z * 100.0 / lineAspect * v_brightSegCount; //保持符号贴图的纵横比\n      \n    //   if (segU < symbolLen) {\n    //     segU = segU / symbolLen;\n\n    //     vec2 uv1 = vec2( segU, vUv.y);\n    //     uv1.y = (v_symbolParams.x * 100.0 - 1.0 + vUv.y) / (v_symbolParams.y * 100.0);\n       \n    //     // 对每个分段的首尾两端做模糊处理\n    //     float endBlurLen = 0.08; //首尾两端模糊长度\n    //     float endBlurFactor = 1.0;\n    //     if(segU < endBlurLen){\n    //       endBlurFactor = pow((segU / endBlurLen), 3.0);\n    //     }else if(segU > 1.0 - endBlurLen){\n    //       endBlurFactor = pow((1.0 - segU) / endBlurLen, 3.0);\n    //     }\n    //     texture1 = v_symbolColor * texture2D(map1, uv1) * endBlurFactor;\n    //   }\n\n    //   texture0 *= blur; //仅对线条纹理做边缘模糊\n    //   texture0 = mix(vec4(.0), texture0, texture0.a);\n    //   texture1 = mix(texture1, vec4(1.0), texture1);\n\n    //   c = c * texture0;\n    //   if (v_symbolColor.w > 0.0) {\n    //     c += texture1;\n    //   }\n    // #endif\n\n    #ifdef USE_ALPHA_MAP\n      // c.a *= texture2D(alphaMap, vUv * repeat).a;\n      c.a *= texture2D(alphaMap, uv0).a;\n\n      texture1.a *= texture2D(alphaMap, uv0).a;\n    #endif\n\n    #include <alphatest_fragment>\n\n    if (c.a < alphaTest) discard;\n\n    // 高亮线处理\n    float dist = 1.0;\n    float blurRange = 0.1;\n\n    float _spaceRatio = v_lineHeadSpaceRatio + blurRange;\n    float localSegLen = mod(uv0.x + v_lineHeadSpaceRatio, 1.0);\n    float localSegRatio = localSegLen;\n\n    if (v_lineHeadSpaceRatio == 0.0) {\n      dist = 0.0;\n      gl_FragColor = c;\n    } else {\n      if (localSegRatio > _spaceRatio) {\n        dist = pow((localSegRatio - _spaceRatio) / (1.0 - _spaceRatio), 4.0 );\n      } else if (localSegRatio > v_lineHeadSpaceRatio) {\n        // 对高亮线段的头部做模糊处理\n        dist = pow((localSegRatio - v_lineHeadSpaceRatio) * blurRange, 4.0 );\n      }\n    }\n    dist = saturate(dist);\n    \n    if (v_lineHeadColor.w > 0.0) {\n      gl_FragColor = mix(c, v_lineHeadColor, dist);\n    } else {\n      gl_FragColor = c;\n    }\n\n    gl_FragColor.a *= blur;\n    \n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n    #include <premultiplied_alpha_fragment>\n\n}",n.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/src/shader/line_vert.glsl",[],function(e,n,t,i,r,o){return e.exports="#define GLSLIFY 1\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#include <fog_pars_vertex>\n\nattribute vec3 previous;\nattribute vec3 next;\nattribute float side;\nattribute float len;\n// attribute float lineLength;\n// attribute float lineWidth;\n// attribute vec4 lineColor;\n// attribute vec4 lineHeadColor;\n// attribute vec4 symbolColor;\nattribute vec4 lineParams;\nattribute vec3 symbolParams;\n\nuniform float lineLengthMax;\nuniform float lineLength;\nuniform float lineWidth;\nuniform vec4 lineColor;\nuniform vec4 lineHeadColor;\nuniform vec4 symbolColor;\n\nuniform vec2 resolution;\nuniform float near;\nuniform float far;\nuniform uint sizeAttenuation;\nuniform float dashOffset0;\nuniform float drawScale;\n\nout vec2 vUv;\n\nvarying vec4 v_lineColor;\nvarying vec2 v_normal;\nvarying float v_lineType;\n// flat out float lineAspect;\n// flat out float v_symbolCount;\nvarying float v_blurWidthRatio;\n\nvarying vec4 v_lineHeadColor;\nvarying float v_lineHeadSpaceRatio;\nvarying float v_brightSegCount;\n// varying float v_lineTextureNum;\n\n// varying vec4 v_symbolColor;\n// varying vec3 v_symbolParams;\n\nvec2 fix(vec4 i, float aspect) {\n  vec2 res = i.xy / i.w;\n  res.x *= aspect;\n  return res;\n}\n\nvoid main() {\n  v_lineColor = lineColor;\n  v_lineHeadColor = lineHeadColor;\n  // v_symbolColor = symbolColor;\n\n  v_lineType = lineParams.x * 100.0;\n  v_blurWidthRatio = lineParams.y;\n  v_lineHeadSpaceRatio = lineParams.z;\n\n  // v_lineTextureNum = lineParams.w * 100.0;\n\n  // v_symbolParams = symbolParams;\n\n  float len_step = (lineLengthMax - lineLength) / 100.0 * 0.5;\n\n  v_brightSegCount = len * len_step / drawScale * 0.000001;\n\n  vUv = uv;\n  // vPick = pick;\n  // vUnPick = pick;\n  float aspect = resolution.x / resolution.y;\n  float pixelWidthRatio = 1. / (resolution.x * projectionMatrix[0][0]);\n  vec2 aspectVec = vec2(aspect, 1.0);\n\n  // lineAspect = len / lineWidth / aspect;\n\n  mat4 mvp = projectionMatrix * modelViewMatrix;\n  // into clip space\n  vec4 currentProjected = mvp * vec4(position, 1.);\n  vec4 previousProjected = mvp * vec4(previous, 1.);\n  vec4 nextProjected = mvp * vec4(next, 1.);\n\n  // into NDC space [-1,1] and correct for aspect ratio(screenWidth/screenHeight)\n  vec2 currentScreen = currentProjected.xy / currentProjected.w * aspectVec;\n  vec2 previousScreen = previousProjected.xy / previousProjected.w * aspectVec;\n  vec2 nextScreen = nextProjected.xy / nextProjected.w * aspectVec;\n   \n  float pixelWidth = sizeAttenuation == 1u ? 1.0 : currentProjected.w * pixelWidthRatio;\n  \n  float width = lineWidth;\n\n  #ifdef USE_MAP\n\n  #else\n    float dist = 1.0;\n    float localSegLen = mod(uv.x - dashOffset0, 1.0 / v_brightSegCount);\n    float localSegRatio = localSegLen * v_brightSegCount;\n\n    \n    float blurRange = 0.1; \n    float spaceRatio = v_lineHeadSpaceRatio + blurRange;\n    if (localSegRatio > spaceRatio) {\n      dist = (localSegRatio - spaceRatio) / (1.0 - spaceRatio);\n    } else if (localSegRatio > spaceRatio - blurRange) {\n      //对高亮线段的头部做模糊处理\n      dist = pow((spaceRatio - localSegRatio) / blurRange, 3.0 );\n    }\n    width = mix(lineWidth, lineWidth, saturate(dist));\n  #endif\n\n  width *= 1.8 * pixelWidth;\n\n  // into NDC space [-1,1] and correct for aspect ratio(screenWidth/screenHeight)\n  // vec2 currentP = fix(currentProjected, aspect);\n  // vec2 prevP = fix(previousProjected, aspect);\n  // vec2 nextP = fix(nextProjected, aspect);\n\n  vec2 dir = vec2(0.0);\n  if (nextScreen == currentScreen) //next == position\n    dir = normalize(currentScreen - previousScreen);\n  else if (previousScreen == currentScreen) //previous == position\n    dir = normalize(nextScreen - currentScreen);\n  else {\n    vec2 dir1 = normalize(currentScreen - previousScreen);\n    vec2 dir2 = normalize(nextScreen - currentScreen);\n    dir = normalize(dir1 + dir2);\n\n    // vec2 perp = vec2(-dir1.y, dir1.x);\n    // vec2 miter = vec2(-dir.y, dir.x);\n    // width = clamp( width / dot( miter, perp ), width, 1.5 * width);\n  }\n\n  v_normal = normalize( vec2(-dir.y / aspect, dir.x) * side); //for antialiase line\n\n  vec4 normalVec4 = vec4( -dir.y, dir.x, 0., 1. );\n  normalVec4.xy *= .5 * width;\n  normalVec4 *= projectionMatrix;\n  vec2 normal = normalVec4.xy;\n\n  vec4 offset = vec4(normal * side, 0., 0.);\n\n  gl_Position = currentProjected + offset;\n\n  vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n  // v_symbolCount = len;\n\n  #include <logdepthbuf_vertex>\n  #include <clipping_planes_vertex>\n  #include <fog_vertex>\n\n}\n",e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/water/src/shader/frag.glsl",[],function(e,n,o,r,i,a){return e.exports="#define GLSLIFY 1\nuniform sampler2D mirrorSampler;\nuniform float alpha;\nuniform vec2 uvTime;\nuniform float size;\nuniform float distortionScale;\nuniform sampler2D normalSampler;\nuniform vec3 sunColor;\nuniform vec3 sunDirection;\nuniform vec3 eye;\nuniform vec3 waterColor;\n\nvarying vec4 mirrorCoord;\nvarying vec4 worldPosition;\n\nvec4 getNoise( vec2 uv ) {\n    vec2 uv0 = ( uv / 103.0 ) + vec2(uvTime.x / 17.0, uvTime.y / 29.0);\n    vec2 uv1 = uv / 107.0 - vec2( uvTime.x / -19.0, uvTime.y / 31.0 );\n    vec2 uv2 = uv / vec2( 8907.0, 9803.0 ) + vec2( uvTime.x / 101.0, uvTime.y / 97.0 );\n    vec2 uv3 = uv / vec2( 1091.0, 1027.0 ) - vec2( uvTime.x / 109.0, uvTime.y / -113.0 );\n\n    vec4 noise = texture2D( normalSampler, uv0 ) +\n    texture2D( normalSampler, uv1 ) +\n    texture2D( normalSampler, uv2 ) +\n    texture2D( normalSampler, uv3 );\n    return noise * 0.5 - 1.0;\n}\n\nvoid sunLight( const vec3 surfaceNormal, const vec3 eyeDirection, float shiny, float spec, float diffuse, inout vec3 diffuseColor, inout vec3 specularColor ) {\n    vec3 reflection = normalize( reflect( -sunDirection, surfaceNormal ) );\n    float direction = max( 0.0, dot( eyeDirection, reflection ) );\n    specularColor += pow( direction, shiny ) * sunColor * spec;\n    diffuseColor += max( dot( sunDirection, surfaceNormal ), 0.0 ) * sunColor * diffuse;\n}\n\n#include <common>\n#include <packing>\n#include <bsdfs>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <lights_pars_begin>\n#include <shadowmap_pars_fragment>\n#include <shadowmask_pars_fragment>\n\nvoid main() {\n\n    #include <logdepthbuf_fragment>\n    vec4 noise = getNoise( worldPosition.xy * size );\n    vec3 surfaceNormal = normalize( noise.xzy * vec3( 1.5, 1.0, 1.5 ) );\n\n    vec3 diffuseLight = vec3(0.0);\n    vec3 specularLight = vec3(0.0);\n\n    vec3 worldToEye = eye - worldPosition.xyz;\n    vec3 eyeDirection = normalize( worldToEye );\n    sunLight( surfaceNormal, eyeDirection, 100.0, 2.0, 0.5, diffuseLight, specularLight );\n\n    float distance = length(worldToEye);\n\n    vec2 distortion = surfaceNormal.xy * ( 0.001 + 1.0 / distance ) * distortionScale;\n    vec3 reflectionSample = vec3( texture2D( mirrorSampler, mirrorCoord.xy / mirrorCoord.w + distortion ) );\n\n    float theta = max( dot( eyeDirection, surfaceNormal ), 0.0 );\n    float rf0 = 0.3;\n    float reflectance = rf0 + ( 1.0 - rf0 ) * pow( ( 1.0 - theta ), 5.0 );\n    vec3 scatter = max( 0.0, dot( surfaceNormal, eyeDirection ) ) * waterColor;\n    vec3 albedo = mix( ( sunColor * diffuseLight * 0.3 + scatter ) * getShadowMask(), ( vec3( 0.1 ) + reflectionSample * 0.9 + reflectionSample * specularLight ), reflectance);\n    vec3 outgoingLight = albedo;\n    gl_FragColor = vec4( outgoingLight, alpha );\n\n    #include <tonemapping_fragment>\n    #include <fog_fragment>\n}",e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/water/src/shader/vert.glsl",[],function(r,e,n,o,i,t){return r.exports="#define GLSLIFY 1\nuniform mat4 textureMatrix;\nuniform vec2 uvTime;\n\nvarying vec4 mirrorCoord;\nvarying vec4 worldPosition;\n\n#include <common>\n#include <fog_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n\nvoid main() {\n    mirrorCoord = modelMatrix * vec4( position, 1.0 );\n    worldPosition = mirrorCoord.xyzw;\n    mirrorCoord = textureMatrix * mirrorCoord;\n    vec4 mvPosition =  modelViewMatrix * vec4( position, 1.0 );\n    gl_Position = projectionMatrix * mvPosition;\n\n    #include <beginnormal_vertex>\n    #include <defaultnormal_vertex>\n    #include <logdepthbuf_vertex>\n    #include <fog_vertex>\n    #include <shadowmap_vertex>\n}",r.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/line_frag.glsl",[],function(n,e,a,l,t,o){return n.exports="#define GLSLIFY 1\nuniform vec3 color;\nuniform float opacity;\n\n#ifdef USE_MAP\n  uniform sampler2D map;\n  uniform sampler2D map1;\n#endif\n\n#ifdef USE_ALPHA_MAP\n  uniform sampler2D alphaMap;\n#endif\n\nuniform float visibility;\nuniform uint useDash;\nuniform float dashOffset0;\nuniform float dashOffset1;\n\nvarying float v_brightSegCount;\n\nuniform float alphaTest;\nuniform vec2 uvScale0;\n\nin vec2 vUv;\n// flat in float lineAspect;\n// flat in float v_symbolCount;\n\nvarying vec2 v_normal;\nvarying vec4 v_lineColor;\nvarying float v_blurWidthRatio;\nvarying float v_lineType;\n\nvarying vec4 v_lineHeadColor;\nvarying float v_lineHeadSpaceRatio;\n\n// varying vec4 v_symbolColor;\n// varying vec3 v_symbolParams;\n\n// varying float v_lineTextureNum;\n\n#include <common>\n#include <fog_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n  #include <clipping_planes_fragment>\n  #include <logdepthbuf_fragment>\n    vec4 c = v_lineColor;\n\n    bool useMap = false;\n\n    // for line  \n    vec2 uv0 = vUv * uvScale0;\n    uv0.x *= v_brightSegCount;\n    uv0.x -= dashOffset0;\n\n    uv0.y = (v_lineType - 1.0 + vUv.y) * 0.2;\n   \n    // antialiase\n    // reference from https://blog.mapbox.com/drawing-antialiased-lines-with-opengl-8766f34192dc\n    float blur = 1.0;\n    float featherLen = length(v_normal) - (1.0 - v_blurWidthRatio);\n    if (featherLen > 0.0) {\n      blur =  1.0 - featherLen / v_blurWidthRatio;\n    }\n    blur *= blur;\n\n    vec4 texture1 = vec4(0.0);\n\n    // float symbolLen = 1.0;\n    \n    // #ifdef USE_MAP\n    //   vec4 texture0 = texture2D(map, uv0); //线条纹理\n\n    //   //使得不同长度的飞线上符号运动速度一致\n    //   float segU = mod(uv0.x + dashOffset0 - dashOffset1, 1.0);\n\n    //   symbolLen = v_symbolParams.z * 100.0 / lineAspect * v_brightSegCount; //保持符号贴图的纵横比\n      \n    //   if (segU < symbolLen) {\n    //     segU = segU / symbolLen;\n\n    //     vec2 uv1 = vec2( segU, vUv.y);\n    //     uv1.y = (v_symbolParams.x * 100.0 - 1.0 + vUv.y) / (v_symbolParams.y * 100.0);\n       \n    //     // 对每个分段的首尾两端做模糊处理\n    //     float endBlurLen = 0.08; //首尾两端模糊长度\n    //     float endBlurFactor = 1.0;\n    //     if(segU < endBlurLen){\n    //       endBlurFactor = pow((segU / endBlurLen), 3.0);\n    //     }else if(segU > 1.0 - endBlurLen){\n    //       endBlurFactor = pow((1.0 - segU) / endBlurLen, 3.0);\n    //     }\n    //     texture1 = v_symbolColor * texture2D(map1, uv1) * endBlurFactor;\n    //   }\n\n    //   texture0 *= blur; //仅对线条纹理做边缘模糊\n    //   texture0 = mix(vec4(.0), texture0, texture0.a);\n    //   texture1 = mix(texture1, vec4(1.0), texture1);\n\n    //   c = c * texture0;\n    //   if (v_symbolColor.w > 0.0) {\n    //     c += texture1;\n    //   }\n    // #endif\n\n    #ifdef USE_ALPHA_MAP\n      // c.a *= texture2D(alphaMap, vUv * repeat).a;\n      c.a *= texture2D(alphaMap, uv0).a;\n\n      texture1.a *= texture2D(alphaMap, uv0).a;\n    #endif\n\n    #include <alphatest_fragment>\n\n    if (c.a < alphaTest) discard;\n\n    // 高亮线处理\n    float dist = 1.0;\n    float blurRange = 0.1;\n\n    float _spaceRatio = v_lineHeadSpaceRatio + blurRange;\n    float localSegLen = mod(uv0.x + v_lineHeadSpaceRatio, 1.0);\n    float localSegRatio = localSegLen;\n\n    if (v_lineHeadSpaceRatio == 0.0) {\n      dist = 0.0;\n      gl_FragColor = c;\n    } else {\n      if (localSegRatio > _spaceRatio) {\n        dist = pow((localSegRatio - _spaceRatio) / (1.0 - _spaceRatio), 4.0 );\n      } else if (localSegRatio > v_lineHeadSpaceRatio) {\n        // 对高亮线段的头部做模糊处理\n        dist = pow((localSegRatio - v_lineHeadSpaceRatio) * blurRange, 4.0 );\n      }\n    }\n    dist = saturate(dist);\n    \n    if (v_lineHeadColor.w > 0.0) {\n      gl_FragColor = mix(c, v_lineHeadColor, dist);\n    } else {\n      gl_FragColor = c;\n    }\n\n    gl_FragColor.a *= blur;\n    \n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n    #include <premultiplied_alpha_fragment>\n\n}",n.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/line_vert.glsl",[],function(e,n,t,i,r,o){return e.exports="#define GLSLIFY 1\nattribute vec3 previous;\nattribute vec3 next;\nattribute float side;\nattribute float len;\n// attribute float lineLength;\n// attribute float lineWidth;\n// attribute vec4 lineColor;\n// attribute vec4 lineHeadColor;\n// attribute vec4 symbolColor;\nattribute vec4 lineParams;\nattribute vec3 symbolParams;\n\nuniform float lineLengthMax;\nuniform float lineLength;\nuniform float lineWidth;\nuniform vec4 lineColor;\nuniform vec4 lineHeadColor;\nuniform vec4 symbolColor;\n\nuniform vec2 resolution;\nuniform float near;\nuniform float far;\nuniform uint sizeAttenuation;\nuniform float dashOffset0;\nuniform float drawScale;\n\nout vec2 vUv;\n\nvarying vec4 v_lineColor;\nvarying vec2 v_normal;\nvarying float v_lineType;\n// flat out float lineAspect;\n// flat out float v_symbolCount;\nvarying float v_blurWidthRatio;\n\nvarying vec4 v_lineHeadColor;\nvarying float v_lineHeadSpaceRatio;\nvarying float v_brightSegCount;\n// varying float v_lineTextureNum;\n\n// varying vec4 v_symbolColor;\n// varying vec3 v_symbolParams;\n\nvec2 fix(vec4 i, float aspect) {\n  vec2 res = i.xy / i.w;\n  res.x *= aspect;\n  return res;\n}\n\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#include <fog_pars_vertex>\n\nvoid main() {\n  v_lineColor = lineColor;\n  v_lineHeadColor = lineHeadColor;\n  // v_symbolColor = symbolColor;\n\n  v_lineType = lineParams.x * 100.0;\n  v_blurWidthRatio = lineParams.y;\n  v_lineHeadSpaceRatio = lineParams.z;\n\n  // v_lineTextureNum = lineParams.w * 100.0;\n\n  // v_symbolParams = symbolParams;\n\n  float len_step = (lineLengthMax - lineLength) / 100.0 * 0.5;\n\n  v_brightSegCount = len * len_step / drawScale * 0.0000001;\n\n  vUv = uv;\n  // vPick = pick;\n  // vUnPick = pick;\n  float aspect = resolution.x / resolution.y;\n  float pixelWidthRatio = 1. / (resolution.x * projectionMatrix[0][0]);\n  vec2 aspectVec = vec2(aspect, 1.0);\n\n  // lineAspect = len / lineWidth / aspect;\n\n  mat4 mvp = projectionMatrix * modelViewMatrix;\n  // into clip space\n  vec4 currentProjected = mvp * vec4(position, 1.);\n  vec4 previousProjected = mvp * vec4(previous, 1.);\n  vec4 nextProjected = mvp * vec4(next, 1.);\n\n  // into NDC space [-1,1] and correct for aspect ratio(screenWidth/screenHeight)\n  vec2 currentScreen = currentProjected.xy / currentProjected.w * aspectVec;\n  vec2 previousScreen = previousProjected.xy / previousProjected.w * aspectVec;\n  vec2 nextScreen = nextProjected.xy / nextProjected.w * aspectVec;\n   \n  float pixelWidth = sizeAttenuation == 1u ? 1.0 : currentProjected.w * pixelWidthRatio;\n  \n  float width = lineWidth;\n\n  #ifdef USE_MAP\n\n  #else\n    float dist = 1.0;\n    float localSegLen = mod(uv.x - dashOffset0, 1.0 / v_brightSegCount);\n    float localSegRatio = localSegLen * v_brightSegCount;\n\n    \n    float blurRange = 0.1; \n    float spaceRatio = v_lineHeadSpaceRatio + blurRange;\n    if (localSegRatio > spaceRatio) {\n      dist = (localSegRatio - spaceRatio) / (1.0 - spaceRatio);\n    } else if (localSegRatio > spaceRatio - blurRange) {\n      //对高亮线段的头部做模糊处理\n      dist = pow((spaceRatio - localSegRatio) / blurRange, 3.0 );\n    }\n    width = mix(lineWidth, lineWidth, saturate(dist));\n  #endif\n\n  width *= 1.8 * pixelWidth;\n\n  // into NDC space [-1,1] and correct for aspect ratio(screenWidth/screenHeight)\n  // vec2 currentP = fix(currentProjected, aspect);\n  // vec2 prevP = fix(previousProjected, aspect);\n  // vec2 nextP = fix(nextProjected, aspect);\n\n  vec2 dir = vec2(0.0);\n  if (nextScreen == currentScreen) //next == position\n    dir = normalize(currentScreen - previousScreen);\n  else if (previousScreen == currentScreen) //previous == position\n    dir = normalize(nextScreen - currentScreen);\n  else {\n    vec2 dir1 = normalize(currentScreen - previousScreen);\n    vec2 dir2 = normalize(nextScreen - currentScreen);\n    dir = normalize(dir1 + dir2);\n\n    // vec2 perp = vec2(-dir1.y, dir1.x);\n    // vec2 miter = vec2(-dir.y, dir.x);\n    // width = clamp( width / dot( miter, perp ), width, 1.5 * width);\n  }\n\n  v_normal = normalize( vec2(-dir.y / aspect, dir.x) * side); //for antialiase line\n\n  vec4 normalVec4 = vec4( -dir.y, dir.x, 0., 1. );\n  normalVec4.xy *= .5 * width;\n  normalVec4 *= projectionMatrix;\n  vec2 normal = normalVec4.xy;\n\n  vec4 offset = vec4(normal * side, 0., 0.);\n\n  gl_Position = currentProjected + offset;\n\n  vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n  // v_symbolCount = len;\n\n  #include <logdepthbuf_vertex>\n  #include <clipping_planes_vertex>\n  #include <fog_vertex>\n\n}\n",e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/config/lineStyle",[],function(e,t,c,p,a,n){return e.exports={"线型1":[{percent:0,opacity:1},{percent:1,opacity:1}],"线型2":[{percent:0,opacity:0},{percent:1,opacity:1}],"线型3":[{percent:0,opacity:.1},{percent:.25,opacity:1},{percent:.5,opacity:1},{percent:1,opacity:0}],"线型4":[{percent:0,opacity:.25},{percent:.1,opacity:1},{percent:.2,opacity:.25},{percent:.3,opacity:1},{percent:.4,opacity:.25},{percent:.5,opacity:1},{percent:.6,opacity:.25},{percent:.7,opacity:1},{percent:.8,opacity:.25},{percent:.9,opacity:1},{percent:1,opacity:.25}],"线型5":[{percent:0,opacity:1},{percent:.05,opacity:1},{percent:.05,opacity:0},{percent:.1,opacity:0},{percent:.1,opacity:1},{percent:.15,opacity:1},{percent:.15,opacity:0},{percent:.2,opacity:0},{percent:.2,opacity:1},{percent:.25,opacity:1},{percent:.25,opacity:0},{percent:.3,opacity:0},{percent:.3,opacity:1},{percent:.35,opacity:1},{percent:.35,opacity:0},{percent:.4,opacity:0},{percent:.4,opacity:1},{percent:.45,opacity:1},{percent:.45,opacity:0},{percent:.5,opacity:0},{percent:.5,opacity:1},{percent:.55,opacity:1},{percent:.55,opacity:0},{percent:.6,opacity:0},{percent:.6,opacity:1},{percent:.65,opacity:1},{percent:.65,opacity:0},{percent:.7,opacity:0},{percent:.7,opacity:1},{percent:.75,opacity:1},{percent:.75,opacity:0},{percent:.8,opacity:0},{percent:.8,opacity:1},{percent:.85,opacity:1},{percent:.85,opacity:0},{percent:.9,opacity:0},{percent:.9,opacity:1},{percent:.95,opacity:1},{percent:.95,opacity:0},{percent:1,opacity:0}]},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/libs/flyinglineMeshLine",[],function(e,t,i,r,n,s){function a(t,e){var i,r=Object.keys(t);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(t),e&&(i=i.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,i)),r}function o(r){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach(function(e){var t,i;t=r,i=n[e=e],e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(n,e))})}return r}function l(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var i=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(i="Object"===i&&e.constructor?e.constructor.name:i)||"Set"===i?Array.from(e):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?u(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var i=0,r=new Array(t);i<t;i++)r[i]=e[i];return r}function h(e,t,i){e*=6,t*=6;return i[e]===i[t]&&i[1+e]===i[1+t]&&i[2+e]===i[2+t]}function f(e,t){e*=6;return[t[e],t[1+e],t[2+e]]}return e.exports=function(C){function e(){this.positions=[],this.previous=[],this.next=[],this.side=[],this.width=[],this.indices=[],this.uvs=[],this.counters=[],this.lens=[],this.lineLengths=[],this.lineWidths=[],this.lineColor=[],this.lineHeadColor=[],this.symbolColor=[],this.lineParams=[],this.symbolParams=[],this.geometry=new C.BufferGeometry,this.widthCallback=null,this.matrixWorld=new C.Matrix4}var M,O,L;function s(e,t,i,r,n){var s;if(e=e.subarray||e.slice?e:e.buffer,i=i.subarray||i.slice?i:i.buffer,e=t?e.subarray?e.subarray(t,n&&t+n):e.slice(t,n&&t+n):e,i.set)i.set(e,r);else for(s=0;s<e.length;s++)i[s+r]=e[s]}return e.prototype.setMatrixWorld=function(e){this.matrixWorld=e},e.prototype.setGeometry=function(e,t,i){this.widthCallback=i,this.process(e,t)},e.prototype.raycast=(M=new C.Matrix4,O=new C.Ray,L=new C.Sphere,function(e,t){var i=e.linePrecision,r=i*i,i=this.geometry;if(null===i.boundingSphere&&i.computeBoundingSphere(),L.copy(i.boundingSphere),L.applyMatrix4(this.matrixWorld),!1!==e.ray.intersectSphere(L)){M.getInverse(this.matrixWorld),O.copy(e.ray).applyMatrix4(M);var n=new C.Vector3,s=new C.Vector3,a=new C.Vector3,o=new C.Vector3,u=this instanceof C.LineSegments?2:1;if(i instanceof C.BufferGeometry){var l=i.index,h=i.attributes;if(null!==l)for(var f=l.array,c=h.position.array,p=0,m=f.length-1;p<m;p+=u){var y=f[p],v=f[p+1];n.fromArray(c,3*y),s.fromArray(c,3*v),r<O.distanceSqToSegment(n,s,o,a)||(o.applyMatrix4(this.matrixWorld),(y=e.ray.origin.distanceTo(o))<e.near||y>e.far||t.push({distance:y,point:a.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this}))}else for(var b,d=h.position.array,g=0,w=d.length/3-1;g<w;g+=u)n.fromArray(d,3*g),s.fromArray(d,3*g+3),r<O.distanceSqToSegment(n,s,o,a)||(o.applyMatrix4(this.matrixWorld),(b=e.ray.origin.distanceTo(o))<e.near||b>e.far||t.push({distance:b,point:a.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}else if(i instanceof C.Geometry)for(var A,x=i.vertices,P=x.length,S=0;S<P-1;S+=u)r<O.distanceSqToSegment(x[S],x[S+1],o,a)||(o.applyMatrix4(this.matrixWorld),(A=e.ray.origin.distanceTo(o))<e.near||A>e.far||t.push({distance:A,point:a.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this}))}}),e.prototype.createGeometry=function(){var e=new C.BufferAttribute(new Float32Array(this.positions),3),t=new C.BufferAttribute(new Float32Array(this.previous),3),i=new C.BufferAttribute(new Float32Array(this.next),3),r=new C.BufferAttribute(new Float32Array(this.side),1),n=new C.BufferAttribute(new Float32Array(this.uvs),2),s=new C.BufferAttribute(new Uint32Array(this.indices),1),a=new C.BufferAttribute(new Float32Array(this.counters),1),o=new C.BufferAttribute(new Float32Array(this.lens),1),u=new C.BufferAttribute(new Float32Array(this.lineLengths),1),l=new C.BufferAttribute(new Float32Array(this.lineWidths),1),h=new C.BufferAttribute(new Float32Array(this.lineColor),4),f=new C.BufferAttribute(new Float32Array(this.lineHeadColor),4),c=new C.BufferAttribute(new Float32Array(this.symbolColor),4),p=new C.BufferAttribute(new Float32Array(this.lineParams),4),m=new C.BufferAttribute(new Float32Array(this.symbolParams),3);this.geometry.setAttribute("position",e),this.geometry.setAttribute("previous",t),this.geometry.setAttribute("next",i),this.geometry.setAttribute("side",r),this.geometry.setAttribute("uv",n),this.geometry.setAttribute("counters",a),this.geometry.setAttribute("len",o),this.geometry.setAttribute("lineLength",u),this.geometry.setAttribute("lineWidth",l),this.geometry.setAttribute("lineColor",h),this.geometry.setAttribute("lineHeadColor",f),this.geometry.setAttribute("symbolColor",c),this.geometry.setAttribute("lineParams",p),this.geometry.setAttribute("symbolParams",m),this.geometry.setIndex(s)},e.prototype.clear=function(){this.positions.length=0,this.previous.length=0,this.next.length=0,this.side.length=0,this.width.length=0,this.indices.length=0,this.uvs.length=0,this.counters.length=0,this.lens.length=0,this.lineLengths.length=0,this.lineWidths.length=0,this.lineColor.length=0,this.lineHeadColor.length=0,this.symbolColor.length=0,this.lineParams.length=0,this.symbolParams.length=0},e.prototype._processPosition=function(e){for(var t,i,r=0,n=e.length/6;r<n;r++)this.counters.push(i=r/(n-1)),this.counters.push(i);(t=this.positions).push.apply(t,l(e));var s=e.length/6,a=h(0,s-1,e)?f(s-2,e):f(0,e);this.previous.push(a[0],a[1],a[2]),this.previous.push(a[0],a[1],a[2]);for(var o=0;o<s-1;o++)a=f(o,e),this.previous.push(a[0],a[1],a[2]),this.previous.push(a[0],a[1],a[2]);for(var u=1;u<s;u++)a=f(u,e),this.next.push(a[0],a[1],a[2]),this.next.push(a[0],a[1],a[2]);a=h(s-1,0,e)?f(1,e):f(s-1,e),this.next.push(a[0],a[1],a[2]),this.next.push(a[0],a[1],a[2])},e.prototype._processIndex=function(e){for(var t=this.positions.length/3,i=e.length/6,r=0;r<i-1;r++){var n=2*r+t;this.indices.push(n,1+n,2+n),this.indices.push(2+n,1+n,3+n)}},e.prototype._processUV=function(e,t){if(2<arguments.length&&void 0!==arguments[2]&&arguments[2]){this.uvs.push(0,0),this.uvs.push(0,1);for(var i,r,n=0,s=6,a=e.length;s<a;s+=6)i=[e[s-6],e[s-6+1],e[s-6+2]],r=[e[s],e[s+1],e[s+2]],n+=Math.sqrt(Math.pow(r[0]-i[0],2)+Math.pow(r[1]-i[1],2)+Math.pow(r[2]-i[2],2)),this.uvs.push(r=n/t,0),this.uvs.push(r,1)}else for(var o=e.length/6,u=0;u<o;u++)this.uvs.push(u/(o-1),0),this.uvs.push(u/(o-1),1)},e.prototype._processSide=function(e){for(var t=e.length/6,i=0;i<t;i++)this.side.push(1),this.side.push(-1)},e.prototype.process=function(e,t){for(var i=t.curveLen,r=t.isGeoUv,n=(t.lineColor,t.lineHeadColor,t.symbolColor,t.lineLength,t.lineWidth,t.lineParams),s=t.symbolParams,a=(this._processIndex(e),this._processSide(e),this._processUV(e,i,r),this._processPosition(e),e.length/6),o=0;o<a;o++)this.lens.push(i),this.lens.push(i),this.lineParams.push(n.lineType),this.lineParams.push(n.blurWidthRatio),this.lineParams.push(n.lineHeadSpaceRatio),this.lineParams.push(n.lineTextureNum),this.lineParams.push(n.lineType),this.lineParams.push(n.blurWidthRatio),this.lineParams.push(n.lineHeadSpaceRatio),this.lineParams.push(n.lineTextureNum),this.symbolParams.push(s.symbolType),this.symbolParams.push(s.symbolNum),this.symbolParams.push(s.symbolAspect),this.symbolParams.push(s.symbolType),this.symbolParams.push(s.symbolNum),this.symbolParams.push(s.symbolAspect)},e.prototype.advance=function(e){var t=this.attributes.position.array,i=this.attributes.previous.array,r=this.attributes.next.array,n=t.length;s(t,0,i,0,n),s(t,6,t,0,n-6),t[n-6]=e.x,t[n-5]=e.y,t[n-4]=e.z,t[n-3]=e.x,t[n-2]=e.y,t[n-1]=e.z,s(t,6,r,0,n-6),r[n-6]=e.x,r[n-5]=e.y,r[n-4]=e.z,r[n-3]=e.x,r[n-2]=e.y,r[n-1]=e.z,this.attributes.position.needsUpdate=!0,this.attributes.previous.needsUpdate=!0,this.attributes.next.needsUpdate=!0},{MeshLine:e,MeshLineMaterial:function(e){var t=new C.ShaderMaterial({depthWrite:!0,depthTest:!0,transparent:!0,side:C.DoubleSide});return t.type="MeshLineMaterial",t.uniforms=o({drawScale:{value:1},opacity:{value:1},lineLengthMax:{value:110},lineLength:{value:60},lineWidth:{value:5},lineColor:{value:new C.Vector4},lineHeadColor:{value:new C.Vector4},symbolColor:{value:new C.Vector4},map:{value:null},map1:{value:null},alphaMap:{value:null},resolution:{value:new C.Vector2(1,1)},sizeAttenuation:{value:1},near:{value:1},far:{value:1},visibility:{value:1},dashOffset0:{value:0},dashOffset1:{value:0},useDash:{value:0},alphaTest:{value:0},repeat:{value:new C.Vector2(1,1)},uvScale0:{value:new C.Vector2(1,1)}},C.UniformsLib.fog),t.vertexShader=i("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/flyingline_vert.glsl"),t.fragmentShader=i("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/flyingline_frag.glsl"),Object.defineProperties(t,{drawScale:{enumerable:!0,get:function(){return this.uniforms.drawScale.value},set:function(e){this.uniforms.drawScale.value=e}},lineLengthMax:{enumerable:!0,get:function(){return this.uniforms.lineLengthMax.value},set:function(e){this.uniforms.lineLengthMax.value=e}},lineLength:{enumerable:!0,get:function(){return this.uniforms.lineLength.value},set:function(e){this.uniforms.lineLength.value=e}},lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(e){this.uniforms.lineWidth.value=e}},lineColor:{enumerable:!0,get:function(){return this.uniforms.lineColor.value},set:function(e){this.uniforms.lineColor.value=e}},lineHeadColor:{enumerable:!0,get:function(){return this.uniforms.lineHeadColor.value},set:function(e){this.uniforms.lineHeadColor.value=e}},symbolColor:{enumerable:!0,get:function(){return this.uniforms.symbolColor.value},set:function(e){this.uniforms.symbolColor.value=e}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(e){this.uniforms.map.value=e}},map1:{enumerable:!0,get:function(){return this.uniforms.map1.value},set:function(e){this.uniforms.map1.value=e}},alphaMap:{enumerable:!0,get:function(){return this.uniforms.alphaMap.value},set:function(e){this.uniforms.alphaMap.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value=e}},sizeAttenuation:{enumerable:!0,get:function(){return this.uniforms.sizeAttenuation.value},set:function(e){this.uniforms.sizeAttenuation.value=e}},near:{enumerable:!0,get:function(){return this.uniforms.near.value},set:function(e){this.uniforms.near.value=e}},far:{enumerable:!0,get:function(){return this.uniforms.far.value},set:function(e){this.uniforms.far.value=e}},visibility:{enumerable:!0,get:function(){return this.uniforms.visibility.value},set:function(e){this.uniforms.visibility.value=e}},dashOffset0:{enumerable:!0,get:function(){return this.uniforms.dashOffset0.value},set:function(e){this.uniforms.dashOffset0.value=e}},dashOffset1:{enumerable:!0,get:function(){return this.uniforms.dashOffset1.value},set:function(e){this.uniforms.dashOffset1.value=e}},useDash:{enumerable:!0,get:function(){return this.uniforms.useDash.value},set:function(e){this.uniforms.useDash.value=e}},alphaTest:{enumerable:!0,get:function(){return this.uniforms.alphaTest.value},set:function(e){this.uniforms.alphaTest.value=e}},repeat:{enumerable:!0,get:function(){return this.uniforms.repeat.value},set:function(e){this.uniforms.repeat.value=e}},uvScale0:{enumerable:!0,get:function(){return this.uniforms.uvScale0.value},set:function(e){this.uniforms.uvScale0.value=e}}}),t.setValues(e),t}}},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/sideLight_frag.glsl",[],function(n,e,t,i,a,r){return n.exports="precision mediump float;\n#define GLSLIFY 1\n\n#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\nuniform float emissiveIntensity;\nuniform vec2 uvOffset;\nuniform float drawScale;\n\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\n// varying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n// #include <dithering_pars_fragment>\n// #include <color_pars_fragment>\n#include <uv_pars_fragment>\n// #include <uv2_pars_fragment>\n#include <map_pars_fragment>\n// #include <alphamap_pars_fragment>\n// #include <aomap_pars_fragment>\n// #include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n// #include <bsdfs>\n// #include <cube_uv_reflection_fragment>\n// #include <envmap_common_pars_fragment>\n// #include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n// #include <lights_pars_begin>\n// #include <lights_physical_pars_fragment>\n// #include <shadowmap_pars_fragment>\n// #include <bumpmap_pars_fragment>\n// #include <normalmap_pars_fragment>\n// #include <clearcoat_pars_fragment>\n// #include <roughnessmap_pars_fragment>\n// #include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\t\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n \tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n \tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_MAP\n\t\tvec2 _v = vUv;\n\t\t_v.x *= 1e-7 / drawScale;\n\t\tvec4 texelColor = texture2D( map, _v );\n\t\t// texelColor = mapTexelToLinear( texelColor );\n\t\tdiffuseColor *= texelColor;\n\t#endif\n\t// #include <color_fragment>\n\t// #include <alphamap_fragment>\n\t// #include <alphatest_fragment>\n\t// #include <roughnessmap_fragment>\n\t// #include <metalnessmap_fragment>\n\t// #include <normal_fragment_begin>\n\t// #include <normal_fragment_maps>\n\t// #include <clearcoat_normal_fragment_begin>\n\t// #include <clearcoat_normal_fragment_maps>\n\n\t#ifdef USE_EMISSIVEMAP\n\t\tvec2 _vUv, _vUv2;\n\t\t_vUv = vUv;\n\t\t_vUv.x *= 1e-7 / drawScale;\n\t\t_vUv2.x = _vUv.x + uvOffset.x;\n\t\t_vUv2.y = _vUv.y + uvOffset.y;\n\t\t\n\t\tvec4 emissiveColor = texture2D( emissiveMap, _vUv2 );\n\t\t// emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\t\ttotalEmissiveRadiance *= emissiveColor.rgb * emissiveIntensity;\n\t#endif\n\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\n\t// accumulation\n\t// #include <lights_physical_fragment>\n\t// #include <lights_fragment_begin>\n\t// #include <lights_fragment_maps>\n\t// #include <lights_fragment_end>\n\n\t// modulation\n\t// #include <aomap_fragment>\n\n\t// vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\t// vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\n\t// this is a stub for the transmission model\n\t// #ifdef TRANSMISSION\n\t// \tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t// #endif\n\n\t// vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\n\tvec3 outgoingLight = diffuseColor.rgb + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",n.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/sideLight_vert.glsl",[],function(e,n,t,r,i,d){return e.exports="#define GLSLIFY 1\n// #define PHYSICAL\n\n// varying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t// vViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/side_frag.glsl",[],function(n,e,t,i,a,r){return n.exports="precision mediump float;\n#define GLSLIFY 1\n\n#define STANDARD\n\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n\t#define TRANSMISSION\n#endif\n\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\nuniform float emissiveIntensity;\nuniform vec2 uvOffset;\nuniform float drawScale;\n\n#ifdef TRANSMISSION\n\tuniform float transmission;\n#endif\n\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\n// varying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n\t#ifdef USE_TANGENT\n\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\n\t#endif\n\n#endif\n\n#include <common>\n#include <packing>\n// #include <dithering_pars_fragment>\n// #include <color_pars_fragment>\n#include <uv_pars_fragment>\n// #include <uv2_pars_fragment>\n#include <map_pars_fragment>\n// #include <alphamap_pars_fragment>\n// #include <aomap_pars_fragment>\n// #include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n// #include <bsdfs>\n// #include <cube_uv_reflection_fragment>\n// #include <envmap_common_pars_fragment>\n// #include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n// #include <lights_pars_begin>\n// #include <lights_physical_pars_fragment>\n// #include <shadowmap_pars_fragment>\n// #include <bumpmap_pars_fragment>\n// #include <normalmap_pars_fragment>\n// #include <clearcoat_pars_fragment>\n// #include <roughnessmap_pars_fragment>\n// #include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n\t\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n \tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n \tvec3 totalEmissiveRadiance = emissive;\n\n\t#include <logdepthbuf_fragment>\n\t#ifdef USE_MAP\n\t\tvec2 _v = vUv;\n\t\t_v.x *= 1e-7 / drawScale;\n\t\tvec4 texelColor = texture2D( map, _v );\n\t\t// texelColor = mapTexelToLinear( texelColor );\n\t\tdiffuseColor *= texelColor;\n\t#endif\n\t// #include <color_fragment>\n\t// #include <alphamap_fragment>\n\t// #include <alphatest_fragment>\n\t// #include <roughnessmap_fragment>\n\t// #include <metalnessmap_fragment>\n\t// #include <normal_fragment_begin>\n\t// #include <normal_fragment_maps>\n\t// #include <clearcoat_normal_fragment_begin>\n\t// #include <clearcoat_normal_fragment_maps>\n\n\t#ifdef USE_EMISSIVEMAP\n\t\tvec2 _vUv, _vUv2;\n\t\t_vUv = vUv;\n\t\t_vUv.x *= 1e-7 / drawScale;\n\t\t_vUv2.x = _vUv.x + uvOffset.x;\n\t\t_vUv2.y = _vUv.y + uvOffset.y;\n\t\t\n\t\tvec4 emissiveColor = texture2D( emissiveMap, _vUv2 );\n\t\t// emissiveColor.rgb = emissiveMapTexelToLinear( emissiveColor ).rgb;\n\t\ttotalEmissiveRadiance *= emissiveColor.rgb * emissiveIntensity;\n\t#endif\n\n\t#ifdef TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t#endif\n\n\t// accumulation\n\t// #include <lights_physical_fragment>\n\t// #include <lights_fragment_begin>\n\t// #include <lights_fragment_maps>\n\t// #include <lights_fragment_end>\n\n\t// modulation\n\t// #include <aomap_fragment>\n\n\t// vec3 totalDiffuse = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse;\n\t// vec3 totalSpecular = reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\n\t// this is a stub for the transmission model\n\t// #ifdef TRANSMISSION\n\t// \tdiffuseColor.a *= saturate( 1. - totalTransmission + linearToRelativeLuminance( reflectedLight.directSpecular + reflectedLight.indirectSpecular ) );\n\t// #endif\n\n\t// vec3 outgoingLight = totalDiffuse + totalSpecular + totalEmissiveRadiance;\n\n\tvec3 outgoingLight = diffuseColor.rgb + totalEmissiveRadiance;\n\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n\n}\n",n.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/side_vert.glsl",[],function(e,n,t,r,i,d){return e.exports="#define GLSLIFY 1\n// #define PHYSICAL\n\n// varying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\n\tvarying vec3 vNormal;\n\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nvoid main() {\n\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED // Normal computed with derivatives when FLAT_SHADED\n\n\tvNormal = normalize( transformedNormal );\n\n#endif\n\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\n\t// vViewPosition = - mvPosition.xyz;\n\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n\n}\n",e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/meshTop_frag.glsl",[],function(n,e,t,a,i,r){return n.exports="#define GLSLIFY 1\n#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform vec3 attenuationColor;\n\tuniform float attenuationDistance;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <transmission_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef USE_TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t\tfloat thicknessFactor = thickness;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\tvec3 rawDiffuseColor = diffuseColor.rgb;\n\t#include <transmission_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\tvec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",n.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/meshTop_vert.glsl",[],function(n,e,t,i,r,a){return n.exports="#define GLSLIFY 1\n#define STANDARD  \t\t\t\t//定义PBR材质的宏\nvarying vec3 vViewPosition;     //相机空间顶点位置\n#ifndef FLAT_SHADED    \t\t\t//flat着色\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#ifdef USE_TRANSMISSION\n\tvarying vec4 vWorldPosition;\n#endif\n#include <common>\t//着色器公用常量和函数（例如常量π，函数pow2）\n#include <uv_pars_vertex> //UV顶点处理的变量声明（处理漫反射纹理、凹凸纹理、法线纹理等）\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n    #ifndef FLAT_SHADED\n        vNormal = normalize( transformedNormal );\n        #ifdef USE_TANGENT\n            vTangent = normalize( transformedTangent );\n            vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n        #endif\n    #endif\n\t#include <begin_vertex>\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n    #ifdef USE_TRANSMISSION\n        vWorldPosition = worldPosition;\n    #endif\n}",n.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/libs/meshLine",[],function(e,t,r,i,n,s){function a(t,e){var r,i=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)),i}function o(i){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach(function(e){var t,r;t=i,r=n[e=e],e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(n,e))})}return i}function l(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function h(e,t,r){e*=6,t*=6;return r[e]===r[t]&&r[1+e]===r[1+t]&&r[2+e]===r[2+t]}function f(e,t){e*=6;return[t[e],t[1+e],t[2+e]]}return e.exports=function(C){function e(){this.positions=[],this.previous=[],this.next=[],this.side=[],this.width=[],this.indices=[],this.uvs=[],this.counters=[],this.lens=[],this.lineLengths=[],this.lineWidths=[],this.lineColor=[],this.lineHeadColor=[],this.symbolColor=[],this.lineParams=[],this.symbolParams=[],this.geometry=new C.BufferGeometry,this.widthCallback=null,this.matrixWorld=new C.Matrix4}var M,O,L;function s(e,t,r,i,n){var s;if(e=e.subarray||e.slice?e:e.buffer,r=r.subarray||r.slice?r:r.buffer,e=t?e.subarray?e.subarray(t,n&&t+n):e.slice(t,n&&t+n):e,r.set)r.set(e,i);else for(s=0;s<e.length;s++)r[s+i]=e[s]}return((e.prototype=Object.create(C.Mesh.prototype)).constructor=e).prototype.setMatrixWorld=function(e){this.matrixWorld=e},e.prototype.setGeometry=function(e,t,r){this.widthCallback=r,this.process(e,t)},e.prototype.raycast=(M=new C.Matrix4,O=new C.Ray,L=new C.Sphere,function(e,t){var r=e.linePrecision,i=r*r,r=this.geometry;if(null===r.boundingSphere&&r.computeBoundingSphere(),L.copy(r.boundingSphere),L.applyMatrix4(this.matrixWorld),!1!==e.ray.intersectSphere(L)){M.getInverse(this.matrixWorld),O.copy(e.ray).applyMatrix4(M);var n=new C.Vector3,s=new C.Vector3,a=new C.Vector3,o=new C.Vector3,u=this instanceof C.LineSegments?2:1;if(r instanceof C.BufferGeometry){var l=r.index,h=r.attributes;if(null!==l)for(var f=l.array,c=h.position.array,p=0,m=f.length-1;p<m;p+=u){var y=f[p],v=f[p+1];n.fromArray(c,3*y),s.fromArray(c,3*v),i<O.distanceSqToSegment(n,s,o,a)||(o.applyMatrix4(this.matrixWorld),(y=e.ray.origin.distanceTo(o))<e.near||y>e.far||t.push({distance:y,point:a.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this}))}else for(var b,d=h.position.array,g=0,w=d.length/3-1;g<w;g+=u)n.fromArray(d,3*g),s.fromArray(d,3*g+3),i<O.distanceSqToSegment(n,s,o,a)||(o.applyMatrix4(this.matrixWorld),(b=e.ray.origin.distanceTo(o))<e.near||b>e.far||t.push({distance:b,point:a.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}else if(r instanceof C.Geometry)for(var A,x=r.vertices,P=x.length,S=0;S<P-1;S+=u)i<O.distanceSqToSegment(x[S],x[S+1],o,a)||(o.applyMatrix4(this.matrixWorld),(A=e.ray.origin.distanceTo(o))<e.near||A>e.far||t.push({distance:A,point:a.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this}))}}),e.prototype.createGeometry=function(){var e=new C.BufferAttribute(new Float32Array(this.positions),3),t=new C.BufferAttribute(new Float32Array(this.previous),3),r=new C.BufferAttribute(new Float32Array(this.next),3),i=new C.BufferAttribute(new Float32Array(this.side),1),n=new C.BufferAttribute(new Float32Array(this.uvs),2),s=new C.BufferAttribute(new Uint32Array(this.indices),1),a=new C.BufferAttribute(new Float32Array(this.counters),1),o=new C.BufferAttribute(new Float32Array(this.lens),1),u=new C.BufferAttribute(new Float32Array(this.lineLengths),1),l=new C.BufferAttribute(new Float32Array(this.lineWidths),1),h=new C.BufferAttribute(new Float32Array(this.lineColor),4),f=new C.BufferAttribute(new Float32Array(this.lineHeadColor),4),c=new C.BufferAttribute(new Float32Array(this.symbolColor),4),p=new C.BufferAttribute(new Float32Array(this.lineParams),4),m=new C.BufferAttribute(new Float32Array(this.symbolParams),3);this.geometry.setAttribute("position",e),this.geometry.setAttribute("previous",t),this.geometry.setAttribute("next",r),this.geometry.setAttribute("side",i),this.geometry.setAttribute("uv",n),this.geometry.setAttribute("counters",a),this.geometry.setAttribute("len",o),this.geometry.setAttribute("lineLength",u),this.geometry.setAttribute("lineWidth",l),this.geometry.setAttribute("lineColor",h),this.geometry.setAttribute("lineHeadColor",f),this.geometry.setAttribute("symbolColor",c),this.geometry.setAttribute("lineParams",p),this.geometry.setAttribute("symbolParams",m),this.geometry.setIndex(s)},e.prototype.clear=function(){this.positions.length=0,this.previous.length=0,this.next.length=0,this.side.length=0,this.width.length=0,this.indices.length=0,this.uvs.length=0,this.counters.length=0,this.lens.length=0,this.lineLengths.length=0,this.lineWidths.length=0,this.lineColor.length=0,this.lineHeadColor.length=0,this.symbolColor.length=0,this.lineParams.length=0,this.symbolParams.length=0},e.prototype._processPosition=function(e){for(var t,r,i=0,n=e.length/6;i<n;i++)this.counters.push(r=i/(n-1)),this.counters.push(r);(t=this.positions).push.apply(t,l(e));var s=e.length/6,a=h(0,s-1,e)?f(s-2,e):f(0,e);this.previous.push(a[0],a[1],a[2]),this.previous.push(a[0],a[1],a[2]);for(var o=0;o<s-1;o++)a=f(o,e),this.previous.push(a[0],a[1],a[2]),this.previous.push(a[0],a[1],a[2]);for(var u=1;u<s;u++)a=f(u,e),this.next.push(a[0],a[1],a[2]),this.next.push(a[0],a[1],a[2]);a=h(s-1,0,e)?f(1,e):f(s-1,e),this.next.push(a[0],a[1],a[2]),this.next.push(a[0],a[1],a[2])},e.prototype._processIndex=function(e){for(var t=this.positions.length/3,r=e.length/6,i=0;i<r-1;i++){var n=2*i+t;this.indices.push(n,1+n,2+n),this.indices.push(2+n,1+n,3+n)}},e.prototype._processUV=function(e,t){if(2<arguments.length&&void 0!==arguments[2]&&arguments[2]){this.uvs.push(0,0),this.uvs.push(0,1);for(var r,i,n=0,s=6,a=e.length;s<a;s+=6)r=[e[s-6],e[s-6+1],e[s-6+2]],i=[e[s],e[s+1],e[s+2]],n+=Math.sqrt(Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2)+Math.pow(i[2]-r[2],2)),this.uvs.push(i=n/t,0),this.uvs.push(i,1)}else for(var o=e.length/6,u=0;u<o;u++)this.uvs.push(u/(o-1),0),this.uvs.push(u/(o-1),1)},e.prototype._processSide=function(e){for(var t=e.length/6,r=0;r<t;r++)this.side.push(1),this.side.push(-1)},e.prototype.process=function(e,t){for(var r=t.curveLen,i=t.isGeoUv,n=(t.lineColor,t.lineHeadColor,t.symbolColor,t.lineLength,t.lineWidth,t.lineParams),s=t.symbolParams,a=(this._processIndex(e),this._processSide(e),this._processUV(e,r,i),this._processPosition(e),e.length/6),o=0;o<a;o++)this.lens.push(r),this.lens.push(r),this.lineParams.push(n.lineType),this.lineParams.push(n.blurWidthRatio),this.lineParams.push(n.lineHeadSpaceRatio),this.lineParams.push(n.lineTextureNum),this.lineParams.push(n.lineType),this.lineParams.push(n.blurWidthRatio),this.lineParams.push(n.lineHeadSpaceRatio),this.lineParams.push(n.lineTextureNum),this.symbolParams.push(s.symbolType),this.symbolParams.push(s.symbolNum),this.symbolParams.push(s.symbolAspect),this.symbolParams.push(s.symbolType),this.symbolParams.push(s.symbolNum),this.symbolParams.push(s.symbolAspect)},e.prototype.advance=function(e){var t=this.attributes.position.array,r=this.attributes.previous.array,i=this.attributes.next.array,n=t.length;s(t,0,r,0,n),s(t,6,t,0,n-6),t[n-6]=e.x,t[n-5]=e.y,t[n-4]=e.z,t[n-3]=e.x,t[n-2]=e.y,t[n-1]=e.z,s(t,6,i,0,n-6),i[n-6]=e.x,i[n-5]=e.y,i[n-4]=e.z,i[n-3]=e.x,i[n-2]=e.y,i[n-1]=e.z,this.attributes.position.needsUpdate=!0,this.attributes.previous.needsUpdate=!0,this.attributes.next.needsUpdate=!0},{MeshLine:e,MeshLineMaterial:function(e){var t=new C.ShaderMaterial({depthWrite:!0,depthTest:!0,transparent:!0,side:C.DoubleSide});return t.type="MeshLineMaterial",t.uniforms=o({drawScale:{value:1},opacity:{value:1},lineLengthMax:{value:110},lineLength:{value:60},lineWidth:{value:5},lineColor:{value:new C.Vector4},lineHeadColor:{value:new C.Vector4},symbolColor:{value:new C.Vector4},map:{value:null},map1:{value:null},alphaMap:{value:null},resolution:{value:new C.Vector2(1,1)},sizeAttenuation:{value:1},near:{value:1},far:{value:1},visibility:{value:1},dashOffset0:{value:0},dashOffset1:{value:0},useDash:{value:0},alphaTest:{value:0},repeat:{value:new C.Vector2(1,1)},uvScale0:{value:new C.Vector2(1,1)}},C.UniformsLib.fog),t.vertexShader=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/line_vert.glsl"),t.fragmentShader=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/line_frag.glsl"),Object.defineProperties(t,{drawScale:{enumerable:!0,get:function(){return this.uniforms.drawScale.value},set:function(e){this.uniforms.drawScale.value=e}},lineLengthMax:{enumerable:!0,get:function(){return this.uniforms.lineLengthMax.value},set:function(e){this.uniforms.lineLengthMax.value=e}},lineLength:{enumerable:!0,get:function(){return this.uniforms.lineLength.value},set:function(e){this.uniforms.lineLength.value=e}},lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(e){this.uniforms.lineWidth.value=e}},lineColor:{enumerable:!0,get:function(){return this.uniforms.lineColor.value},set:function(e){this.uniforms.lineColor.value=e}},lineHeadColor:{enumerable:!0,get:function(){return this.uniforms.lineHeadColor.value},set:function(e){this.uniforms.lineHeadColor.value=e}},symbolColor:{enumerable:!0,get:function(){return this.uniforms.symbolColor.value},set:function(e){this.uniforms.symbolColor.value=e}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(e){this.uniforms.map.value=e}},map1:{enumerable:!0,get:function(){return this.uniforms.map1.value},set:function(e){this.uniforms.map1.value=e}},alphaMap:{enumerable:!0,get:function(){return this.uniforms.alphaMap.value},set:function(e){this.uniforms.alphaMap.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value=e}},sizeAttenuation:{enumerable:!0,get:function(){return this.uniforms.sizeAttenuation.value},set:function(e){this.uniforms.sizeAttenuation.value=e}},near:{enumerable:!0,get:function(){return this.uniforms.near.value},set:function(e){this.uniforms.near.value=e}},far:{enumerable:!0,get:function(){return this.uniforms.far.value},set:function(e){this.uniforms.far.value=e}},visibility:{enumerable:!0,get:function(){return this.uniforms.visibility.value},set:function(e){this.uniforms.visibility.value=e}},dashOffset0:{enumerable:!0,get:function(){return this.uniforms.dashOffset0.value},set:function(e){this.uniforms.dashOffset0.value=e}},dashOffset1:{enumerable:!0,get:function(){return this.uniforms.dashOffset1.value},set:function(e){this.uniforms.dashOffset1.value=e}},useDash:{enumerable:!0,get:function(){return this.uniforms.useDash.value},set:function(e){this.uniforms.useDash.value=e}},alphaTest:{enumerable:!0,get:function(){return this.uniforms.alphaTest.value},set:function(e){this.uniforms.alphaTest.value=e}},repeat:{enumerable:!0,get:function(){return this.uniforms.repeat.value},set:function(e){this.uniforms.repeat.value=e}},uvScale0:{enumerable:!0,get:function(){return this.uniforms.uvScale0.value},set:function(e){this.uniforms.uvScale0.value=e}}}),t.setValues(e),t}}},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/libs/bufferAttributes",["datav:/npm/gl-vec3/1.1.3","datav:/npm/earcut/2.1.3"],function(t,r,n,e,a,o){function k(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var e,a,o=[],i=!0,s=!1;try{for(n=n.call(t);!(i=(e=n.next()).done)&&(o.push(e.value),!r||o.length!==r);i=!0);}catch(t){s=!0,a=t}finally{try{i||null==n.return||n.return()}finally{if(s)throw a}}return o}}(t,r)||function(t,r){if(t){if("string"==typeof t)return i(t,r);var n=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(n="Object"===n&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,r):void 0}}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,r){(null==r||r>t.length)&&(r=t.length);for(var n=0,e=new Array(r);n<r;n++)e[n]=t[n];return e}var s=n("datav:/npm/gl-vec3/1.1.3"),q=s.subtract,B=s.length,u=s.cross,D=s.normalize,G=n("datav:/npm/earcut/2.1.3");var l=[],c=[];function H(t,r,n,e,a){var o=3<arguments.length&&void 0!==e?e:[],i=!(4<arguments.length&&void 0!==a)||a;q(l,n,r),q(c,t,r),u(o,l,c),i&&D(o,o)}return t.exports={top:function(t,I,C,O){var T={indices:[],positions:[],normals:[],uvs:[]};return t.forEach(function(t,r){for(var n,e,a,t=C&&2<t[0].length?t[0]:t,t=G.flatten([t]),o=t.vertices,i=t.holes,s=t.dimensions,u=G(o,i,s),l=[],c=[],f=[],h=[],p=[],v=T.indices,d=T.positions,g=T.normals,m=T.uvs,y=I[2]-I[0],b=I[3]-I[1],A=d.length/3,x=0,S=o.length;x<S;x+=s)l[0]=+o[x],l[1]=+o[x+1],l[2]=+O,d.push.apply(d,l),m.push((+l[0]-I[0])/y,(+l[1]-I[1])/b),g.push(0,0,0);for(var w=2,E=u.length;w<E;w+=3)n=u[w-2]+A,e=u[w-1]+A,a=u[w]+A,v.push(n,e,a),c[0]=d[n*=3],c[1]=d[1+n],c[2]=d[2+n],f[0]=d[e*=3],f[1]=d[1+e],f[2]=d[2+e],h[0]=d[a*=3],h[1]=d[1+a],h[2]=d[2+a],H(c,f,h,p,!1),g[n]+=p[0],g[1+n]+=p[1],g[2+n]+=p[2],g[e]+=p[0],g[1+e]+=p[1],g[2+e]+=p[2],g[a]+=p[0],g[1+a]+=p[1],g[2+a]+=p[2];for(var j=3*A,F=g.length;j<F;j+=3)p[0]=g[j],p[1]=g[j+1],p[2]=g[j+2],D(p,p),g[j]=p[0],g[j+1]=p[1],g[j+2]=p[2]}),T},side:function(t,I,C,O){var T=[],_=[],z=[],L=[],M=[],U=[],$={indices:[],positions:[],normals:[],uvs:[],f_attr0:[]};return t.forEach(function(t,i){for(var t=C&&2<t[0].length?t[0]:t,t=G.flatten([t]),s=t.vertices,r=t.holes,u=t.dimensions,n=(G(s,r,u),[]),l=[],c=$.indices,f=$.positions,h=$.normals,p=$.uvs,e=$.f_attr0,a=I[2]-I[0],o=I[3]-I[1],v=[],d=f.length/3,g=0,m=s.length;g<m;g+=u){n[0]=+s[g].toFixed(1),n[1]=+s[g+1].toFixed(1),n[2]=+O.toFixed(1),f.push.apply(f,n),h.push(0,0,0),n[2]=0,f.push.apply(f,n),h.push(0,0,0);var y=(n[0]-I[0])/a,b=(n[2]-I[2])/o;e.push(y,b),e.push(y,b)}var A,x,t=r&&0<r.length?r[0]:s.length/u;v.push([0,t]);for(var S,w=0,E=r.length;w<E;w++)A=r[w],x=w<E-1?r[w+1]:s.length/u,v.push([A,x]);v.forEach(function(t,r){var t=k(t,2),n=t[0],e=t[1];if((S=0)===r===function(t,r,n,e){for(var a=0,o=r,i=n-e;o<n;o+=e)a+=(t[i]-t[o])*(t[o+1]+t[i+1]),i=o;return 0<a}(s,n*u,e*u,u))for(var a=n+1;a<e;a++)i=2*(a-1)+d,i*=3,T[0]=f[i],T[1]=f[i+1],T[2]=f[i+2],_[0]=f[i+3],_[1]=f[i+4],_[2]=f[i+5],i=2*a+d,i*=3,z[0]=f[i],z[1]=f[i+1],z[2]=f[i+2],L[0]=f[i+3],L[1]=f[i+4],L[2]=f[i+5],i=2*(a-1)+d,p[i*=2]=S,p[i+1]=1,p[i+2]=S,p[i+3]=0,S+=B(q(l,L,_)),i=2*a+d,p[i*=2]=S,p[i+1]=1,p[i+2]=S,p[i+3]=0,H(_,L,T,M,!1),H(L,z,T,U,!1),i=2*(a-1)+d,h[i*=3]+=M[0]+U[0],h[i+1]+=M[1]+U[1],h[i+2]+=M[2]+U[2],h[i+3]+=M[0],h[i+4]+=M[1],h[i+5]+=M[2],i=2*a+d,h[i*=3]+=U[0],h[i+1]+=U[1],h[i+2]+=U[2],h[i+3]+=M[0]+U[0],h[i+4]+=M[1]+U[1],h[i+5]+=M[2]+U[2],i=2*(a-1)+d,c.push(i+1,i+3,i),c.push(i+3,i+2,i);else for(var o=e-2;n<=o;o--)i=2*(o+1)+d,i*=3,T[0]=f[i],T[1]=f[i+1],T[2]=f[i+2],_[0]=f[i+3],_[1]=f[i+4],_[2]=f[i+5],i=2*o+d,i*=3,z[0]=f[i],z[1]=f[i+1],z[2]=f[i+2],L[0]=f[i+3],L[1]=f[i+4],L[2]=f[i+5],i=2*(o+1)+d,p[i*=2]=S,p[i+1]=1,p[i+2]=S,p[i+3]=0,S+=B(q(l,L,_)),i=2*o+d,p[i*=2]=S,p[i+1]=1,p[i+2]=S,p[i+3]=0,H(_,L,T,M,!1),H(L,z,T,U,!1),i=2*(o+1)+d,h[i*=3]+=M[0]+U[0],h[i+1]+=M[1]+U[1],h[i+2]+=M[2]+U[2],h[i+3]+=M[0],h[i+4]+=M[1],h[i+5]+=M[2],i=2*o+d,h[i*=3]+=U[0],h[i+1]+=U[1],h[i+2]+=U[2],h[i+3]+=M[0]+U[0],h[i+4]+=M[1]+U[1],h[i+5]+=M[2]+U[2],i=2*(o+1)+d,c.push(i+1,i-1,i),c.push(i-1,i-2,i)});for(var j=3*d,F=h.length;j<F;j+=3)M[0]=h[j],M[1]=h[j+1],M[2]=h[j+2],D(M,M),h[j]=M[0],h[j+1]=M[1],h[j+2]=M[2]}),$}},t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/src/libs/meshLine",[],function(e,t,r,i,n,s){function a(t,e){var r,i=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)),i}function o(i){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach(function(e){var t,r;t=i,r=n[e=e],e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(n,e))})}return i}function l(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return u(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function h(e,t,r){e*=6,t*=6;return r[e]===r[t]&&r[1+e]===r[1+t]&&r[2+e]===r[2+t]}function f(e,t){e*=6;return[t[e],t[1+e],t[2+e]]}return e.exports=function(C){function e(){this.positions=[],this.previous=[],this.next=[],this.side=[],this.width=[],this.indices=[],this.uvs=[],this.counters=[],this.lens=[],this.lineLengths=[],this.lineWidths=[],this.lineColor=[],this.lineHeadColor=[],this.symbolColor=[],this.lineParams=[],this.symbolParams=[],this.geometry=new C.BufferGeometry,this.widthCallback=null,this.matrixWorld=new C.Matrix4}var M,O,L;function s(e,t,r,i,n){var s;if(e=e.subarray||e.slice?e:e.buffer,r=r.subarray||r.slice?r:r.buffer,e=t?e.subarray?e.subarray(t,n&&t+n):e.slice(t,n&&t+n):e,r.set)r.set(e,i);else for(s=0;s<e.length;s++)r[s+i]=e[s]}return((e.prototype=Object.create(C.Mesh.prototype)).constructor=e).prototype.setMatrixWorld=function(e){this.matrixWorld=e},e.prototype.setGeometry=function(e,t,r){this.widthCallback=r,this.process(e,t)},e.prototype.raycast=(M=new C.Matrix4,O=new C.Ray,L=new C.Sphere,function(e,t){var r=e.linePrecision,i=r*r,r=this.geometry;if(null===r.boundingSphere&&r.computeBoundingSphere(),L.copy(r.boundingSphere),L.applyMatrix4(this.matrixWorld),!1!==e.ray.intersectSphere(L)){M.getInverse(this.matrixWorld),O.copy(e.ray).applyMatrix4(M);var n=new C.Vector3,s=new C.Vector3,a=new C.Vector3,o=new C.Vector3,u=this instanceof C.LineSegments?2:1;if(r instanceof C.BufferGeometry){var l=r.index,h=r.attributes;if(null!==l)for(var f=l.array,c=h.position.array,p=0,m=f.length-1;p<m;p+=u){var y=f[p],v=f[p+1];n.fromArray(c,3*y),s.fromArray(c,3*v),i<O.distanceSqToSegment(n,s,o,a)||(o.applyMatrix4(this.matrixWorld),(y=e.ray.origin.distanceTo(o))<e.near||y>e.far||t.push({distance:y,point:a.clone().applyMatrix4(this.matrixWorld),index:p,face:null,faceIndex:null,object:this}))}else for(var b,d=h.position.array,g=0,w=d.length/3-1;g<w;g+=u)n.fromArray(d,3*g),s.fromArray(d,3*g+3),i<O.distanceSqToSegment(n,s,o,a)||(o.applyMatrix4(this.matrixWorld),(b=e.ray.origin.distanceTo(o))<e.near||b>e.far||t.push({distance:b,point:a.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}else if(r instanceof C.Geometry)for(var A,x=r.vertices,P=x.length,S=0;S<P-1;S+=u)i<O.distanceSqToSegment(x[S],x[S+1],o,a)||(o.applyMatrix4(this.matrixWorld),(A=e.ray.origin.distanceTo(o))<e.near||A>e.far||t.push({distance:A,point:a.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this}))}}),e.prototype.createGeometry=function(){var e=new C.BufferAttribute(new Float32Array(this.positions),3),t=new C.BufferAttribute(new Float32Array(this.previous),3),r=new C.BufferAttribute(new Float32Array(this.next),3),i=new C.BufferAttribute(new Float32Array(this.side),1),n=new C.BufferAttribute(new Float32Array(this.uvs),2),s=new C.BufferAttribute(new Uint32Array(this.indices),1),a=new C.BufferAttribute(new Float32Array(this.counters),1),o=new C.BufferAttribute(new Float32Array(this.lens),1),u=new C.BufferAttribute(new Float32Array(this.lineLengths),1),l=new C.BufferAttribute(new Float32Array(this.lineWidths),1),h=new C.BufferAttribute(new Float32Array(this.lineColor),4),f=new C.BufferAttribute(new Float32Array(this.lineHeadColor),4),c=new C.BufferAttribute(new Float32Array(this.symbolColor),4),p=new C.BufferAttribute(new Float32Array(this.lineParams),4),m=new C.BufferAttribute(new Float32Array(this.symbolParams),3);this.geometry.setAttribute("position",e),this.geometry.setAttribute("previous",t),this.geometry.setAttribute("next",r),this.geometry.setAttribute("side",i),this.geometry.setAttribute("uv",n),this.geometry.setAttribute("counters",a),this.geometry.setAttribute("len",o),this.geometry.setAttribute("lineLength",u),this.geometry.setAttribute("lineWidth",l),this.geometry.setAttribute("lineColor",h),this.geometry.setAttribute("lineHeadColor",f),this.geometry.setAttribute("symbolColor",c),this.geometry.setAttribute("lineParams",p),this.geometry.setAttribute("symbolParams",m),this.geometry.setIndex(s)},e.prototype.clear=function(){this.positions.length=0,this.previous.length=0,this.next.length=0,this.side.length=0,this.width.length=0,this.indices.length=0,this.uvs.length=0,this.counters.length=0,this.lens.length=0,this.lineLengths.length=0,this.lineWidths.length=0,this.lineColor.length=0,this.lineHeadColor.length=0,this.symbolColor.length=0,this.lineParams.length=0,this.symbolParams.length=0},e.prototype._processPosition=function(e){for(var t,r,i=0,n=e.length/6;i<n;i++)this.counters.push(r=i/(n-1)),this.counters.push(r);(t=this.positions).push.apply(t,l(e));var s=e.length/6,a=h(0,s-1,e)?f(s-2,e):f(0,e);this.previous.push(a[0],a[1],a[2]),this.previous.push(a[0],a[1],a[2]);for(var o=0;o<s-1;o++)a=f(o,e),this.previous.push(a[0],a[1],a[2]),this.previous.push(a[0],a[1],a[2]);for(var u=1;u<s;u++)a=f(u,e),this.next.push(a[0],a[1],a[2]),this.next.push(a[0],a[1],a[2]);a=h(s-1,0,e)?f(1,e):f(s-1,e),this.next.push(a[0],a[1],a[2]),this.next.push(a[0],a[1],a[2])},e.prototype._processIndex=function(e){for(var t=this.positions.length/3,r=e.length/6,i=0;i<r-1;i++){var n=2*i+t;this.indices.push(n,1+n,2+n),this.indices.push(2+n,1+n,3+n)}},e.prototype._processUV=function(e,t){if(2<arguments.length&&void 0!==arguments[2]&&arguments[2]){this.uvs.push(0,0),this.uvs.push(0,1);for(var r,i,n=0,s=6,a=e.length;s<a;s+=6)r=[e[s-6],e[s-6+1],e[s-6+2]],i=[e[s],e[s+1],e[s+2]],n+=Math.sqrt(Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2)+Math.pow(i[2]-r[2],2)),this.uvs.push(i=n/t,0),this.uvs.push(i,1)}else for(var o=e.length/6,u=0;u<o;u++)this.uvs.push(u/(o-1),0),this.uvs.push(u/(o-1),1)},e.prototype._processSide=function(e){for(var t=e.length/6,r=0;r<t;r++)this.side.push(1),this.side.push(-1)},e.prototype.process=function(e,t){for(var r=t.curveLen,i=t.isGeoUv,n=(t.lineColor,t.lineHeadColor,t.symbolColor,t.lineLength,t.lineWidth,t.lineParams),s=t.symbolParams,a=(this._processIndex(e),this._processSide(e),this._processUV(e,r,i),this._processPosition(e),e.length/6),o=0;o<a;o++)this.lens.push(r),this.lens.push(r),this.lineParams.push(n.lineType),this.lineParams.push(n.blurWidthRatio),this.lineParams.push(n.lineHeadSpaceRatio),this.lineParams.push(n.lineTextureNum),this.lineParams.push(n.lineType),this.lineParams.push(n.blurWidthRatio),this.lineParams.push(n.lineHeadSpaceRatio),this.lineParams.push(n.lineTextureNum),this.symbolParams.push(s.symbolType),this.symbolParams.push(s.symbolNum),this.symbolParams.push(s.symbolAspect),this.symbolParams.push(s.symbolType),this.symbolParams.push(s.symbolNum),this.symbolParams.push(s.symbolAspect)},e.prototype.advance=function(e){var t=this.attributes.position.array,r=this.attributes.previous.array,i=this.attributes.next.array,n=t.length;s(t,0,r,0,n),s(t,6,t,0,n-6),t[n-6]=e.x,t[n-5]=e.y,t[n-4]=e.z,t[n-3]=e.x,t[n-2]=e.y,t[n-1]=e.z,s(t,6,i,0,n-6),i[n-6]=e.x,i[n-5]=e.y,i[n-4]=e.z,i[n-3]=e.x,i[n-2]=e.y,i[n-1]=e.z,this.attributes.position.needsUpdate=!0,this.attributes.previous.needsUpdate=!0,this.attributes.next.needsUpdate=!0},{MeshLine:e,MeshLineMaterial:function(e){var t=new C.ShaderMaterial({depthWrite:!0,depthTest:!0,transparent:!0,side:C.DoubleSide});return t.type="MeshLineMaterial",t.uniforms=o({drawScale:{value:1},opacity:{value:1},lineLengthMax:{value:110},lineLength:{value:60},lineWidth:{value:5},lineColor:{value:new C.Vector4},lineHeadColor:{value:new C.Vector4},symbolColor:{value:new C.Vector4},map:{value:null},map1:{value:null},alphaMap:{value:null},resolution:{value:new C.Vector2(1,1)},sizeAttenuation:{value:1},near:{value:1},far:{value:1},visibility:{value:1},dashOffset0:{value:0},dashOffset1:{value:0},useDash:{value:0},alphaTest:{value:0},repeat:{value:new C.Vector2(1,1)},uvScale0:{value:new C.Vector2(1,1)}},C.UniformsLib.fog),t.vertexShader=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/src/shader/line_vert.glsl"),t.fragmentShader=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/src/shader/line_frag.glsl"),Object.defineProperties(t,{drawScale:{enumerable:!0,get:function(){return this.uniforms.drawScale.value},set:function(e){this.uniforms.drawScale.value=e}},lineLengthMax:{enumerable:!0,get:function(){return this.uniforms.lineLengthMax.value},set:function(e){this.uniforms.lineLengthMax.value=e}},lineLength:{enumerable:!0,get:function(){return this.uniforms.lineLength.value},set:function(e){this.uniforms.lineLength.value=e}},lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(e){this.uniforms.lineWidth.value=e}},lineColor:{enumerable:!0,get:function(){return this.uniforms.lineColor.value},set:function(e){this.uniforms.lineColor.value=e}},lineHeadColor:{enumerable:!0,get:function(){return this.uniforms.lineHeadColor.value},set:function(e){this.uniforms.lineHeadColor.value=e}},symbolColor:{enumerable:!0,get:function(){return this.uniforms.symbolColor.value},set:function(e){this.uniforms.symbolColor.value=e}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(e){this.uniforms.map.value=e}},map1:{enumerable:!0,get:function(){return this.uniforms.map1.value},set:function(e){this.uniforms.map1.value=e}},alphaMap:{enumerable:!0,get:function(){return this.uniforms.alphaMap.value},set:function(e){this.uniforms.alphaMap.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value=e}},sizeAttenuation:{enumerable:!0,get:function(){return this.uniforms.sizeAttenuation.value},set:function(e){this.uniforms.sizeAttenuation.value=e}},near:{enumerable:!0,get:function(){return this.uniforms.near.value},set:function(e){this.uniforms.near.value=e}},far:{enumerable:!0,get:function(){return this.uniforms.far.value},set:function(e){this.uniforms.far.value=e}},visibility:{enumerable:!0,get:function(){return this.uniforms.visibility.value},set:function(e){this.uniforms.visibility.value=e}},dashOffset0:{enumerable:!0,get:function(){return this.uniforms.dashOffset0.value},set:function(e){this.uniforms.dashOffset0.value=e}},dashOffset1:{enumerable:!0,get:function(){return this.uniforms.dashOffset1.value},set:function(e){this.uniforms.dashOffset1.value=e}},useDash:{enumerable:!0,get:function(){return this.uniforms.useDash.value},set:function(e){this.uniforms.useDash.value=e}},alphaTest:{enumerable:!0,get:function(){return this.uniforms.alphaTest.value},set:function(e){this.uniforms.alphaTest.value=e}},repeat:{enumerable:!0,get:function(){return this.uniforms.repeat.value},set:function(e){this.uniforms.repeat.value=e}},uvScale0:{enumerable:!0,get:function(){return this.uniforms.uvScale0.value},set:function(e){this.uniforms.uvScale0.value=e}}}),t.setValues(e),t}}},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/water/src/Water",[],function(e,r,A,t,a,o){function L(e,r){return function(e){if(Array.isArray(e))return e}(e)||function(e,r){var t=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=t){var a,o,n=[],i=!0,l=!1;try{for(t=t.call(e);!(i=(a=t.next()).done)&&(n.push(a.value),!r||n.length!==r);i=!0);}catch(e){l=!0,o=e}finally{try{i||null==t.return||t.return()}finally{if(l)throw o}}return n}}(e,r)||function(e,r){if(e){if("string"==typeof e)return n(e,r);var t=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(t="Object"===t&&e.constructor?e.constructor.name:t)||"Set"===t?Array.from(e):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?n(e,r):void 0}}(e,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,r){(null==r||r>e.length)&&(r=e.length);for(var t=0,a=new Array(r);t<r;t++)a[t]=e[t];return a}return e.exports=function(e){var r=e.THREE,t=e.geometry,e=e.options,a=new r.Mesh,l=a,t=(l.isWater=!0,l.geometry=t,void 0!==e.textureWidth?e.textureWidth:512),o=void 0!==e.textureHeight?e.textureHeight:512,s=void 0!==e.clipBias?e.clipBias:0,n=void 0!==e.alpha?e.alpha:1,i=void 0!==e.uvTime?e.uvTime:new r.Vector2(1,1),u=void 0!==e.waterNormals?e.waterNormals:null,d=void 0!==e.sunDirection?e.sunDirection:new r.Vector3(.70707,.70707,0),m=new r.Color(void 0!==e.sunColor?e.sunColor:16777215),c=new r.Color(void 0!==e.waterColor?e.waterColor:8355711),v=void 0!==e.eye?e.eye:new r.Vector3(0,0,0),f=void 0!==e.distortionScale?e.distortionScale:20,p=void 0!==e.side?e.side:r.FrontSide,w=void 0!==e.fog&&e.fog,e=void 0!==e.size?e.size:1,x=new r.Plane,h=new r.Vector3,y=new r.Vector3,g=new r.Vector3,M=new r.Matrix4,b=new r.Vector3(0,0,-1),S=new r.Vector4,C=new r.Vector3,V=new r.Vector3,W=new r.Vector4,T=new r.Matrix4,U=new r.PerspectiveCamera,F={minFilter:r.LinearFilter,magFilter:r.LinearFilter,format:r.RGBFormat},R=new r.WebGLRenderTarget(t,o,F),F=(r.MathUtils.isPowerOfTwo(t)&&r.MathUtils.isPowerOfTwo(o)||(R.texture.generateMipmaps=!1),{uniforms:r.UniformsUtils.merge([r.UniformsLib.fog,r.UniformsLib.lights,{normalSampler:{value:null},mirrorSampler:{value:null},alpha:{value:1},uvTime:{value:new r.Vector2(0,0)},size:{value:1},distortionScale:{value:20},textureMatrix:{value:new r.Matrix4},sunColor:{value:new r.Color(8355711)},sunDirection:{value:new r.Vector3(.70707,.70707,0)},eye:{value:new r.Vector3(0,0,0)},waterColor:{value:new r.Color(5592405)}}]),vertexShader:A("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/water/src/shader/vert.glsl"),fragmentShader:A("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/water/src/shader/frag.glsl")});return(t=new r.ShaderMaterial({fragmentShader:F.fragmentShader,vertexShader:F.vertexShader,uniforms:r.UniformsUtils.clone(F.uniforms),lights:!0,side:p,fog:w,depthWrite:!0,depthTest:!0})).uniforms.mirrorSampler.value=R.texture,t.uniforms.textureMatrix.value=T,t.uniforms.alpha.value=n,t.uniforms.uvTime.value=i,t.uniforms.normalSampler.value=u,t.uniforms.sunColor.value=m,t.uniforms.waterColor.value=c,t.uniforms.sunDirection.value=d,t.uniforms.distortionScale.value=f,t.uniforms.size.value=e,t.uniforms.eye.value=v,l.material=t,l.onBeforeRender=function(e,r,t){var a,o,n,i;y.setFromMatrixPosition(l.matrixWorld),g.setFromMatrixPosition(t.matrixWorld),M.extractRotation(l.matrixWorld),h.set(0,0,1),h.applyMatrix4(M),C.subVectors(y,g),0<C.dot(h)||(C.reflect(h).negate(),C.add(y),M.extractRotation(t.matrixWorld),b.set(0,0,-1),b.applyMatrix4(M),b.add(g),V.subVectors(y,b),V.reflect(h).negate(),V.add(y),U.position.copy(C),U.up.set(0,1,0),U.up.applyMatrix4(M),U.up.reflect(h),U.lookAt(V),U.far=t.far,U.updateMatrixWorld(),U.projectionMatrix.copy(t.projectionMatrix),T.set(.5,0,0,.5,0,.5,0,.5,0,0,.5,.5,0,0,0,1),T.multiply(U.projectionMatrix),T.multiply(U.matrixWorldInverse),x.setFromNormalAndCoplanarPoint(h,y),x.applyMatrix4(U.matrixWorldInverse),S.set(x.normal.x,x.normal.y,x.normal.z,x.constant),a=U.projectionMatrix,W.x=(Math.sign(S.x)+a.elements[8])/a.elements[0],W.y=(Math.sign(S.y)+a.elements[9])/a.elements[5],W.z=-1,W.w=(1+a.elements[10])/a.elements[14],S.multiplyScalar(2/S.dot(W)),a.elements[2]=S.x,a.elements[6]=S.y,a.elements[10]=S.z+1-s,a.elements[14]=S.w,v.setFromMatrixPosition(t.matrixWorld),a=e.getRenderTarget(),o=e.xr.enabled,n=e.shadowMap.autoUpdate,l.visible=!1,i=[],function e(r,t,a){if(t(r)){a(r);for(var o=r.children,n=0,i=o.length;n<i;n++)e(o[n],t,a)}}(r,function(e){return e.ignoreWaterReflection&&(i.push([e.visible,e]),e.visible=!1),e.visible},function(){}),e.xr.enabled=!1,e.shadowMap.autoUpdate=!1,e.setRenderTarget(R),e.state.buffers.depth.setMask(!0),!1===e.autoClear&&e.clear(),e.render(r,U),i.forEach(function(e){var e=L(e,2),r=e[0];e[1].visible=r}),l.visible=!0,e.xr.enabled=o,e.shadowMap.autoUpdate=n,e.setRenderTarget(a),void 0!==(r=t.viewport)&&e.state.viewport(r))},a},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/grid/shader/frag.glsl",[],function(n,e,i,t,a,r){return n.exports="#define GLSLIFY 1\n#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform vec3 attenuationColor;\n\tuniform float attenuationDistance;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n\nuniform float emissiveIntensity;\nuniform vec2 uvOffset;\nvarying vec2 emissiveUV;\n#include <common>\n        \n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <transmission_pars_fragment>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n#include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef USE_TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t\tfloat thicknessFactor = thickness;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t#include <clearcoat_normal_fragment_begin>\n\t#include <clearcoat_normal_fragment_maps>\n\t#include <emissivemap_fragment>\n\tvec3 rawDiffuseColor = diffuseColor.rgb;\n\t#include <transmission_fragment>\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\t \n    vec2 _vUv = emissiveUV;\n    _vUv.x = emissiveUV.x;\n    _vUv.y = emissiveUV.y;\n\n    _vUv.x += uvOffset.x;\n    _vUv.y += uvOffset.y;\n    vec4 _emissiveColor = texture2D( emissiveMap, _vUv );\n    _emissiveColor.rgb = emissiveMapTexelToLinear( _emissiveColor ).rgb;\n    totalEmissiveRadiance *= _emissiveColor.rgb * emissiveIntensity;\n    vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n        \n\tgl_FragColor = vec4( outgoingLight, diffuseColor.a );\n\t#include <tonemapping_fragment>\n\t#include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",n.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/grid/shader/vert.glsl",[],function(e,n,i,t,r,v){return e.exports="#define GLSLIFY 1\n#define STANDARD\nvarying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#ifdef USE_TRANSMISSION\n\tvarying vec4 vWorldPosition;\n#endif\n\nuniform vec2 mapRepeat;\nuniform vec2 emissiveMapRepeat;\nvarying vec2 emissiveUV;\n#include <common>\n        \n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n    #ifndef FLAT_SHADED\n        vNormal = normalize( transformedNormal );\n        #ifdef USE_TANGENT\n            vTangent = normalize( transformedTangent );\n            vBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n        #endif\n    #endif\n\t\n    #include <begin_vertex>\n\n    vUv.x = uv.x * mapRepeat.x;\n    vUv.y = uv.y * mapRepeat.y;\n    emissiveUV.x = uv.x * emissiveMapRepeat.x;\n    emissiveUV.y = uv.y * emissiveMapRepeat.y;\n        \n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n    #ifdef USE_TRANSMISSION\n        vWorldPosition = worldPosition;\n    #endif\n}",e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/chinaBorder/lib/meshLine",[],function(t,e,i,r,s,n){function o(t){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function a(t,e){for(var i=0;i<e.length;i++){var r=e[i];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function u(t,e,i){return e&&a(t.prototype,e),i&&a(t,i),Object.defineProperty(t,"prototype",{writable:!1}),t}function h(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function l(t,e){if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&p(t,e)}function p(t,e){return(p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function c(i){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=d(i),e=(t=r?(t=d(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===o(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return f(e)}}function f(t){if(void 0===t)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function d(t){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}return t.exports=function(b){function d(t,e,i,r,s,n){return Math.sqrt(Math.pow(r-t,2)+Math.pow(s-e,2)+Math.pow(n-i,2))}l(i,b.BufferGeometry),e=c(i);var e,t=u(i);function i(){var t;return h(this,i),(t=e.call(this)).isMeshLine=!0,t.type="MeshLine",t.positions=[],t.previous=[],t.next=[],t.side=[],t.width=[],t.indices_array=[],t.uvs=[],t.counters=[],t._points=[],t._geom=null,t.widthCallback=null,t.matrixWorld=new b.Matrix4,Object.defineProperties(f(t),{geometry:{enumerable:!0,get:function(){return this}},geom:{enumerable:!0,get:function(){return this._geom},set:function(t){this.setGeometry(t,this.widthCallback)}},points:{enumerable:!0,get:function(){return this._points},set:function(t){this.setPoints(t,this.widthCallback)}}}),t}function n(t,e,i,r,s){var n;if(t=t.subarray||t.slice?t:t.buffer,i=i.subarray||i.slice?i:i.buffer,t=e?t.subarray?t.subarray(e,s&&e+s):t.slice(e,s&&e+s):t,i.set)i.set(t,r);else for(n=0;n<t.length;n++)i[n+r]=t[n]}t.prototype.setMatrixWorld=function(t){this.matrixWorld=t},t.prototype.setGeometry=function(t,e){this._geometry=t,this.setPoints(t.getAttribute("position").array,e)},t.prototype.setPoints=function(t,e){if(t instanceof Float32Array||t instanceof Array){this._points=t,this.widthCallback=e,this.positions=[],this.counters=[];var i=[],r=[0];if(t.length&&t[0]instanceof b.Vector3){for(var s=0;s<t.length;s++){var n=t[s];0<s&&(r[s]=d(n.x,n.y,n.z,t[s-1].x,t[s-1].y,t[s-1].z)+r[s-1])}for(var s=0,o=t.length;s<o;s++){n=t[s];this.positions.push(n.x,n.y,n.z),this.positions.push(n.x,n.y,n.z),this.counters.push(r[s]),this.counters.push(r[o-1]),this.counters.push(r[s]),this.counters.push(r[o-1])}i.push(t.length)}else if(t[0]instanceof Array)for(var a=0;a<t.length;a++){for(var u=t[a],r=[0],s=0;s<u.length;s+=3){var h,n=u[s];0<s&&(r[h=s/3]=d(u[s],u[s+1],u[s+2],u[s-3],u[s-2],u[s-1])+r[h-1])}for(s=0,o=u.length;s<o;s+=3){var n=u[s],l=(this.positions.push(u[s],u[s+1],u[s+2]),this.positions.push(u[s],u[s+1],u[s+2]),s/3),p=o/3;this.counters.push(r[l]),this.counters.push(r[p-1]),this.counters.push(r[l]),this.counters.push(r[p-1])}i.push(u.length/3)}else{for(s=0,o=pointArr.length;s<o;s+=3)0<s&&(r+=d(t[s],t[s+1],t[s+2],t[s-3],t[s-2],t[s-1]));for(s=0,o=pointArr.length;s<o;s+=3){this.positions.push(t[s],t[s+1],t[s+2]),this.positions.push(t[s],t[s+1],t[s+2]);var c=s/3,f=o/3;this.counters.push(r[c]),this.counters.push(r[f-1]),this.counters.push(r[c]),this.counters.push(r[f-1])}i.push(t.length/3)}this.process(i)}else console.error("ERROR: The BufferArray of points is not instancied correctly.")},t.prototype.raycast=function(t,e){var i=new b.Matrix4,r=new b.Ray,s=new b.Sphere,n=new b.Vector3,o=this.geometry;if(o.boundingSphere||o.computeBoundingSphere(),s.copy(o.boundingSphere),s.applyMatrix4(this.matrixWorld),!1!==t.ray.intersectSphere(s,n)){i.copy(this.matrixWorld).invert(),r.copy(t.ray).applyMatrix4(i);var a=new b.Vector3,u=new b.Vector3,h=new b.Vector3,l=this instanceof b.LineSegments?2:1,s=o.index,i=o.attributes;if(null!==s)for(var p=s.array,c=i.position.array,f=i.width.array,d=0,y=p.length-1;d<y;d+=l){var v=p[d],m=p[d+1],v=(a.fromArray(c,3*v),u.fromArray(c,3*m),void 0!==f[Math.floor(d/3)]?f[Math.floor(d/3)]:1),m=t.params.Line.threshold+this.material.lineWidth*v/2;m*m<r.distanceSqToSegment(a,u,n,h)||(n.applyMatrix4(this.matrixWorld),(v=t.ray.origin.distanceTo(n))<t.near||v>t.far||(e.push({distance:v,point:h.clone().applyMatrix4(this.matrixWorld),index:d,face:null,faceIndex:null,object:this}),d=y))}}},t.prototype.compareV3=function(t,e){t*=6,e*=6;return this.positions[t]===this.positions[e]&&this.positions[1+t]===this.positions[1+e]&&this.positions[2+t]===this.positions[2+e]},t.prototype.copyV3=function(t){t*=6;return[this.positions[t],this.positions[1+t],this.positions[2+t]]},t.prototype.process=function(t){var s,n,o=this,a=(this.previous=[],this.next=[],this.side=[],this.width=[],this.indices_array=[],this.uvs=[],0);t.forEach(function(t){var e=a+=t;n=o.compareV3(a-t,e-1)?o.copyV3(e-2):o.copyV3(a-t),o.previous.push(n[0],n[1],n[2]),o.previous.push(n[0],n[1],n[2]);for(var i,r=e-t;r<e;r++)o.side.push(1),o.side.push(-1),s=o.widthCallback?o.widthCallback(r/(e-1)):1,o.width.push(s),o.width.push(s),o.uvs.push(r/(e-1),0),o.uvs.push(r/(e-1),1),r<e-1&&(n=o.copyV3(r),o.previous.push(n[0],n[1],n[2]),o.previous.push(n[0],n[1],n[2]),o.indices_array.push(i=2*r,1+i,2+i),o.indices_array.push(2+i,1+i,3+i)),e-t<r&&(n=o.copyV3(r),o.next.push(n[0],n[1],n[2]),o.next.push(n[0],n[1],n[2]));n=o.compareV3(e-1,a-t)?o.copyV3(a-t+1):o.copyV3(e-1),o.next.push(n[0],n[1],n[2]),o.next.push(n[0],n[1],n[2])}),this._attributes&&this._attributes.position.count===this.positions.length?(this._attributes.position.copyArray(new Float32Array(this.positions)),this._attributes.position.needsUpdate=!0,this._attributes.previous.copyArray(new Float32Array(this.previous)),this._attributes.previous.needsUpdate=!0,this._attributes.next.copyArray(new Float32Array(this.next)),this._attributes.next.needsUpdate=!0,this._attributes.side.copyArray(new Float32Array(this.side)),this._attributes.side.needsUpdate=!0,this._attributes.width.copyArray(new Float32Array(this.width)),this._attributes.width.needsUpdate=!0,this._attributes.uv.copyArray(new Float32Array(this.uvs)),this._attributes.uv.needsUpdate=!0,this._attributes.index.copyArray(new Uint16Array(this.indices_array)),this._attributes.index.needsUpdate=!0):this._attributes={position:new b.BufferAttribute(new Float32Array(this.positions),3),previous:new b.BufferAttribute(new Float32Array(this.previous),3),next:new b.BufferAttribute(new Float32Array(this.next),3),side:new b.BufferAttribute(new Float32Array(this.side),1),width:new b.BufferAttribute(new Float32Array(this.width),1),uv:new b.BufferAttribute(new Float32Array(this.uvs),2),index:new b.BufferAttribute(new Uint16Array(this.indices_array),1),counters:new b.BufferAttribute(new Float32Array(this.counters),2)},this.setAttribute("position",this._attributes.position),this.setAttribute("previous",this._attributes.previous),this.setAttribute("next",this._attributes.next),this.setAttribute("side",this._attributes.side),this.setAttribute("width",this._attributes.width),this.setAttribute("uv",this._attributes.uv),this.setAttribute("counters",this._attributes.counters),this.setIndex(this._attributes.index),this.computeBoundingSphere(),this.computeBoundingBox()},t.prototype.advance=function(t){var e=this._attributes.position.array,i=this._attributes.previous.array,r=this._attributes.next.array,s=e.length;n(e,0,i,0,s),n(e,6,e,0,s-6),e[s-6]=t.x,e[s-5]=t.y,e[s-4]=t.z,e[s-3]=t.x,e[s-2]=t.y,e[s-1]=t.z,n(e,6,r,0,s-6),r[s-6]=t.x,r[s-5]=t.y,r[s-4]=t.z,r[s-3]=t.x,r[s-2]=t.y,r[s-1]=t.z,this._attributes.position.needsUpdate=!0,this._attributes.previous.needsUpdate=!0,this._attributes.next.needsUpdate=!0},b.ShaderChunk.meshline_vert=["",b.ShaderChunk.logdepthbuf_pars_vertex,b.ShaderChunk.fog_pars_vertex,b.ShaderChunk.common,"","attribute vec3 previous;","attribute vec3 next;","attribute float side;","attribute float width;","attribute vec2 counters;","","uniform vec2 resolution;","uniform float lineWidth;","uniform vec3 color;","uniform float opacity;","uniform float sizeAttenuation;","","varying vec2 vUV;","varying vec4 vColor;","varying vec2 vCounters;","","vec2 fix( vec4 i, float aspect ) {","","    vec2 res = i.xy / i.w;","    res.x *= aspect;","    return res;","","}","","void main() {","","    float aspect = resolution.x / resolution.y;","","    vColor = vec4( color, opacity );","    vUV = uv;","\t   vCounters = counters;","","    mat4 m = projectionMatrix * modelViewMatrix;","    vec4 finalPosition = m * vec4( position, 1.0 );","    vec4 prevPos = m * vec4( previous, 1.0 );","    vec4 nextPos = m * vec4( next, 1.0 );","","    vec2 currentP = fix( finalPosition, aspect );","    vec2 prevP = fix( prevPos, aspect );","    vec2 nextP = fix( nextPos, aspect );","","    float w = lineWidth * width;","","    vec2 dir;","    if( nextP == currentP ) dir = normalize( currentP - prevP );","    else if( prevP == currentP ) dir = normalize( nextP - currentP );","    else {","        vec2 dir1 = normalize( currentP - prevP );","        vec2 dir2 = normalize( nextP - currentP );","        dir = normalize( dir1 + dir2 );","","        vec2 perp = vec2( -dir1.y, dir1.x );","        vec2 miter = vec2( -dir.y, dir.x );","        //w = clamp( w / dot( miter, perp ), 0., 4. * lineWidth * width );","","    }","","    //vec2 normal = ( cross( vec3( dir, 0. ), vec3( 0., 0., 1. ) ) ).xy;","    vec4 normal = vec4( -dir.y, dir.x, 0., 1. );","    normal.xy *= .5 * w;","    normal *= projectionMatrix;","    if( sizeAttenuation == 0. ) {","        normal.xy *= finalPosition.w;","        normal.xy /= ( vec4( resolution, 0., 1. ) * projectionMatrix ).xy;","    }","","    finalPosition.xy += normal.xy * side;","","    gl_Position = finalPosition;","",b.ShaderChunk.logdepthbuf_vertex,b.ShaderChunk.fog_vertex&&"    vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );",b.ShaderChunk.fog_vertex,"}"].join("\n"),b.ShaderChunk.meshline_frag=["",b.ShaderChunk.fog_pars_fragment,b.ShaderChunk.logdepthbuf_pars_fragment,"","uniform sampler2D map;","uniform sampler2D alphaMap;","uniform float useMap;","uniform float useAlphaMap;","uniform float useDash;","uniform float[5] dashArray;","uniform float dashOffset;","uniform float dashRatio;","uniform float visibility;","uniform float alphaTest;","uniform vec2 repeat;","uniform float u_lengthPerPixel;","","varying vec2 vUV;","varying vec4 vColor;","varying vec2 vCounters;","","void main() {","",b.ShaderChunk.logdepthbuf_fragment,"","    vec4 c = vColor;","    if( useMap == 1. ) c *= texture2D( map, vUV * repeat );","    if( useAlphaMap == 1. ) c.a *= texture2D( alphaMap, vUV * repeat ).a;","    if( c.a < alphaTest ) discard;","    if( useDash == 1. ){","        float sumDash = dashArray[0] + dashArray[1] + dashArray[2] + dashArray[3] + dashArray[4];","        float dashCount = sumDash * u_lengthPerPixel;","        float scale = floor( vCounters[1] / dashCount);","        dashCount *= (vCounters[1] / dashCount) / scale; ","        float percentage = mod(vCounters[0], dashCount)/dashCount;","        c.a *=  percentage <= dashArray[0]/sumDash ? 0. : percentage <= (dashArray[0] + dashArray[1])/sumDash ? 1. : percentage <= (dashArray[0] + dashArray[1] + dashArray[2])/sumDash? 0. : percentage <= (dashArray[0] + dashArray[1] + dashArray[2] + dashArray[3])/sumDash? 1.:0.;","    }","    gl_FragColor = c;","    gl_FragColor.a *= visibility;","",b.ShaderChunk.fog_fragment,"}"].join("\n");l(o,b.ShaderMaterial),r=c(o);var r,s=u(o);function o(t){var e;return h(this,o),(e=r.call(this,{uniforms:Object.assign({},b.UniformsLib.fog,{lineWidth:{value:1},map:{value:null},useMap:{value:0},alphaMap:{value:null},useAlphaMap:{value:0},color:{value:new b.Color(16777215)},opacity:{value:1},resolution:{value:new b.Vector2(1,1)},sizeAttenuation:{value:1},dashArray:{value:[1,0,0,0]},dashOffset:{value:0},dashRatio:{value:.5},useDash:{value:0},visibility:{value:1},alphaTest:{value:0},repeat:{value:new b.Vector2(1,1)},u_lengthPerPixel:{value:2e4}}),vertexShader:b.ShaderChunk.meshline_vert,fragmentShader:b.ShaderChunk.meshline_frag})).isMeshLineMaterial=!0,e.type="MeshLineMaterial",Object.defineProperties(f(e),{lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(t){this.uniforms.lineWidth.value=t}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(t){this.uniforms.map.value=t}},useMap:{enumerable:!0,get:function(){return this.uniforms.useMap.value},set:function(t){this.uniforms.useMap.value=t}},alphaMap:{enumerable:!0,get:function(){return this.uniforms.alphaMap.value},set:function(t){this.uniforms.alphaMap.value=t}},useAlphaMap:{enumerable:!0,get:function(){return this.uniforms.useAlphaMap.value},set:function(t){this.uniforms.useAlphaMap.value=t}},color:{enumerable:!0,get:function(){return this.uniforms.color.value},set:function(t){this.uniforms.color.value=t}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(t){this.uniforms.opacity.value=t}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(t){this.uniforms.resolution.value.copy(t)}},sizeAttenuation:{enumerable:!0,get:function(){return this.uniforms.sizeAttenuation.value},set:function(t){this.uniforms.sizeAttenuation.value=t}},dashArray:{enumerable:!0,get:function(){return this.uniforms.dashArray.value},set:function(t){this.uniforms.dashArray.value=t,this.useDash=0!==t?1:0}},dashOffset:{enumerable:!0,get:function(){return this.uniforms.dashOffset.value},set:function(t){this.uniforms.dashOffset.value=t}},dashRatio:{enumerable:!0,get:function(){return this.uniforms.dashRatio.value},set:function(t){this.uniforms.dashRatio.value=t}},useDash:{enumerable:!0,get:function(){return this.uniforms.useDash.value},set:function(t){this.uniforms.useDash.value=t}},visibility:{enumerable:!0,get:function(){return this.uniforms.visibility.value},set:function(t){this.uniforms.visibility.value=t}},alphaTest:{enumerable:!0,get:function(){return this.uniforms.alphaTest.value},set:function(t){this.uniforms.alphaTest.value=t}},repeat:{enumerable:!0,get:function(){return this.uniforms.repeat.value},set:function(t){this.uniforms.repeat.value.copy(t)}}}),e.setValues(t),e}return s.prototype.copy=function(t){return b.ShaderMaterial.prototype.copy.call(this,t),this.lineWidth=t.lineWidth,this.map=t.map,this.useMap=t.useMap,this.alphaMap=t.alphaMap,this.useAlphaMap=t.useAlphaMap,this.color.copy(t.color),this.opacity=t.opacity,this.resolution.copy(t.resolution),this.sizeAttenuation=t.sizeAttenuation,this.dashArray.copy(t.dashArray),this.dashOffset.copy(t.dashOffset),this.dashRatio.copy(t.dashRatio),this.useDash=t.useDash,this.visibility=t.visibility,this.alphaTest=t.alphaTest,this.repeat.copy(t.repeat),this},{MeshLine:t,MeshLineMaterial:s}},t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/config",[],function(e,i,a,s,t,n){return e.exports={DEFAULT_OPTIONS:{isSceneGroup:!1,sceneNames:[{sceneName:"main"}],visible:!0,lowHeightScale:.1,castShadow:!0,topTexture:{metalness:75,roughness:55,color:"#1a1c1e",map:"https://tile.nextzen.org/tilezen/terrain/v1/256/normal/{z}/{x}/{y}.png?api_key=PzP1EaGMTGSL_vYBiYClog&",mapFill:{show:!1,opacity:1,map:"http://img.alicdn.com/tfs/TB1BzF5AuT2gK0jSZFvXXXnFXXa-800-800.png"},normal:{show:!0,normalMap:"https://tile.nextzen.org/tilezen/terrain/v1/256/normal/{z}/{x}/{y}.png?api_key=PzP1EaGMTGSL_vYBiYClog&",normalScale:55},emissive:{show:!1,emissive:"#ffffff",emissiveMap:"http://img.alicdn.com/tfs/TB1BzF5AuT2gK0jSZFvXXXnFXXa-800-800.png",emissiveIntensity:10},light:{show:!1,lightMap:"",lightMapIntensity:100},ao:{show:!1,aoMap:"",aoMapIntensity:100}},sideTexture:{uvTexture:!0,speed:{x:1,y:0},color:"#23407a",map:"https://img.alicdn.com/tfs/TB1fJnDFGL7gK0jSZFBXXXZZpXa-800-800.png",emissive:{show:!1,emissive:"#07adfb",emissiveMap:"http://img.alicdn.com/tfs/TB1reTtccKfxu4jSZPfXXb3dXXa-1000-1000.png",emissiveIntensity:20}},sideLight:{show:!0,openShadow:!0,heightScale:5.4,color:"rgba(255, 255, 255, 0.09)",map:"https://img.alicdn.com/tfs/TB1kGPbVuL2gK0jSZFmXXc7iXXa-256-256.png",emissive:{emissive:"#07adfb",emissiveMap:"https://img.alicdn.com/tfs/TB1kGPbVuL2gK0jSZFmXXc7iXXa-256-256.png",emissiveIntensity:20}}}},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/areaLayer",[],function(e,t,l,r,o,n){function g(e){return function(e){if(Array.isArray(e))return i(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return i(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?i(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function c(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function v(){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O(e)););return e}(e,t);if(o)return o=Object.getOwnPropertyDescriptor(o,t),o.get?o.get.call(arguments.length<3?e:r):o.value}).apply(this,arguments)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=O(r),t=(e=o?(e=O(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return j(t)}}function j(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}return e.exports=function(p){var i=p.THREE,e=p.Utils,a=(p.GuiUtils,e._,e.mergeOptions),s=e.Chroma,t=e.deepClone,f=e.geojsonFlatten,y=(e.geojsonDissolve,e.geojsonBBox),h=e.coordtransformCli,d=e.BASE_HEIGHT_SCALE,e=l("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/libs/bufferAttributes"),b=e.top;e.side;var e=p.Layer,r=u;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&m(r,e);var o,n=w(u);function u(e){if(!(this instanceof u))throw new TypeError("Cannot call a class as a function");var t=n.call(this),r={isSceneGroup:!1,sceneNames:[{sceneName:"main"}],visible:!0,renderOrder:10+Math.round(90*Math.random())};return t.options=a(r,e||{}),t.eventsType={click:!0,dblclick:!0},t.classNameAlias="AreaLayer",t.renderQueue=p.VOGO.Transparent,t.options.visible?t.show():t.hide(),t.geojson=null,t.mappingData=[],t.data=[],t.textureImageUrls={},t.draw=t.draw.bind(j(t)),t.setGeojson=t.setGeojson.bind(j(t)),t.addTop=t.addTop.bind(j(t)),t}return r=u,(e=[{key:"render",value:function(e){this.data=e||[],this.mappingData=[],this.dataProcess(),this.draw()}},{key:"getRootObj3d",value:function(){var t=[];return this.layer.length&&this.layer.forEach(function(e){return t.push(e.group)}),t}},{key:"setGeojson",value:function(e){if(this.clear(),this._geojson=null,e&&e.features){for(var t={type:"FeatureCollection",features:[]},r=0;r<e.features.length;r++){var o=e.features[r];o.type&&"Feature"==o.type&&o.geometry&&("Polygon"==o.geometry.type||"MultiPolygon"==o.geometry.type)&&t.features.push(o)}this._geojson=t,this.dataProcess(),this.draw()}}},{key:"dataProcess",value:function(){for(var e,t=!1,r=this.data,o=0;o<r.length;o++)if((e=r[o]).geometry&&("Polygon"==e.geometry.type||"MultiPolygon"==e.geometry.type)){t=!0;break}var n={type:"FeatureCollection",features:[]};if(t)for(o=0;o<r.length;o++){var i=r[o];!i.geometry||"Polygon"!=i.geometry.type&&"MultiPolygon"!=i.geometry.type||(i={type:"Feature",properties:{},geometry:i.geometry},n.features.push(i))}else this._geojson&&(n=a({},this._geojson));this.clear(),this.geojson=n}},{key:"draw",value:function(){for(var e=h.wgs84ToMecator(this.geojson,p.proj.proj),t=y(e),r=(f(e),this.bboxLowHeightScale=200,Math.max(Math.abs(t[2]-t[0]),Math.abs(t[3]-t[1]))),t=p.baseHeightScale,o=p.drawScale*d*(t+.005),n=0;n<e.features.length;n++){var i=e.features[n],a=[],s=i.geometry,u=s.type,l=s.coordinates;switch(u){case"Polygon":a.push.apply(a,g(l));break;case"MultiPolygon":for(var c=0;c<l.length;c++)a.push.apply(a,g(l[c]))}var s=y(i);r/Math.max(Math.abs(s[2]-s[0]),Math.abs(s[3]-s[1]))<this.bboxLowHeightScale&&(u=y(i),s=1<a.length,u=b(a,u,s,1),this.addTop(u,"rgba(255,255,255,0.0)",o,i))}}},{key:"addTop",value:function(e,t,r,o){var n=new i.BufferGeometry,e=(n.setAttribute||(n.setAttribute=n.addAttribute),n.setIndex(new i.BufferAttribute(new Uint32Array(e.indices),1)),n.setAttribute("position",new i.BufferAttribute(new Float32Array(e.positions),3)),n.setAttribute("normal",new i.BufferAttribute(new Float32Array(e.normals),3)),n.setAttribute("uv",new i.BufferAttribute(new Float32Array(e.uvs),2)),n.computeBoundingSphere(),n.computeBoundingBox(),s(t).gl()),t=new i.MeshStandardMaterial({opacity:e[3],color:new i.Color(e[0],e[1],e[2]),depthWrite:!1,depthTest:!1,transparent:!0}),e=new i.Mesh(n,t);e.position.z=r,e.scale.z=1,e.userData=a(o.properties,{isClick:!0,isDblclickDrill:!0}),this.add(e),e.renderOrder=9}},{key:"updateOptions",value:function(e){t(this.options);this.options=a(this.options,e||{}),this.clear(),this.draw()}},{key:"checkVisible",value:function(){(this.options.visible?v(O(u.prototype),"show",this):v(O(u.prototype),"hide",this)).call(this)}},{key:"show",value:function(){this.options.visible=!0,v(O(u.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.options.visible=!1,v(O(u.prototype),"hide",this).call(this)}},{key:"destroy",value:function(){v(O(u.prototype),"remove",this).call(this),this.clear(),this.geojson=null,this.data=null,this.mappingData=null,this.options=null}}])&&c(r.prototype,e),o&&c(r,o),Object.defineProperty(r,"prototype",{writable:!1}),u},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/labelLayer",[],function(e,t,r,o,n,i){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function p(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function f(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function y(){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=v(e)););return e}(e,t);if(o)return o=Object.getOwnPropertyDescriptor(o,t),o.get?o.get.call(arguments.length<3?e:r):o.value}).apply(this,arguments)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(r),t=(e=o?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return g(t)}}function g(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}return e.exports=function(s){var l=s.THREE,a=s.Utils,c=Math.max(devicePixelRatio,2),u=a.measureText,o=a.polylabel,h=(a.deepClone,a.BASE_HEIGHT_SCALE),e=s.Layer,t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e);var r,n=b(i);function i(e,t){if(!(this instanceof i))throw new TypeError("Cannot call a class as a function");var r;return(r=n.call(this)).options=a.mergeOptions({isSceneGroup:!1,sceneNames:[{sceneName:"main"}],visible:!0,renderOrder:13},e||{}),r.status=t,r.renderQueue=s.VOGO.Transparent,r.options.visible?r.show():r.hide(),r.draw=r.draw.bind(g(r)),r.checkVisible=r.checkVisible.bind(g(r)),r}return t=i,(e=[{key:"traverse",value:function(t){this.group&&this.group.traverse&&this.group.traverse(function(e){(e instanceof l.Mesh||e instanceof l.InstancedMesh||e instanceof l.LineSegments||e instanceof l.Sprite)&&t&&t(e)})}},{key:"render",value:function(e){e.geojson_children?this.geojson=e.geojson_children:this.geojson={features:[]},this.draw()}},{key:"draw",value:function(){this.clear();for(var e=this.options.terrainHeight.baseHeightScale,t=s.drawScale*h*(e+.02),r=0;r<this.geojson.features.length;r++){var o,n,i=this.geojson.features[r],a=i.properties;a.name&&(i=this.calLabelPos(i,1),i=s.proj.proj([i[0],i[1],t]),a=this.getTextCanvas(a.name),(o=new l.CanvasTexture(a)).minFilter=l.LinearFilter,o.wrapS=o.wrapT=l.RepeatWrapping,o.repeat.set(1,1),o.anisotropy=20,o.needsUpdate=!0,o=new l.SpriteMaterial({map:o,transparent:!0,depthWrite:!1,depthTest:!0,sizeAttenuation:!1,opacity:1}),(o=new l.Sprite(o)).center.set(.5,0),(n=o.position).set.apply(n,p(i)),n=.36/c/s.constants.size.height,i=a.width*n,a=a.height*n,o.scale.set(i,a,1),o.renderOrder=+this.options.renderOrder,this.add(o))}this.checkVisible()}},{key:"getTextCanvas",value:function(e){var t=a.mergeOptions({},this.options).borderStyle.textStyle,r=u(e,t.fontFamily,t.fontWeight,t.fontSize*c),o=r.width,r=r.height,n=document.createElement("canvas"),o=2*(o+2*t.lineWidth),r=2*(r+2*t.lineWidth),i=(n.width=o,n.height=r,n.style.width=o+"px",n.style.height=r+"px",n.getContext("2d",this.status.screenshotEnable?{preserveDrawingBuffer:!0}:{}));return i.imageSmoothingQuality="high",i.textBaseline="middle",i.textAlign="center",i.font=t.fontWeight+" "+t.fontSize*c+"px "+t.fontFamily,0<t.lineWidth&&(i.lineWidth=t.lineWidth,i.strokeStyle=t.strokeColor||"white",i.strokeText(e,o/2,r/2*1.2)),i.fillStyle=t.color||"red",i.fillText(e,o/2,r/2*1.2),n}},{key:"area",value:function(e){for(var t=0,r=0;r<e.length;r++)for(var o=e[r],n=0,i=o.length,a=i-1;n<i;a=n++)t+=(o[n][0]-o[a][0])*(o[n][1]+o[a][1])*(r?-1:1);return Math.abs(t)/2}},{key:"calLabelPos",value:function(e,t){var r=this;return e.geometry&&"Polygon"===e.geometry.type?o(e.geometry.coordinates,t):e.geometry&&"MultiPolygon"===e.geometry.type?(e=e.geometry.coordinates.reduce(function(e,t){return r.area(e)>=r.area(t)?e:t},{}),o(e,t)):void 0}},{key:"updateOptions",value:function(e){var t,r=a.deepClone(this.options),e=(this.options=a.mergeOptions(this.options,e||{}),this.options.borderStyle.textStyle),e=(r.borderStyle.textStyle.show===e.show&&r.borderStyle.textStyle.fontFamily===e.fontFamily&&r.borderStyle.textStyle.fontWeight===e.fontWeight&&r.borderStyle.textStyle.fontSize===e.fontSize&&r.borderStyle.textStyle.color===e.color&&r.borderStyle.textStyle.lineWidth===e.lineWidth&&r.borderStyle.textStyle.strokeColor===e.strokeColor||this.draw(),this.options.terrainHeight.baseHeightScale);r.terrainHeight.baseHeightScale!==e&&(r=s.drawScale*h,t=Math.round(r*(e+.02)),this.traverse(function(e){e.position.z=t})),this.checkVisible()}},{key:"checkVisible",value:function(){var e=this.options,t=e.visible,e=e.borderStyle;(t&&e.textStyle.show?y(v(i.prototype),"show",this):y(v(i.prototype),"hide",this)).call(this)}},{key:"show",value:function(){this.options.visible=!0,this.options.borderStyle.textStyle.show&&y(v(i.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.options.visible=!1,y(v(i.prototype),"hide",this).call(this)}},{key:"destroy",value:function(){y(v(i.prototype),"remove",this).call(this),this.clear(),this.geojson=null,this.options=null}}])&&f(t.prototype,e),r&&f(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/flyinglineLayer",[],function(e,t,u,r,n,o){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function w(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function S(){return(S="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=C(e)););return e}(e,t);if(n)return n=Object.getOwnPropertyDescriptor(n,t),n.get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function j(e,t){return(j=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function O(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=C(r),t=(e=n?(e=C(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return L(t)}}function L(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function C(e){return(C=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}return e.exports=function(f){var d=f.THREE,e=f.Utils,n=e.mergeOptions,m=e.Chroma,t=e.deepClone,h=e.geojsonBBox,s=e.geojsonDissolve,p=e.geojsonFlatten,y=e.coordtransformCli,g=e.BASE_HEIGHT_SCALE,e=u("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/libs/flyinglineMeshLine")(d),b=e.MeshLine,o=e.MeshLineMaterial,c=u("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/config/lineStyle");var e=f.Layer,r=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");r.prototype=Object.create(e&&e.prototype,{constructor:{value:r,writable:!0,configurable:!0}}),Object.defineProperty(r,"prototype",{writable:!1}),e&&j(r,e);var i,a=O(l);function l(e,t){if(!(this instanceof l))throw new TypeError("Cannot call a class as a function");(r=a.call(this,e)).options=n({isSceneGroup:!1,sceneNames:[{sceneName:"main"}],visible:!0,renderOrder:17},e||{}),r.status=t,r.renderQueue=f.VOGO.Transparent,r.needsAutoUpdate=!0;var r,e=r.options.borderStyle.flyingLineStyle,t=(m("red").gl(),r.addMesh=r.addMesh.bind(L(r)),r.genGeojson=r.genGeojson.bind(L(r)),r.checkVisible=r.checkVisible.bind(L(r)),r.getLineTexture()),t=(r.material=o({resolution:new d.Vector2,sizeAttenuation:!1,side:d.DoubleSide,blending:d[e.blending],near:1,far:1e8,visibility:1,dashOffset0:0,dashOffset1:0,map:t,map1:null,uvScale0:new d.Vector2(1,1),depthWrite:!1,depthTest:!0,transparent:!0}),r.material.depthFunc=d.AlwaysDepth,r.material.uniforms.drawScale.value=f.drawScale,r.material.uniforms.USE_MAP=!0,r.material.map=t,r.material.uvScale0=new d.Vector2(1,1),r.material.uniforms.lineLengthMax.value=210,r.material.uniforms.lineLength.value=e.lineLength,r.material.uniforms.lineWidth.value=e.weight,m(e.strokeColor).gl()),e=(r.material.uniforms.lineColor.value=t,r.material.uniforms.lineHeadColor.value=t,r.material.uniforms.symbolColor.value=t,new d.Vector2);return f.engine.renderer.getDrawingBufferSize(e),r.material.uniforms.resolution.value=e,r.material.needsUpdate=!0,r}return r=l,(e=[{key:"traverse",value:function(t){this.group&&this.group.traverse&&this.group.traverse(function(e){(e instanceof d.Mesh||e instanceof d.InstancedMesh||e instanceof d.LineSegments||e instanceof d.Sprite)&&t&&t(e)})}},{key:"autoUpdate",value:function(){var e;this.options&&this.material&&(e=this.options.borderStyle.flyingLineStyle.lineSpeed,this.material.uniforms.dashOffset0.value+=.001*e)}},{key:"setGeojson",value:function(e){if(e&&e.features&&0!==e.features.length){for(var t,r,n={type:"FeatureCollection",features:[]},o={type:"FeatureCollection",features:[]},i=0;i<e.features.length;i++)(t=e.features[i]).geometry&&((r=t.properties).adcode&&"100000_JD"==r.adcode?n:o).features.push(t);o=p(Object.assign({},o)),p(o),(t={type:"Feature",properties:{},geometry:{}}).geometry=s(o);var a={type:"FeatureCollection",features:[]};for(a.features.push(t),i=0;i<n.features.length;i++)a.features.push(n.features[i]);this.geojson=a,this.genGeojson()}}},{key:"genGeojson",value:function(){this.clear();for(var e=f.baseHeightScale,t=f.lowHeightScale,r=f.drawScale,n=y.wgs84ToMecator(this.geojson,f.proj.proj),n=p(n),o={type:"FeatureCollection",features:[]},i={type:"FeatureCollection",features:[]},a=0;a<n.features.length;a++){var s,l,u=n.features[a];u.geometry&&(s=h(u),s=Math.max(Math.abs(s[2]-s[0]),Math.abs(s[3]-s[1]))/f.bboxSize*f.bboxLowHeightScale,(l=u.properties).adcode&&"100000_JD"==l.adcode?i.features.push(u):1<s&&o.features.push(u))}var c=this.options.borderStyle.flyingLineStyle;this.material.uniforms.drawScale.value=f.drawScale,this.material.uniforms.lineLength.value=c.lineLength,this.material.uniforms.lineWidth.value=c.weight,this.addMesh({geojson:o,height:r*g*(e+.015),lineType:this.getLineType(c.lineShape)}),this.addMesh({geojson:i,height:r*g*(e+.015)*t,lineType:this.getLineType(c.lineShape)}),this.checkVisible()}},{key:"addMesh",value:function(e){for(var t=e.geojson,r=e.height,n=e.lineType,o=new b,i=0;i<t.features.length;i++)for(var a,s=t.features[i].geometry.coordinates,l=[],u=(l.push.apply(l,v(s)),void 0),c=void 0,u=0;u<l.length;u++){for(var f=[],c=0;c<l[u].length;c++)a=l[u][c],f.push(a[0],a[1],r,a[0],a[1],r);var h,p,y=0;for(c=0;c<f.length-6;c+=6)h=[f[c],f[c+1]],p=[f[c+6],f[c+6+1]],y+=Math.sqrt(Math.pow(p[0]-h[0],2)+Math.pow(p[1]-h[1],2));0!=y&&o.setGeometry(f,{curveLen:y,isGeoUv:!1,lineColor:m("#fff").gl(),lineHeadColor:m("rgba(255,0,0,0)").gl(),symbolColor:m("rgba(255,0,0,0)").gl(),lineParams:{lineType:.01*n,blurWidthRatio:0,lineHeadSpaceRatio:0,lineTextureNum:.05},symbolParams:{symbolType:.01,symbolNum:.01,symbolAspect:.01}})}o.createGeometry(),this.material.needsUpdate=!0;e=new d.Mesh(o.geometry,this.material);e.meshType="1",e.frustumCulled=!1,this.add(e),e.renderOrder=this.options.renderOrder}},{key:"updateOptions",value:function(e){t(this.options);this.options=n(this.options,e||{});e=this.options.borderStyle.flyingLineStyle,this.material.uniforms.drawScale.value=f.drawScale,this.material.blending=d[e.blending],this.material.uniforms.lineLength.value=e.lineLength,this.material.uniforms.lineWidth.value=e.weight,e=m(e.strokeColor).gl();this.material.uniforms.lineColor.value=e,this.material.uniforms.lineHeadColor.value=e,this.material.uniforms.symbolColor.value=e,this.genGeojson(),this.checkVisible()}},{key:"checkVisible",value:function(){var e=this.options.borderStyle.flyingLineStyle;(this.options.visible&&e.show?S(C(l.prototype),"show",this):S(C(l.prototype),"hide",this)).call(this)}},{key:"show",value:function(){this.options.visible=!0;var e=this.options.borderStyle.flyingLineStyle;this.options.visible&&e.show&&S(C(l.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.options.visible=!1,S(C(l.prototype),"hide",this).call(this)}},{key:"destory",value:function(){S(C(l.prototype),"remove",this).call(this),this.clear(),this.needsAutoUpdate=!1,this.material&&this.material.dispose&&this.material.dispose(),this.options=null}},{key:"getLineType",value:function(e){var t=1;switch(e){case"线型1":t=1;break;case"线型2":t=2;break;case"线型3":t=3;break;case"线型4":t=4;break;case"线型5":t=5}return t}},{key:"getLineTexture",value:function(){var e,t,r=document.createElement("canvas"),n=(r.width=100,r.height=100,r.style.width="100px",r.style.height="100px",r.getContext("2d",this.status.screenshotEnable?{preserveDrawingBuffer:!0}:{})),o=20;for(e in c){for(var i,a=c[e],s={r:255,g:255,b:255,a:1},l=n.createLinearGradient(0,0,100,0),u=0;u<a.length;u++)i=a[u],l.addColorStop(i.percent,(t=i.percent,i=i.opacity,"rgba("+~~((s.r-s.r)*t+s.r)+","+~~((s.g-s.g)*t+s.g)+","+~~((s.b-s.b)*t+s.b)+","+i*s.a+")"));n.fillStyle=l,n.fillRect(0,100-o,100,20),o+=20}r=new d.CanvasTexture(r);return r.wrapS=d.RepeatWrapping,r.wrapT=d.RepeatWrapping,r}}])&&w(r.prototype,e),i&&w(r,i),Object.defineProperty(r,"prototype",{writable:!1}),l},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/lineLayer",[],function(e,t,l,r,o,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function u(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function g(){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O(e)););return e}(e,t);if(o)return o=Object.getOwnPropertyDescriptor(o,t),o.get?o.get.call(arguments.length<3?e:r):o.value}).apply(this,arguments)}function S(e,t){return(S=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function j(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=O(r),t=(e=o?(e=O(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return w(t)}}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}return e.exports=function(c){var f=c.THREE,e=c.Utils,o=e.mergeOptions,h=e.Chroma,r=e.deepClone,p=e.geojsonBBox,m=e.geojsonFlatten,y=e.coordtransformCli,d=e.BASE_HEIGHT_SCALE,e=l("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/libs/meshLine")(f),b=e.MeshLine,i=e.MeshLineMaterial,e=c.Layer,t=s;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&S(t,e);var n,a=j(s);function s(e){if(!(this instanceof s))throw new TypeError("Cannot call a class as a function");(t=a.call(this,e)).options=o({isSceneGroup:!1,sceneNames:[{sceneName:"main"}],visible:!0,renderOrder:17},e||{}),t.renderQueue=c.VOGO.Transparent,t.needsAutoUpdate=!0;var t,e=t.options.borderStyle.lineStyle,r=(h("red").gl(),t.mappingData=[],t.mappingDataMap={},t.addMesh=t.addMesh.bind(w(t)),t.genGeojson=t.genGeojson.bind(w(t)),t.checkVisible=t.checkVisible.bind(w(t)),t.lockVisibleStatus=!1,t.material=i({resolution:new f.Vector2,sizeAttenuation:!1,side:f.DoubleSide,near:1,far:1e8,visibility:1,dashOffset0:0,dashOffset1:0,map:null,map1:null,uvScale0:new f.Vector2(1,1)}),new f.Vector2),r=(c.engine.renderer.getSize(r),t.material.uniforms.resolution.value=r,t.material.uniforms.USE_MAP=!1,t.material.uniforms.drawScale.value=c.drawScale,t.material.uniforms.lineLengthMax.value=110,t.material.uniforms.lineLength.value=100,t.material.uniforms.lineWidth.value=e.weight,h(e.strokeColor).gl());return t.material.uniforms.lineColor.value=r,t.material.uniforms.lineHeadColor.value=r,t.material.uniforms.symbolColor.value=r,t.material.needsUpdate=!0,t}return t=s,(e=[{key:"traverse",value:function(t){this.group&&this.group.traverse&&this.group.traverse(function(e){(e instanceof f.Mesh||e instanceof f.InstancedMesh||e instanceof f.LineSegments||e instanceof f.Sprite)&&t&&t(e)})}},{key:"setGeojson",value:function(e){this.geojson=e||{type:"FeatureCollection",features:[]};for(var t,r={type:"FeatureCollection",features:[]},o=0;o<this.geojson.features.length;o++)!(t=this.geojson.features[o]).geometry||"Polygon"!=t.geometry.type&&"MultiPolygon"!=t.geometry.type||r.features.push(t);this.geojson=r,this.genGeojson()}},{key:"render",value:function(e){var t;this.mappingData=e||[],this.mappingDataMap={};for(var r=0;r<e.length;r++)t=e[r],this.mappingDataMap[t.area_id]=t;this.geojson&&this.genGeojson()}},{key:"genGeojson",value:function(){this.clear();for(var e=c.baseHeightScale,t=c.lowHeightScale,r=c.drawScale,o=y.wgs84ToMecator(this.geojson,c.proj.proj),o=m(o),i={type:"FeatureCollection",features:[]},n={type:"FeatureCollection",features:[]},a=0;a<o.features.length;a++){var s,l,u=o.features[a];u.geometry&&(s=p(u),s=Math.max(Math.abs(s[2]-s[0]),Math.abs(s[3]-s[1]))/c.bboxSize*c.bboxLowHeightScale,((!(l=u.properties).adcode||"100000_JD"!=l.adcode)&&1<s?i:n).features.push(u))}this.addMesh({geojson:i,height:r*d*(e+.01)}),this.addMesh({geojson:n,height:r*d*(e+.01)*t}),this.checkVisible()}},{key:"addMesh",value:function(e){for(var t=e.geojson,r=e.height,o=new b,i=0;i<t.features.length;i++)for(var n,a=t.features[i].geometry.coordinates,s=[],l=(s.push.apply(s,v(a)),void 0),u=void 0,l=0;l<s.length;l++){for(var c=[],u=0;u<s[l].length;u++)n=s[l][u],c.push(n[0],n[1],r,n[0],n[1],r);o.setGeometry(c,{curveLen:226392,isGeoUv:!1,lineColor:h("#fff").gl(),lineHeadColor:h("rgba(255,0,0,0)").gl(),symbolColor:h("rgba(255,0,0,0)").gl(),lineParams:{lineType:.01,blurWidthRatio:0,lineHeadSpaceRatio:0,lineTextureNum:.01},symbolParams:{symbolType:.01,symbolNum:.01,symbolAspect:.01}})}o.createGeometry(),this.material.needsUpdate=!0;e=new f.Mesh(o.geometry,this.material);e.meshType="1",e.frustumCulled=!1,this.add(e),e.renderOrder=this.options.renderOrder}},{key:"autoUpdate",value:function(){this.material&&(this.material.uniforms.dashOffset0.value+=.015,this.material.uniforms.dashOffset0.value%=1,this.material.uniforms.dashOffset1.value=this.material.uniforms.dashOffset0.value)}},{key:"updateOptions",value:function(e){r(this.options);this.options=o(this.options,e||{});var e=this.options.borderStyle.lineStyle,t=(c.baseHeightScale,c.drawScale),t=(this.material.uniforms.drawScale.value=t,this.material.uniforms.lineLengthMax.value=110,this.material.uniforms.lineLength.value=100,this.material.uniforms.lineWidth.value=e.weight,h(e.strokeColor).gl());e.show||(t[3]=0),this.material.uniforms.lineColor.value=t,this.material.uniforms.lineHeadColor.value=t,this.material.uniforms.symbolColor.value=t,this.genGeojson(),this.checkVisible()}},{key:"checkVisible",value:function(){this.lockVisibleStatus||(this.options.visible?g(O(s.prototype),"show",this):g(O(s.prototype),"hide",this)).call(this)}},{key:"show",value:function(){this.lockVisibleStatus||(this.options.visible=!0,this.options.visible&&g(O(s.prototype),"show",this).call(this))}},{key:"hide",value:function(){this.lockVisibleStatus||(this.options.visible=!1,g(O(s.prototype),"hide",this).call(this))}},{key:"changeLockVisibleStatus",value:function(e){this.lockVisibleStatus=e}},{key:"destroy",value:function(){g(O(s.prototype),"remove",this).call(this),this.clear(),this.needsAutoUpdate=!1,this.material&&this.material.dispose&&this.material.dispose(),this.options=null}}])&&u(t.prototype,e),n&&u(t,n),Object.defineProperty(t,"prototype",{writable:!1}),s},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/extrudeLayer",[],function(e,i,l,t,a,s){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function d(e,i){for(var t=0;t<i.length;t++){var a=i[t];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function h(){return(h="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,i,t){var a=function(e,i){for(;!Object.prototype.hasOwnProperty.call(e,i)&&null!==(e=y(e)););return e}(e,i);if(a)return a=Object.getOwnPropertyDescriptor(a,i),a.get?a.get.call(arguments.length<3?e:t):a.value}).apply(this,arguments)}function c(e,i){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,i){return e.__proto__=i,e})(e,i)}function g(t){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,i=y(t),i=(e=a?(e=y(this).constructor,Reflect.construct(i,arguments,e)):i.apply(this,arguments),this);if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return w(i)}}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}return e.exports=function(M){var b=M.THREE,e=M.Utils,p=e.Chroma,v=e.mergeOptions,f=e.deepClone,x=e.BASE_HEIGHT_SCALE,m=(new b.TextureLoader).setCrossOrigin("*"),o=1e4,u=.01;function s(e){for(var i=e.tilesOptions,a=e.baseUrl,s=i.tiles,n=i.bboxProj,l=i.tileBboxProj,p=i.minCol,m=i.maxCol,u=i.minRow,v=i.maxRow,r=[],f=256,d=256,t=0;t<s.length;t++)!function(e){var t=s[e],e=new Promise(function(i,e){fetch(/(http:\/\/)|(https:\/\/)/.test(t.url)?t.url:a+t.url).then(function(e){e.blob().then(function(e){createImageBitmap(e).then(function(e){f=e.width,d=e.height,t.imageBitmap=e,i(t)})})})});r.push(e)}(t);return Promise.all(r).then(function(e){for(var i=new OffscreenCanvas((m-p+1)*f*n.size.x/l.size.x,(v-u+1)*d*n.size.y/l.size.y).getContext("2d"),t=0;t<e.length;t++){var a=e[t],s=(a.tileX-p)*f-Math.abs(n.leftTop[0]-l.leftTop[0])*(m-p+1)*f/l.size.x,r=(a.tileY-u)*d-Math.abs(n.leftTop[1]-l.leftTop[1])*(v-u+1)*d/l.size.y;i.drawImage(a.imageBitmap,s,r,f,d)}var o=i.getImageData(0,0,(m-p+1)*f*n.size.x/l.size.x,(v-u+1)*d*n.size.y/l.size.y);return o.data=new Uint8Array(o.data),o}).catch(function(e){})}var t=new b.Clock,e=M.Layer,i=n;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&c(i,e);var a,r=g(n);function n(e,i){var t;if(this instanceof n)return(t=r.call(this)).options=v({},e||{}),t.status=i,t.renderQueue=M.VOGO.Geometry,t.needsAutoUpdate=!0,t.group.ignoreWaterReflection=!1,t.group.userData=v(t.group.userData,{layerName:"extrudeTerrain"}),t.initTopMaterial=t.initTopMaterial.bind(w(t)),t.initTopFillMaterial=t.initTopFillMaterial.bind(w(t)),t.initSideMaterial=t.initSideMaterial.bind(w(t)),t.initSideLightMaterial=t.initSideLightMaterial.bind(w(t)),t.updateTopMaterial=t.updateTopMaterial.bind(w(t)),t.updateTopFillMaterial=t.updateTopFillMaterial.bind(w(t)),t.updateSideMaterial=t.updateSideMaterial.bind(w(t)),t.updateSideLightMaterial=t.updateSideLightMaterial.bind(w(t)),t.draw=t.draw.bind(w(t)),t.getTiles=t.getTiles.bind(w(t)),t.checkVisible=t.checkVisible.bind(w(t)),t.materialTop=t.initTopMaterial(),t.materialTopFill=t.initTopFillMaterial(),t.materialSide=t.initSideMaterial(""),t.materialSideUV=t.initSideMaterial("uv"),t.materialSideLight=t.initSideLightMaterial(),t;throw new TypeError("Cannot call a class as a function")}return i=n,(e=[{key:"traverse",value:function(i){this.group&&this.group.traverse&&this.group.traverse(function(e){(e instanceof b.Mesh||e instanceof b.InstancedMesh||e instanceof b.LineSegments||e instanceof b.Sprite)&&i&&i(e)})}},{key:"autoUpdate",value:function(){var e,i,a,s,r;this.options&&(i=(e=this.options).visible,a=e.sideTexture,s=e.sideLight,i&&(r=t.getDelta(),this.traverse(function(e){var i,t;e&&e.meshType&&("meshSideUV"==e.meshType&&1==e.mainArea?!(t=a.emissive).show||0==t.uvSpeedX&&0==t.uvSpeedY||((i=e.material).uniforms.time.value+=5*r,i.uniforms.uvOffset.value.x>o||i.uniforms.uvOffset.value.x<-o?i.uniforms.uvOffset.value.x=0:i.uniforms.uvOffset.value.x-=.01*t.uvSpeedX*.01,i.uniforms.uvOffset.value.y>o||i.uniforms.uvOffset.value.y<-o?i.uniforms.uvOffset.value.y=0:i.uniforms.uvOffset.value.y-=.01*t.uvSpeedY*.01):"meshSideLight"!=e.meshType||!(i=s.emissive).show||0==i.uvSpeedX&&0==i.uvSpeedY||((t=e.material).uniforms.time.value+=5*r,t.uniforms.uvOffset.value.x>o||t.uniforms.uvOffset.value.x<-o?t.uniforms.uvOffset.value.x=0:t.uniforms.uvOffset.value.x-=.01*i.uvSpeedX*.01,t.uniforms.uvOffset.value.y>o||t.uniforms.uvOffset.value.y<-o?t.uniforms.uvOffset.value.y=0:t.uniforms.uvOffset.value.y-=.01*i.uvSpeedY*.01))})))}},{key:"bboxProj",value:function(e){var i=Math.min(e[0],e[2]),t=Math.max(e[0],e[2]),a=Math.min(e[1],e[3]),e=Math.max(e[1],e[3]),i=M.proj.proj([i,a,0]),a=M.proj.proj([t,e,0]);return[i[0],i[2],a[0],a[2]]}},{key:"render",value:function(e){var i=e.bbox,e=e.extrudeAttributes,i=(this.options.bbox=i,this.draw(e),this.options.topTexture),e=i.map,i=i.normal;e.show&&e.mapUrl&&-1<e.mapUrl.indexOf("{x}")&&-1<e.mapUrl.indexOf("{y}")&&-1<e.mapUrl.indexOf("{z}")&&this.getTiles({material:this.materialTop,imageType:"map",tilesOptions:this.getTilesOptions(e.mapUrl,this.options.bbox)}),i.show&&-1<i.normalMap.indexOf("{x}")&&-1<i.normalMap.indexOf("{y}")&&-1<i.normalMap.indexOf("{z}")&&this.getTiles({material:this.materialTop,imageType:"normalMap",tilesOptions:this.getTilesOptions(i.normalMap,this.options.bbox)}),this.checkVisible()}},{key:"draw",value:function(e){this.clear();for(var i=this.options,t=i.terrainHeight,a=i.sideTexture,s=i.lowHeightScale,r=i.sideLight,o=t.baseHeightScale,n=a.castShadow,l=0,p=0,m=0,u=0,v=0;v<e.groups.length;v+=5){l+=m,p+=u;var f=e.groups[v],d=e.groups[v+1],h=e.groups[v+2],m=e.groups[v+3],u=e.groups[v+4],c=M.drawScale*x;switch(1===f&&(c=d?c:c*s),h){case 0:var g={indices:e.indices.slice(l,+(l+m)),positions:e.positions.slice(3*p,3*(p+u)),normals:e.normals.slice(3*p,3*(p+u)),uvs:e.uvs.slice(2*p,2*(p+u))},g=this.genBufferGeometry(g),w=new b.Mesh(g,this.materialTop),w=(w.position.z=c*o,w.ignoreWaterReflection=!0,w.meshType="meshTop",w.mainArea=d,this.add(w),w.renderOrder=7,new b.Mesh(g,this.materialTopFill));w.position.z=c*(o+.002),w.ignoreWaterReflection=!0,w.meshType="meshTopFill",w.mainArea=d,this.add(w),w.renderOrder=8;break;case 1:var g={indices:e.indices.slice(l,+(l+m)),positions:e.positions.slice(3*p,3*(p+u)),normals:e.normals.slice(3*p,3*(p+u)),uvs:e.uvs.slice(2*p,2*(p+u)),fAttr0:e.fAttr0.slice(2*p,2*(p+u))},w=this.genBufferGeometry(g),y=(this.materialSideUV.uniforms.drawScale.value=M.drawScale,new b.Mesh(w,this.materialSideUV));y.scale.z=c*o,y.position.z=0,y.ignoreWaterReflection=!n,y.waterReflection=!0,y.meshType="meshSideUV",y.mainArea=d,this.add(y),y.renderOrder=9;break;case 2:if(0===d)break;var y={indices:e.indices.slice(l,+(l+m)),positions:e.positions.slice(3*p,3*(p+u)),normals:e.normals.slice(3*p,3*(p+u)),uvs:e.uvs.slice(2*p,2*(p+u)),fAttr0:e.fAttr0.slice(2*p,2*(p+u))},S=this.genBufferGeometry(y),T=(this.materialSideLight.uniforms.drawScale.value=M.drawScale*(null!=(T=r.widthScale)?T:1),new b.Mesh(S,this.materialSideLight));T.scale.z=c*o*r.heightScale,T.position.z=c*(o*r.bottomElevation),T.ignoreWaterReflection=!r.openShadow,T.meshType="meshSideLight",T.userData={height:c*o},T.mainArea=d,this.add(T),T.renderOrder=1e4}}}},{key:"genBufferGeometry",value:function(e,i){var t=new b.BufferGeometry;return t.setAttribute||(t.setAttribute=t.addAttribute),t.setIndex(new b.BufferAttribute(new Uint32Array(e.indices),1)),t.setAttribute("position",new b.BufferAttribute(new Float32Array(e.positions),3)),t.setAttribute("normal",new b.BufferAttribute(new Float32Array(e.normals),3)),t.setAttribute("uv",new b.BufferAttribute(new Float32Array(e[i||"uvs"]),2)),t.computeBoundingSphere(),t.computeBoundingBox(),t}},{key:"updateOptions",value:function(e){var i=f(this.options),e=(this.options=v(this.options,e||{}),f(i.topTexture)),t=f(i.sideTexture),a=f(i.sideLight),s=this.options,r=s.terrainHeight,o=s.topTexture,n=s.sideTexture,l=s.sideLight,p=r.baseHeightScale,m=r.lowHeightScale,u=(e.metalness==o.metalness&&e.roughness==o.roughness&&e.color==o.color&&e.map.show==o.map.show&&e.map.mapUrl===o.map.mapUrl&&e.normal.show==o.normal.show&&e.normal.normalMap==o.normal.normalMap&&e.normal.normalScale==o.normal.normalScale&&e.emissive.show==o.emissive.show&&e.emissive.emissive==o.emissive.emissive&&e.emissive.emissiveMap==o.emissive.emissiveMap&&e.emissive.emissiveIntensity==o.emissive.emissiveIntensity||this.updateTopMaterial(this.materialTop,i,this.options),e.mapFill.show==o.mapFill.show&&e.mapFill.color==o.mapFill.color&&e.mapFill.map==o.mapFill.map||this.updateTopFillMaterial(this.materialTopFill,i,this.options),e.map==o.map&&t.color==n.color&&t.map==n.map&&t.uvTexture.show==n.uvTexture.show&&t.uvTexture.map==n.uvTexture.map&&t.emissive.show==n.emissive.show&&t.emissive.emissive==n.emissive.emissive&&t.emissive.emissiveMap==n.emissive.emissiveMap&&t.emissive.emissiveIntensity==n.emissive.emissiveIntensity&&t.emissive.uvSpeedX==n.emissive.uvSpeedX&&t.emissive.uvSpeedY==n.emissive.uvSpeedY||(this.updateSideMaterial(this.materialSide,"",i,this.options),this.updateSideMaterial(this.materialSideUV,"uv",i,this.options)),a.show==l.show&&a.color==l.color&&a.map==l.map&&a.emissive.show==l.emissive.show&&a.emissive.emissive==l.emissive.emissive&&a.emissive.emissiveMap==l.emissive.emissiveMap&&a.emissive.emissiveIntensity==l.emissive.emissiveIntensity&&a.emissive.uvSpeedX==a.emissive.uvSpeedX&&a.emissive.uvSpeedY==a.emissive.uvSpeedY||this.updateSideLightMaterial(this.materialSideLight,i,this.options),a.heightScale==l.heightScale&&a.openShadow==l.openShadow&&a.bottomElevation==l.bottomElevation&&a.widthScale===l.widthScale||this.traverse(function(e){var i=M.drawScale*x;0===e.mainArea&&(i*=m),"meshSideLight"===e.meshType&&(e.scale.z=e.userData.height*l.heightScale,e.position.z=i*(p*l.bottomElevation),e.ignoreWaterReflection=!l.openShadow,e.material.uniforms.drawScale.value=M.drawScale*(null!=(i=l.widthScale)?i:1))}),i.terrainHeight.baseHeightScale==p&&i.terrainHeight.lowHeightScale==m||this.traverse(function(e){var i=M.drawScale*x;switch(0===e.mainArea&&(i*=m),e.meshType){case"meshTop":e.position.z=i*p;break;case"meshTopFill":e.position.z=i*(p+.002);break;case"meshSide":case"meshSideUV":e.scale.z=i*p;break;case"meshSideLight":e.scale.z=i*p*l.heightScale,e.position.z=i*(p*l.bottomElevation)}}),n.castShadow);i.sideTexture.castShadow!=u&&this.traverse(function(e){switch(e.meshType){case"meshSide":case"meshSideUV":e.ignoreWaterReflection=!u;break;case"meshSideLight":e.ignoreWaterReflection=!u||!l.openShadow;break;default:e.ignoreWaterReflection=!0}}),this.checkVisible()}},{key:"textureLoaderFun",value:function(e,i,t,a){var s=null;return e&&((s=m.load(e)).wrapS=s.wrapT=b.RepeatWrapping,s.repeat.set(i,t),s.anisotropy=a),s}},{key:"initTopMaterial",value:function(){var i=new b.MeshStandardMaterial({transparent:!0,depthWrite:!0,depthTest:!0}),e=this.options.topTexture,t=e.metalness,a=e.roughness,s=e.color,r=e.map,o=e.normal,e=e.emissive,t=(i.metalness=t*u,i.roughness=a*u,p(s).gl()),a=(e.show?p(e.emissive):p("#fff")).gl(),s=t[3];return e.show&&(s*=a[3]),i.opacity=s,i.color=new b.Color(t[0],t[1],t[2]),!r.show||!r.mapUrl||-1<r.mapUrl.indexOf("{x}")&&-1<r.mapUrl.indexOf("{y}")&&-1<r.mapUrl.indexOf("{z}")?i.map=null:m.load(r.mapUrl,function(e){e.wrapS=e.wrapT=b.RepeatWrapping,e.repeat.set(1,1),e.anisotropy=20,i.map=e,i.needsUpdate=!0}),o.show&&o.normalMap?(-1<o.normalMap.indexOf("{x}")&&-1<o.normalMap.indexOf("{y}")&&-1<o.normalMap.indexOf("{z}")?i.normalMap=null:m.load(o.normalMap,function(e){e.wrapS=e.wrapT=b.RepeatWrapping,e.repeat.set(1,1),e.anisotropy=20,i.normalMap=e,i.needsUpdate=!0}),s=.1*o.normalScale,i.normalScale=new b.Vector2(s,s)):(i.normalMap=null,i.normalScale=null),e.show?(i.emissive=new b.Color(a[0],a[1],a[2]),e.emissiveMap&&-1<e.emissiveMap.indexOf("{x}")&&-1<e.emissiveMap.indexOf("{y}")&&-1<e.emissiveMap.indexOf("{z}")?i.emissiveMap=null:m.load(e.emissiveMap,function(e){e.wrapS=e.wrapT=b.RepeatWrapping,e.repeat.set(1,1),e.anisotropy=20,i.emissiveMap=e,i.needsUpdate=!0}),i.emissiveIntensity=e.emissiveIntensity*u):(i.emissive=new b.Color("#000"),i.emissiveMap=null,i.emissiveIntensity=0),i.onBeforeCompile=function(e){e.vertexShader=l("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/meshTop_vert.glsl"),e.fragmentShader=l("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/meshTop_frag.glsl"),this.userData.shader=e},i.needsUpdate=!0,i}},{key:"getTilesOptions",value:function(e,i){for(var t={leftTop:M.proj.proj([i[0],i[3],0]),rightBottm:M.proj.proj([i[2],i[1],0]),size:{x:0,y:0},maxSize:0},a=(t.size={x:Math.abs(t.rightBottm[0]-t.leftTop[0]),y:Math.abs(t.rightBottm[1]-t.leftTop[1])},t.maxSize=Math.max(t.size.x,t.size.y),~~(40075016.68/t.maxSize)||6),s=0;s<21;s++)if(a>=Math.pow(2,s)&&a<Math.pow(2,s+1)){a=s+3;break}for(var r=M.TileLnglatTransform._lngToTileX(i[0],a=12<a?12:a),o=M.TileLnglatTransform._lngToTileX(i[2],a),n=M.TileLnglatTransform._latToTileY(i[3],a),l=M.TileLnglatTransform._latToTileY(i[1],a),i={leftTop:M.TileLnglatTransform.pixelToLnglat(0,0,r,n,a),rightBottom:M.TileLnglatTransform.pixelToLnglat(256,256,o,l,a)},i={leftTop:M.proj.proj([i.leftTop.lng,i.leftTop.lat,0]),rightBottom:M.proj.proj([i.rightBottom.lng,i.rightBottom.lat,0]),size:{x:0,y:0}},p=(i.size={x:Math.abs(i.rightBottom[0]-i.leftTop[0]),y:Math.abs(i.rightBottom[1]-i.leftTop[1])},[]),m=r;m<=o;m++)for(var u,v=n;v<=l;v++)0<=m&&0<=v&&m<Math.pow(2,a)&&v<Math.pow(2,a)&&(u={url:e.replace("{x}",m).replace("{y}",v).replace("{z}",a),tileX:m,tileY:v,zoom:a},p.push(u));return{bboxProj:t,tileBboxProj:i,minCol:r,maxCol:o,minRow:n,maxRow:l,tiles:p}}},{key:"getTiles",value:function(e){var t=e.material,a=e.imageType,i=e.tilesOptions;M.workerFarm.createWorkerPool({}).startTask().then(function(e){e.postMessage({command:"EXECUTE-FUNCTION",data:{func:s,params:{imageType:"map",tilesOptions:i,baseUrl:window.location.origin}}}).then(function(e){var i=new b.DataTexture(e.data,e.width,e.height,b.RGBAFormat);switch(i.wrapS=i.wrapT=b.RepeatWrapping,i.magFilter=b.LinearFilter,i.minFilter=b.LinearFilter,i.flipY=!0,i.repeat.set(1,1),a){case"map":t.map=i;break;case"normalMap":t.normalMap=i;break;case"emissiveMap":t.emissiveMap=i}t.opacity=1,t.needsUpdate=!0})})}},{key:"updateTopMaterial",value:function(i,e,t){var e=f(e.topTexture),t=t.topTexture,a=t.metalness,s=t.roughness,r=t.color,o=t.map,n=t.normal,t=t.emissive,a=(e.metalness!=a&&(i.metalness=a*u),e.roughness!=s&&(i.roughness=s*u),p(r).gl()),s=(t.show?p(t.emissive):p("#fff")).gl(),l=a[3];t.show&&(l*=s[3]),e.color==r&&e.emissive.show==t.show&&e.emissive.emissive==t.emissive||(i.opacity=l,i.color=new b.Color(a[0],a[1],a[2])),o.mapUrl&&o.show?(e.map.mapUrl!=o.mapUrl&&o.mapUrl||!e.map.show)&&(i.opacity=.5,-1<o.mapUrl.indexOf("{x}")&&-1<o.mapUrl.indexOf("{y}")&&-1<o.mapUrl.indexOf("{z}")?this.getTiles({material:i,imageType:"map",tilesOptions:this.getTilesOptions(o.mapUrl,this.options.bbox)}):m.load(o.mapUrl,function(e){i.opacity=l,e.wrapS=e.wrapT=b.RepeatWrapping,e.repeat.set(1,1),e.anisotropy=1,i.map=e,i.needsUpdate=!0})):i.map=null,e.normal.show==n.show&&e.normal.normalMap==n.normalMap&&e.normal.normalScale==n.normalScale||(n.show&&n.normalMap?(n.normalMap&&-1<n.normalMap.indexOf("{x}")&&-1<n.normalMap.indexOf("{y}")&&-1<n.normalMap.indexOf("{z}")?this.getTiles({material:i,imageType:"normalMap",tilesOptions:this.getTilesOptions(n.normalMap,this.options.bbox)}):m.load(n.normalMap,function(e){e.wrapS=e.wrapT=b.RepeatWrapping,e.repeat.set(1,1),e.anisotropy=20,i.normalMap=e,i.needsUpdate=!0}),r=.1*n.normalScale,i.normalScale=new b.Vector2(r,r)):(i.normalMap=null,i.normalScale=null)),e.emissive.show==t.show&&e.emissive.emissive==t.emissive&&e.emissive.emissiveMap==t.emissiveMap&&e.emissive.emissiveIntensity==t.emissiveIntensity||(t.show?(i.emissive=new b.Color(s[0],s[1],s[2]),t.emissiveMap&&-1<t.emissiveMap.indexOf("{x}")&&-1<t.emissiveMap.indexOf("{y}")&&-1<t.emissiveMap.indexOf("{z}")?this.getTiles({material:i,imageType:"emissiveMap",tilesOptions:this.getTilesOptions(t.emissiveMap,this.options.bbox)}):m.load(t.emissiveMap,function(e){e.wrapS=e.wrapT=b.RepeatWrapping,e.repeat.set(1,1),e.anisotropy=20,i.emissiveMap=e,i.needsUpdate=!0}),i.emissiveIntensity=t.emissiveIntensity*u):(i.emissive=new b.Color("#fff"),i.emissiveMap=null,i.emissiveIntensity=0)),i.needsUpdate=!0}},{key:"initTopFillMaterial",value:function(){var e,i=new b.MeshStandardMaterial({transparent:!0,depthWrite:!0,depthTest:!0}),t=this.options.topTexture.mapFill;return t.show&&t.color&&t.map?(e=p(t.color).gl(),i.opacity=e[3],i.color=new b.Color(e[0],e[1],e[2]),i.map=this.textureLoaderFun(t.map,1,1,20)):(i.opacity=0,i.color=new b.Color("#000"),i.map=null),i}},{key:"updateTopFillMaterial",value:function(e,i,t){var a,t=t.topTexture.mapFill;t.show?(a=p(t.color).gl(),e.opacity=a[3],e.color=new b.Color(a[0],a[1],a[2]),i.topTexture.mapFill.map==t.map&&i.topTexture.mapFill.show===t.show||(e.map=this.textureLoaderFun(t.map,1,1,20))):(e.opacity=0,e.color=new b.Color("#000"),e.map=null),e.needsUpdate=!0}},{key:"initSideMaterial",value:function(e){var i=this.options,i=(i.topTexture,i.sideTexture),t=i.color,a=i.emissive,i=i.uvTexture,s=b.UniformsUtils,r=b.UniformsLib,s=new b.ShaderMaterial({uniforms:s.merge([r.common,r.emissivemap,r.fog,{roughness:{value:1},metalness:{value:0},time:{value:1},opacity:{value:1},diffuse:{value:new b.Color("#fff")},map:{value:i.map?m.load(i.map):null},emissive:{value:new b.Color("#fff")},emissiveMap:{value:a.emissiveMap?m.load(a.emissiveMap):null},emissiveIntensity:{value:1},uvOffset:{value:{x:0,y:0}},drawScale:{value:M.drawScale}}]),defines:{PHYSICAL:!0,USE_UV:!0,USE_MAP:!0,USE_EMISSIVEMAP:!0,USE_FOG:!1,FLAT_SHADED:!0},vertexShader:l("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/side_vert.glsl"),fragmentShader:l("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/side_frag.glsl"),transparent:!0}),r=p(t).gl(),t=p(a.emissive).gl(),i=m.load(i.map),i=(i.wrapS=i.wrapT=b.RepeatWrapping,i.repeat.set(1,1),s.uniforms.map.value=i,s.uniforms.diffuse.value=new b.Color(r[0],r[1],r[2]),s.uniforms.emissive.value=new b.Color(t[0],t[1],t[2]),m.load(a.emissiveMap));return i.wrapS=i.wrapT=b.RepeatWrapping,i.repeat.set(1,1),s.uniforms.emissiveMap.value=i,s.uniforms.emissiveIntensity.value=a.emissiveIntensity*u,s.uniforms.uvOffset.value.x=a.uvSpeedX*u,s.uniforms.uvOffset.value.y=a.uvSpeedY*u,s}},{key:"updateSideMaterial",value:function(e,i,t,a){var a=a.sideTexture,s=a.metalness,r=a.roughness,o=a.color,n=a.emissive,a=a.uvTexture,s=(e.uniforms.metalness.value=s*u,e.uniforms.roughness.value=r*u,p(o).gl()),r=p(n.emissive).gl(),o=(e.uniforms.diffuse.value=new b.Color(s[0],s[1],s[2]),e.uniforms.emissive.value=new b.Color(r[0],r[1],r[2]),e.uniforms.emissiveIntensity.value=n.show?n.emissiveIntensity*u:0,e.uniforms.uvOffset.value.x=n.uvSpeedX*u,e.uniforms.uvOffset.value.y=n.uvSpeedY*u,m.load(a.map)),s=(o.wrapS=o.wrapT=b.RepeatWrapping,o.repeat.set(1,1),e.uniforms.map.value=o,m.load(n.emissiveMap));s.wrapS=s.wrapT=b.RepeatWrapping,s.repeat.set(1,1),e.uniforms.emissiveMap.value=s}},{key:"initSideLightMaterial",value:function(){var e=this.options.sideLight,i=e.color,t=e.map,a=e.emissive,s=b.UniformsUtils,r=b.UniformsLib,s=new b.ShaderMaterial({uniforms:s.merge([r.common,r.emissivemap,r.fog,{roughness:{value:1},metalness:{value:0},time:{value:1},opacity:{value:1},diffuse:{value:new b.Color("#fff")},map:{value:t?m.load(t):null},emissive:{value:new b.Color("#fff")},emissiveMap:{value:a.emissiveMap?m.load(a.emissiveMap):null},emissiveIntensity:{value:1},uvOffset:{value:{x:0,y:0}},drawScale:{value:M.drawScale}}]),defines:{PHYSICAL:!0,USE_UV:!0,USE_MAP:!0,USE_EMISSIVEMAP:!0,USE_FOG:!1,FLAT_SHADED:!0},vertexShader:l("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/sideLight_vert.glsl"),fragmentShader:l("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/shader/sideLight_frag.glsl"),side:b.DoubleSide,depthWrite:!1,depthTest:!0,transparent:!0}),r=m.load(t),t=(r.wrapS=r.wrapT=b.RepeatWrapping,r.repeat.set(1,1),s.uniforms.map.value=r,p(i).gl()),r=p(a.emissive).gl(),i=t[3],e=(a.show?i*=r[3]:i=0,s.uniforms.opacity.value=e.show?i:0,s.uniforms.diffuse.value=new b.Color(t[0],t[1],t[2]),s.uniforms.emissive.value=new b.Color(r[0],r[1],r[2]),m.load(a.emissiveMap));return e.wrapS=e.wrapT=b.RepeatWrapping,e.repeat.set(1,1),s.uniforms.emissiveMap.value=e,s.uniforms.emissiveIntensity.value=a.emissiveIntensity*u,s.uniforms.uvOffset.value.x=a.uvSpeedX*u,s.uniforms.uvOffset.value.y=a.uvSpeedY*u,s}},{key:"updateSideLightMaterial",value:function(e,i,t){var a,t=t.sideLight,s=t.show,r=t.color,o=t.map,t=t.emissive;s?(s=p(r).gl(),r=p(t.emissive).gl(),a=s[3],t.show&&(a*=r[3]),e.uniforms.opacity.value=a,(a=m.load(o)).wrapS=a.wrapT=b.RepeatWrapping,a.repeat.set(1,1),e.uniforms.map.value=a,e.uniforms.diffuse.value=new b.Color(s[0],s[1],s[2]),e.uniforms.emissive.value=new b.Color(r[0],r[1],r[2]),(o=m.load(t.emissiveMap)).wrapS=o.wrapT=b.RepeatWrapping,o.repeat.set(1,1),e.uniforms.emissiveMap.value=o,e.uniforms.emissiveIntensity.value=t.show?t.emissiveIntensity*u:0):e.uniforms.opacity.value=0}},{key:"checkVisible",value:function(){(this.options.visible?h(y(n.prototype),"show",this):h(y(n.prototype),"hide",this)).call(this)}},{key:"show",value:function(){this.options.visible=!0,h(y(n.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.options.visible=!1,h(y(n.prototype),"hide",this).call(this)}},{key:"destroy",value:function(){h(y(n.prototype),"remove",this).call(this),this.clear(),this.needsAutoUpdate=!1,this.materialTop&&this.materialTop.dispose(),this.materialTopFill&&this.materialTopFill.dispose(),this.materialSide&&this.materialSide.dispose(),this.materialSideLight&&this.materialSideLight.dispose(),this.options=null}}])&&d(i.prototype,e),a&&d(i,a),Object.defineProperty(i,"prototype",{writable:!1}),n},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/dynamicDecoration/config",[],function(e,a,r,n,t,c){return e.exports={DEFAULT_OPTIONS:{isSceneGroup:!1,sceneNames:[{sceneName:"main"}],visible:!0,opacity:50,rotateSpeed:10,renderOrder:20}},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/dynamicDecoration/dynamicDecorationLayer",[],function(e,t,i,o,n,s){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var i=0;i<t.length;i++){var o=t[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(o)return o=Object.getOwnPropertyDescriptor(o,t),o.get?o.get.call(arguments.length<3?e:i):o.value}).apply(this,arguments)}function y(e,t){return(y=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(i){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(i),t=(e=o?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}return e.exports=function(r){var p=r.THREE,e=r.Utils,a=e.BASE_HEIGHT_SCALE,u=e.mergeOptions,h=e.Chroma,m=e.deepClone,f=(new p.TextureLoader).setCrossOrigin("*"),n=0,e=r.Layer,t=s;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&y(t,e);var i,o=v(s);function s(e){var t;if(!(this instanceof s))throw new TypeError("Cannot call a class as a function");(t=o.call(this)).options=u({},e),t.data=null,t.renderQueue=r.VOGO.Transparent,t.needsAutoUpdate=!0,t.material=t.initMaterial();t.options.renderOrder;e=new p.PlaneBufferGeometry(1,1,1,1),e=t.mesh=new p.Mesh(e,t.material);return e.position.x=0,e.position.y=0,e.position.z=0,e.rotation.x=0,e.frustumCulled=!1,e.needsUpdate=!0,t.add(e),e.renderOrder=1e6,t}return t=s,(e=[{key:"render",value:function(){var e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:this.data,t=(this.data=e).center,e=e.size,i=(this.options.size=e,this.options),o=i.scale,i=i.baseHeightScale_dynamic,n=r.drawScale,s=r.baseHeightScale,n=(r.baseHeightScale_background,n*a*(s*(void 0===i?.02:i)+.02));this.mesh.position.x=t[0],this.mesh.position.y=t[1],this.mesh.position.z=n,this.mesh.scale.x=.5*e[0]*o,this.mesh.scale.y=.5*e[1]*o}},{key:"initMaterial",value:function(){var t=new p.MeshStandardMaterial({transparent:!0,depthWrite:!1,depthTest:!0}),e=this.options,i=e.color,o=e.mapUrl,e=e.emissive,i=h(i).gl(),n=h(e.emissive).gl(),s=i[3];return e.show&&(s*=n[3]),t.opacity=s,t.color=new p.Color(i[0],i[1],i[2]),o?f.load(o,function(e){t.map=e,t.map.center.x=.5,t.map.center.y=.5,t.needsUpdate=!0}):t.map=null,e.show?(t.emissive=new p.Color(n[0],n[1],n[2]),f.load(e.emissiveMap,function(e){t.emissiveMap=e,t.emissiveMap.center.x=.5,t.emissiveMap.center.y=.5,t.needsUpdate=!0}),t.emissiveIntensity=.01*e.emissiveIntensity):(t.emissive=new p.Color("#000"),t.emissiveMap=null,t.emissiveIntensity=0),t.needsUpdate=!0,t}},{key:"autoUpdate",value:function(){var e,t,i,o;this.options.visible&&this.mesh&&this.material&&(e=(i=this.options).size,t=i.scale,o=i.rotateSpeed,i=i.bubbleSpeed,0!=o&&(o=o*Math.PI/180*.01,this.material.map&&(this.material.map.rotation+=o)),e&&0!=i&&(n+=.001*i,o=.5*e[0]*t*(1+.1*Math.sin(n)),this.mesh.scale.x=o,this.mesh.scale.y=o))}},{key:"updateOptions",value:function(e){var t,i,o,n,s,r,a,l=m(this.options),c=(this.options=u(this.options,e||{}),this.material);c&&(t=(e=this.options).color,i=e.mapUrl,o=e.emissive,n=e.size,e=e.scale,s=h(t).gl(),r=h(o.emissive).gl(),a=s[3],o.show&&(a*=r[3]),l.color==t&&l.emissive.show==o.show&&l.emissive.emissive==o.emissive||(c.opacity=a,c.color=new p.Color(s[0],s[1],s[2])),i?l.mapUrl!=i&&i&&(c.opacity=.5,f.load(i,function(e){c.opacity=a,c.map=e,c.map.center.x=.5,c.map.center.y=.5})):c.map=null,l.emissive.show==o.show&&l.emissive.emissive==o.emissive&&l.emissive.emissiveMap==o.emissiveMap&&l.emissive.emissiveIntensity==o.emissiveIntensity||(o.show?(f.load(o.emissiveMap,function(e){c.emissiveMap=e,c.emissiveMap.center.x=.5,c.emissiveMap.center.y=.5}),c.emissive=new p.Color(r[0],r[1],r[2]),c.emissiveIntensity=.01*o.emissiveIntensity):(c.emissive=new p.Color("#000"),c.emissiveMap=null,c.emissiveIntensity=0)),this.mesh.scale.x=.5*n[0]*e,this.mesh.scale.y=.5*n[1]*e,this.render())}},{key:"show",value:function(){this.options.visible=!0,c(d(s.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.options.visible=!1,c(d(s.prototype),"hide",this).call(this)}},{key:"destory",value:function(){c(d(s.prototype),"remove",this).call(this),this.clear(),this.needsAutoUpdate=!1,this.options=null}}])&&l(t.prototype,e),i&&l(t,i),Object.defineProperty(t,"prototype",{writable:!1}),s},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/grid/config",[],function(e,a,r,n,s,c){return e.exports={DEFAULT_OPTIONS:{isSceneGroup:!1,sceneNames:[{sceneName:"main"}],visible:!0,map:"https://img.alicdn.com/tfs/TB1IArOGXY7gK0jSZKzXXaikpXa-641-642.png",uvScale:{x:6,y:6},renderOrder:1}},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/grid/gridLayer",[],function(e,t,m,i,s,r){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function h(e,t){for(var i=0;i<t.length;i++){var s=t[i];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,i){var s=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=d(e)););return e}(e,t);if(s)return s=Object.getOwnPropertyDescriptor(s,t),s.get?s.get.call(arguments.length<3?e:i):s.value}).apply(this,arguments)}function f(e,t){return(f=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(i){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=d(i),t=(e=s?(e=d(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y(t)}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function d(e){return(d=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}return e.exports=function(s){var n=s.THREE,l=s.Utils,p=l.Chroma,r=l.BASE_HEIGHT_SCALE,u=(new n.TextureLoader).setCrossOrigin("*"),e=s.Layer,t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&f(t,e);var i,a=v(o);function o(e){var t;if(this instanceof o)return(t=a.call(this)).options=l.mergeOptions({},e),t.layerName="GridLayer",t.renderQueue=s.VOGO.Transparent,t.needsAutoUpdate=!0,t.initMaterial=t.initMaterial.bind(y(t)),t.checkVisible=t.checkVisible.bind(y(t)),t.updateMaterial=t.updateMaterial.bind(y(t)),t.updateOptions=t.updateOptions.bind(y(t)),t.material=t.initMaterial(),t.init(),t;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"init",value:function(){this.group.frustumCulled=!1;var e=this.options.renderOrder,t=(this.updateMaterial(),new n.PlaneBufferGeometry(1,1,1,1)),t=this.mesh=new n.Mesh(t,this.material);t.position.x=0,t.position.y=0,t.position.z=0,t.scale.x=1,t.scale.y=1,t.scale.z=1,t.rotation.x=0,t.renderOrder=e,t.frustumCulled=!1,this.add(t)}},{key:"render",value:function(e,t){this.mesh&&(this.mesh.position.x=e[0],this.mesh.position.y=e[1],this.mesh.position.z=0,this.updateBaseHeight(),this.mesh.scale.x=t,this.mesh.scale.y=t),this.checkVisible()}},{key:"updateBaseHeight",value:function(){var e=this.options.baseHeightScale_background,t=s.drawScale,i=s.baseHeightScale;this.mesh.position.z=t*r*(i*(void 0===e?0:e))}},{key:"autoUpdate",value:function(){var e,t,i;this.options&&(e=(t=this.options).map,t=t.emissive,this.mesh&&(i=this.mesh.material.userData.shader)&&(1e4<i.uniforms.uvOffset.value.x||i.uniforms.uvOffset.value.x<-1e4?i.uniforms.uvOffset.value.x=0:i.uniforms.uvOffset.value.x-=.01*t.uvSpeedX*.01,1e4<i.uniforms.uvOffset.value.y||i.uniforms.uvOffset.value.y<-1e4?i.uniforms.uvOffset.value.y=0:i.uniforms.uvOffset.value.y-=.01*t.uvSpeedY*.01,i.uniforms.emissiveIntensity.value=.01*t.emissiveIntensity*2,i.uniforms.mapRepeat.value={x:+e.xRepeat,y:+e.yRepeat},i.uniforms.emissiveMapRepeat.value={x:+t.xRepeat,y:+t.yRepeat}))}},{key:"initMaterial",value:function(){var e=this.options,t=e.metalness,i=e.roughness,s=e.color,r=e.map,a=e.emissive,e=(e.repeat,new n.MeshStandardMaterial({metalness:.01*t,roughness:.01*i,transparent:!0,depthWrite:!0,depthTest:!0})),t=p(s).gl(),i=p(a.emissive).gl(),s=t[3];return a.show&&(s*=i[3]),e.opacity=s,e.color=new n.Color(t[0],t[1],t[2]),r.mapUrl?((s=u.load(r.mapUrl)).wrapS=s.wrapT=n.MirroredRepeatWrapping,s.repeat.set(1,1),e.map=s):e.map=null,a.show?(e.emissive=new n.Color(i[0],i[1],i[2]),(t=u.load(a.emissiveMap)).wrapS=t.wrapT=n.MirroredRepeatWrapping,t.repeat.set(1,1),e.emissiveMap=t,e.emissiveIntensity=.01*a.emissiveIntensity):(e.emissive=new n.Color("#000"),e.emissiveMap=null,e.emissiveIntensity=0),e.needsUpdate=!0,e}},{key:"updateMaterial",value:function(){var e=this.options,t=e.map,i=e.emissive;this.material.onBeforeCompile=function(e){e.uniforms.mapRepeat={value:{x:+t.xRepeat,y:+t.yRepeat}},e.uniforms.emissiveMapRepeat={value:{x:+i.xRepeat,y:+i.yRepeat}},e.uniforms.uvOffset={value:{x:0,y:0}},e.uniforms.emissiveIntensity={value:0},e.vertexShader=m("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/grid/shader/vert.glsl"),e.fragmentShader=m("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/grid/shader/frag.glsl"),this.userData.shader=e}}},{key:"updateOptions",value:function(e){var t=l.deepClone(this.options),e=(this.options=l.mergeOptions(this.options,e||{}),this.options),i=e.metalness,s=e.roughness,r=e.color,a=e.map,o=e.emissive,e=(e.repeat,this.material.metalness=.01*i,this.material.roughness=.01*s,p(r).gl()),i=p(o.emissive).gl(),s=e[3];o.show&&(s*=i[3]),t.color==r&&t.emissive.show==o.show&&t.emissive.emissive==o.emissive||(this.material.opacity=s,this.material.color=new n.Color(e[0],e[1],e[2])),a.mapUrl?t.map.mapUrl!=a.mapUrl&&a.mapUrl&&((r=u.load(a.mapUrl)).wrapS=r.wrapT=n.MirroredRepeatWrapping,r.repeat.set(1,1),this.material.map=r):this.material.map=null,t.emissive.show==o.show&&t.emissive.emissive==o.emissive&&t.emissive.emissiveMap==o.emissiveMap&&t.emissive.emissiveIntensity==o.emissiveIntensity||(o.show?(this.material.emissive=new n.Color(i[0],i[1],i[2]),(s=u.load(o.emissiveMap)).wrapS=s.wrapT=n.MirroredRepeatWrapping,s.repeat.set(1,1),this.material.emissiveMap=s,this.material.emissiveIntensity=.01*o.emissiveIntensity):(this.material.emissive=new n.Color("#000"),this.material.emissiveMap=null,this.material.emissiveIntensity=0)),this.updateMaterial(),this.updateBaseHeight()}},{key:"checkVisible",value:function(){(this.options.visible?c(d(o.prototype),"show",this):c(d(o.prototype),"hide",this)).call(this)}},{key:"show",value:function(){this.options.visible=!0,c(d(o.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.options.visible=!1,c(d(o.prototype),"hide",this).call(this)}},{key:"remove",value:function(){c(d(o.prototype),"remove",this).call(this),this.clear(),this.needsAutoUpdate=!1,this.options=null,this.mesh=null}}])&&h(t.prototype,e),i&&h(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/geometry/geojsonExtrude/bufferAttributes",["datav:/npm/gl-vec3/1.1.3","datav:/npm/earcut/2.1.3"],function(n,e,i,d,t,r){function k(n,e){return function(n){if(Array.isArray(n))return n}(n)||function(n,e){var i=null==n?null:"undefined"!=typeof Symbol&&n[Symbol.iterator]||n["@@iterator"];if(null!=i){var d,t,r=[],x=!0,a=!1;try{for(i=i.call(n);!(x=(d=i.next()).done)&&(r.push(d.value),!e||r.length!==e);x=!0);}catch(n){a=!0,t=n}finally{try{x||null==i.return||i.return()}finally{if(a)throw t}}return r}}(n,e)||function(n,e){if(n){if("string"==typeof n)return x(n,e);var i=Object.prototype.toString.call(n).slice(8,-1);return"Map"===(i="Object"===i&&n.constructor?n.constructor.name:i)||"Set"===i?Array.from(n):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?x(n,e):void 0}}(n,e)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function x(n,e){(null==e||e>n.length)&&(e=n.length);for(var i=0,d=new Array(e);i<e;i++)d[i]=n[i];return d}var a=i("datav:/npm/gl-vec3/1.1.3"),q=a.subtract,B=a.length,o=a.cross,D=a.normalize,F=i("datav:/npm/earcut/2.1.3");var u=[],l=[];function G(n,e,i,d,t){var r=3<arguments.length&&void 0!==d?d:[],x=!(4<arguments.length&&void 0!==t)||t;q(u,i,e),q(l,n,e),o(r,u,l),x&&D(r,r)}return n.exports={top:function(n,e,i,d){for(var t,r,x,a=(n=F.flatten(n)).vertices,o=n.holes,u=n.dimensions,l=F(a,o,u),s=[],h=[],f=[],p=[],c=[],v=d.indices,g=d.positions,m=d.normals,y=d.uvs,b=e[2]-e[0],A=e[3]-e[1],M=g.length/3,S=0,j=a.length;S<j;S+=u)s[0]=+Math.round(a[S]),s[1]=+Math.round(a[S+1]),s[2]=+Math.round(i),g.push.apply(g,s),y.push((+s[0]-e[0])/b,(+s[1]-e[1])/A),m.push(0,0,0);for(var w=2,E=l.length;w<E;w+=3)t=l[w-2]+M,r=l[w-1]+M,x=l[w]+M,v.push(t,r,x),h[0]=g[t*=3],h[1]=g[1+t],h[2]=g[2+t],f[0]=g[r*=3],f[1]=g[1+r],f[2]=g[2+r],p[0]=g[x*=3],p[1]=g[1+x],p[2]=g[2+x],G(h,f,p,c,!1),m[t]+=c[0],m[1+t]+=c[1],m[2+t]+=c[2],m[r]+=c[0],m[1+r]+=c[1],m[2+r]+=c[2],m[x]+=c[0],m[1+x]+=c[1],m[2+x]+=c[2];for(var I=3*M,C=m.length;I<C;I+=3)c[0]=m[I],c[1]=m[I+1],c[2]=m[I+2],D(c,c),m[I]=c[0],m[I+1]=c[1],m[I+2]=c[2]},side:function(n,e,i,d){for(var x=[],a=[],o=[],u=[],l=[],s=[],t=[],h=[],f=(n=F.flatten(n)).vertices,r=n.holes,p=n.dimensions,c=(F(f,r,p),d.indices),v=d.positions,g=d.normals,m=d.uvs,y=d.f_attr0,b=e[2]-e[0],A=e[3]-e[1],M=[],S=v.length/3,j=0,w=f.length;j<w;j+=p){t[0]=+Math.round(f[j]),t[1]=+Math.round(f[j+1]),t[2]=+Math.round(i),v.push.apply(v,t),g.push(0,0,0),t[2]=0,v.push.apply(v,t),g.push(0,0,0);var E=(t[0]-e[0])/b,I=(t[1]-e[1])/A;y.push(E,I),y.push(E,I)}var C,O,n=r&&0<r.length?r[0]:f.length/p;M.push([0,n]);for(var z,T=0,U=r.length;T<U;T++)C=r[T],O=T<U-1?r[T+1]:f.length/p,M.push([C,O]);M.forEach(function(n,e){var n=k(n,2),i=n[0],d=n[1];if((z=0)===e===function(n,e,i,d){for(var t=0,r=e,x=i-d;r<i;r+=d)t+=(n[x]-n[r])*(n[r+1]+n[x+1]),x=r;return 0<t}(f,i*p,d*p,p))for(var t=i+1;t<d;t++)index=2*(t-1)+S,index*=3,x[0]=v[index],x[1]=v[index+1],x[2]=v[index+2],a[0]=v[index+3],a[1]=v[index+4],a[2]=v[index+5],index=2*t+S,index*=3,o[0]=v[index],o[1]=v[index+1],o[2]=v[index+2],u[0]=v[index+3],u[1]=v[index+4],u[2]=v[index+5],index=2*(t-1)+S,index*=2,m[index]=z,m[index+1]=1,m[index+2]=z,m[index+3]=0,z+=B(q(h,u,a)),index=2*t+S,index*=2,m[index]=z,m[index+1]=1,m[index+2]=z,m[index+3]=0,G(a,u,x,l,!1),G(u,o,x,s,!1),index=2*(t-1)+S,index*=3,g[index]+=l[0]+s[0],g[index+1]+=l[1]+s[1],g[index+2]+=l[2]+s[2],g[index+3]+=l[0],g[index+4]+=l[1],g[index+5]+=l[2],index=2*t+S,index*=3,g[index]+=s[0],g[index+1]+=s[1],g[index+2]+=s[2],g[index+3]+=l[0]+s[0],g[index+4]+=l[1]+s[1],g[index+5]+=l[2]+s[2],index=2*(t-1)+S,c.push(index+1,index+3,index),c.push(index+3,index+2,index);else for(var r=d-2;i<=r;r--)index=2*(r+1)+S,index*=3,x[0]=v[index],x[1]=v[index+1],x[2]=v[index+2],a[0]=v[index+3],a[1]=v[index+4],a[2]=v[index+5],index=2*r+S,index*=3,o[0]=v[index],o[1]=v[index+1],o[2]=v[index+2],u[0]=v[index+3],u[1]=v[index+4],u[2]=v[index+5],index=2*(r+1)+S,index*=2,m[index]=z,m[index+1]=1,m[index+2]=z,m[index+3]=0,z+=B(q(h,u,a)),index=2*r+S,index*=2,m[index]=z,m[index+1]=1,m[index+2]=z,m[index+3]=0,G(a,u,x,l,!1),G(u,o,x,s,!1),index=2*(r+1)+S,index*=3,g[index]+=l[0]+s[0],g[index+1]+=l[1]+s[1],g[index+2]+=l[2]+s[2],g[index+3]+=l[0],g[index+4]+=l[1],g[index+5]+=l[2],index=2*r+S,index*=3,g[index]+=s[0],g[index+1]+=s[1],g[index+2]+=s[2],g[index+3]+=l[0]+s[0],g[index+4]+=l[1]+s[1],g[index+5]+=l[2]+s[2],index=2*(r+1)+S,c.push(index+1,index-1,index),c.push(index-1,index-2,index)});for(var $=3*S,_=g.length;$<_;$+=3)l[0]=g[$],l[1]=g[$+1],l[2]=g[$+2],D(l,l),g[$]=l[0],g[$+1]=l[1],g[$+2]=l[2]}},n.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/water/config",[],function(e,a,i,r,t,n){return e.exports={DEFAULT_OPTIONS:{isSceneGroup:!1,sceneNames:[{sceneName:"main"}],visible:!0,speed:.1,distortionScale:3.5,waterSize:99.8,waterSpeed:10,normalMap:"https://img.alicdn.com/tfs/TB1OSvUczihSKJjy0FlXXadEXXa-1024-1024.jpg",color:"#121413",opacity:1,renderOrder:0,light:{color:"#ffffff",rayleigh:2,inclination:.46,azimuth:.44}}},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/water/waterLayer",[],function(e,t,n,r,o,i){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function y(){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=m(e)););return e}(e,t);if(o)return o=Object.getOwnPropertyDescriptor(o,t),o.get?o.get.call(arguments.length<3?e:r):o.value}).apply(this,arguments)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function v(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=m(r),t=(e=o?(e=m(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return w(t)}}function w(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function m(e){return(m=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}return e.exports=function(l){var u=l.THREE,e=l.Utils,r=e.mergeOptions,c=(e.deepClone,e.Chroma),p=n("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/water/src/Water"),f=(new u.TextureLoader).setCrossOrigin("*"),e=l.Layer,t=h;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e);var o,i=v(h);function h(e){var t;if(this instanceof h)return(t=i.call(this)).options=r({},e||{}),t.renderQueue=l.VOGO.Transparent,t.needsAutoUpdate=!0,t.uvTime={x:0,y:0},t.updateMaterialUniforms=t.updateMaterialUniforms.bind(w(t)),t.init(),t;throw new TypeError("Cannot call a class as a function")}return t=h,(e=[{key:"init",value:function(){var e=this.options,t=e.relativeHeight,r=e.normalMap,o=e.color,i=e.waterSize,n=e.distortionScale,a=e.lightColor,e=e.renderOrder,s=new u.PlaneGeometry(1,1),a=c(a).gl(),o=c(o).gl(),s=this.water=p({THREE:u,geometry:s,options:{textureWidth:512,textureHeight:512,waterNormals:f.load(r,function(e){e.wrapS=e.wrapT=u.RepeatWrapping,e.repeat.set(1,1)}),alpha:1,sunDirection:new u.Vector3,sunColor:new u.Color(a[0],a[1],a[2])||16777215,waterColor:new u.Color(o[0],o[1],o[2])||7695,distortionScale:n,size:1e-6*(100-i+.1)*l.drawScale,eye:new u.Vector3(0,0,0),fog:void 0!==l.engine.scene.fog}}),r=[0,0];s.position.x=r[0],s.position.y=r[1],s.position.z=t,s.scale.x=1,s.scale.y=1,s.renderOrder=e,this.add(s),(this.options.visible?y(m(h.prototype),"show",this):y(m(h.prototype),"hide",this)).call(this)}},{key:"render",value:function(e){var t=e.center,e=e.scale,r=this.options.relativeHeight;this.water&&(this.water.position.x=t[0],this.water.position.y=t[1],this.water.position.z=r,this.water.scale.x=e,this.water.scale.y=e,this.updateMaterialUniforms())}},{key:"autoUpdate",value:function(){var e;this.water&&(1e10<this.uvTime.x||1e10<this.uvTime.y||this.uvTime.x<-1e10||this.uvTime.y<-1e10?this.uvTime={x:0,y:0}:(e=this.options.waterSpeed,this.uvTime.x-=3e-4*e.x,this.uvTime.y-=3e-4*e.y),this.water.material.uniforms.uvTime.value=new u.Vector2(this.uvTime.x,this.uvTime.y))}},{key:"show",value:function(){this.options.visible=!0,y(m(h.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.options.visible=!1,y(m(h.prototype),"hide",this).call(this)}},{key:"updateOptions",value:function(e){this.options=r(this.options,e||{}),this.water&&this.updateMaterialUniforms()}},{key:"updateMaterialUniforms",value:function(){var e=this.options,t=e.color,r=e.waterSize,o=e.distortionScale,i=e.lightColor,e=e.lightPosition;this.water.material.uniforms.eye.value=new u.Vector3(20037508.34*e.x,20037508.34*e.y,20037508.34*e.z);var e=0,n=180,e=u.MathUtils.degToRad(90-e),n=u.MathUtils.degToRad(n),a=new u.Vector3,e=(a.setFromSphericalCoords(1,e,n),c(t).gl()),n=c(i).gl();this.water.material.uniforms.waterColor.value=new u.Color(e[0],e[1],e[2]),this.water.material.uniforms.size.value=1e-6*(100-r+.1)*20037508.34/this.water.scale.x,this.water.material.uniforms.distortionScale.value=o,this.water.material.uniforms.sunColor.value=new u.Color(n[0],n[1],n[2]),this.water.material.uniforms.sunDirection.value.copy(a).normalize()}},{key:"destory",value:function(){y(m(h.prototype),"remove",this).call(this),this.clear(),this.water=null}}])&&s(t.prototype,e),o&&s(t,o),Object.defineProperty(t,"prototype",{writable:!1}),h},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/config",[],function(e,a,i,t,s,o){return e.exports={DEFAULT_OPTIONS:{isSceneGroup:!1,sceneNames:[{sceneName:"main"}],visible:!0,renderOrder:5,relativeHeight:0,castShadow:!0,topTexture:{opacity:100,metalness:75,roughness:55,color:"#1a1c1e",map:"",normal:{show:!0,normalMap:"",normalScale:55},emissive:{show:!1,emissive:"#ffffff",emissiveMap:"http://img.alicdn.com/tfs/TB1BzF5AuT2gK0jSZFvXXXnFXXa-800-800.png",emissiveIntensity:10},light:{show:!1,lightMap:"",lightMapIntensity:100},ao:{show:!1,aoMap:"",aoMapIntensity:100}},sideTexture:{opacity:100,color:"#23407a",map:"https://img.alicdn.com/tfs/TB1fJnDFGL7gK0jSZFBXXXZZpXa-800-800.png",emissive:{show:!0,emissive:"#07adfb",emissiveMap:"http://img.alicdn.com/tfs/TB1reTtccKfxu4jSZPfXXb3dXXa-1000-1000.png",emissiveIntensity:20}},lineStyle:{strokeColor:"#33C9FB",weight:1},textStyle:{fontFamily:"Microsoft Yahei",fontSize:12,color:"rgba(255, 0, 0, 1)",fontWeight:"normal",lineWidth:1,strokeColor:"rgba(0, 0, 0, 0.85)"}}},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/src/label",[],function(e,t,r,o,n,i){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e){return function(e){if(Array.isArray(e))return s(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function l(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=g(e)););return e}(e,t);if(o)return o=Object.getOwnPropertyDescriptor(o,t),o.get?o.get.call(arguments.length<3?e:r):o.value}).apply(this,arguments)}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=g(r),t=(e=o?(e=g(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return h(t)}}function h(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function g(e){return(g=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}return e.exports=function(p){var y=p.THREE,a=p.Utils,s=a.measureText,o=a.polylabel,d=a.BASE_HEIGHT_SCALE,e=p.Layer,t=i;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,n=f(i);function i(e,t){var r;if(this instanceof i)return(r=n.call(this)).options=a.mergeOptions({},e),r.status=t,r.renderQueue=p.VOGO.Transparent,r.options.visible?r.show():r.hide(),r.draw=r.draw.bind(h(r)),r.checkVisible=r.checkVisible.bind(h(r)),r;throw new TypeError("Cannot call a class as a function")}return t=i,(e=[{key:"render",value:function(e){this.geojson=e.geojson||{features:[]},this.options.adcode=e.adcode,this.options.bbox_background=e.bbox_background,this.draw()}},{key:"draw",value:function(){this.clear();for(var e=this.options,t=e.adcode,r=e.bbox_background,e=p.drawScale,o=p.baseHeightScale,n=p.baseHeightScale_background,i=e*d*n*(o+.05),a=0;a<this.geojson.features.length;a++){var s,l,c,u,f=this.geojson.features[a],h=f.properties;h.name&&h.adcode&&(h.adcode===+t||h.adcode===""+t)||h.name&&(f=this.calLabelPos(f,1),s=Math.min(r[0],r[2]),l=Math.max(r[0],r[2]),c=Math.min(r[1],r[3]),u=Math.max(r[1],r[3]),f[0]<s||f[0]>l||f[1]<c||f[1]>u||(s=p.proj.proj([f[0],f[1],i]),l=this.getTextCanvas(h.name),(c=new y.CanvasTexture(l)).wrapS=c.wrapT=y.MirroredRepeatWrapping,c.repeat.set(1,1),c.anisotropy=20,c.needsUpdate=!0,u=new y.SpriteMaterial({map:c,transparent:!0,depthWrite:!1,depthTest:!0,sizeAttenuation:!1,opacity:1}),(f=new y.Sprite(u)).center.set(.5,0),(h=f.position).set.apply(h,b(s)),c=.36/p.constants.size.height,u=l.width*c,h=l.height*c,f.scale.set(u,h,1),f.renderOrder=+this.options.renderOrder,this.add(f)))}this.checkVisible()}},{key:"getTextCanvas",value:function(e){var t=a.mergeOptions({},this.options).borderStyle.textStyle,r=s(e,t.fontFamily,t.fontWeight,t.fontSize),o=r.width,r=r.height,n=document.createElement("canvas"),i=(n.width=o,n.height=r,n.getContext("2d",this.status.screenshotEnable?{preserveDrawingBuffer:!0}:{}));return i.imageSmoothingQuality="high",i.textBaseline="middle",i.textAlign="center",i.font=t.fontWeight+" "+t.fontSize+"px "+t.fontFamily,0<t.lineWidth&&(i.lineWidth=t.lineWidth,i.strokeStyle=t.strokeColor||"white",i.strokeText(e,o/2,r/2)),i.fillStyle=t.color||"red",i.fillText(e,o/2,r/2),n}},{key:"area",value:function(e){for(var t=0,r=0;r<e.length;r++)for(var o=e[r],n=0,i=o.length,a=i-1;n<i;a=n++)t+=(o[n][0]-o[a][0])*(o[n][1]+o[a][1])*(r?-1:1);return Math.abs(t)/2}},{key:"calLabelPos",value:function(e,t){var r=this;return e.geometry&&"Polygon"===e.geometry.type?o(e.geometry.coordinates,t):e.geometry&&"MultiPolygon"===e.geometry.type?(e=e.geometry.coordinates.reduce(function(e,t){return r.area(e)>=r.area(t)?e:t},{}),o(e,t)):void 0}},{key:"updateOptions",value:function(e){var t,r=a.deepClone(this.options),o=(this.options=a.mergeOptions(this.options,e||{}),this.options.borderStyle.textStyle),o=(r.borderStyle.textStyle.show===o.show&&r.borderStyle.textStyle.fontFamily===o.fontFamily&&r.borderStyle.textStyle.fontWeight===o.fontWeight&&r.borderStyle.textStyle.fontSize===o.fontSize&&r.borderStyle.textStyle.color===o.color&&r.borderStyle.textStyle.lineWidth===o.lineWidth&&r.borderStyle.textStyle.strokeColor===o.strokeColor||this.draw(),p.drawScale),n=p.baseHeightScale,i=p.baseHeightScale_background;r.baseHeightScale_background==i&&e.baseHeightScale==n||(t=Math.round(o*d*i*(n+.05)),this.traverse(function(e){e.position.z=t})),this.checkVisible()}},{key:"checkVisible",value:function(){var e=this.options,t=e.visible,e=e.borderStyle;(t&&e.textStyle.show?c(g(i.prototype),"show",this):c(g(i.prototype),"hide",this)).call(this)}},{key:"show",value:function(){this.options.visible=!0,this.options.borderStyle.textStyle.show&&c(g(i.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.options.visible=!1,c(g(i.prototype),"hide",this).call(this)}},{key:"destroy",value:function(){c(g(i.prototype),"remove",this).call(this),this.clear(),this.geojson=null,this.options=null}}])&&l(t.prototype,e),r&&l(t,r),Object.defineProperty(t,"prototype",{writable:!1}),i},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/src/line",[],function(e,t,m,r,o,n){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function b(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){if(e){if("string"==typeof e)return a(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(e,t):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,o=new Array(t);r<t;r++)o[r]=e[r];return o}function v(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function g(){return(g="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var o=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=j(e)););return e}(e,t);if(o)return o=Object.getOwnPropertyDescriptor(o,t),o.get?o.get.call(arguments.length<3?e:r):o.value}).apply(this,arguments)}function w(e,t){return(w=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function S(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=j(r),t=(e=o?(e=j(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return O(t)}}function O(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function j(e){return(j=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}return e.exports=function(n){var f=n.THREE,o=n.Utils,h=o.Chroma,i=o.deepClone,a=o.mergeOptions,l=o.coordtransformCli,s=o.geojsonFlatten,u=(o.geojsonDissolve,o.BASE_HEIGHT_SCALE),e=(o.turf,m("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/src/libs/meshLine")(f)),p=e.MeshLine,c=e.MeshLineMaterial,e=n.Layer,t=d;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&w(t,e);var r,y=S(d);function d(e){var t;if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");(t=y.call(this)).options=o.mergeOptions({},e),t.renderQueue=n.VOGO.Transparent;var e=t.options.borderStyle.lineStyle,r=e.strokeColor,r=(o.Chroma(r).gl(),t.material=c({resolution:new f.Vector2,sizeAttenuation:!1,side:f.DoubleSide,near:1,far:1e8,visibility:1,dashOffset0:0,dashOffset1:0,map:null,map1:null,uvScale0:new f.Vector2(1,1),depthWrite:!1,depthTest:!0,transparent:!0}),t.material.uniforms.drawScale.value=n.drawScale,t.material.uniforms.USE_MAP=!1,t.material.uniforms.lineLengthMax.value=110,t.material.uniforms.lineLength.value=100,t.material.uniforms.lineWidth.value=e.weight,h(e.strokeColor).gl()),e=(t.material.uniforms.lineColor.value=r,t.material.uniforms.lineHeadColor.value=r,t.material.uniforms.symbolColor.value=r,new f.Vector2);return n.engine.renderer.getSize(e),t.material.uniforms.resolution.value=e,t.material.needsUpdate=!0,t.checkVisible=t.checkVisible.bind(O(t)),t.options.visible?t.show():t.hide(),t}return t=d,(e=[{key:"render",value:function(e){var t=e.geojson,e=e.bbox_background;this.options.bbox_background=e,this.geojson=t||{features:[]},this.genGeojson()}},{key:"genGeojson",value:function(){this.clear();var e=n.baseHeightScale,t=n.baseHeightScale_background,r=n.drawScale,o=l.wgs84ToMecator(this.geojson,n.proj.proj),o=s(o);this.addMesh({geojson:o,height:r*u*(e+.05)*t}),this.checkVisible()}},{key:"addMesh",value:function(e){for(var t=e.geojson,r=e.height,o=new p,n=0;n<t.features.length;n++)for(var i,a=t.features[n].geometry.coordinates,l=[],s=(l.push.apply(l,b(a)),void 0),u=void 0,s=0;s<l.length;s++){for(var c=[],u=0;u<l[s].length;u++)i=l[s][u],c.push(i[0],i[1],r,i[0],i[1],r);o.setGeometry(c,{curveLen:226392,isGeoUv:!1,lineColor:h("#fff").gl(),lineHeadColor:h("rgba(255,0,0,0)").gl(),symbolColor:h("rgba(255,0,0,0)").gl(),lineParams:{lineType:.01,blurWidthRatio:0,lineHeadSpaceRatio:0,lineTextureNum:.01},symbolParams:{symbolType:.01,symbolNum:.01,symbolAspect:.01}})}o.createGeometry(),this.material.needsUpdate=!0;e=new f.Mesh(o.geometry,this.material);e.meshType="1",e.frustumCulled=!1,this.add(e),e.renderOrder=this.options.renderOrder}},{key:"updateOptions",value:function(e){var t=i(this.options),e=(this.options=a(this.options,e||{}),this.options.borderStyle.lineStyle),r=(this.material.uniforms.lineLengthMax.value=110,this.material.uniforms.lineLength.value=100,this.material.uniforms.lineWidth.value=e.weight,h(e.strokeColor).gl()),r=(e.show||(r[3]=0),this.material.uniforms.lineColor.value=r,this.material.uniforms.lineHeadColor.value=r,this.material.uniforms.symbolColor.value=r,n.baseHeightScale,n.baseHeightScale_background,n.drawScale);this.material.uniforms.drawScale.value=r,t.borderStyle.lineStyle.strokeColor===e.strokeColor&&t.borderStyle.lineStyle.weight===e.weight||(r=e.strokeColor,h(r).gl()),this.genGeojson(),this.checkVisible()}},{key:"checkVisible",value:function(){var e=this.options,t=e.visible,e=e.borderStyle;(t&&e.lineStyle.show?g(j(d.prototype),"show",this):g(j(d.prototype),"hide",this)).call(this)}},{key:"show",value:function(){this.options.visible=!0,this.options.borderStyle.lineStyle.show&&g(j(d.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.options.visible=!1,g(j(d.prototype),"hide",this).call(this)}},{key:"destroy",value:function(){g(j(d.prototype),"remove",this).call(this),this.clear(),this.material&&this.material.dispose&&this.material.dispose(),this.options=null}}])&&v(t.prototype,e),r&&v(t,r),Object.defineProperty(t,"prototype",{writable:!1}),d},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/src/backgroundTerrainLayer",[],function(e,i,t,s,a,o){function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(e,i){for(var t=0;t<i.length;t++){var s=i[t];s.enumerable=s.enumerable||!1,s.configurable=!0,"value"in s&&(s.writable=!0),Object.defineProperty(e,s.key,s)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,i,t){var s=function(e,i){for(;!Object.prototype.hasOwnProperty.call(e,i)&&null!==(e=w(e)););return e}(e,i);if(s)return s=Object.getOwnPropertyDescriptor(s,i),s.get?s.get.call(arguments.length<3?e:t):s.value}).apply(this,arguments)}function h(e,i){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,i){return e.__proto__=i,e})(e,i)}function g(t){var s=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,i=w(t),i=(e=s?(e=w(this).constructor,Reflect.construct(i,arguments,e)):i.apply(this,arguments),this);if(e&&("object"===r(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return y(i)}}function y(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}return e.exports=function(d){var f=d.THREE,e=d.Utils,p=e.Chroma,l=e.mergeOptions,m=e.deepClone,v=e.BASE_HEIGHT_SCALE;function a(e){for(var i=e.tilesOptions,t=e.baseUrl,s=i.tiles,n=i.bboxProj,l=i.tileBboxProj,p=i.minCol,m=i.maxCol,u=i.minRow,c=i.maxRow,a=[],h=256,d=256,o=0;o<s.length;o++)!function(e){var n=s[e],e=new Promise(function(r,e){fetch(/(http:\/\/)|(https:\/\/)/.test(n.url)?n.url:t+n.url).then(function(e){e.blob().then(function(e){createImageBitmap(e).then(function(e){h=e.width,d=e.height;for(var i=new OffscreenCanvas(h,d).getContext("2d"),e=(i.drawImage(e,0,0,h,d),i.getImageData(0,0,h,d)),t=e.data,s=0,a=t.length/4;s<a;s++){var o=4*s;0===t[o]&0===t[1+o]&&0===t[2+o]&&(t[o]=128,t[1+o]=128,t[2+o]=255,t[3+o]=255)}createImageBitmap(e,0,0,h,d).then(function(e){n.imageBitmap=e,r(n)})})})})});a.push(e)}(o);return Promise.all(a).then(function(e){for(var i=new OffscreenCanvas((m-p+1)*h*n.size.x/l.size.x,(c-u+1)*d*n.size.y/l.size.y).getContext("2d"),t=0;t<e.length;t++){var s=e[t],a=(s.tileX-p)*h-Math.abs(n.leftTop[0]-l.leftTop[0])*(m-p+1)*h/l.size.x,o=(s.tileY-u)*d-Math.abs(n.leftTop[1]-l.leftTop[1])*(c-u+1)*d/l.size.y;i.drawImage(s.imageBitmap,a,o,h,d)}var r=i.getImageData(0,0,(m-p+1)*h*n.size.x/l.size.x,(c-u+1)*d*n.size.y/l.size.y);return r.data=new Uint8Array(r.data),r}).catch(function(e){})}var u=(new f.TextureLoader).setCrossOrigin("*"),e=d.Layer,i=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&h(i,e);var t,s=g(o);function o(e,i){var t;if(this instanceof o)return(t=s.call(this)).options=l({},e||{}),t.status=i,t.renderQueue=d.VOGO.Background,t.group.ignoreGbuffer=!0,t.group.ignoreWaterReflection=!1,t.initTopMaterial=t.initTopMaterial.bind(y(t)),t.initSideMaterial=t.initSideMaterial.bind(y(t)),t.updateTopMaterial=t.updateTopMaterial.bind(y(t)),t.updateSideMaterial=t.updateSideMaterial.bind(y(t)),t.materialTop=t.initTopMaterial(t.options),t.materialSide=t.initSideMaterial(t.options),t.checkVisible=t.checkVisible.bind(y(t)),t.getTiles=t.getTiles.bind(y(t)),t;throw new TypeError("Cannot call a class as a function")}return i=o,(e=[{key:"traverse",value:function(i){this.group&&this.group.traverse&&this.group.traverse(function(e){(e instanceof f.Mesh||e instanceof f.InstancedMesh||e instanceof f.LineSegments||e instanceof f.Sprite)&&i&&i(e)})}},{key:"render",value:function(e){var i=e.bbox_background,e=e.extrudeAttributes,i=(this.options.bbox_background=i,this.draw(e),this.options.topTexture),e=i.map,i=i.normal;e.show&&e.mapUrl&&-1<e.mapUrl.indexOf("{x}")&&-1<e.mapUrl.indexOf("{y}")&&-1<e.mapUrl.indexOf("{z}")&&this.getTiles({material:this.materialTop,imageType:"map",tilesOptions:this.getTilesOptions(e.mapUrl,this.options.bbox_background),baseUrl:window.location.origin}),i.show&&-1<i.normalMap.indexOf("{x}")&&-1<i.normalMap.indexOf("{y}")&&-1<i.normalMap.indexOf("{z}")&&this.getTiles({material:this.materialTop,imageType:"normalMap",tilesOptions:this.getTilesOptions(i.normalMap,this.options.bbox_background),baseUrl:window.location.origin})}},{key:"draw",value:function(e){this.clear();for(var i=this.options,t=i.sideTexture,s=i.renderOrder,a=t.castShadow,i=d.drawScale,o=0,r=0,n=0,l=0,p=d.baseHeightScale*d.baseHeightScale_background*i*v,m=0;m<e.groups.length;m+=5){o+=n,r+=l;e.groups[m],e.groups[m+1];var u=e.groups[m+2],n=e.groups[m+3],l=e.groups[m+4];switch(u){case 0:var c={indices:e.indices.slice(o,+(o+n)),positions:e.positions.slice(3*r,3*(r+l)),normals:e.normals.slice(3*r,3*(r+l)),uvs:e.uvs.slice(2*r,2*(r+l))},c=this.genBufferGeometry(c),c=this.meshTop=new f.Mesh(c,this.materialTop);c.renderOrder=s+2,c.position.z=p,c.ignoreWaterReflection=!0,c.meshType="meshTop",c.frustumCulled=!1,this.add(c),c.renderOrder=s+2;break;case 1:var c={indices:e.indices.slice(o,+(o+n)),positions:e.positions.slice(3*r,3*(r+l)),normals:e.normals.slice(3*r,3*(r+l)),uvs:e.uvs.slice(2*r,2*(r+l)),fAttr0:e.fAttr0.slice(2*r,2*(r+l))},h=this.genBufferGeometry(c),h=this.meshSide=new f.Mesh(h,this.materialSide);h.renderOrder=s+1,h.scale.z=p,h.position.z=0,h.ignoreWaterReflection=!a,h.meshType="meshSide",h.frustumCulled=!1,this.add(h),h.renderOrder=s+1}}}},{key:"genBufferGeometry",value:function(e){var i=new f.BufferGeometry;return i.setAttribute||(i.setAttribute=i.addAttribute),i.setIndex(new f.BufferAttribute(new Uint32Array(e.indices),1)),i.setAttribute("position",new f.BufferAttribute(new Float32Array(e.positions),3)),i.setAttribute("normal",new f.BufferAttribute(new Float32Array(e.normals),3)),i.setAttribute("uv",new f.BufferAttribute(new Float32Array(e.uvs),2)),i.computeBoundingSphere(),i.computeBoundingBox(),i}},{key:"initTopMaterial",value:function(e){var i=new f.MeshStandardMaterial({transparent:!0,depthWrite:!0,depthTest:!0}),e=e.topTexture,t=e.metalness,s=e.roughness,a=e.color,o=e.map,r=e.normal,e=e.emissive,t=(i.metalness=.01*t,i.roughness=.01*s,p(a).gl()),s=(e.show?p(e.emissive):p("#fff")).gl(),a=t[3];return e.show&&(a*=s[3]),i.opacity=a,i.color=new f.Color(t[0],t[1],t[2]),!o.show||!o.mapUrl||-1<o.mapUrl.indexOf("{x}")&&-1<o.mapUrl.indexOf("{y}")&&-1<o.mapUrl.indexOf("{z}")?i.map=null:u.load(o.mapUrl,function(e){e.wrapS=e.wrapT=f.MirroredRepeatWrapping,e.repeat.set(1,1),e.anisotropy=20,i.map=e,i.needsUpdate=!0}),r.show&&r.normalMap?(r.normalMap&&-1<r.normalMap.indexOf("{x}")&&-1<r.normalMap.indexOf("{y}")&&-1<r.normalMap.indexOf("{z}")?i.normalMap=null:u.load(r.normalMap,function(e){e.wrapS=e.wrapT=f.MirroredRepeatWrapping,e.repeat.set(1,1),e.anisotropy=20,i.normalMap=e,i.needsUpdate=!0}),a=.1*r.normalScale,i.normalScale=new f.Vector2(a,a)):(i.normalMap=null,i.normalScale=null),e.show?(i.emissive=new f.Color(s[0],s[1],s[2]),e.emissiveMap&&-1<e.emissiveMap.indexOf("{x}")&&-1<e.emissiveMap.indexOf("{y}")&&-1<e.emissiveMap.indexOf("{z}")?i.emissiveMap=null:u.load(e.emissiveMap,function(e){e.wrapS=e.wrapT=f.MirroredRepeatWrapping,e.repeat.set(1,1),e.anisotropy=20,i.emissiveMap=e,i.needsUpdate=!0}),i.emissiveIntensity=.01*e.emissiveIntensity):(i.emissive=new f.Color("#000"),i.emissiveMap=null,i.emissiveIntensity=0),i.needsUpdate=!0,i}},{key:"getTilesOptions",value:function(e,i){for(var t={leftTop:d.proj.proj([i[0],i[3],0]),rightBottm:d.proj.proj([i[2],i[1],0]),size:{x:0,y:0},maxSize:0},s=(t.size={x:Math.abs(t.rightBottm[0]-t.leftTop[0]),y:Math.abs(t.rightBottm[1]-t.leftTop[1])},t.maxSize=Math.max(t.size.x,t.size.y),~~(40075016.68/t.maxSize)||6),a=0;a<21;a++)if(s>=Math.pow(2,a)&&s<Math.pow(2,a+1)){s=a+3;break}for(var o=d.TileLnglatTransform._lngToTileX(i[0],s=11<s?11:s),r=d.TileLnglatTransform._lngToTileX(i[2],s),n=d.TileLnglatTransform._latToTileY(i[3],s),l=d.TileLnglatTransform._latToTileY(i[1],s),i={leftTop:d.TileLnglatTransform.pixelToLnglat(0,0,o,n,s),rightBottom:d.TileLnglatTransform.pixelToLnglat(256,256,r,l,s)},i={leftTop:d.proj.proj([i.leftTop.lng,i.leftTop.lat,0]),rightBottom:d.proj.proj([i.rightBottom.lng,i.rightBottom.lat,0]),size:{x:0,y:0}},p=(i.size={x:Math.abs(i.rightBottom[0]-i.leftTop[0]),y:Math.abs(i.rightBottom[1]-i.leftTop[1])},[]),m=o;m<=r;m++)for(var u,c=n;c<=l;c++)0<=m&&0<=c&&m<Math.pow(2,s)&&c<Math.pow(2,s)&&(u={url:e.replace("{x}",m).replace("{y}",c).replace("{z}",s),tileX:m,tileY:c,zoom:s},p.push(u));return{bboxProj:t,tileBboxProj:i,minCol:o,maxCol:r,minRow:n,maxRow:l,tiles:p}}},{key:"getTiles",value:function(e){var t=e.material,s=e.imageType,i=e.tilesOptions;e.baseUrl;d.workerFarm.createWorkerPool({}).startTask().then(function(e){e.postMessage({command:"EXECUTE-FUNCTION",data:{func:a,params:{imageType:"map",tilesOptions:i,baseUrl:window.location.origin}}}).then(function(e){var i=new f.DataTexture(e.data,e.width,e.height,f.RGBAFormat);switch(i.wrapS=i.wrapT=f.RepeatWrapping,i.magFilter=f.LinearFilter,i.minFilter=f.LinearFilter,i.flipY=!0,i.repeat.set(1,1),s){case"map":t.map=i;break;case"normalMap":t.normalMap=i;break;case"emissiveMap":t.emissiveMap=i}t.opacity=1,t.needsUpdate=!0})})}},{key:"updateTopMaterial",value:function(i,e,t){var e=m(e.topTexture),t=t.topTexture,s=t.metalness,a=t.roughness,o=t.color,r=t.map,n=t.normal,t=t.emissive,s=(e.metalness!=s&&(i.metalness=.01*s),e.roughness!=a&&(i.roughness=.01*a),p(o).gl()),a=(t.show?p(t.emissive):p("#fff")).gl(),l=s[3];t.show&&(l*=a[3]),e.color==o&&e.emissive.show==t.show&&e.emissive.emissive==t.emissive||(i.opacity=l,i.color=new f.Color(s[0],s[1],s[2])),r.show&&r.mapUrl?e.map.mapUrl==r.mapUrl&&e.map.show||(-1<r.mapUrl.indexOf("{x}")&&-1<r.mapUrl.indexOf("{y}")&&-1<r.mapUrl.indexOf("{z}")?this.getTiles({material:i,imageType:"map",tilesOptions:this.getTilesOptions(r.mapUrl,this.options.bbox_background),baseUrl:window.location.origin}):u.load(r.mapUrl,function(e){i.opacity=l,e.wrapS=e.wrapT=f.MirroredRepeatWrapping,e.repeat.set(1,1),e.anisotropy=1,i.map=e,i.needsUpdate=!0})):i.map=null,e.normal.show==n.show&&e.normal.normalMap==n.normalMap&&e.normal.normalScale==n.normalScale||(n.show&&n.normalMap?(n.normalMap&&-1<n.normalMap.indexOf("{x}")&&-1<n.normalMap.indexOf("{y}")&&-1<n.normalMap.indexOf("{z}")?this.getTiles({material:i,imageType:"normalMap",tilesOptions:this.getTilesOptions(n.normalMap,this.options.bbox_background),baseUrl:window.location.origin}):u.load(n.normalMap,function(e){e.wrapS=e.wrapT=f.MirroredRepeatWrapping,e.repeat.set(1,1),e.anisotropy=20,i.normalMap=e,i.needsUpdate=!0}),o=.1*n.normalScale,i.normalScale=new f.Vector2(o,o)):(i.normalMap=null,i.normalScale=null)),e.emissive.show==t.show&&e.emissive.emissive==t.emissive&&e.emissive.emissiveMap==t.emissiveMap&&e.emissive.emissiveIntensity==t.emissiveIntensity||(t.show?(i.emissive=new f.Color(a[0],a[1],a[2]),t.emissiveMap&&-1<t.emissiveMap.indexOf("{x}")&&-1<t.emissiveMap.indexOf("{y}")&&-1<t.emissiveMap.indexOf("{z}")?this.getTiles({material:i,imageType:"emissiveMap",tilesOptions:this.getTilesOptions(t.emissiveMap,this.options.bbox_background),baseUrl:window.location.origin}):u.load(t.emissiveMap,function(e){e.wrapS=e.wrapT=f.MirroredRepeatWrapping,e.repeat.set(1,1),e.anisotropy=20,i.emissiveMap=e,i.needsUpdate=!0}),i.emissiveIntensity=.01*t.emissiveIntensity):(i.emissive=new f.Color("#000"),i.emissiveMap=null,i.emissiveIntensity=0)),i.needsUpdate=!0}},{key:"initSideMaterial",value:function(e){var i=new f.MeshStandardMaterial({transparent:!0,depthWrite:!0,depthTest:!0}),e=e.sideTexture,t=e.color,s=e.map,e=e.emissive,t=p(t).gl(),a=(e.show?p(e.emissive):p("#fff")).gl(),o=t[3];return e.show&&(o*=a[3]),i.opacity=o,i.color=new f.Color(t[0],t[1],t[2]),i.map=this.textureLoaderFun(s,1e-6,1,1),e.show?(i.emissive=new f.Color(a[0],a[1],a[2]),i.emissiveMap=this.textureLoaderFun(e.emissiveMap,1e-6,1,1),i.emissiveIntensity=.01*e.emissiveIntensity):(i.emissive=new f.Color("#000"),i.emissiveMap=null,i.emissiveIntensity=0),i.needsUpdate=!0,i}},{key:"updateSideMaterial",value:function(e,i,t){var i=m(i.sideTexture),t=t.sideTexture,s=t.color,a=t.map,t=t.emissive,o=p(s).gl(),r=(t.show?p(t.emissive):p("#fff")).gl(),n=o[3];t.show&&(n*=r[3]),e.opacity=n,i.color!=s&&(e.color=new f.Color(o[0],o[1],o[2])),i.map!=a&&(e.map=this.textureLoaderFun(a,1e-6,1,1)),i.emissive.show==t.show&&i.emissive.emissive==t.emissive&&i.emissive.emissiveMap==t.emissiveMap&&i.emissive.emissiveIntensity==t.emissiveIntensity||(t.show?(i.emissive.emissive!=t.emissive&&(e.emissive=new f.Color(r[0],r[1],r[2])),i.emissive.emissiveMap!=t.emissiveMap&&(e.emissiveMap=this.textureLoaderFun(t.emissiveMap,1e-6,1,1)),i.emissive.emissiveIntensity!=t.emissiveIntensity&&(e.emissiveIntensity=.01*t.emissiveIntensity)):(e.emissive=new f.Color("#000"),e.emissiveMap=null,e.emissiveIntensity=0)),e.needsUpdate=!0}},{key:"textureLoaderFun",value:function(e,i,t,s){var a=null;return e&&((a=u.load(e)).wrapS=a.wrapT=f.MirroredRepeatWrapping,a.repeat.set(i,t),a.anisotropy=s,a.needsUpdate=!0),a}},{key:"updateOptions",value:function(e){var i,t=m(this.options),s=(this.options=l(this.options,e||{}),m(t.topTexture)),a=m(t.sideTexture),o=this.options,r=o.topTexture,o=o.sideTexture,s=(s.metalness==r.metalness&&s.roughness==r.roughness&&s.color==r.color&&s.map==r.map&&s.normal.show==r.normal.show&&s.normal.normalMap==r.normal.normalMap&&s.normal.normalScale==r.normal.normalScale&&s.emissive.show==r.emissive.show&&s.emissive.emissive==r.emissive.emissive&&s.emissive.emissiveMap==r.emissive.emissiveMap&&s.emissive.emissiveIntensity==r.emissive.emissiveIntensity||this.updateTopMaterial(this.materialTop,t,this.options),a.color==o.color&&a.map==o.map&&a.emissive.show==o.emissive.show&&a.emissive.emissive==o.emissive.emissive&&a.emissive.emissiveMap==o.emissive.emissiveMap&&a.emissive.emissiveIntensity==o.emissive.emissiveIntensity||this.updateSideMaterial(this.materialSide,t,this.options),d.drawScale),r=d.baseHeightScale,a=d.baseHeightScale_background,n=(t.baseHeightScale_background==a&&e.baseHeightScale==r||(i=r*a*s*v,this.traverse(function(e){switch(e.meshType){case"meshTop":e.position.z=i;break;case"meshSide":e.scale.z=i}})),o.castShadow);t.sideTexture.castShadow!=n&&this.traverse(function(e){"meshSide"===e.meshType&&(e.ignoreWaterReflection=!n)}),this.checkVisible()}},{key:"checkVisible",value:function(){(this.options.visible?c(w(o.prototype),"show",this):c(w(o.prototype),"hide",this)).call(this)}},{key:"show",value:function(){this.options.visible=!0,c(w(o.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.options.visible=!1,c(w(o.prototype),"hide",this).call(this)}},{key:"destroy",value:function(){c(w(o.prototype),"remove",this).call(this),this.clear(),this.materialTop&&this.materialTop.dispose(),this.materialSide&&this.materialSide.dispose()}}])&&n(i.prototype,e),t&&n(i,t),Object.defineProperty(i,"prototype",{writable:!1}),o},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/chinaBorder/chinaBorderLineLayer",[],function(e,t,r,n,o,i){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){var r,n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=function(e,t){if(e){if("string"==typeof e)return s(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length)return n&&(e=n),r=0,{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var o,i=!0,a=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return i=e.done,e},e:function(e){a=!0,o=e},f:function(){try{i||null==n.return||n.return()}finally{if(a)throw o}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function d(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function v(){return(v="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=w(e)););return e}(e,t);if(n)return n=Object.getOwnPropertyDescriptor(n,t),n.get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function g(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=w(r),t=(e=n?(e=w(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return b(t)}}function b(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function w(e){return(w=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var j=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/chinaBorder/lib/meshLine"),k={0:{key:"country",dashArray:[0,1,0,0,0]},1:{key:"country",dashArray:[1.5,3,3,3,1.5]},2:{key:"ocean",dashArray:[0,1,0,0,0]},3:{key:"province",dashArray:[0,1,0,0,0]},4:{key:"province",dashArray:[1.5,10,3,5,1.5]},5:{key:"country",dashArray:[0,1,0,0,0]}};return e.exports=function(a){var c=a.THREE,e=a.Utils,r=e.mergeOptions,o=e.Chroma,t=e.deepClone,s=(e.geojsonBBox,e.geojsonFlatten),l=e.coordtransformCli,u=e.BASE_HEIGHT_SCALE,f=j(c),e=(new c.Vector3,a.Layer),n=p;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(e&&e.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),e&&m(n,e);var i,h=g(p);function p(e){if(!(this instanceof p))throw new TypeError("Cannot call a class as a function");var t;return(t=h.call(this,e)).options=r({isSceneGroup:!1,sceneNames:[{sceneName:"main"}],visible:!0,renderOrder:16,country:{show:!0,color:"#bae7ff",width:4},ocean:{show:!0,color:"#14fad0",width:2},province:{show:!0,color:"#e6f7ff",width:2}},e||{}),t.renderQueue=a.VOGO.Geometry,t.needsAutoUpdate=!0,t.mappingData=[],t.mappingDataMap={},t.addMesh=t.addMesh.bind(b(t)),t.genGeojson=t.genGeojson.bind(b(t)),t.checkVisible=t.checkVisible.bind(b(t)),t.materials={},t.createMaterial(),t.updateOptions(t.options),t}return n=p,(e=[{key:"traverse",value:function(t){this.group&&this.group.traverse&&this.group.traverse(function(e){(e instanceof c.Mesh||e instanceof c.InstancedMesh||e instanceof c.LineSegments||e instanceof c.Sprite)&&t&&t(e)})}},{key:"setGeojson",value:function(e){this.geojson=e||{type:"FeatureCollection",features:[]};for(var t,r={type:"FeatureCollection",features:[]},n=0;n<this.geojson.features.length;n++)!(t=this.geojson.features[n]).geometry||"LineString"!=t.geometry.type&&"MultiLineString"!=t.geometry.type||r.features.push(t);this.geojson=r,this.genGeojson()}},{key:"render",value:function(e){var t;this.mappingData=e||[],this.mappingDataMap={};for(var r=0;r<e.length;r++)t=e[r],this.mappingDataMap[t.area_id]=t;this.geojson&&this.genGeojson()}},{key:"genGeojson",value:function(){this.clear();var e,t=a.baseHeightScale,r=(a.lowHeightScale,a.drawScale),n=y(l.wgs84ToMecator(this.geojson,a.proj.proj).features);try{for(n.s();!(e=n.n()).done;){var o=e.value,i=s(o);this.addMesh({features:i,height:r*u*(t+.01)})}}catch(e){n.e(e)}finally{n.f()}this.checkVisible()}},{key:"updateBaseHeight",value:function(e){this.group.scale.z=e}},{key:"addMesh",value:function(e){for(var t=e.features,r=e.height,n=[],o=0;o<t.length;o++){for(var i=t[o],a=i.geometry.coordinates,s=(i.properties,[]),l=0;l<a.length;l++){var u=a[l];s.push(u[0],u[1],r)}n.push(s)}e=new f.MeshLine,e.setPoints(n),e=new c.Mesh(e,this.materials[t[0].properties.id]);e.meshType="1",e.frustumCulled=!1,this.add(e)}},{key:"autoUpdate",value:function(){Object.values(this.materials).forEach(function(e){e.uniforms.u_lengthPerPixel.value=a.lengthPerPixel})}},{key:"updateOptions",value:function(e){var n=this;t(this.options);this.options=r(this.options,e||{}),Object.keys(this.materials).forEach(function(e){var t=n.options[k[e].key],e=n.materials[e],r=(e.visibility=null==(r=null==t?void 0:t.show)||r,o(null!=(r=null==t?void 0:t.color)?r:"#8c8c8c").gl());e.color.setRGB(r[0],r[1],r[2]),e.opacity=r[3],e.lineWidth=null!=(r=null==t?void 0:t.width)?r:3}),this.checkVisible()}},{key:"createMaterial",value:function(){var t=this,r=new c.Vector2;a.engine.renderer.getSize(r),Object.keys(k).forEach(function(e){t.materials[e]=new f.MeshLineMaterial({resolution:r,lineWidth:2,color:"#fff",sizeAttenuation:!1,dashArray:k[e].dashArray,transparent:!0})})}},{key:"updateMaterial",value:function(){var e=new c.Vector2,e=(a.engine.renderer.getSize(e),material.uniforms.resolution.value=e,material.uniforms.USE_MAP=!1,material.uniforms.drawScale.value=a.drawScale,material.uniforms.lineLengthMax.value=110,material.uniforms.lineLength.value=100,material.uniforms.lineWidth.value=lineStyle.weight,o(lineStyle.strokeColor).gl());material.uniforms.lineColor.value=e,material.uniforms.lineHeadColor.value=e,material.uniforms.symbolColor.value=e}},{key:"checkVisible",value:function(){(this.options.visible?v(w(p.prototype),"show",this):v(w(p.prototype),"hide",this)).call(this)}},{key:"show",value:function(){this.options.visible=!0,this.options.visible&&v(w(p.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.options.visible=!1,v(w(p.prototype),"hide",this).call(this)}},{key:"destroy",value:function(){v(w(p.prototype),"remove",this).call(this),this.clear(),this.needsAutoUpdate=!1,this.material&&this.material.dispose&&this.material.dispose(),this.options=null}}])&&d(n.prototype,e),i&&d(n,i),Object.defineProperty(n,"prototype",{writable:!1}),p},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/Parser/geojsonDecode",["datav:/npm/topojson-client/3.1.0","datav:/npm/@mapbox/polyline/1.1.1"],function(e,o,r,a,t,n){var p=r("datav:/npm/topojson-client/3.1.0").feature,g=r("datav:/npm/@mapbox/polyline/1.1.1");function u(e,o){for(var r=[],a=o[0],t=o[1],n=0;n<e.length;n+=2){var l=(l=e.charCodeAt(n)-64)>>1^-(1&l),c=(c=e.charCodeAt(n+1)-64)>>1^-(1&c);l+=a,c+=t,r.push([(a=l)/1024,(t=c)/1024])}return r}return e.exports=function(e){if(!e.polyarcs&&!e.UTF8Encoding)return p(e,e.objects.collection);if(!e._flagEd)return e;if(3!==e._flagEd){var o=e;if(o._isParsed)return(r=p(o,o.objects.collection))._flagEd=0,r;o.arcs=o.polyarcs.map(function(e){return g.decode(e,o._flagEd)}),o.polyarcs=null;var r=p(o,o.objects.collection);return r._flagEd=0,o._isParsed=!0,r}if(!(r=e)._isParsed){for(var a=r.features,t=0;t<a.length;t++)for(var n=a[t],l=n.geometry.coordinates,c=n.geometry.encodeOffsets,d=0;d<l.length;d++){var s=l[d];if("Polygon"===n.geometry.type)l[d]=u(s,c[d]);else if("MultiPolygon"===n.geometry.type)for(var f=0;f<s.length;f++){var i=s[f];s[f]=u(i,c[d][f])}}r._flagEd=0,r._isParsed=!0}return r},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/dynamicDecoration",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(e,t,r,n,o,a){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function s(e,t){return(s=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=l(r),t=(e=n?(e=l(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function l(e){return(l=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=r("datav:/npm/eventemitter3/3.0.0"),f=r("datav:/npm/safely-merge/1.0.1"),p=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/dynamicDecoration/dynamicDecorationLayer"),d=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/dynamicDecoration/config").DEFAULT_OPTIONS,r=function(){var e=o,t=u;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&s(e,t);var r,n=y(o);function o(e){var t;if(this instanceof o)return(t=n.call(this)).options=f(d,e||{}),t.visible=!0,t;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"addTo",value:function(e,t){this.layerId=t;t=p(e);this.layer=new t(this.options),e.addLayer(this.layerId+"_layer",this.layer),this.visible?this.layer.show():this.layer.hide()}},{key:"render",value:function(e,t){this.layer&&this.layer.render&&this.layer.render(e,t)}},{key:"updateOptions",value:function(e){this.layer&&this.layer.updateOptions&&this.layer.updateOptions(e)}},{key:"update",value:function(){this.layer&&this.layer.update&&this.layer.update()}},{key:"show",value:function(){this.visible=!0,this.layer&&this.layer.show&&this.layer.show()}},{key:"hide",value:function(){this.visible=!1,this.layer&&this.layer.hide&&this.layer.hide()}},{key:"destroy",value:function(){this.layer&&(this.layer.destory&&this.layer.destory(),this.layer=null)}}])&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}();return e.exports=r,e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/grid",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(e,t,r,n,o,i){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function l(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=s(r),t=(e=n?(e=s(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function s(e){return(s=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=r("datav:/npm/eventemitter3/3.0.0"),f=r("datav:/npm/safely-merge/1.0.1"),p=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/grid/gridLayer"),d=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/grid/config").DEFAULT_OPTIONS,r=function(){var e=o,t=y;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t);var r,n=l(o);function o(e){var t;if(this instanceof o)return(t=n.call(this)).options=f(d,e||{}),t.visible=!0,t;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"addTo",value:function(e,t){this.layerId=t;t=p(e);this.layer=new t(this.options),e.addLayer(this.layerId+"_layer",this.layer),this.visible?this.layer.show():this.layer.hide()}},{key:"render",value:function(e,t){this.layer&&this.layer.render&&this.layer.render(e,t)}},{key:"updateOptions",value:function(e){this.layer&&this.layer.updateOptions(e)}},{key:"show",value:function(){this.visible=!0,this.layer&&this.layer.show()}},{key:"hide",value:function(){this.visible=!1,this.layer&&this.layer.hide()}},{key:"destroy",value:function(){this.layer&&(this.layer.remove(),this.layer=null)}}])&&c(e.prototype,t),r&&c(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}();return e.exports=r,e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/water",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(e,t,r,n,o,a){function i(e){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=n?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===i(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=r("datav:/npm/eventemitter3/3.0.0"),f=r("datav:/npm/safely-merge/1.0.1"),p=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/water/waterLayer"),d=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/water/config").DEFAULT_OPTIONS,r=function(){var e=o,t=y;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t);var r,n=u(o);function o(e){var t;if(this instanceof o)return(t=n.call(this)).options=f(d,e||{}),t.visible=!0,t;throw new TypeError("Cannot call a class as a function")}return e=o,(t=[{key:"addTo",value:function(e,t){this.layerId=t,this.options=f(this.options,{relativeHeight:-10});t=p(e);this.layer=new t(this.options),e.addLayer(this.layerId+"_layer",this.layer),this.visible?this.layer.show():this.layer.hide()}},{key:"render",value:function(e){this.layer&&this.layer.render&&this.layer.render(e)}},{key:"updateOptions",value:function(e){this.layer&&this.layer.updateOptions(e)}},{key:"update",value:function(){this.layer&&this.layer.update&&this.layer.update()}},{key:"show",value:function(){this.visible=!0,this.layer&&this.layer.show()}},{key:"hide",value:function(){this.visible=!1,this.layer&&this.layer.hide()}},{key:"destroy",value:function(){this.layer&&(this.layer.destory&&this.layer.destory(),this.layer=null)}}])&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),o}();return e.exports=r,e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(e,t,r,a,n,i){function s(e){return(s="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(r){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=u(r),t=(e=a?(e=u(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===s(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var c=r("datav:/npm/eventemitter3/3.0.0"),d=r("datav:/npm/safely-merge/1.0.1"),h=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/extrudeLayer"),f=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/lineLayer"),p=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/flyinglineLayer"),v=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/labelLayer"),b=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/src/areaLayer"),L=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain/config").DEFAULT_OPTIONS,r=function(){var e=n,t=c;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t);var r,a=y(n);function n(e,t){var r;if(this instanceof n)return(r=a.call(this)).options=d(L,e||{}),r.status=t,r.layers={extrudeLayer:null,areaLayer:null,lineLayer:null,labelLayer:null},r.visible=!0,r;throw new TypeError("Cannot call a class as a function")}return e=n,(t=[{key:"addTo",value:function(e,t){this.viewer=e,this.layerId=t;t=h(e),this.layers.extrudeLayer=new t(this.options,this.status),e.addLayer(this.layerId+"_extrudeLayer",this.layers.extrudeLayer),t=b(e),this.layers.areaLayer=new t(this.options,this.status),e.addLayer(this.layerId+"_areaLayer",this.layers.areaLayer),t=f(e),this.layers.lineLayer=new t(this.options,this.status),e.addLayer(this.layerId+"_lineLayer",this.layers.lineLayer),t=p(e),this.layers.flyinglineLayer=new t(this.options,this.status),e.addLayer(this.layerId+"_flyinglineLayer",this.layers.flyinglineLayer),t=v(e);if(this.layers.labelLayer=new t(this.options,this.status),e.addLayer(this.layerId+"_labelLayer",this.layers.labelLayer),this.options.visible)for(var r in this.layers)this.layers[r].show&&this.layers[r].show();else for(var a in this.layers)this.layers[a].hide&&this.layers[a].hide()}},{key:"render",value:function(e){var t=e.geojson_children;this.layers.extrudeLayer.render(e),this.layers.labelLayer.render(e),this.layers.areaLayer.setGeojson(t),this.layers.lineLayer.setGeojson(t),this.layers.flyinglineLayer.setGeojson(t)}},{key:"updateOptions",value:function(e){for(var t in this.options=d(this.options,e||{}),this.layers)this.layers[t].updateOptions&&this.layers[t].updateOptions(this.options)}},{key:"show",value:function(){for(var e in this.visible=!0,this.layers)this.layers[e].show&&this.layers[e].show()}},{key:"hide",value:function(){for(var e in this.visible=!1,this.layers)this.layers[e].hide&&this.layers[e].hide()}},{key:"destroy",value:function(){for(var e in this.layers)this.layers[e].destroy&&this.layers[e].destroy(),this.layers[e]=null}}])&&o(e.prototype,t),r&&o(e,r),Object.defineProperty(e,"prototype",{writable:!1}),n}();return e.exports=r,e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(e,t,r,a,i,n){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(r){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=h(r),t=(e=a?(e=h(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=r("datav:/npm/eventemitter3/3.0.0"),c=r("datav:/npm/safely-merge/1.0.1"),d=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/src/backgroundTerrainLayer"),p=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/src/line"),b=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/src/label"),f=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain/config").DEFAULT_OPTIONS,r=function(){var e=i,t=u;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t);var r,a=y(i);function i(e,t){var r;if(this instanceof i)return(r=a.call(this)).options=c(f,e||{}),r.visible=!0,r.status=t,r;throw new TypeError("Cannot call a class as a function")}return e=i,(t=[{key:"addTo",value:function(e,t){this.layerId=t;t=d(e),this.layer=new t(this.options,this.status),e.addLayer(this.layerId+"_layer",this.layer),this.visible?this.layer.show():this.layer.hide(),t=p(e),this.lineLayer=new t(this.options,this.status),e.addLayer(this.layerId+"_lineLayer",this.lineLayer),this.visible?this.lineLayer.show():this.lineLayer.hide(),t=b(e);this.labelLayer=new t(this.options,this.status),e.addLayer(this.layerId+"_labelLayer",this.labelLayer),this.visible?this.labelLayer.show():this.labelLayer.hide()}},{key:"render",value:function(e){this.layer&&this.layer.render(e),this.lineLayer&&this.lineLayer.render(e),this.labelLayer&&this.labelLayer.render(e)}},{key:"updateOptions",value:function(e){this.options=c(this.options,e||{}),this.layer&&this.layer.updateOptions&&this.layer.updateOptions(e),this.lineLayer&&this.lineLayer.updateOptions&&this.lineLayer.updateOptions(e),this.labelLayer&&this.labelLayer.updateOptions&&this.labelLayer.updateOptions(e)}},{key:"show",value:function(){this.visible=!0,this.layer&&this.layer.show&&this.layer.show(),this.lineLayer&&this.lineLayer.show&&this.lineLayer.show(),this.labelLayer&&this.labelLayer.show&&this.labelLayer.show()}},{key:"hide",value:function(){this.visible=!1,this.layer&&this.layer.hide&&this.layer.hide(),this.lineLayer&&this.lineLayer.hide&&this.lineLayer.hide(),this.labelLayer&&this.labelLayer.hide&&this.labelLayer.hide()}},{key:"destroy",value:function(){this.layer&&(this.layer.destroy(),this.layer=null),this.lineLayer&&(this.lineLayer.destroy(),this.lineLayer=null),this.labelLayer&&(this.labelLayer.destroy(),this.labelLayer=null)}}])&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),i}();return e.exports=r,e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/CopyShader",[],function(e,i,a,o,t,v){var r={uniforms:{tDiffuse:{value:null},opacity:{value:1}},vertexShader:["varying vec2 vUv;","void main() {","vUv = uv;","gl_Position = projectionMatrix * modelViewMatrix * vec4( position, 1.0 );","}"].join("\n"),fragmentShader:["uniform float opacity;","uniform sampler2D tDiffuse;","varying vec2 vUv;","void main() {","vec4 texel = texture2D( tDiffuse, vUv );","gl_FragColor = opacity * texel;","}"].join("\n")};return e.exports=r,e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/geometry/geojsonExtrude",["datav:/npm/regenerator-runtime/0.13.7"],function(t,e,r,o,n,a){function j(t){return(j="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function L(){"use strict";L=function(){return i};var i={},t=Object.prototype,u=t.hasOwnProperty,e="function"==typeof Symbol?Symbol:{},o=e.iterator||"@@iterator",r=e.asyncIterator||"@@asyncIterator",n=e.toStringTag||"@@toStringTag";function a(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{a({},"")}catch(t){a=function(t,e,r){return t[e]=r}}function s(t,e,r,o){var n,a,i,s,e=e&&e.prototype instanceof h?e:h,e=Object.create(e.prototype),o=new b(o||[]);return e._invoke=(n=t,a=r,i=o,s="suspendedStart",function(t,e){if("executing"===s)throw new Error("Generator is already running");if("completed"===s){if("throw"===t)throw e;return _()}for(i.method=t,i.arg=e;;){var r=i.delegate;if(r){r=function t(e,r){var o=e.iterator[r.method];if(void 0===o){if(r.delegate=null,"throw"===r.method){if(e.iterator.return&&(r.method="return",r.arg=void 0,t(e,r),"throw"===r.method))return f;r.method="throw",r.arg=new TypeError("The iterator does not provide a 'throw' method")}return f}o=c(o,e.iterator,r.arg);if("throw"===o.type)return r.method="throw",r.arg=o.arg,r.delegate=null,f;o=o.arg;return o?o.done?(r[e.resultName]=o.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=void 0),r.delegate=null,f):o:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,f)}(r,i);if(r){if(r===f)continue;return r}}if("next"===i.method)i.sent=i._sent=i.arg;else if("throw"===i.method){if("suspendedStart"===s)throw s="completed",i.arg;i.dispatchException(i.arg)}else"return"===i.method&&i.abrupt("return",i.arg);s="executing";r=c(n,a,i);if("normal"===r.type){if(s=i.done?"completed":"suspendedYield",r.arg===f)continue;return{value:r.arg,done:i.done}}"throw"===r.type&&(s="completed",i.method="throw",i.arg=r.arg)}}),e}function c(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}i.wrap=s;var f={};function h(){}function l(){}function p(){}var e={},v=(a(e,o,function(){return this}),Object.getPrototypeOf),v=v&&v(v(x([]))),g=(v&&v!==t&&u.call(v,o)&&(e=v),p.prototype=h.prototype=Object.create(e));function d(t){["next","throw","return"].forEach(function(e){a(t,e,function(t){return this._invoke(e,t)})})}function y(i,s){var e;this._invoke=function(r,o){function t(){return new s(function(t,e){!function e(t,r,o,n){var a,t=c(i[t],i,r);if("throw"!==t.type)return(r=(a=t.arg).value)&&"object"==j(r)&&u.call(r,"__await")?s.resolve(r.__await).then(function(t){e("next",t,o,n)},function(t){e("throw",t,o,n)}):s.resolve(r).then(function(t){a.value=t,o(a)},function(t){return e("throw",t,o,n)});n(t.arg)}(r,o,t,e)})}return e=e?e.then(t,t):t()}}function m(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function w(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function b(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(m,this),this.reset(!0)}function x(e){if(e){var r,t=e[o];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length))return r=-1,(t=function t(){for(;++r<e.length;)if(u.call(e,r))return t.value=e[r],t.done=!1,t;return t.value=void 0,t.done=!0,t}).next=t}return{next:_}}function _(){return{value:void 0,done:!0}}return a(g,"constructor",l.prototype=p),a(p,"constructor",l),l.displayName=a(p,n,"GeneratorFunction"),i.isGeneratorFunction=function(t){t="function"==typeof t&&t.constructor;return!!t&&(t===l||"GeneratorFunction"===(t.displayName||t.name))},i.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,p):(t.__proto__=p,a(t,n,"GeneratorFunction")),t.prototype=Object.create(g),t},i.awrap=function(t){return{__await:t}},d(y.prototype),a(y.prototype,r,function(){return this}),i.AsyncIterator=y,i.async=function(t,e,r,o,n){void 0===n&&(n=Promise);var a=new y(s(t,e,r,o),n);return i.isGeneratorFunction(e)?a:a.next().then(function(t){return t.done?t.value:a.next()})},d(g),a(g,n,"Generator"),a(g,o,function(){return this}),a(g,"toString",function(){return"[object Generator]"}),i.keys=function(r){var t,o=[];for(t in r)o.push(t);return o.reverse(),function t(){for(;o.length;){var e=o.pop();if(e in r)return t.value=e,t.done=!1,t}return t.done=!0,t}},i.values=x,b.prototype={constructor:b,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(w),!t)for(var e in this)"t"===e.charAt(0)&&u.call(this,e)&&!isNaN(+e.slice(1))&&(this[e]=void 0)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(r){if(this.done)throw r;var o=this;function t(t,e){return a.type="throw",a.arg=r,o.next=t,e&&(o.method="next",o.arg=void 0),!!e}for(var e=this.tryEntries.length-1;0<=e;--e){var n=this.tryEntries[e],a=n.completion;if("root"===n.tryLoc)return t("end");if(n.tryLoc<=this.prev){var i=u.call(n,"catchLoc"),s=u.call(n,"finallyLoc");if(i&&s){if(this.prev<n.catchLoc)return t(n.catchLoc,!0);if(this.prev<n.finallyLoc)return t(n.finallyLoc)}else if(i){if(this.prev<n.catchLoc)return t(n.catchLoc,!0)}else{if(!s)throw new Error("try statement without catch or finally");if(this.prev<n.finallyLoc)return t(n.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;0<=r;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&u.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var n=o;break}}var a=(n=n&&("break"===t||"continue"===t)&&n.tryLoc<=e&&e<=n.finallyLoc?null:n)?n.completion:{};return a.type=t,a.arg=e,n?(this.method="next",this.next=n.finallyLoc,f):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),f},finish:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),w(r),f}},catch:function(t){for(var e=this.tryEntries.length-1;0<=e;--e){var r,o,n=this.tryEntries[e];if(n.tryLoc===t)return"throw"===(r=n.completion).type&&(o=r.arg,w(n)),o}throw new Error("illegal catch attempt")},delegateYield:function(t,e,r){return this.delegate={iterator:x(t),resultName:e,nextLoc:r},"next"===this.method&&(this.arg=void 0),f}},i}function s(t,e,r,o,n,a,i){try{var s=t[a](i),u=s.value}catch(t){return void r(t)}s.done?e(u):Promise.resolve(u).then(o,n)}var u,i,U=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/geo/projection").coordtransformCli,c=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/geometry/geojsonExtrude/bufferAttributes"),V=c.top,W=c.side,c=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils"),X=c.geojsonBBox,Z=c.geojsonFlatten,$=c.geojsonDissolve,tt=c.turf;r("datav:/npm/regenerator-runtime/0.13.7");function et(t){for(var e=0;e<t.features.length;e++){for(var r,o=(r=t.features[e]).geometry.coordinates,n=[],a=0;a<o.length;a++){var i=o[a][0],s=o[a][o[a].length-1];i[0]==s[0]&&i[1]==s[1]?n.push(o[a]):10<o[a].length&&(o[a].push(i),n.push(o[a]))}r.geometry.coordinates=n}}return t.exports=(u=L().mark(function t(e){return L().wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(1==e.extrude)return t.abrupt("return",function(t){for(var e,r=t.json,c=t.extrude,o=t.proj,n=(t.bbox,t.bboxProj),a=t.height||1,A=t.bboxLowHeightScale||100,I=Math.max(Math.abs(n[2]-n[0]),Math.abs(n[3]-n[1])),i=Object.assign({},r),s=(Z(i),et(i),[]),u=[],f=0;f<i.features.length;f++)e=(v=i.features[f]).properties,v&&(e&&e.name&&"JD"==e.name?u:s).push(v);var i={type:"FeatureCollection",features:[{type:"Feature",properties:{},geometry:$(s)}]},h={type:"FeatureCollection",features:[]},l={type:"FeatureCollection",features:[]};Z(i),et(i);for(var p=0;p<i.features.length;p++){var v=i.features[p],g=X(U.wgs84ToMecator(v,o.proj));(I/Math.max(Math.abs(g[2]-g[0]),Math.abs(g[3]-g[1]))<A?h:l).features.push(v)}for(var d=0;d<u.length;d++)l.features.push(u[d]);for(var r=U.wgs84ToMecator(h,o.proj),B=U.wgs84ToMecator(l,o.proj),y=Math.abs(n[2]-n[0]),m=Math.abs(n[3]-n[1]),t=t.bufferRadius||1e3/6783e3*(y+m)/2,w=(t*=10,{type:"FeatureCollection",features:[]}),b=0;b<h.features.length;b++){var x=h.features[b],_=x.geometry.coordinates;if(x.geometry&&1<_.length){for(var j=[],L=0;L<_.length;L++){var E=_[L];if(4<E.length){for(var F=[],M=0;M<E.length;M++)F.push([+E[M][0].toFixed(6),+E[M][1].toFixed(6)]);j.push(F)}}h.features[b].geometry.coordinates=j}0<_.length&&w.features.push(h.features[b])}et(h=w);for(var y=tt.buffer(h,t,{units:"meters",steps:1}),m=U.wgs84ToMecator(y,o.proj),O=(Z(m),{type:"FeatureCollection",features:[]}),S=0;S<l.features.length;S++){var P=l.features[S],k=P.geometry.coordinates;if(P.geometry&&1<k.length){for(var T=[],C=0;C<k.length;C++){var D=k[C];4<D.length&&T.push(D)}l.features[S].geometry.coordinates=T}0<k.length&&O.features.push(l.features[S])}var l=O,Y={indices:[],positions:[],normals:[],uvs:[],f_attr0:[],i_attr0:[],groups:[]},H={indices:[],positions:[],normals:[],uvs:[],f_attr0:[],i_attr0:[],groups:[]},J={indices:[],positions:[],normals:[],uvs:[],f_attr0:[],i_attr0:[],groups:[]},R={indices:[],positions:[],normals:[],uvs:[],f_attr0:[],i_attr0:[],groups:[]},q={indices:[],positions:[],normals:[],uvs:[],f_attr0:[],i_attr0:[],groups:[]};function z(t,e){for(var r=0;r<t.features.length;r++){var o=t.features[r].geometry.coordinates;o.length<1||(1===e?(V(o,n,a,Y),W(o,n,a,H)):(V(o,n,a,R),W(o,n,a,q)))}}z(r,1),z(B,0);for(var K=m,G=0;G<K.features.length;G++){var Q=K.features[G].geometry.coordinates;W(Q,n,a,J)}function N(t,e,r,o){for(var n=0;n<o.indices.length;n++)r.indices.push(o.indices[n]);for(var a=0;a<o.positions.length;a++)r.positions.push(o.positions[a]);for(var i=0;i<o.normals.length;i++)r.normals.push(o.normals[i]);for(var s=0;s<o.uvs.length;s++)r.uvs.push(o.uvs[s]);for(var u=0;u<o.f_attr0.length;u++)r.fAttr0.push(o.f_attr0[u]);r.groups.push(c,t,e,o.indices.length,o.positions.length/3)}return N(1,0,t={indices:[],positions:[],normals:[],uvs:[],fAttr0:[],groups:[]},Y),N(1,1,t,H),1===c&&N(1,2,t,J),N(0,0,t,R),N(0,1,t,q),t}(e));t.next=4;break;case 4:if(0==e.extrude)return t.abrupt("return",function(t){for(var e,r=t.json,o=t.proj,c=t.extrude,n=t.bboxProj,a=t.height||1,i={type:"FeatureCollection",features:[]},s=0;s<r.features.length;s++)(e=(p=r.features[s]).geometry)&&("Polygon"===e.type||"MultiPolygon"===e.type)&&e.coordinates&&0<e.coordinates.length&&i.features.push(p);et(i);for(var u=U.wgs84ToMecator(i,o.proj),f={indices:[],positions:[],normals:[],uvs:[],f_attr0:[],i_attr0:[],groups:[]},h={indices:[],positions:[],normals:[],uvs:[],f_attr0:[],i_attr0:[],groups:[]},l=0;l<u.features.length;l++){var p,v=(p=u.features[l]).geometry.coordinates;v.length<1||(V(v,n,a,f),W(v,n,a,h))}function g(t,e,r,o){for(var n=0;n<o.indices.length;n++)r.indices.push(o.indices[n]);for(var a=0;a<o.positions.length;a++)r.positions.push(o.positions[a]);for(var i=0;i<o.normals.length;i++)r.normals.push(o.normals[i]);for(var s=0;s<o.uvs.length;s++)r.uvs.push(o.uvs[s]);for(var u=0;u<o.f_attr0.length;u++)r.fAttr0.push(o.f_attr0[u]);r.groups.push(c,t,e,o.indices.length,o.positions.length/3)}return g(1,0,t={indices:[],positions:[],normals:[],uvs:[],fAttr0:[],groups:[]},f),g(1,1,t,h),t}(e));t.next=6;break;case 6:case"end":return t.stop()}},t)}),i=function(){var t=this,i=arguments;return new Promise(function(e,r){var o=u.apply(t,i);function n(t){s(o,e,r,n,a,"next",t)}function a(t){s(o,e,r,n,a,"throw",t)}n(void 0)})},function(t){return i.apply(this,arguments)}),t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/geo/projection/mercator",[],function(t,a,r,n,o,e){return t.exports={project:function(t){var a=20037508.34*t[0]/180,r=((t[0]<-11&&34<=t[1]||t[0]<-21&&t[1]<34)&&(a=20037508.34*(t[0]+360)/180),Math.log(Math.tan((90+t[1])*Math.PI/360))/(Math.PI/180)*20037508.34/180);return[a=Math.round(a),Math.round(r),+t[2]||0]},unproject:function(t){var a=t[0]/20037508.34*180,r=-t[1]/20037508.34*180,r=180/Math.PI*(2*Math.atan(Math.exp(r*Math.PI/180))-Math.PI/2);return(a<-11&&34<=r||a<-21&&r<34)&&(a-=180),[a,r,t[1]]}},t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/geo/projection/coordtransformCli",["datav:/npm/coordtransform-cli/0.0.13"],function(a,r,o,t,n,d){var c=o("datav:/npm/coordtransform-cli/0.0.13"),e=o("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils").turf;return a.exports={transformGeoJSON:c,wgs84ToMecator:function(a,o){return a=JSON.parse(JSON.stringify(a)),e.meta.coordEach(a,function(a){var r=o([a[0],a[1]]);a[0]=Math.round(r[0]),a[1]=Math.round(r[1])}),a}},a.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/RenderPass",[],function(e,r,a,t,i,l){return e.exports=function(e){function r(e,r,a,t,i){l.call(this),this.scene=e,this.camera=r,this.overrideMaterial=a,this.clearColor=t,this.clearAlpha=void 0!==i?i:0,this.clear=!0,this.clearDepth=!1,this.needsSwap=!1}var l=a("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/Pass")(e);return r.prototype=Object.assign(Object.create(l.prototype),{constructor:r,render:function(e,r,a){var t,i,l,o=e.autoClear;e.autoClear=!1,void 0!==this.overrideMaterial&&(l=this.scene.overrideMaterial,this.scene.overrideMaterial=this.overrideMaterial),this.clearColor&&(t=e.getClearColor().getHex(),i=e.getClearAlpha(),e.setClearColor(this.clearColor,this.clearAlpha)),this.clearDepth&&e.clearDepth(),e.setRenderTarget(this.renderToScreen?null:a),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil),e.render(this.scene,this.camera),this.clearColor&&e.setClearColor(t,i),void 0!==this.overrideMaterial&&(this.scene.overrideMaterial=l),e.autoClear=o}}),r},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/Pass",[],function(e,t,n,r,s,i){return e.exports=function(e){var t,n,r=e.OrthographicCamera,s=e.PlaneBufferGeometry,i=e.Mesh;function a(){this.enabled=!0,this.needsSwap=!0,this.clear=!1,this.renderToScreen=!1}function o(e){this._mesh=new i(n,e)}return Object.assign(a.prototype,{setSize:function(){},render:function(){console.error("THREE.Pass: .render() must be implemented in derived pass.")}}),a.FullScreenQuad=(t=new r(-1,1,1,-1,0,1),n=new s(2,2),Object.defineProperty(o.prototype,"material",{get:function(){return this._mesh.material},set:function(e){this._mesh.material=e}}),Object.assign(o.prototype,{render:function(e){e.render(this._mesh,t)}}),o),a},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/ShaderPass",[],function(e,t,i,r,a,s){return e.exports=function(e){function t(e,t){s.call(this),this.textureID=void 0!==t?t:"tDiffuse",e instanceof r?(this.uniforms=e.uniforms,this.material=e):e&&(this.uniforms=a.clone(e.uniforms),this.material=new r({defines:Object.assign({},e.defines),uniforms:this.uniforms,vertexShader:e.vertexShader,fragmentShader:e.fragmentShader})),this.fsQuad=new s.FullScreenQuad(this.material)}var r=e.ShaderMaterial,a=e.UniformsUtils,s=i("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/Pass")(e);return t.prototype=Object.assign(Object.create(s.prototype),{constructor:t,render:function(e,t,r){this.uniforms[this.textureID]&&(this.uniforms[this.textureID].value=r.texture),this.fsQuad.material=this.material,this.renderToScreen?e.setRenderTarget(null):(e.setRenderTarget(t),this.clear&&e.clear(e.autoClearColor,e.autoClearDepth,e.autoClearStencil)),this.fsQuad.render(e)}}),t},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/EffectComposer",[],function(e,t,i,s,r,h){return e.exports=function(e){function t(e,t){var i,s;this.renderer=e,void 0===t?(i={minFilter:h,magFilter:h,format:a,stencilBuffer:!1},s=e.getSize(new n),this._pixelRatio=e.getPixelRatio(),this._width=s.width,this._height=s.height,(t=new d(this._width*this._pixelRatio,this._height*this._pixelRatio,i)).texture.name="EffectComposer.rt1"):(this._pixelRatio=1,this._width=t.width,this._height=t.height),this.renderTarget1=t,this.renderTarget2=t.clone(),this.renderTarget2.texture.name="EffectComposer.rt2",this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2,this.renderToScreen=!0,this.passes=[],void 0===o&&console.error("THREE.EffectComposer relies on CopyShader"),void 0===f&&console.error("THREE.EffectComposer relies on ShaderPass"),this.copyPass=new f(o),this.clock=new r}var r=e.Clock,h=e.LinearFilter,a=(e.Mesh,e.OrthographicCamera,e.PlaneBufferGeometry,e.RGBAFormat),n=e.Vector2,d=e.WebGLRenderTarget,o=i("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/CopyShader"),f=i("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/ShaderPass")(e);return Object.assign(t.prototype,{swapBuffers:function(){var e=this.readBuffer;this.readBuffer=this.writeBuffer,this.writeBuffer=e},addPass:function(e){this.passes.push(e);var t=this.renderer.getDrawingBufferSize(new n);e.setSize(t.width,t.height)},deletePass:function(e){e=this.passes.indexOf(e);0<=e&&this.passes.splice(e,1)},insertPass:function(e,t){this.passes.splice(t,0,e)},isLastEnabledPass:function(e){for(var t=e+1;t<this.passes.length;t++)if(this.passes[t].enabled)return!1;return!0},render:function(e){void 0===e&&(e=this.clock.getDelta());for(var t,i=this.renderer.getRenderTarget(),s=this.passes.length,r=0;r<s;r++)!1!==(t=this.passes[r]).enabled&&(t.renderToScreen=this.renderToScreen&&this.isLastEnabledPass(r),t.render(this.renderer,this.writeBuffer,this.readBuffer,e,!1),t.needsSwap&&this.swapBuffers());this.renderer.setRenderTarget(i)},reset:function(e){var t;void 0===e&&(t=this.renderer.getSize(new n),this._pixelRatio=this.renderer.getPixelRatio(),this._width=t.width,this._height=t.height,(e=this.renderTarget1.clone()).setSize(this._width*this._pixelRatio,this._height*this._pixelRatio)),this.renderTarget1.dispose(),this.renderTarget2.dispose(),this.renderTarget1=e,this.renderTarget2=e.clone(),this.writeBuffer=this.renderTarget1,this.readBuffer=this.renderTarget2},setSize:function(e,t){this._width=e,this._height=t;var i=this._width*this._pixelRatio,s=this._height*this._pixelRatio;this.renderTarget1.setSize(i,s),this.renderTarget2.setSize(i,s);for(var r=0;r<this.passes.length;r++)this.passes[r].setSize(i,s)},setPixelRatio:function(e){this._pixelRatio=e,this.setSize(this._width,this._height)}}),t},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils/canvas/roundRect",[],function(t,o,e,a,i,h){var p=e("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils/canvas/getDashArray");function m(t,o){return t.offset-o.offset}return CanvasRenderingContext2D.prototype.roundRect=function(t,o,e,a,i){var h=i.border,s=i.borderRadius,i=i.background,s={topRight:s.topRight>e||s.topRight>a?Math.min(e,a):s.topRight,bottomRight:s.bottomRight>e||s.bottomRight>a?Math.min(e,a):s.bottomRight,bottomLeft:s.bottomLeft>e||s.bottomLeft>a?Math.min(e,a):s.bottomLeft,topLeft:s.topLeft>e||s.topLeft>a?Math.min(e,a):s.topLeft},r=s.topLeft,n=s.topRight,f=s.bottomLeft,s=s.bottomRight;if(t+=h.weight/2,o+=h.weight/2,this.beginPath(),this.moveTo(t+r,o),this.arcTo(t+e,o,t+e,o+a,n),this.arcTo(t+e,o+a,t,o+a,s),this.arcTo(t,o+a,t,o,f),this.arcTo(t,o,t+e,o,r),this.closePath(),"linearGradient"===i.type){for(var l,n=i.value,s=n.angle,c=n.stops.sort(m),f=[e/2+Math.cos((s+180)/180*Math.PI)*e/2,a/2+Math.sin((s+180)/180*Math.PI)*a/2],t=[e/2+Math.cos(s/180*Math.PI)*e/2,a/2+Math.sin(s/180*Math.PI)*a/2],d=this.createLinearGradient(f[0],f[1],t[0],t[1]),g=0;g<c.length;g++)l=c[g],d.addColorStop(l.offset/100,l.color);this.fillStyle=d}else"flat"==i.type&&(this.fillStyle=i.value||"rgba(255,255,0,0.1)");return this.fill(),0<h.weight&&(this.lineWidth=h.weight,this.strokeStyle=h.color,this.setLineDash&&(o=p(h.dashArray),this.setLineDash(o)),this.stroke()),this},t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/Tools",[],function(t,e,n,r,o,i){return t.exports=function(t){var i=t.BufferAttribute,a=t.BufferGeometry;return{getBufferGeometry:function(e){var n,r,o=1<arguments.length&&void 0!==arguments[1]&&arguments[1];{if(e.position)return n=e.position.length,r=new a,Object.keys(e).forEach(function(t){"index"===t?0!==e.index.length&&(o?r.setIndex(new i(e.index,1)):Math.max(e.index)<65536?r.setIndex(new i(new Uint16Array(e.index),1)):r.setIndex(new i(new Uint32Array(e.index),1))):o?Math.round(e[t].length)===n?r.setAttribute(t,new i(e[t],3)):Math.round(3*e[t].length)===n?r.setAttribute(t,new i(e[t],1)):Math.round(3*e[t].length/2)===n?r.setAttribute(t,new i(e[t],2)):Math.round(3*e[t].length/4)===n&&r.setAttribute(t,new i(e[t],4)):Math.round(e[t].length)===n?r.setAttribute(t,new i(new Float32Array(e[t]),3)):Math.round(3*e[t].length)===n?r.setAttribute(t,new i(new Float32Array(e[t]),1)):Math.round(3*e[t].length/2)===n?r.setAttribute(t,new i(new Float32Array(e[t]),2)):Math.round(3*e[t].length/4)===n&&r.setAttribute(t,new i(new Float32Array(e[t]),4))}),r;console.error("getBufferGeometry必须包含position属性，将使用position作为基准生成BufferGeometry")}}}},t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer",[],function(e,r,a,t,i,n){function p(e){return function(e){if(Array.isArray(e))return o(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,r){if(e){if("string"==typeof e)return o(e,r);var a=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(a="Object"===a&&e.constructor?e.constructor.name:a)||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?o(e,r):void 0}}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function o(e,r){(null==r||r>e.length)&&(r=e.length);for(var a=0,t=new Array(r);a<r;a++)t[a]=e[a];return t}function s(e,r){for(var a=0;a<r.length;a++){var t=r[a];t.enumerable=t.enumerable||!1,t.configurable=!0,"value"in t&&(t.writable=!0),Object.defineProperty(e,t.key,t)}}var c=a("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/backgroundTerrain"),g=a("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/mainTerrain"),f=a("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/water"),m=a("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/grid"),b=a("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/dynamicDecoration"),y=a("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/Parser/geojsonDecode"),v=a("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer/chinaBorder/chinaBorderLineLayer");function j(e,r){return null!=e&&""!==e?e:r}return e.exports=function(w){var e,r,a,S=w.THREE,u=w.Utils,h=u.mergeOptions,k=u.geojsonBBox,D=u.geojsonExtrude,N=u.geojsonFlatten,_=u.geojsonDissolve,B=u.geojsonRewind,C=u.turf;return e=d,(r=[{key:"addTo",value:function(e){for(var r=this.options,a=r.nature,t=r.terrain,i=r.decoration,r=r.chinaBorderLine,n={water:a.water,grid:i.backgrounGrid,dynamicDecoration:i.dynamicDecoration,mainTerrain:t.mainTerrain,backgroundTerrain:t.backgroundTerrain,chinaBorderLine:null!=r?r:{}},o=["water","grid","dynamicDecoration","mainTerrain","backgroundTerrain","chinaBorderLine"],s=0;s<o.length;s++){var l=o[s];this.layers[l].addTo(e,l),"chinaBorderLine"===l&&(w.addLayer(l,this.layers[l]),this.layers.chinaBorderLine.updateBaseHeight(this.options.terrain.mainTerrain.terrainHeight.baseHeightScale)),n[l].show?this.layers[l].show():this.layers[l].hide()}}},{key:"setDefaultArea",value:function(e){var r=new String(e.value);6===r.length&&/^\d*$/g.test(r)?this.isTreeIDSelect=!1:this.isTreeIDSelect=!0,this.defaultArea=e.value,w.defaultArea=e.value,this.updateArea()}},{key:"setWorldBorder",value:function(e){this.worldBorder=e||{type:"FeatureCollection",features:[]},this.updateArea()}},{key:"setChinaBorder",value:function(e){var r;null!=(r=this.layers.chinaBorderLine)&&r.setGeojson(e)}},{key:"setTopojson",value:function(e){this.alldata.areaTopojson=null,e.payload&&(this.alldata.areaTopojson=e),this.treeName=null,this.extrudeAttributesCache={},this.updateArea()}},{key:"findPathByTreeName",value:function(e,r,a){if(e.treeID===r){var t,i={type:"FeatureCollection",features:[]};for(t in e.children){var n=y(e.children[t].payload);if(n.features&&n.features.length){for(var o,s=0;s<n.features.length;s++)n.features[s].properties._treeName=e.children[t].treeName,n.features[s].properties.treeName=e.children[t].treeID,n.features[s].properties.name=j(n.features[s].properties.name,e.children[t].name),n.features[s].properties.adcode||(n.features[s].properties.adcode=e.children[t].treeID);(o=i.features).push.apply(o,p(n.features))}}var l,d=y(e.payload);for(l in d.features)d.features[l].properties._treeName=j(d.features[l].properties.treeName,e.treeName),d.features[l].properties.treeName=j(d.features[l].properties.treeID,e.treeID),d.features[l].properties.name=j(d.features[l].properties.name,e.name),d.features[l].properties.adcode=j(j(d.features[l].properties.adcode,e.adcode),e.treeID);return{geojson:d,geojson_children:i,treeName:r,treeName_parent:a}}for(var u in e.children){u=this.findPathByTreeName(e.children[u],r,e.treeID);if(u)return u}}},{key:"findPathByAdCode",value:function(e,r,a){var t,i;if(+(null==e||null==(t=e.payload)||null==(t=t.objects)||null==(t=t.collection)||null==(t=t.geometries)||null==(t=t[0])||null==(t=t.properties)?void 0:t.adcode)==+r){var n,o={type:"FeatureCollection",features:[]};for(n in e.children){var s=y(e.children[n].payload);if(s.features&&s.features.length){for(var l,d=0;d<s.features.length;d++)s.features[d].properties._treeName=e.children[n].treeName,s.features[d].properties.treeName=e.children[n].treeID,s.features[d].properties.name=j(s.features[d].properties.name,e.children[n].name),s.features[d].properties.adcode||(s.features[d].properties.adcode=e.children[n].treeID);(l=o.features).push.apply(l,p(s.features))}}var u,h=y(e.payload);for(u in h.features)h.features[u].properties._treeName=j(h.features[u].properties.treeName,e.treeName),h.features[u].properties.treeName=j(h.features[u].properties.treeID,e.treeID),h.features[u].properties.name=j(h.features[u].properties.name,e.name),h.features[u].properties.adcode=j(j(h.features[u].properties.adcode,e.adcode),e.treeID);return{geojson:h,geojson_children:o,treeName:e.treeID,treeName_parent:a}}for(i in e.children){var c=this.findPathByAdCode(e.children[i],r,e.treeID);if(c)return c}}},{key:"updateArea",value:function(){var r=this;if(this.alldata.areaTopojson&&this.worldBorder&&this.defaultArea!==this.treeName){var e=(this.isTreeIDSelect?this.findPathByTreeName:this.findPathByAdCode)(this.alldata.areaTopojson,this.defaultArea);if(!e){if(this.defaultArea=this.alldata.areaTopojson.treeID,!(e=(this.isTreeIDSelect?this.findPathByTreeName:this.findPathByAdCode)(this.alldata.areaTopojson,this.defaultArea)))return void console.log("没有找到匹配区域!");console.log("没有找到匹配区域，将会使用默认根节点!")}this.treeName=this.defaultArea,this.treeName_parent=e.treeName_parent;var a=e.geojson,t=(this.geojson_main=e.geojson,e.geojson_children),i=Object.assign({},this.worldBorder);if(0!=i.features.length){var a=B(a,!1),n=k(a),o=w.proj.proj([n[0],n[1],0]),s=w.proj.proj([n[2],n[3],0]),l=Math.abs(s[0]-o[0]),d=Math.abs(o[1]-s[1]),o=[(o[0]+s[0])/2,(o[1]+s[1])/2],s=Math.max(l,d),l=(w.bboxSize=s,w.bbox_main=n,w.center=[o[0],o[1]],w.bboxLowHeightScale=200,this.options.general.cameraRotate),d=this.getCameraInfo(n,s,o,this.options.general),l=(w.VOGOViewer.setCamera({fov:20,position:{lng:d.camera.target.x,lat:d.camera.target.y,altitude:d.camera.position.z},rotation:{tilt:89<l.tilt?89:l.tilt,pan:l.pan},near:1,far:d.camera.maxDistance||1e8}),3*s),d=(w.drawScale=s/40075016.68,this.options.terrain),u=d.mainTerrain.terrainHeight,h=u.baseHeightScale,u=u.lowHeightScale,d=d.backgroundTerrain.baseHeightScale_background,h=(w.baseHeightScale=h,w.lowHeightScale=u,w.baseHeightScale_background=d,this.layers.dynamicDecoration.options.backgroundTerrain_options=.2,this.layers.dynamicDecoration.render({center:o,size:[l,l]}),o[1]+=.25*s,this.layers.grid.render(o,l),this.layers.water.render({center:o,scale:l}),{leftTop:w.proj.inverseProj([o[0]-1.5*s,o[1]-1.5*s,0]),rightBottom:w.proj.inverseProj([o[0]+1.5*s,o[1]+1.5*s,0])}),c=[h.leftTop[0],h.leftTop[1]<-90?-90:h.leftTop[1],h.rightBottom[0],90<h.rightBottom[1]?90:h.rightBottom[1]];if(this.extrudeAttributesCache[this.treeName]||(this.extrudeAttributesCache[this.treeName]={}),this.extrudeAttributesCache[this.treeName]&&this.extrudeAttributesCache[this.treeName].geojson_background_result)j=this.extrudeAttributesCache[this.treeName].geojson_background_result;else{for(var u=C.bboxClip(i.features[0],c),p=u.geometry.coordinates,g=[],f=0;f<p.length;f++)0<p[f].length&&g.push(p[f]);u.geometry.coordinates=g;var m={type:"Feature",properties:{},geometry:{type:"Polygon",coordinates:[]}},d={type:"Feature",properties:{},geometry:{}};switch((m=1==a.features.length?Object.assign({},a.features[0].geometry):_(Object.assign({},a))).type){case"MultiPolygon":for(var b=0;b<m.coordinates.length;b++)for(var y=0;y<m.coordinates[b].length;y++)m.coordinates[b][y][0]!=m.coordinates[b][y][m.coordinates[b][y].length-1]&&m.coordinates[b][y].push(m.coordinates[b][y][0]);break;case"Polygon":for(var v=0;v<m.coordinates.length;v++)m.coordinates[0]!=m.coordinates[m.coordinates.length-1]&&m.coordinates.push(m.coordinates[0])}d.geometry=m,i=C.difference(u,d);for(var i=N(i),j={type:"FeatureCollection",features:[]},T=0;T<i.length;T++){var A=i[T];j.features.push(A)}this.extrudeAttributesCache[this.treeName].geojson_background_result=j,this.extrudeAttributesCache[this.treeName].geojson_main_dissolve={type:"FeatureCollection",features:[d]}}var x=this,l=(this.extrudeAttributesCache[this.treeName]&&this.extrudeAttributesCache[this.treeName].backgroundTerrain&&this.extrudeAttributesCache[this.treeName].geojson_background_result?x.layers.backgroundTerrain.render({geojson:j,extrudeAttributes:this.extrudeAttributesCache[this.treeName].backgroundTerrain,bbox:n,bbox_background:c}):(l=w.proj.proj([c[0],c[1],0]),o=w.proj.proj([c[2],c[3],0]),s=[l[0],l[1],o[0],o[1]],D({json:Object.assign({},j),proj:w.proj,extrude:0,offsetAlt:0,height:1,bbox:c,bboxProj:s}).then(function(e){x.extrudeAttributesCache[r.treeName].backgroundTerrain=e,x.layers.backgroundTerrain.render({geojson:j,extrudeAttributes:e,bbox_background:c})})),this.extrudeAttributesCache[this.treeName]&&this.extrudeAttributesCache[this.treeName].mainTerrain?x.layers.mainTerrain.render({geojson:a,geojson_children:0<t.features.length?t:a,extrudeAttributes:this.extrudeAttributesCache[this.treeName].mainTerrain,bbox:n,bboxLowHeightScale:w.bboxLowHeightScale}):(h=w.proj.proj([n[0],n[1],0]),u=w.proj.proj([n[2],n[3],0]),d=[h[0],h[1],u[0],u[1]],D({json:Object.assign({},a),proj:w.proj,bbox:n,bboxProj:d,extrude:1,offsetAlt:0,height:1,deleteCoordinates:10,bboxLowHeightScale:w.bboxLowHeightScale}).then(function(e){x.extrudeAttributesCache[r.treeName].mainTerrain=e,x.layers.mainTerrain.render({geojson:a,geojson_children:0<t.features.length?t:a,extrudeAttributes:e,bbox:n,bboxLowHeightScale:w.bboxLowHeightScale})})),w.mainTerrainData||(w.mainTerrainData={}),w.mainTerrainData.geojson_main=a,w.mainTerrainData.geojson_main_children=t,w.mainTerrainData.geojson_main_dissolve=this.extrudeAttributesCache[this.treeName].geojson_main_dissolve,w.subcoms.forEach(function(e){e.updateArea&&e.updateArea()}),this.options.nature),o=2003750.834;l.fog.show?(s=Math.round(l.fog.farRange[0]*w.drawScale*o),h=Math.round(l.fog.farRange[1]*w.drawScale*o),w.engine.scene.fog=new S.Fog(new S.Color(l.fog.color),s,h)):w.engine.scene.fog=null,"全国"===(null==(u=e)||null==(d=u.geojson)||null==(o=d.features)||null==(l=o[0].properties)?void 0:l.name)||"中国"===(null==(s=e)||null==(h=s.geojson)||null==(u=h.features)||null==(d=u[0].properties)?void 0:d.name)?(null!=(o=this.layers.chinaBorderLine)&&o.show(),null!=(l=this.layers.mainTerrain)&&null!=(e=l.layers)&&null!=(s=e.lineLayer)&&s.hide(!1),null!=(h=this.layers.mainTerrain)&&null!=(u=h.layers)&&null!=(d=u.lineLayer)&&d.changeLockVisibleStatus(!0)):(this.layers.chinaBorderLine.hide(),null!=(o=this.layers.mainTerrain)&&null!=(l=o.layers)&&null!=(e=l.lineLayer)&&e.changeLockVisibleStatus(!1),this.options.terrain.mainTerrain.borderStyle.lineStyle.show&&null!=(s=this.layers.mainTerrain)&&null!=(h=s.layers)&&null!=(u=h.lineLayer)&&u.show(!0))}}}},{key:"getCameraInfo",value:function(e,r,a,t){var i=t.cameraOffset,n=i.x,i=i.y,o=t.cameraRotate,s=o.tilt,o=(o.pan,t.cameraScale.scale),t=w.proj.inverseProj([a[0]+r*n*.01,a[1]+r*i*.01,0]),n={x:t[0],y:t[1],z:r/10},t=r*i*.01*o*Math.cos(s*Math.PI/180),i=w.proj.inverseProj([a[0],a[1]-t,0]);return{camera:{position:{x:(e[0]+e[2])/2,y:i[1],z:r*o*3*Math.sin(s*Math.PI/180)},target:n,maxDistance:Math.min(5*r,1e8)}}}},{key:"updateOptions",value:function(e){var r=h({},this.options),e=(this.options=h(this.options,e.options),this.options),a=e.general,t=e.nature,i=e.terrain,e=e.decoration;if(r.general.defaultArea!=a.defaultArea&&a.defaultArea)this.setDefaultArea({value:a.defaultArea});else{var n,o=i.mainTerrain.terrainHeight,s=o.baseHeightScale,o=o.lowHeightScale,l=i.backgroundTerrain.baseHeightScale_background,d=(w.baseHeightScale=s,w.lowHeightScale=o,w.baseHeightScale_background=l,{water:t.water,grid:e.backgrounGrid,dynamicDecoration:e.dynamicDecoration,mainTerrain:i.mainTerrain,backgroundTerrain:i.backgroundTerrain});for(n in d)this.layers[n].updateOptions&&this.layers[n].updateOptions(d[n]),d[n].show?this.layers[n].show():this.layers[n].hide();r.terrain.mainTerrain.terrainHeight.baseHeightScale==s&&r.terrain.mainTerrain.terrainHeight.lowHeightScale==o||(i.baseHeightScale,this.layers.backgroundTerrain.updateOptions(i.backgroundTerrain),w.subcoms.forEach(function(e){e.updateBaseHeight&&e.updateBaseHeight()})),this.layers.chinaBorderLine.updateOptions(this.options.chinaBorderLine),this.layers.chinaBorderLine.updateBaseHeight(this.options.terrain.mainTerrain.terrainHeight.baseHeightScale),u.deepDiff(r.general.cameraRotate,this.options.general.cameraRotate)&&u.deepDiff(r.general.cameraScale,this.options.general.cameraScale)&&u.deepDiff(r.general.cameraOffset,this.options.general.cameraOffset)||(l=a.cameraRotate,t=w.bbox_main,e=w.bboxSize,s=w.center,o=this.getCameraInfo(t,e,s,a),w.VOGOViewer.setCamera({fov:20,position:{lng:o.camera.target.x,lat:o.camera.target.y,altitude:o.camera.position.z},rotation:{tilt:89<l.tilt?89:l.tilt,pan:l.pan},near:1,far:o.camera.maxDistance||1e8}))}}},{key:"destroy",value:function(){for(var e in this.layers)this.layers[e].destroy&&this.layers[e].destroy(),this.layers[e]=null}}])&&s(e.prototype,r),a&&s(e,a),Object.defineProperty(e,"prototype",{writable:!1}),d;function d(e,r){if(!(this instanceof d))throw new TypeError("Cannot call a class as a function");this.options=h({},e.options);var e=this.options,a=e.general,t=e.nature,i=e.terrain,n=e.decoration,e=e.chinaBorderLine,o=i.mainTerrain.terrainHeight,s=o.baseHeightScale,o=o.lowHeightScale,l=i.backgroundTerrain.baseHeightScale_background;w.baseHeightScale=s,w.lowHeightScale=o,w.baseHeightScale_background=l,this.layers={backgroundTerrain:new c(i.backgroundTerrain,r),mainTerrain:new g(i.mainTerrain,r),water:new f(t.water,r),grid:new m(n.backgrounGrid,r),dynamicDecoration:new b(n.dynamicDecoration,r),chinaBorderLine:new(v(w))(null!=e?e:{},r)},this.alldata={defaultArea:null,areaTopojson:null,adcodeKeys:null,areaGeojson:null,mappingData:null,mappingDataMap:null,areaGeojson_default:{}},this.worldBorder=null,this.extrudeAttributesCache={},this.treeName="",this._treeName="",this.findPathByTreeName=this.findPathByTreeName.bind(this),this.findPathByAdCode=this.findPathByAdCode.bind(this),this.updateArea=this.updateArea.bind(this),this.isTreeIDSelect=!0,this.setDefaultArea({value:a.defaultArea})}},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/transform-class-slippy",[],function(t,e,a,i,l,n){function o(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}r=M,(h=[{key:"_getMapSize",value:function(t){return Math.pow(2,t)}},{key:"getResolution",value:function(t,e){return 12756274*Math.PI*Math.cos(t)/256/this._getMapSize(e)}},{key:"_lngToTileX",value:function(t,e){t=Math.floor((t+180)/360*this._getMapSize(e));return Math.min(t,Math.pow(2,e)-1)}},{key:"_latToTileY",value:function(t,e){t=t*Math.PI/180,t=(1-Math.log(Math.tan(t)+1/Math.cos(t))/Math.PI)/2;return Math.floor(t*this._getMapSize(e))}},{key:"lnglatToTile",value:function(t,e,a){return{tileX:this._lngToTileX(t,a),tileY:this._latToTileY(e,a)}}},{key:"_lngToPixelX",value:function(t,e){return Math.floor((t+180)/360*this._getMapSize(e)*256%256)}},{key:"_latToPixelY",value:function(t,e){t=Math.sin(t*Math.PI/180),t=.5-Math.log((1+t)/(1-t))/(4*Math.PI);return Math.floor(t*this._getMapSize(e)*256%256)}},{key:"lnglatToPixel",value:function(t,e,a){return{pixelX:this._lngToPixelX(t,a),pixelY:this._latToPixelY(e,a)}}},{key:"_pixelXTolng",value:function(t,e,a){return(e+t/256)/this._getMapSize(a)*360-180}},{key:"_pixelYToLat",value:function(t,e,a){return 180*Math.atan((e=Math.PI*(1-2*(e+t/256)/this._getMapSize(a)),(Math.exp(e)-Math.exp(-e))/2))/Math.PI}},{key:"pixelToLnglat",value:function(t,e,a,i,l){return{lng:this._pixelXTolng(t,a,l),lat:this._pixelYToLat(e,i,l)}}}])&&o(r.prototype,h),u&&o(r,u),Object.defineProperty(r,"prototype",{writable:!1});var r,u,h=M;function M(t,e){if(!(this instanceof M))throw new TypeError("Cannot call a class as a function");this.levelMax=t,this.levelMin=e}return t.exports=h,t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/Parser/formatTransform",[],function(e,t,r,n,o,i){function a(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function s(n){for(var e=1;e<arguments.length;e++){var o=null!=arguments[e]?arguments[e]:{};e%2?a(Object(o),!0).forEach(function(e){var t,r;t=n,r=o[e=e],e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(o)):a(Object(o)).forEach(function(e){Object.defineProperty(n,e,Object.getOwnPropertyDescriptor(o,e))})}return n}function u(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}c=y,(p=[{key:"geojson2datav",value:function(e){for(var t,r,n,o,i=[],a=0,u=e.features.length;a<u;a++)if((t=e.features[a]).type&&t.geometry)switch(r=t.geometry.coordinates,(o=t.properties||{}).id=void 0===o.id?a:o.id,t.geometry.type){case"Point":n=s({lng:r[0],lat:r[1],altitude:r[2]||0},o),i.push(n);break;case"MultiPoint":for(var c=r.length,l=0;l<c;l++)n=s({lng:r[l][0],lat:r[l][1],altitude:r[l][2]||0},o),i.push(n);break;case"LineString":n=s({geometry:{type:"LineString",coordinates:r.map(function(e){return[e[0],e[1],e[2]||0]})}},o),i.push(n);break;case"MultiLineString":n=s({geometry:{type:"MultiLineString",coordinates:r=r.map(function(e){return e.map(function(e){return[e[0],e[1],e[2]||0]})})}},o),i.push(n);break;case"Polygon":for(var p=0;p<r.length;p++)r[p]=r[p].map(function(e){return[e[0],e[1],e[2]||0]});n=s({geometry:{type:"Polygon",coordinates:r}},o),i.push(n);break;case"MultiPolygon":n=s({geometry:{type:"MultiPolygon",coordinates:r=r.map(function(e){return e.map(function(e){return e.map(function(e){return[e[0],e[1],e[2]||0]})})})}},o),i.push(n)}return i}},{key:"datav2geojson",value:function(e){for(var t,r,n=["lng","lat","altitude","geometry"],o=["Point","MultiPoint","LineString","MultiLineString","Polygon","MultiPolygon"],i={type:"FeatureCollection",features:[]},a=0,u=e.length;a<u;a++){if(t=e[a],r={},Object.keys(t).forEach(function(e){-1===n.indexOf(e)&&(r[e]=t[e])}),t.geometry){if(s=t.geometry.type,-1===o.indexOf(s)){console.error("Invalid type for geojson: ",s);continue}s={type:"Feature",geometry:t.geometry,properties:r}}else var c=t.lng,l=t.lat,p=t.altitude,s={type:"Feature",geometry:{type:"Point",coordinates:p?[c||0,l||0,p]:[c||0,l||0]},properties:r};i.features.push(s)}return i}}])&&u(c.prototype,p),l&&u(c,l),Object.defineProperty(c,"prototype",{writable:!1});var c,l,p=y;function y(){if(!(this instanceof y))throw new TypeError("Cannot call a class as a function")}return e.exports=p,e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/geo/projection",[],function(a,o,r,t,d,e){var c=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/geo/projection/coordtransformCli"),r=r("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/geo/projection/mercator");return a.exports={coordtransformCli:c,mercator:r},a.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/geometry",[],function(a,e,t,d,o,r){t=t("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/geometry/geojsonExtrude");return a.exports={geojsonExtrude:t},a.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/Geographic/Projection",["datav:/npm/eventemitter3/3.0.0","datav:/npm/@ali/datav-vangogh-planar/2.0.2"],function(t,e,r,o,n,i){function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function u(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function c(t,e){return(c=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function s(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=f(r),e=(t=o?(t=f(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function f(t){return(f=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var l=r("datav:/npm/eventemitter3/3.0.0"),r=r("datav:/npm/@ali/datav-vangogh-planar/2.0.2"),p=r.THREE,h=r.Geographic,y=r.Utils,v=y.simple,r=function(){var t=n,e=l;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&c(t,e);var r,o=s(n);function n(t){var e;if(this instanceof n)return(e=o.call(this)).options=Object.assign({},t),e.proj=null,e.inverseProj=null,e.projType=null,e.getNormal=null,e.getTfMat4=null,e.init(),e.zoomConfig={1:5e4,2:5e4,3:5e4,4:5e4,5:5e4,6:4e4,7:3e4,8:28e3,9:26e3,10:24e3,11:22e3,12:2e4,13:15e3,14:1e4,15:8e3,16:6e3,17:4e3,18:2e3},e.type="mercator",e;throw new TypeError("Cannot call a class as a function")}return t=n,(e=[{key:"init",value:function(){this.geoProj=h.Ellipsoid.WGS84,this.simpleProj=v,this.mercator=function(t){var e=20037508.34*t[0]/180,r=((t[0]<-11&&34<=t[1]||t[0]<-21&&t[1]<34)&&(e=20037508.34*(t[0]+360)/180),Math.log(Math.tan((90+t[1])*Math.PI/360))/(Math.PI/180)*20037508.34/180),e=Math.round(e),r=Math.round(r);return[e,+t[2]||0,-r]},this.inverseMercator=function(t){var e=t[0]/20037508.34*180,r=-t[2]/20037508.34*180;return[e,180/Math.PI*(2*Math.atan(Math.exp(r*Math.PI/180))-Math.PI/2),t[1]]}}},{key:"type",get:function(){return this.projType},set:function(t){var e=t.toLowerCase();switch(e){case"cartesian":this.proj=this.simpleProj,this.inverseProj=this.simpleProj,this.getNormal=function(){return new p.Vector3(0,1,0)},this.getTfMat4=function(){return new p.Matrix4};break;case"mercator":this.proj=this.mercator,this.inverseProj=this.inverseMercator,this.getNormal=function(){return new p.Vector3(0,1,0)},this.getTfMat4=function(){return new p.Matrix4};break;default:console.log("projection ".concat(e," is not support!"))}this.projType=e,this.emit("projChanged",this.projType)}},{key:"zoom",set:function(t){this.zoomConfig=t}},{key:"getHeightByZoom",value:function(t){(t=18<t?18:t)<1&&(t=1);var e=Math.floor(t),r=Math.ceil(t),o=this.zoomConfig[e],r=this.zoomConfig[r];return y.lerp(o,r,t-e)}},{key:"tansformToWorld",value:function(t){return this.proj(t)}},{key:"inverseWorldCoords",value:function(t){return this.inverseProj(t)}},{key:"normalFromCoords",value:function(t){return this.getNormal(t)}},{key:"transformMatrix4",value:function(t){return this.getTfMat4(t)}}])&&u(t.prototype,e),r&&u(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}();return t.exports=r,t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils/jquery.actual",[],function(t,e,n,a,o,i){return t.exports=function(l){return l.fn.addBack=l.fn.addBack||l.fn.andSelf,l.fn.extend({actual:function(t,e){if(!this[t])throw'$.actual => The jQuery method "'+t+'" you called does not exist';var n,a,o,i=l.extend({absolute:!1,clone:!1,includeMargin:!1,display:"block"},e),r=this.eq(0),d=(e=!0===i.clone?(d=function(){r=r.clone().attr("style","position: absolute !important; top: -1000 !important; ").appendTo("body")},function(){r.remove()}):(n=[],a="",d=function(){o=r.parents().addBack().filter(":hidden"),a+="visibility: hidden !important; display: "+i.display+" !important; ",!0===i.absolute&&(a+="position: absolute !important; "),o.each(function(){var t=l(this),e=t.attr("style");n.push(e),t.attr("style",e?e+";"+a:a)})},function(){o.each(function(t){var e=l(this),t=n[t];void 0===t?e.removeAttr("style"):e.attr("style",t)})}),d(),/(outer)/.test(t)?r[t](i.includeMargin):r[t]());return e(),d}}),l},t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils/canvas/measureText",[],function(t,e,a,c,n,o){var r=document.createElement("canvas").getContext("2d");return t.exports=function(t,e,a,c){return r.font="".concat(a," ").concat(c,"px ").concat(e),{width:Math.ceil(r.measureText(t).width),height:c}},t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils/canvas/getDashArray",[],function(r,e,t,a,s,n){return r.exports=function(r){var e=[];if(""!==r&&r)if("string"==typeof r)for(var t,a=r.split(/[, ]+/),s=0;s<a.length;s++){if(t=Number(a[s]),isNaN(t))return;e.push(t)}else e=r;else e=[];return e},r.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils/turf",["datav:/npm/@turf/helpers/6.3.0","datav:/npm/@turf/area/6.3.0","datav:/npm/@turf/center/6.3.0","datav:/npm/@turf/intersect/6.3.0","datav:/npm/@turf/bbox/6.3.0","datav:/npm/@turf/bbox-clip/6.3.0","datav:/npm/@turf/kinks/6.3.0","datav:/npm/@turf/buffer/6.3.0","datav:/npm/@turf/rewind/6.3.0","datav:/npm/@turf/clean-coords/6.3.0","datav:/npm/@turf/meta/6.3.0","datav:/npm/@turf/difference/6.3.0","datav:/npm/@turf/hex-grid/6.3.0","datav:/npm/@turf/points-within-polygon/6.3.0"],function(t,a,r,n,e,d){var f=r("datav:/npm/@turf/helpers/6.3.0").polygon,p=r("datav:/npm/@turf/area/6.3.0").default,u=r("datav:/npm/@turf/center/6.3.0").default,v=r("datav:/npm/@turf/intersect/6.3.0").default,m=r("datav:/npm/@turf/bbox/6.3.0").default,o=r("datav:/npm/@turf/bbox-clip/6.3.0").default,i=r("datav:/npm/@turf/kinks/6.3.0"),l=r("datav:/npm/@turf/buffer/6.3.0"),c=r("datav:/npm/@turf/rewind/6.3.0"),s=r("datav:/npm/@turf/clean-coords/6.3.0").default,b=r("datav:/npm/@turf/meta/6.3.0"),x=r("datav:/npm/@turf/difference/6.3.0"),h=r("datav:/npm/@turf/hex-grid/6.3.0").default,r=r("datav:/npm/@turf/points-within-polygon/6.3.0");return t.exports={polygon:f,area:p,center:u,intersect:v,bbox:m,bboxClip:o,kinks:i,buffer:l,rewind:c,cleanCoords:s,difference:x,meta:b,hexGrid:h,pointsWithinPolygon:r},t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils/geojson/geojsonBBox",[],function(t,e,r,n,o,u){function i(t){return function(t){if(Array.isArray(t))return a(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return a(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(r="Object"===r&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?a(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=new Array(e);r<e;r++)n[r]=t[r];return n}return t.exports=function(t){if(t.hasOwnProperty("type"))return function r(t){var e;"Point"==t.type?e=[t.coordinates]:"LineString"==t.type||"MultiPoint"==t.type?e=t.coordinates:"Polygon"==t.type||"MultiLineString"==t.type?e=t.coordinates.reduce(function(t,e){return t.push.apply(t,i(e)),t},[]):"MultiPolygon"==t.type?e=t.coordinates.reduce(function(t,e){return t.push.apply(t,i(e.reduce(function(t,e){return t.push.apply(t,i(e)),t},[]))),t},[]):"Feature"==t.type?e=r(t.geometry):"GeometryCollection"==t.type?e=t.geometries.reduce(function(t,e){return t.push.apply(t,i(r(e))),t},[]):"FeatureCollection"==t.type&&(e=t.features.reduce(function(t,e){return t.push.apply(t,i(r(e))),t},[]));return e}(t).reduce(function(t,e){return[Math.min(e[0],t[0]),Math.min(e[1],t[1]),Math.max(e[0],t[2]),Math.max(e[1],t[3])]},[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY])},t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils",["datav:/npm/geojson-flatten/1.0.4","datav:/npm/geojson-dissolve/3.1.0","datav:/npm/@mapbox/geojson-rewind/0.5.1","datav:/npm/polylabel/1.0.2","datav:/npm/chroma-js/1.3.3","datav:/npm/topojson/3.0.2","datav:/npm/jquery/2.1.4"],function(a,o,t,e,d,n){var v=t("datav:/npm/geojson-flatten/1.0.4"),s=t("datav:/npm/geojson-dissolve/3.1.0"),r=t("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils/geojson/geojsonBBox"),p=t("datav:/npm/@mapbox/geojson-rewind/0.5.1"),l=t("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils/turf"),m=t("datav:/npm/polylabel/1.0.2"),c=t("datav:/npm/chroma-js/1.3.3"),j=t("datav:/npm/topojson/3.0.2"),u=t("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils/canvas/getDashArray"),g=t("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils/canvas/measureText"),i=t("datav:/npm/jquery/2.1.4");return t("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils/jquery.actual")(i),a.exports={geojsonFlatten:v,geojsonDissolve:s,geojsonRewind:p,geojsonBBox:r,turf:l,Chroma:c,polylabel:m,topojson:j,measureText:g,getDashArray:u,$:i},a.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/Config/Default",[],function(t,a,e,o,i,n){return t.exports={style:"blueTechStyle",camera:{fov:60,maxDistance:6e8,animationType:"NONE",duration:1e4,isLoop:!0,autoPlay:!0,rpx:120.14807224,rpy:30.247797,rpz:5e10,rtx:120.14807224,rty:30.247797,rtz:0,px:120.14807224,py:30.247797,pz:5e10,tx:120.14807224,ty:30.247797,tz:0,apx:120.15457379876473,apy:30.18263337755386,apz:2030.9228693806012,atx:120.14807224,aty:30.247797,atz:0,bpx:120.01743497855063,bpy:30.194024866660502,bpz:10967.15256752108,btx:120.00771168182283,bty:30.257815761443847,btz:8587.353458822958,opx:120.15457379876473,opy:30.18263337755386,opz:2030.9228693806012,otx:120.14807224,oty:30.247797,otz:0},solarSystem:{solarType:"USERDEFINED",startTime:"noon",endTime:"nightfall",duration:3,isLoop:!0},lights:{keyLight:{enabled:!1,intensity:1.5,castShadow:!1,color:"#bae7ff",px:120.18828392,py:30.23482149,pz:2200,tx:120.15386581,ty:30.25513788,tz:0},fillLight:{enabled:!0,intensity:.6,castShadow:!0,color:"#40a9ff",px:120.1186752319336,py:30.241791820946666,pz:2200,tx:120.15386581,ty:30.25513788,tz:0},backLight:{enabled:!1,intensity:.02,castShadow:!1,color:"#69c0ff",px:120.12073516845703,py:30.278414989215722,pz:2200,tx:120.15386581,ty:30.25513788,tz:0}},basic:{projType:"mercator",isGammaInput:!1,isGammaOutput:!0,outputEncoding:"sRGBEncoding",isPhysicallyCorrect:!1,isShadowMap:!0,logarithmicDepthBuffer:!1,clearColor:"rgba(0,0,0,0.0)",toneMapping:{tmType:"ACESFilmicToneMapping",exposure:1},fogColor:"#fff",fogDensity:0,maxFPS:60},globe:{visible:!0,receiveShadow:!1,light:{color:"#fff",intensity:.5,shadow:{enabled:!1,position:{x:120.14807224,y:30.247797,z:1e3},quality:2,bias:1e-4,extent:1e3,distance:2e3}},atmosphere:{useSkyCloud:!1,weatherMap:"https://img.alicdn.com/tfs/TB1SYw2XpP7gK0jSZFjXXc5aXXa-256-256.png",noise3DMap:"http://sh-conf.oss-cn-shanghai.aliyuncs.com/datav.engine/cloud/lowFrequency3DTexture.bin",noiseDetail3DMap:"http://sh-conf.oss-cn-shanghai.aliyuncs.com/datav.engine/cloud/highFrequency3DTexture.bin",ground:{visible:!0},sky:{visible:!0,physically:!0,colormapping:!0,color:"rgba(38, 38, 38, 100)",fixedColor:"#3bacf1",exponent:.5},cloud:{horizonDistance:1,density:1,inscatteringCoff:1,extinctionCoff:.2}},uvScale:{x:2e4,y:2e4},baseColor:"#fff",baseColorMap:"https://img.alicdn.com/tfs/TB1QfkrvND1gK0jSZFyXXciOVXa-603-603.png",cloudMap:"https://img.alicdn.com/tfs/TB1eGxwHFzqK1RjSZFoXXbfcXXa-4096-2048.jpg",metalness:1,metalnessMap:"https://img.alicdn.com/tfs/TB1_GJ5INjaK1RjSZKzXXXVwXXa-8100-4050.png",roughness:.6,roughnessMap:"https://img.alicdn.com/tfs/TB1.VRJIIbpK1RjSZFyXXX_qFXa-8100-4050.png",emissive:"#fff",emissiveMap:"https://img.alicdn.com/tfs/TB1T3dGINTpK1RjSZFKXXa2wXXa-8100-4050.jpg",bumpScale:5e4,bumpMap:"https://img.alicdn.com/tfs/TB16vVGINTpK1RjSZFKXXa2wXXa-8100-4050.jpg",backgroundMap:"https://img.alicdn.com/tfs/TB19EyZvAL0gK0jSZFxXXXWHVXa-860-820.png"},renderer:{renderMode:"normalMode"},postprocessing:{}},t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/Viewer",["datav:/npm/@ali/datav-vangogh-planar/2.0.2","datav:/npm/eventemitter3/3.0.0","datav:/npm/alibabacloud-datav-tool-gui-utils/1.0.2","datav:/npm/lodash/4.17.20","datav:/npm/safely-merge/1.0.1"],function(e,l,c,G,z,I){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function n(t,e){var r,n=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),n.push.apply(n,r)),n}function h(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?n(Object(r),!0).forEach(function(e){O(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):n(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function f(e,t){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var r=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=r){var n,a,o=[],i=!0,s=!1;try{for(r=r.call(e);!(i=(n=r.next()).done)&&(o.push(n.value),!t||o.length!==t);i=!0);}catch(e){s=!0,a=e}finally{try{i||null==r.return||r.return()}finally{if(s)throw a}}return o}}(e,t)||p(e,t)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function p(e,t){if(e){if("string"==typeof e)return o(e,t);var r=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(r="Object"===r&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?o(e,t):void 0}}function o(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,n=new Array(t);r<t;r++)n[r]=e[r];return n}function u(){return(u="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var n=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=b(e)););return e}(e,t);if(n)return n=Object.getOwnPropertyDescriptor(n,t),n.get?n.get.call(arguments.length<3?e:r):n.value}).apply(this,arguments)}function d(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}function y(e,t,r){t&&i(e.prototype,t),r&&i(e,r),Object.defineProperty(e,"prototype",{writable:!1})}function g(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&r(e,t)}function r(e,t){return(r=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(r){var n=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=b(r),t=(e=n?(e=b(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return v(t)}}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function b(e){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function O(e,t,r){t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}var w,L,j=null,k=null,V=c("datav:/npm/@ali/datav-vangogh-planar/2.0.2"),t=c("datav:/npm/eventemitter3/3.0.0"),E=(c("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/Geographic/Projection"),c("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/geometry").geojsonExtrude),s=c("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils"),C=s.geojsonBBox,S=s.geojsonDissolve,D=s.geojsonFlatten,P=s.geojsonRewind,x=s.turf,M=s.measureText,R=s.polylabel,_=s.topojson,T=s.getDashArray,B=c("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/geo/projection").coordtransformCli,F=c("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/Parser/formatTransform"),W=c("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/transform-class-slippy"),N=c("datav:/npm/alibabacloud-datav-tool-gui-utils/1.0.2"),H=c("datav:/npm/lodash/4.17.20"),U=Math.round(2e5/.1264),Z=c("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/baseLayer"),X=c("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/Tools"),Y=c("datav:/npm/safely-merge/1.0.1"),s=(c("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils/canvas/roundRect"),g(A,t),L=m(A),y(A,[{key:"addLayer",value:function(e,t){this.VOGOViewer.addLayer(e,t)}},{key:"initEngine",value:function(){var e=this.options.options,t=e.general,e=e.nature,r=k.Chroma(t.backgroundColor).rgba(),t=(this.engine.renderer.setClearColor(new j.Color(t.backgroundColor),r[3]),this.engine.createScene("main"),this.engine.scene),r=e.baselights,e=r.ambientLight,r=r.directionalLight,e=(this.ambientLight=new j.AmbientLight(e.color),this.ambientLight.intensity=.01*e.intensity,t.add(this.ambientLight),r.color),n=r.x,a=r.y,o=r.z,r=r.intensity;this.directionalLight=new j.DirectionalLight(e),this.directionalLight.position.set(n,a,o),this.directionalLight.intensity=.01*r,t.add(this.directionalLight),this.events=[],this.initInteractive()}},{key:"addDirectionalLight",value:function(e,t){var r=t.color,n=t.x,a=t.y,o=t.z,t=t.intensity,r=new j.DirectionalLight(r);r.position.set(n,a,o),r.intensity=.01*t,e.add(r)}},{key:"initInteractive",value:function(){this.raycaster=new j.Raycaster,this.engine.renderer.domElement.addEventListener("dblclick",this.onDblclick.bind(this),!0),this.engine.renderer.domElement.addEventListener("click",this.onClick.bind(this),!0)}},{key:"onDblclick",value:function(e){clearTimeout(w);var t=new j.Vector2,o=(t.x=e.offsetX/this.engine.renderer.domElement.offsetWidth*2-1,t.y=2*-(e.offsetY/this.engine.renderer.domElement.offsetHeight)+1,this.raycaster.setFromCamera(t,this.engine.cameraMgr.cameras.get("main")),[]),r=(this.VOGOViewer.layerArray.forEach(function(e,t,r){if(e.eventsType&&e.eventsType.dblclick)for(var n=0;n<e.group.children.length;n++){var a=e.group.children[n];a.userData.layer_key=t,o.push(a)}}),this.raycaster.intersectObjects(o));if(0<r.length){for(var n,a=0,i=r[a].object;!this._isVisible(i);)if(!(i=null==(n=r[++a])?void 0:n.object))return;var s,i=r[a].object,l=function(e,t){var r,n="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!n){if(Array.isArray(e)||(n=p(e))||t&&e&&"number"==typeof e.length)return n&&(e=n),r=0,{s:t=function(){},n:function(){return r>=e.length?{done:!0}:{done:!1,value:e[r++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var a,o=!0,i=!1;return{s:function(){n=n.call(e)},n:function(){var e=n.next();return o=e.done,e},e:function(e){i=!0,a=e},f:function(){try{o||null==n.return||n.return()}finally{if(i)throw a}}}}(this.VOGOViewer.layerArray);try{for(l.s();!(s=l.n()).done;){var c=f(s.value,2),u=c[0],d=c[1];if(i.userData.isDblclickDrill){if(i.userData.treeName)return this.VOGOViewer.layerArray.forEach(function(e,t,r){e.deSelect&&e.deSelect()}),this.focusContextStatus="focus",this.baseLayer.setDefaultArea({value:i.userData.treeName}),void this.emit("dblclick_focus",h(h({},i.userData),{},{treeID:i.userData.treeName}))}else i.userData.layer_key==u&&d.onDblclick&&d.onDblclick(i)}}catch(e){l.e(e)}finally{l.f()}}else this.baseLayer.treeName_parent&&(this.VOGOViewer.layerArray.forEach(function(e,t,r){e.deSelect&&e.deSelect()}),this.focusContextStatus="context",this.baseLayer.setDefaultArea({value:this.baseLayer.treeName_parent}),this.emit("dblclick_context",h(h({},this.baseLayer.geojson_main.features[0].properties),{},{treeID:this.baseLayer.treeName})))}},{key:"onClick",value:function(l){var c=this;clearTimeout(w),w=setTimeout(function(){var e=new j.Vector2,o=(e.x=l.offsetX/c.engine.renderer.domElement.clientWidth*2-1,e.y=2*-(l.offsetY/c.engine.renderer.domElement.clientHeight)+1,c.raycaster.setFromCamera(e,c.engine.cameraMgr.cameras.get("main")),[]),t=(c.VOGOViewer.layerArray.forEach(function(e,t,r){if(e.eventsType&&e.eventsType.click)for(var n=0;n<e.group.children.length;n++){var a=e.group.children[n];a.userData.isClick&&(a.userData.layer_key=t,o.push(a))}}),c.raycaster.intersectObjects(o));if(0<t.length){for(var r,n=0,a=t[n].object;!c._isVisible(a);)if(!(a=null==(r=t[++n])?void 0:r.object))return;var i,s=t[n],e=(c.VOGOViewer.layerArray.forEach(function(e,t,r){a.userData.layer_key==t?("InstancedMesh"===a.userData.meshType?e.onClick&&e.onClick(s):e.onClick&&e.onClick(a),"mainTerrain_areaLayer"===t&&c.emit("click_area",h(h({},a.userData),{},{treeID:a.userData.treeName}))):e.deSelect&&e.deSelect()}),t.find(function(e){return 0<e.object.userData.layer_key.indexOf("3dplane-area")}));2===t.length&&e&&(i=e.object,c.VOGOViewer.layerArray.forEach(function(e,t,r){i.userData.layer_key==t&&e.onClick(i)}))}else c.VOGOViewer.layerArray.forEach(function(e,t,r){e.deSelect&&e.deSelect()})},500)}},{key:"_isVisible",value:function(e){return!!e.visible&&(!e.parent||this._isVisible(e.parent))}},{key:"setDefaultArea",value:function(e){this.baseLayer&&this.baseLayer.setDefaultArea&&this.baseLayer.setDefaultArea(e)}},{key:"setTopojson",value:function(e){this.baseLayer&&this.baseLayer.setTopojson&&this.baseLayer.setTopojson(e)}},{key:"setWorldBorder",value:function(e){this.baseLayer&&this.baseLayer.setWorldBorder&&this.baseLayer.setWorldBorder(e)}},{key:"setChinaBorder",value:function(e){this.baseLayer&&this.baseLayer.setChinaBorder&&this.baseLayer.setChinaBorder(e)}},{key:"setDate",value:function(t){var r,e=new Date(t);Number.isNaN(e.valueOf())||(e=(60*e.getHours()+e.getMinutes())/1440,r=Math.sin(e*Math.PI),this.subcoms&&this.subcoms.size&&this.subcoms.forEach(function(e){e.layer.setDate&&e.layer.setDate.call(e.layer,t,r)}))}},{key:"resize",value:function(e,t){this.engine&&this.engine.resize(e,t),this.globe&&this.globe.resize(),this.constants.size={width:e,height:t}}},{key:"updateOptions",value:function(e){var t=k.deepClone(this.options.options),e=(this.options=k.mergeOptions(this.options,e||{}),this.options.options),r=(this.baseLayer&&this.baseLayer.updateOptions&&this.baseLayer.updateOptions(this.options),this.engine),n=r.renderer,r=r.scene,a=e.general,e=e.nature,o=a.backgroundColor,a=a.interactive,i=e.fog,e=e.baselights,e=("editor"===this.mode?(this.controls.enableMove=!0,this.controls.enableZoom=!0,this.controls.enableRotate=!0):(this.controls._enableMove=a.enableMove,this.controls._enableZoom=a.enableZoom,this.controls._enableRotate=a.enableRotate),t.nature.baselights.ambientLight.color===e.ambientLight.color&&t.nature.baselights.ambientLight.intensity===e.ambientLight.intensity&&t.nature.baselights.directionalLight.x===e.directionalLight.x&&t.nature.baselights.directionalLight.y===e.directionalLight.y&&t.nature.baselights.directionalLight.z===e.directionalLight.z&&t.nature.baselights.directionalLight.color===e.directionalLight.color&&t.nature.baselights.directionalLight.intensity===e.directionalLight.intensity||(this.ambientLight.color.setStyle(e.ambientLight.color),this.ambientLight.intensity=.01*e.ambientLight.intensity,this.directionalLight.color.setStyle(e.directionalLight.color),this.directionalLight.position.set(e.directionalLight.x,e.directionalLight.y,e.directionalLight.z),this.directionalLight.intensity=.01*e.directionalLight.intensity),t.general.backgroundColor!==o&&(a=k.Chroma(o).rgba(),n.setClearColor(new j.Color(o),a[3])),2003750.834),a=(i.show?(t=Math.round(i.farRange[0]*this.drawScale*e),n=Math.round(i.farRange[1]*this.drawScale*e),r.fog=new j.Fog(new j.Color(i.color),t,n)):r.fog=null,(null==(o=this.options.options.general.pixelRatio)?void 0:o.adaptive)||!this.options.options.general.pixelRatio);this.VOGOViewer.engine.renderer.setPixelRatio(a?devicePixelRatio:this.options.options.general.pixelRatio.ratio)}},{key:"getCameraInfo",value:function(){var e=this.engine.cameraControl,t=e.camera,e=e.target,t=[t.position.x,t.position.y,t.position.z],e=[e.x,e.y,e.z],t=this.proj.inverseWorldCoords(t),e=this.proj.inverseWorldCoords(e);return{camera:{position:{x:t[0],y:t[1],z:t[2]},target:{x:e[0],y:e[1],z:e[2]}}}}},{key:"getBoundsXY",value:function(){var e=new j.Vector3(-1.01,1.01,1),t=new j.Vector3(1.01,1.01,1),r=new j.Vector3(-1.01,-1.01,1),n=new j.Vector3(1.01,-1.01,1),a=this.VOGOViewer.engine.camera;return[this.getWorldPosFromScreenCoord(a,r),this.getWorldPosFromScreenCoord(a,n),this.getWorldPosFromScreenCoord(a,t),this.getWorldPosFromScreenCoord(a,e)]}},{key:"getWorldPosFromScreenCoord",value:function(e,t){var t=t.unproject(e),r=(t.sub(e.position).normalize(),-e.position.z/(0<=t.z?-1e-6:t.z));return(new j.Vector3).copy(e.position).add(t.multiplyScalar(r))}},{key:"setCamera",value:function(e){var t;null!=(t=this.baseLayer)&&t.getCameraInfo&&(t=(e=Y(this.options.options.general,e)).cameraRotate,e=this.baseLayer.getCameraInfo(this.bbox_main,this.bboxSize,this.center,e),this.VOGOViewer.setCamera({fov:20,position:{lng:e.camera.target.x,lat:e.camera.target.y,altitude:e.camera.position.z},rotation:{tilt:89<t.tilt?89:t.tilt,pan:t.pan},near:1,far:e.camera.maxDistance||1e8}))}},{key:"mouseUpEvent",value:function(){this.controls.getCameraState()}},{key:"destroy",value:function(){this.engine&&this.engine.renderer&&this.engine.renderer.domElement&&void 0!==this.engine.container.addEventListener&&(this.engine.renderer.domElement.removeEventListener("dblclick",this.onDblclick,!0),this.engine.renderer.domElement.removeEventListener("click",this.onClick,!0)),this.subcoms&&this.subcoms.size&&this.subcoms.forEach(function(e){e.layer&&e.layer.destroy&&e.layer.destroy()}),this.baseLayer&&this.baseLayer.destroy&&this.baseLayer.destroy(),this.VOGOViewer.engine.cameraAnime&&this.VOGOViewer.engine.cameraAnime.destroy(),this.engine.cameraControl&&this.engine.cameraControl.remove(),this.container&&this.container.remove()}}]),A);function A(e,t,r,n){var a;d(this,A),O(v(a=L.call(this)),"updateFrame",function(){var e=a.VOGOViewer.engine.cameraMgr.camera3D,t=v(a),t=(t.baseHeightScale,t.drawScale,a.getWorldPosFromScreenCoord(a.VOGOViewer.engine.camera,new j.Vector3(0,0,1)).sub(e.position).length()*Math.tan(e.fov/2*Math.PI/180)/(a.container.clientHeight/2));a.lengthPerPixel=t}),a.container=e,a.mode=r.env,a.screenshotEnable=r.screenshotEnable,a.subcoms=n,a.GuiUtils=N,k=a.Utils=Object.assign({},V.Utils),j=a.THREE=Object.assign({},V.THREE),Object.assign(a.THREE,{EffectComposer:c("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/EffectComposer")(j),ShaderPass:c("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/ShaderPass")(j),Pass:c("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/Pass")(j),RenderPass:c("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/libs/RenderPass")(j)});var n=k.mergeOptions,o=(a.options=n({},t),k._=H,k.geojsonExtrude=E,k.geojsonBBox=C,k.geojsonDissolve=S,k.geojsonFlatten=D,k.geojsonRewind=P,k.turf=x,k.polylabel=R,k.topojson=_,k.measureText=M,k.getDashArray=T,k.coordtransformCli=B,k.BASE_HEIGHT_SCALE=U,k.FormatTransformer=F,a.VOGO=V,a.tools=X(j),a.addLayer=a.addLayer.bind(v(a)),new V.Coordinates(0,0,0));o.crs=V.EPSG3857,a.proj={proj:function(e){return e=new j.Vector3(e[0],e[1],e[2]),o.setFromVector3(e),new j.Vector3,e=e.clone(),[(e=o.toXYZ(e)).x,e.y,e.z]},inverseProj:function(e){return o.fromXYZ(e[0],e[1],e[2]),[o.longitude,o.latitude,o.altitude]}},a.VOGOViewer=new V.PlanarViewer(e,{projType:V.EPSG3857,renderer:{alpha:!0,antialias:!0,logarithmicDepthBuffer:!0,preserveDrawingBuffer:a.screenshotEnable}});var i,t=(null==(n=a.options.options.general.pixelRatio)?void 0:n.adaptive)||!a.options.options.general.pixelRatio,n=(a.VOGOViewer.engine.renderer.setPixelRatio(t?devicePixelRatio:a.options.options.general.pixelRatio.ratio),a.engine=a.VOGOViewer.engine,V.MOUSE_LEFT_DOWN),t=V.MOUSE_RIGHT_DOWN,s=V.MOUSE_MIDDLE_DOWN,t=(a.VOGOViewer.controls.setMouseStates({PAN:{mouseButton:t,keyboard:null},ZOOM:{mouseButton:s,keyboard:null},ROTATE:{mouseButton:n,keyboard:null}}),a.controls=a.VOGOViewer.controls,a.controls._maxTilt=75*Math.PI/180,a.options.options.general.interactive),s=("editor"===a.mode?(a.controls.enableMove=!0,a.controls.enableZoom=!0,a.controls.enableRotate=!0):(a.controls._enableMove=t.enableMove,a.controls._enableZoom=t.enableZoom,a.controls._enableRotate=t.enableRotate),a.VOGOViewer.startRendering(),g(l,V.Layer),i=m(l),y(l,[{key:"traverse",value:function(t){this.group&&this.group.traverse&&this.group.traverse(function(e){(e instanceof j.Mesh||e instanceof j.InstancedMesh||e instanceof j.LineSegments||e instanceof j.Sprite)&&t&&t(e)})}},{key:"updateSceneId",value:function(){}},{key:"clear",value:function(){if((object3d=this.group)&&object3d.children)for(var e=object3d.children.length-1;0<=e;e--){var t,r=object3d.children[e];null!=(t=r.parent)&&t.remove(r),r.traverse(function(e){var t;(e.isMesh||e.isInstancedMesh||e.isSprite||e.isLineSegments)&&(null!=(t=e.geometry)&&t.dispose(),V.Utils.materialTraverse(e.material,function(e,t){var r=V.Utils.getCurrentMaterial(e,t);["map","alphaMap","specularMap","envMap","aoMap","lightMap","emissiveMap","bumpMap","normalMap","displacementMap","roughnessMap","metalnessMap","gradientMap"].forEach(function(e){r[e]&&r[e].dispose&&r[e].dispose()}),r.dispose()})),null!=(t=e.parent)&&t.remove(e)})}}},{key:"remove",value:function(){u(b(l.prototype),"remove",this).call(this),this.viewer.layerArray.delete(this.id)}}]),l);function l(e){var t;return d(this,l),(t=i.call(this)).options={isSceneGroup:!1,sceneNames:[{sceneName:"main"}]},t.group.ignoreWaterReflection=!0,t.group.frustumCulled=!1,t.traverse=t.traverse.bind(v(t)),t}a.Layer=s,a.Processor=V.Processor,a.workerFarm=new V.WorkerFarm,a.TileLnglatTransform=new W(19,0),a.timeline=a.engine.timeline,a.initEngine();n=Z(v(a));return(a.baseLayer=new n(a.options,r)).addTo(v(a)),a.VOGOViewer.on("onBeforeRender",a.updateFrame),a.constants={},a.constants.size={width:0<e.clientWidth?e.clientWidth:Number.parseFloat(e.style.width),height:0<e.clientHeight?e.clientHeight:Number.parseFloat(e.style.height)},a}return e.exports=s,e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/hooks/before_add_child",["datav:/npm/jquery/2.1.4"],function(n,e,t,a,o,r){t("datav:/npm/jquery/2.1.4");return n.exports=function(n,e){var t=n.coms,r=n.componentData,c=(r.instance,e.visServiceEndpoint);return Promise.all(t.map(function(n){return a="".concat(c,"/geo/random/com"),o={comName:n.name,version:n.version,apiName:"dataSource",range:r.instance.viewer.baseLayer.geojson_main},new Promise(function(e,t){fetch(a,{method:"POST",body:JSON.stringify(o),headers:{"content-type":"application/json"}}).then(function(n){return n.json()}).then(function(n){e({api_data:{dataSource:n}})}).catch(function(n){t(n)})});var a,o})).then(function(n){return n}).catch(function(n){throw console.error("业务子组件数据请求错误"),n})},n.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(e,t,n,r,i,o){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function c(e,t){var n,r="undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(!r){if(Array.isArray(e)||(r=function(e,t){if(e){if("string"==typeof e)return s(e,t);var n=Object.prototype.toString.call(e).slice(8,-1);return"Map"===(n="Object"===n&&e.constructor?e.constructor.name:n)||"Set"===n?Array.from(e):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?s(e,t):void 0}}(e))||t&&e&&"number"==typeof e.length)return r&&(e=r),n=0,{s:t=function(){},n:function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}},e:function(e){throw e},f:t};throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var i,o=!0,a=!1;return{s:function(){r=r.call(e)},n:function(){var e=r.next();return o=e.done,e},e:function(e){a=!0,i=e},f:function(){try{o||null==r.return||r.return()}finally{if(a)throw i}}}}function s(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=new Array(t);n<t;n++)r[n]=e[n];return r}function l(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function f(n){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=v(n),t=(e=r?(e=v(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function v(e){return(v=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=n("datav:/npm/eventemitter3/3.0.0"),d=n("datav:/npm/safely-merge/1.0.1"),h=n("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/hooks/before_add_child"),m=n("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/Viewer"),y=n("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/Config/Default"),w=n("datav:/com/@datav-3d-v3/datav-3dplane/3.1.30/src/core/utils").$,b=[["鼠标双击 + 区域"," 下钻地图；"],["鼠标双击 + 空白处"," 上钻地图；"],["鼠标左键 + 移动"," 旋转相机；"],["鼠标右键 + 移动"," 平移相机"]],n=function(){var e=s,t=p;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t);var n,a=f(s);function s(e,t){var n=2<arguments.length&&void 0!==arguments[2]?arguments[2]:{env:"editor",screenshotEnable:!1},r=this,i=s;if(!(r instanceof i))throw new TypeError("Cannot call a class as a function");(r=a.call(this)).options=d(y,t),x(r.options.options.terrain.backgroundTerrain),x(r.options.options.terrain.mainTerrain),k(r.options.options.general),A(r.options.options.general),r.apis=t.apis,r.subComs=new Map,r.status=n,r.container=document.createElement("div");var i=w(e).actual("width"),o=w(e).actual("height");return r.container.style.width=i+"px",r.container.style.height=o+"px",e.appendChild(r.container),r.helperDom=r.createHelperDom(),r.container.appendChild(r.helperDom),r.container.addEventListener("contextmenu",function(e){return e.preventDefault(),!1}),r._container=e,r.viewer=new m(r.container,r.options,n,r.subComs),r.viewer.baseHeightScale=1,r.viewer.drawScale=.17109,r.initEvents(),r}return e=s,(t=[{key:"createHelperDom",value:function(){var e,t=document.createElement("div"),n=(t.style="background-color: rgba(0, 0, 0, .3);line-height: 30px;padding: 0 5px; position:absolute; color:#ffffff; display:none; pointer-events:none;",c(b));try{for(n.s();!(e=n.n()).done;){var r=e.value,i=document.createElement("span"),o=document.createElement("span"),a=(o.innerText=r[1],document.createElement("span"));a.style="display: inline-block; line-height: 14px; padding: 2px; border: 1px solid #ffffff;",a.innerText=r[0],i.appendChild(a),i.appendChild(o),t.appendChild(i)}}catch(e){n.e(e)}finally{n.f()}return t}},{key:"displayHelperDom",value:function(){this.helperDom.style.display=0<arguments.length&&void 0!==arguments[0]&&arguments[0]?"block":"none"}},{key:"resize",value:function(e,t){this.viewer&&this.viewer.resize(e,t),this.emit("resize")}},{key:"get",value:function(e){return this.subComs.get(e)}},{key:"add",value:function(e,t){if(!e)return console.log("layer 没有定义");e.addTo&&e.addTo(this.viewer,t),this.subComs.set(t,e)}},{key:"remove",value:function(e,t){e.destroy&&e.destroy(),e.remove&&e.remove(),this.subComs.delete(t)}},{key:"updateCustomArea",value:function(t){var n=this;if(t.url)try{fetch(t.url).then(function(e){return e.json()}).then(function(e){n.setTopojson(e),n.setDefaultArea({value:t.defaultArea})})}catch(e){console.error("3D平面地图-更新自定义区域- url更新失败！")}else if(t.data)if("string"==typeof t.data)try{t=JSON.parse(t.data),this.setTopojson(t),this.setDefaultArea({value:t.defaultArea})}catch(e){console.error("3D平面地图-更新自定义区域- data更新失败！")}else try{this.setTopojson(t.data),this.setDefaultArea({value:t.defaultArea})}catch(e){console.error("3D平面地图-更新自定义区域- data更新失败！")}else t.defaultArea?this.setDefaultArea({value:t.defaultArea}):console.error("3D平面地图-更新自定义区域- url或data或defaultArea不能都为空！更新失败！")}},{key:"setDefaultArea",value:function(e){void 0!==e.value&&this.viewer&&this.viewer.setDefaultArea&&this.viewer.setDefaultArea(e)}},{key:"setTopojson",value:function(e){var t=this;e&&e.type&&e.api?fetch(e.api).then(function(e){return e.json()}).then(function(e){t.viewer&&t.viewer.setTopojson&&t.viewer.setTopojson(e)}):this.viewer&&this.viewer.setTopojson&&this.viewer.setTopojson(e)}},{key:"setWorldBorder",value:function(e){var t=this;e&&e.type&&e.api?fetch(e.api).then(function(e){return e.json()}).then(function(e){t.viewer&&t.viewer.setWorldBorder&&t.viewer.setWorldBorder(e)}):this.viewer&&this.viewer.setWorldBorder&&this.viewer.setWorldBorder(e)}},{key:"setChinaBorder",value:function(e){var t=this;e&&e.api?fetch(e.api).then(function(e){return e.json()}).then(function(e){t.viewer&&t.viewer.setChinaBorder&&t.viewer.setChinaBorder(e)}):this.viewer&&this.viewer.setChinaBorder&&this.viewer.setChinaBorder(e)}},{key:"updateOptions",value:function(e){this.options=d(this.options,e||{}),x(this.options.options.terrain.backgroundTerrain),x(this.options.options.terrain.mainTerrain),k(this.options.options.general),A(this.options.options.general),this.viewer&&this.viewer.updateOptions(this.options)}},{key:"stop",value:function(){this.viewer.cameraAnime&&("editor"===this.status.env&&!0===this.viewer.cameraAnime.isPreview&&this.viewer.cameraAnime.cancelPreview(),this.viewer.cameraAnime.stop())}},{key:"play",value:function(){this.viewer.cameraAnime&&("editor"===this.status.env&&!1===this.viewer.cameraAnime.isPreview&&this.viewer.cameraAnime.preview(),this.viewer.cameraAnime.play())}},{key:"pause",value:function(){var e;null!=(e=this.viewer)&&null!=(e=e.VOGOViewer)&&null!=(e=e.atomAnime)&&e.pause()}},{key:"restart",value:function(){var e;null!=(e=this.viewer)&&null!=(e=e.VOGOViewer)&&null!=(e=e.atomAnime)&&e.play()}},{key:"setCamera",value:function(e){this.viewer.setCamera(e)}},{key:"getCameraState",value:function(){return this.viewer.controls.getCameraState()}},{key:"getCameraInfo",value:function(){return this.viewer.getCameraInfo()}},{key:"initEvents",value:function(){var t=this;this.viewer&&this.viewer.engine.cameraControl&&this.viewer.engine.cameraControl.on("viewChanged",function(){t.emit("viewChanged")}),this.viewer&&(this.viewer.on("dblclick_focus",function(e){t.emit("dblclick_focus",e)}),this.viewer.on("dblclick_context",function(e){t.emit("dblclick_context",e)}),this.viewer.on("click_area",function(e){t.emit("click_area",e)}))}},{key:"destroy",value:function(){this.viewer&&this.viewer.destroy&&this.viewer.destroy(),this.viewer=null,this.container&&(this.container.innerHTML=""),this.container.remove(),this.emit("destroy")}}])&&l(e.prototype,t),n&&l(e,n),Object.defineProperty(e,"prototype",{writable:!1}),s}();function g(e,t){var e=e.componentData,s=e.instance;e.config,t.quitCallback;return s.displayHelperDom(!0),function(){var e=s.getCameraState(),t=s.viewer,n=t.bboxSize,t=t.center,r=e.position.lng,i=e.position.lat,o=e.position.altitude,r=s.viewer.proj.proj([r,i,0]),i=e.rotation.tilt,e=e.rotation.pan,a=100*(r[0]-t[0])/n,r=100*(r[1]-t[1])/n,t=o/(3*n*Math.sin(i*Math.PI/180)),o={config:{options:{general:{defaultArea:s.viewer.defaultArea,cameraOffset:{x:+a.toFixed(2),y:+r.toFixed(2)},cameraRotate:{tilt:+i.toFixed(2),pan:+e.toFixed(2)},cameraScale:{scale:+t.toFixed(2)}}}}};return s.displayHelperDom(!1),o}}function x(e){"string"==typeof e.topTexture.map&&(e.topTexture.map={show:!!e.topTexture.map,mapUrl:e.topTexture.map})}function k(e){var t;e.cameraOffset||(t=e.cameraView,e.cameraOffset={x:t.x,y:t.y},e.cameraRotate={tilt:t.tilt,pan:t.pan},e.cameraScale={scale:t.scale})}function A(e){var t;e.interaction instanceof Array&&!e.interactive&&(t=e.interaction,e.interactive={},e.interactive.enableMove=-1<t.indexOf("enableMove"),e.interactive.enableZoom=-1<t.indexOf("enableZoom"),e.interactive.enableRotate=-1<t.indexOf("enableRotate"))}return n.editBeforeAddChild=h,g.config={stretchSize:!0,enterIcon:"citylite-immersion",enterText:"设置默认区域",quitIcon:"save-exit",quitText:"保存并退出设置"},n.editOnImmerse=g,e.exports=n,e.exports});