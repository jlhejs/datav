// env=undefined => env=publish 
Cube("datav:/com/@datav_shukongkeji/shuiweitu/0.1.7/liquidFill",["datav:/npm/d3-array/1.2.0","datav:/npm/d3-ease/1.0.3","datav:/npm/d3-format/1.2.0","datav:/npm/d3-selection/1.1.0","datav:/npm/d3-scale/1.0.6","datav:/npm/d3-shape/1.2.0","datav:/npm/d3-transition/1.1.0"],function(a,b,c){function d(a){var a=e.select(a),b=a.select(".shukongkeji-liquid-fill");b.empty()&&(b=a.append("svg").attr("class","shukongkeji-liquid-fill")),d.count+=1,this.container=a,this.chart=b,this.id="shukongkeji-liquid-fill-"+d.count}var e=Object.assign({},c("datav:/npm/d3-array/1.2.0"),c("datav:/npm/d3-ease/1.0.3"),c("datav:/npm/d3-format/1.2.0"),c("datav:/npm/d3-selection/1.1.0"),c("datav:/npm/d3-scale/1.0.6"),c("datav:/npm/d3-shape/1.2.0"),c("datav:/npm/d3-transition/1.1.0"));return b.LiquidFill=d,d.count=0,d.prototype.render=function(a,b){var c=this.id,d=this.container,f=this.chart,h=parseInt(d.style("width")),i=parseInt(d.style("height"));f.attr("width",h).attr("height",i);var j=f.select(".shukongkeji-container");j.empty()&&(j=f.append("g").attr("class","shukongkeji-container")),j.attr("transform","translate("+h/2+","+i/2+")");var g=b.series,k=g.liquidColors,l=k[0]||n.stroke;a.forEach(function(a,b){a._color=a.color||k[b]||l});var m=function(a,b){if(a.selectAll(".shukongkeji-shape").attr("display","none"),"circle"===o){var c=a.select("circle");c.empty()&&(c=a.append("circle").attr("class","shukongkeji-shape").attr("cx",0).attr("cy",0)),c.attr("r",b).attr("display","block")}else if("rect"===o||"roundRect"===o){var d="rect"===o?0:b/3,e=a.select("rect");e.empty()&&(e=a.append("rect").attr("class","shukongkeji-shape")),e.attr("width",2*b).attr("height",2*b).attr("x",-b).attr("y",-b).attr("rx",d).attr("ry",d).attr("display","block")}},n=b.frame,o=n.shape,p=i*n.radius/2,q=j.select(".shukongkeji-frame");q.empty()&&(q=j.append("g").attr("class","shukongkeji-frame").attr("fill","none")),q.attr("stroke",n.stroke).attr("stroke-width",n.strokeWidth).call(m,p);var r=p-n.fillGap,s=j.selectAll(".shukongkeji-liquid").data(a);s.exit().remove(),s.enter().append("g").attr("class","shukongkeji-liquid").call(m,r);var t=b.wave,u=j.selectAll(".shukongkeji-liquid");u.call(m,r).attr("fill",function(a){return a._color}).selectAll(".shukongkeji-shape").attr("stroke-width",0).attr("opacity",t.opacity);var v=b.text,w="."+v.percentage+"%",x=j.select(".shukongkeji-label");x.empty()&&(j.append("text").attr("class","shukongkeji-label"),j.append("text").attr("class","shukongkeji-label shukongkeji-label-clip")),j.selectAll(".shukongkeji-label").attr("stroke","none").attr("text-anchor","middle").attr("fill",v.color).attr("font-weight",v.fontWeight).attr("dy",r*(1-2*v.position)).style("font-size",v.fontSize+"px").text(function(){var b=a.length?a[0].value:0;return e.format(w)(b)});var y=Math.round(t.peaks),z=r*t.amplitude,A=Math.PI*t.phase/180,B=8*Math.PI*y,C=1/(240*y),D=e.range(0,1+C/2,C),E=e.scaleLinear().domain([0,1]).range([-r,r]),F=e.scaleLinear().domain([-1,1]).range([z,-z]),G=a.map(function(a,b){return(b+1)*z*y+r}),H=a.map(function(a,b){var c=G[b];return e.scaleLinear().domain([0,1]).range([-c,c])}),I=a.map(function(a,b){return e.area().x(function(a){return 4*H[b](a.x)}).y0(r).y1(function(b){return F(b.y)-E(a.value)})}),J=j.select("defs");J.empty()&&(J=j.insert("defs",":first-child"));var K=J.selectAll(".shukongkeji-wave").data(a);K.exit().remove(),K.enter().append("clipPath").attr("class","shukongkeji-wave").append("path");var L=J.selectAll(".shukongkeji-wave").attr("id",function(a,b){return c+"-clip-path-"+b}),M=L.select("path");M.empty()&&(M=L.append("path")),M.attr("d",function(a,b){return I[b](D.map(function(a){return{x:a,y:Math.sin(B*a+A*(b+1))}}))}),u.attr("clip-path",function(a,b){return"url(#"+c+"-clip-path-"+b+")"}),j.select(".shukongkeji-label-clip").attr("fill",v.insideColor).attr("clip-path",function(){return"url(#"+c+"-clip-path-0)"});var N=t.animation;if(M.interrupt(),N.show){var O=N.direction,P=1e3*t.period,Q=N.ease,R="translate(0,0)",S=function(a,b){return"translate("+2*G[b]+", 0)"},T=function(a){a.attr("transform","ltr"===O?R:S).transition().duration(P).ease(e[Q]).attr("transform","ltr"===O?S:R).on("end",function(){T(a)})};M.call(T)}},a.exports});;
Cube("datav:/com/@datav_shukongkeji/shuiweitu/0.1.7",["datav:/npm/bcore/0.0.18/event","datav:/npm/d3-selection/1.1.0","datav:/npm/lodash/4.6.1"],function(a,b,c){var d=c("datav:/npm/bcore/0.0.18/event"),e=c("datav:/npm/d3-selection/1.1.0"),f=c("datav:/npm/lodash/4.6.1"),g=c("datav:/com/@datav_shukongkeji/shuiweitu/0.1.7/liquidFill").LiquidFill;return a.exports=d.extend(function(a,b){this.config={theme:{}},this.container=a,this.apis=b.apis,this._data=null,this.chart=new g(a),this.init(b)},{init:function(a){this.mergeConfig(a),this.updateLayout(),this.updateStyle()},render:function(a,b){a=this.data(a);var c=this.mergeConfig(b);this.chart.render(a,c),this.updateStyle()},resize:function(a,b){this.updateLayout(a,b),this.render()},setColors:function(){},data:function(a){return a&&(this._data=a),this._data},mergeConfig:function(a){return a?(this.config.theme=f.defaultsDeep(a.theme||{},this.config.theme),this.setColors(),this.config=f.defaultsDeep(a||{},this.config),this.config):this.config},updateLayout:function(){},updateStyle:function(){var a=this.config;e.select(this.container).style("font-size",a.size+"px").style("color",a.color||"#fff")},destroy:function(){console.log("\u8BF7\u5B9E\u73B0 destroy \u65B9\u6CD5")}}),a.exports});