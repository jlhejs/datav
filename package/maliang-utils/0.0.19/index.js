// env=undefined => env=publish 
Cube("datav:/com/maliang-utils/0.0.19",["datav:/npm/lodash/4.13.1"],function(a,b,c){function d(a,b,c){for(var d=[],f=0,g=a.length;f<g;f+=2)d.push([a[f],a[f+1]]);for(var h=e(d,0.4,b,c),i=d.length,j=[],k=0,l=0,m=0,n=0;n<i-1;n++)k=h[2*n],l=h[2*n+1],m=d[n+1],j.push(["C",k[0],k[1],l[0],l[1],m[0],m[1]]);return b&&(k=h[i],l=h[i+1],m=d[0],j.push(["C",k[0],k[1],l[0],l[1],m[0],m[1]])),j}function e(a,b,c,d){var e=[],f=void 0,h=void 0,j=!!d,k=void 0,m=void 0;if(j){k=[Infinity,Infinity],m=[-Infinity,-Infinity];for(var n,o=0,i=a.length;o<i;o++)n=a[o],k=g.min([],k,n),m=g.max([],m,n);k=g.min([],k,d[0]),m=g.max([],m,d[1])}for(var l,p=0,q=a.length;p<q;p++){if(l=a[p],c)f=a[p?p-1:q-1],h=a[(p+1)%q];else if(0===p||p===q-1){e.push(l);continue}else f=a[p-1],h=a[p+1];var r=[];r=g.sub(r,h,f),r=g.scale(r,r,b);var s=g.distance(l,f),t=g.distance(l,h),u=s+t;0!==u&&(s/=u,t/=u);var v=g.scale([],r,-s),w=g.scale([],r,t),x=g.add([],l,v),y=g.add([],l,w);j&&(x=g.max([],x,k),x=g.min([],x,m),y=g.max([],y,k),y=g.min([],y,m)),e.push(x),e.push(y)}return e}var f=c("datav:/npm/lodash/4.13.1");a.exports={threeD2Two:function(a,b,c,d,e,g){if(void 0===b||void 0===c||void 0===d||void 0===e)return a;e=f.map(e,function(a){return a+="",a});var h=[],i=[],j={},k=f.groupBy(a,function(a){var c=a[b];return j[c]||(j[c]=!0),a[b]});i=f.uniq(f.map(a,b)),g&&i.sort(g);var l={y:"z",z:"y"};return i.length&&i.forEach(function(a){var g=k[a],i=f.cloneDeep(k[a][0]);i[b]=a,f.isArray(c)?f.map(c,function(a){i[a]=[]}):i[c]=[],g.sort(function(c,a){return f.indexOf(e,c[d]+"")-f.indexOf(e,a[d]+"")}),f.map(g,function(a){var b=f.indexOf(e,a[d]+"");return!(0<=b)||void(f.isArray(c)?f.map(c,function(c){i[c][b]={value:a[c],data:f.omit(a,l[c])}}):i[c][b]={value:a[c],data:f.omit(a,l[c])})}),h.push(i)}),h},twoD2Three:function(a,b,c,d,e){if(void 0===b||void 0===c||void 0===d||void 0===e)return a;var g=[];return f.map(a,function(a){f.map(a.y,function(f,h){if(e[h]){var i={};i[b]=a[b],i[c]=f,i[d]=e[h],g.push(i)}})}),g},getSeriesValue:function(a,b){return f.uniq(f.map(a,b))},fixSeries4cycle:function(a,b,c,d,e){var g=f.uniq(f.map(b,c)),h=this.fixArray4cycle(a,g.length);return h.length&&h.forEach(function(b,c){var f=a[c]?a[c][d]||g[c]:g[c];e&&e(b,f)}),h},fixArray4cycle:function(a,b){if(b<=a.length)return a;var c=parseInt(b/a.length),d=b%a.length,e=f.concat.apply(this,this.fillArr(a,c));return e=f.concat(e,f.slice(a,0,d)),e},fillArr:function(a,b){for(var c=[],d=0;d<b;d++)c[d]=f.cloneDeep(a);return c},conflictConfigWithData:function(a,b,c){if(!a||!b||!c||!f.isArray(c)||0===c.length)return a;var d=f.cloneDeep(a),e=this;return c&&c.forEach(function(a){var c=a.dataField,g=a.configField,h=a.priority,j=a.newConfigField;if(a&&c&&g){var i,k;if(e.getDataField(c,b,function(a,c){i=a||"",k=c||b}),f.isObject(g)){var l=g.field;if("array"===g.type&&g.parent){var m=g.parent,n=f.get(d,m)||d,o=f.uniq(f.map(k,i)),p=e.fixArray4cycle(n,o.length);p.length&&p.forEach(function(a,b){e.getValueViaPriority(a,l,o[b],h,j)}),f.set(d,m,p)}else d=e.getValueViaPriority(d,l,k[k.length-1][i],h,j)}else d=e.getValueViaPriority(d,g,k[k.length-1][i],h,j)}}),d},getValueViaPriority:function(a,b,c,d,e){var f;return b&&(f=d&&"config"===d?a?a[b]||e&&a[e]||c:c:a?c||a[b]:c,a[e||b]=f),a},getDataField:function(a,b,c){var d,e;a&&(f.isObject(a)?(d=a.field,a.type&&"array"===a.type&&a.parent&&b&&b.forEach(function(b){f.get(b,a.parent)&&(e=f.get(b,a.parent))})):d=a,c(d,e))},getCustomSmoothSpline:function(a){if(!a)return console.warn("Smooth Spline Generation Warning: Input parameter cannot be null/undefined, please entering parameter in Array format"),"";if(!Array.isArray(a)||!a.length)return console.warn("Smooth Spline Generation Warning: Input parameter should be in Array format"),"";if(!a.length)return console.warn("Smooth Spline Generation Warning: Input parameter cannot be empty Array, Spline line cannot generate from empty point list"),"";a=a.map(function(a){return{x:a[0],y:a[1]}});var b=[],c=a[0],e=null;if(2>=a.length){var f=a[1];return c.x+","+c.y+(f?"L"+f.x+","+f.y:"")}a.forEach(function(a){e&&e.x===a.x&&e.y===a.y||(b.push(a.x),b.push(a.y),e=a)});var g=d(b,!1,[[0,0],[1,1]]);g.unshift(["",c.x,c.y]);var h=g.map(function(a){return""+a[0]+a.slice(1).join(",")});return h.join(" ")}};var g={min:function(c,d,a){return c[0]=Math.min(d[0],a[0]),c[1]=Math.min(d[1],a[1]),c},max:function(c,d,a){return c[0]=Math.max(d[0],a[0]),c[1]=Math.max(d[1],a[1]),c},scale:function(c,d,a){return c[0]=d[0]*a,c[1]=d[1]*a,c},add:function(c,d,a){return c[0]=d[0]+a[0],c[1]=d[1]+a[1],c},sub:function(c,d,a){return c[0]=d[0]-a[0],c[1]=d[1]-a[1],c},distance:function(c,a){var b=a[0]-c[0],d=a[1]-c[1];return Math.sqrt(b*b+d*d)}};return a.exports});