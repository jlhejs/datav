// env=undefined => env=publish 
Cube("datav:/com/@echarts/ml-echarts-bar-stack/2.0.12",["datav:/com/maliang-echarts-utils/0.0.18","datav:/npm/bcore/0.0.18/event","datav:/npm/jquery/2.1.4","datav:/npm/lodash/4.6.1","datav:/npm/echarts/4.4.0"],function(t,e,i,n,a,s){var c=i("datav:/npm/bcore/0.0.18/event"),r=i("datav:/npm/jquery/2.1.4"),h=i("datav:/npm/lodash/4.6.1"),o=i("datav:/npm/echarts/4.4.0"),d=i("datav:/com/maliang-echarts-utils/0.0.18");return t.exports=c.extend(function(t,e){this.config={series:[],yAxis:{data:[]},xAxis:{data:[]}},this.container=r(t),this.apis=e.apis,this._data=null,this.chart=null,this.init(e)},{init:function(t){var i=this;t=this.mergeConfig(t),this.chart=o.init(this.container[0],null,{renderer:t.renderer||"canvas"}),this.chart.setOption(d.config2echartsOptions(t)),this.updateStyle(),this.chart.off(),this.chart.on("click",function(t){var e=void 0;delete(e=h.merge({x:t.name,y:t.value,s:t.seriesName},t.data)).value,i.emit("click",e)}),this.chart.on("legendselectchanged",function(e){var t=h.filter(h.keys(e.selected),function(t){return e.selected[t]});i.emit("legend-select-changed",{selected:t,name:e.name})})},showTip:function(){var t=h.merge(t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},{type:"showTip"});this.chart.dispatchAction(t)},hideTip:function(){this.chart.dispatchAction({type:"hideTip"})},legendAction:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},e=t.type,e=void 0===e?"legendToggleSelect":e,t=t.name;e&&-1!==["legendSelect","legendUnSelect","legendToggleSelect"].indexOf(e)&&this.chart.dispatchAction({type:e,name:t})},render:function(t,e){e=this.mergeConfig(e),t=this.data(t);t=d.config2echartsOptions(this.mergeConfig(d.data2echartsBar(t,this.config)));this.chart.setOption(t,!0),this.updateStyle()},switchRenderer:function(t){this.chart.dispose(),this.chart=o.init(this.container[0],null,{renderer:t}),this.render()},resize:function(t,e){this.chart.resize({width:t,height:e})},data:function(t){return t&&(this._data=t),this._data},mergeConfig:function(t){if(!t)return this.config;var i=this;return t.series&&(t.series.forEach(function(t,e){t.data&&(i.config.series[e].data=t.data),i.config.series[e]=h.defaultsDeep(t||{},i.config.series[e]),i.config.series[e].type="bar"}),i.config.series=h.take(i.config.series,t.series.length)),this.config=h.defaultsDeep(t||{},this.config),h.map(this.config.series,function(t){t._markLine.show?t.markLine={lineStyle:{normal:{type:t._markLine.type,name:t._markLine.name,color:"auto"===t._markLine.color?null:t._markLine.color}},data:[[{type:"min"},{type:"max"}]]}:t.markLine=null}),this.config.legend.data=h.map(this.config.series,"name"),this.config.xAxis.name=this.config.xAxis._name,this.config.yAxis.name=this.config.yAxis._name,this.config.tooltip.showContent=this.config.tooltip.show,"dataMax"===this.config.yAxis.max&&(this.config.yAxis.max=function(t){return Math.round(100*t.max)/100}),this.config},updateStyle:function(){this.config},clear:function(){this.chart&&this.chart.clear&&this.chart.clear()},destroy:function(){this.chart&&this.chart.dispose&&this.chart.dispose()}}),t.exports});