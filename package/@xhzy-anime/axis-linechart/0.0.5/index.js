// env=undefined => env=publish 
Cube("datav:/com/@xhzy-anime/axis-linechart/0.0.5",["datav:/npm/bcore/0.0.19/event","datav:/npm/jquery/3.5.1","datav:/npm/lodash/4.17.20","datav:/npm/vizz/0.2.56"],function(a,b,c){var d=Object.assign||function(a){for(var b,c=1;c<arguments.length;c++)for(var d in b=arguments[c],b)Object.prototype.hasOwnProperty.call(b,d)&&(a[d]=b[d]);return a},e=c("datav:/npm/bcore/0.0.19/event"),f=c("datav:/npm/jquery/3.5.1"),g=c("datav:/npm/lodash/4.17.20"),h=c("datav:/npm/vizz/0.2.56");return a.exports=e.extend(function(a,b){var c=this;this.config={theme:{}},this.container=f(a),this.apis=b.apis,this._data=null,this.chart=null,this.option=null,this.interval=null,this.animation=null,this.init(b),this.finish=function(a){var b=a.data,d=a.duration,e=new Date().getTime();c.myReq=requestAnimationFrame(function a(){var f=new Date().getTime();f-e<d?c.myReq=requestAnimationFrame(a):(c.emit("finish",{data:b}),cancelAnimationFrame(c.myReq))})}},{init:function(a){this.mergeConfig(a),this.updateLayout(),this.updateStyle()},render:function(a,b){var c=this;a=this.data(a);var d=this.mergeConfig(b);this.chart=h.init(this.container[0]);var e=function(a,b){function c(a){a/=10,f++,1<a&&c(a)}var d=Math.max(a[a.length-1].x,a[a.length-1].y),e=d/b,f=0;c(e);for(var g=Math.pow(10,f-1),h=Math.ceil(e/g)*g,j=[],k=0;k<b+1;k++)j.push(k*h);return{span:h,array:j}}(a,4),f=1e3*d.options.others.animation.animationDuration,g=0<a.length?f/a.length:f;this.option={data:[{originData:[]}],grid:[{left:d.options.chart.grid.left,right:d.options.chart.grid.right,top:d.options.chart.grid.top,bottom:d.options.chart.grid.bottom}],axis:[{position:"bottom",type:"point",xOrY:"x",$dataIndex:0,dataKey:"date",interval:d.options.axis.xAxis.label.interval,alwaysShowLast:!0,label:{padding:d.options.axis.xAxis.label.padding,rotate:d.options.axis.xAxis.label.rotate,style:{fill:d.options.axis.xAxis.label.text.color,fontSize:d.options.axis.xAxis.label.text.fontSize,fontWeight:d.options.axis.xAxis.label.text.fontWeight,fontFamily:d.options.axis.xAxis.label.text.fontFamily}},line:{show:d.options.axis.xAxis.line.show,style:{stroke:d.options.axis.xAxis.line.stroke,lineWidth:d.options.axis.xAxis.line.lineWidth}}},{position:"left",nice:!0,type:"linear",xOrY:"y",animationDuration:g,animationEasing:"linear",splitNumber:100,min:0,z:4,tickValues:function(){return e.array},label:{show:d.options.axis.yAxis.show,padding:d.options.axis.yAxis.label.padding,rotate:d.options.axis.yAxis.label.rotate,style:{fill:d.options.axis.yAxis.label.text.color,fontSize:d.options.axis.yAxis.label.text.fontSize,fontWeight:d.options.axis.yAxis.label.text.fontWeight,fontFamily:d.options.axis.yAxis.label.text.fontFamily,textAlign:"left",textVerticalAlign:"bottom"}},offset:-10,line:{show:d.options.axis.yAxis.line.show&&d.options.axis.yAxis.show,style:{stroke:d.options.axis.yAxis.line.stroke,lineWidth:d.options.axis.yAxis.line.lineWidth}}}],series:[{type:"lineAnimation",$dataIndex:0,$axisIndex:[0,1],$gridIndex:0,dataKey:"x",threshhold:0,z:4,line:{style:{stroke:d.options.series.line1.stroke,lineWidth:d.options.series.line1.lineWidth}},splitArea:{show:!0,span:e.span,style:{fill:d.options.axis.yAxis.fill}},splitLine:{show:!1,style:{stroke:"rgb(200, 200, 200)",lineWidth:2}},splitLabel:{show:!1},vertexLabel:{show:!0,style:{textFill:d.options.series.line1.label.text.color,fontFamily:d.options.series.line1.label.text.fontFamily,offset:[0,-60+d.options.series.line1.label.padding],fontSize:d.options.series.line1.label.text.fontSize,textAlign:"center",fontWeight:d.options.series.line1.label.text.fontWeight}},animation:!0,animationDuration:g},{type:"lineAnimation",$dataIndex:0,$axisIndex:[0,1],$gridIndex:0,dataKey:"y",threshhold:0,z:4,line:{style:{stroke:d.options.series.line2.stroke,lineWidth:d.options.series.line2.lineWidth}},splitLine:{show:!1,style:{stroke:"rgb(200, 200, 200)",lineWidth:2}},vertexLabel:{show:!0,style:{textFill:d.options.series.line2.label.text.color,fontFamily:d.options.series.line2.label.text.fontFamily,offset:[0,-60+d.options.series.line2.label.padding],fontSize:d.options.series.line2.label.text.fontSize,fontWeight:d.options.series.line2.label.text.fontWeight,textAlign:"center"}},animation:!0,animationDuration:g}]},this.chart.setOption(this.option),this.animation=function(b){var d=0,e=c.chart.getDataModel(0),f=c.chart.getModel("series",0),g=c.chart.getModel("series",1),h=f.createData(a,d);e.setData(h),c.interval&&clearInterval(c.interval),c.interval=setInterval(function(){d++,d<a.length?(e.setData(f.createData(a,d)),f.set("threshhold",d),g.set("threshhold",d)):clearInterval(c.interval)},b)},this.animation(g);var i=1e3*d.options.others.animation.animationDelay+1e3*d.options.others.animation.animationDuration;this.finish({data:a,duration:i}),this.updateStyle()},resize:function(a,b){this.updateLayout(a,b),this.chart.resize(),this.chart.setOption(this.option)},setColors:function(){},data:function(a){return a&&(this._data=a),this._data},mergeConfig:function(a){return a?(this.config.theme=g.defaultsDeep(a.theme||{},this.config.theme),this.setColors(),this.config=g.defaultsDeep(a||{},this.config),this.config):this.config},updateLayout:function(){},updateStyle:function(){},updateOptions:function(a){var b=this.data(),c=1e3*a.options.others.animation.animationDuration,e=0<b.length?c/b.length:c;this.option.axis[0].interval=a.options.axis.xAxis.label.interval,this.option.axis[0].label={padding:a.options.axis.xAxis.label.padding,rotate:a.options.axis.xAxis.label.rotate,style:d({},this.option.axis[0].label.style,a.options.axis.xAxis.label.text,{fill:a.options.axis.xAxis.label.text.color})},this.option.axis[0].line={show:a.options.axis.xAxis.line.show,style:{stroke:a.options.axis.xAxis.line.stroke,lineWidth:a.options.axis.xAxis.line.lineWidth}},this.option.axis[1].label={show:a.options.axis.yAxis.show,padding:a.options.axis.yAxis.label.padding,rotate:a.options.axis.yAxis.label.rotate,style:d({},this.option.axis[1].label.style,a.options.axis.yAxis.label.text,{fill:a.options.axis.yAxis.label.text.color})},this.option.axis[1].line={show:a.options.axis.yAxis.line.show&&a.options.axis.yAxis.show,style:{stroke:a.options.axis.yAxis.line.stroke,lineWidth:a.options.axis.yAxis.line.lineWidth}},this.option.axis[1].animationDuration=e,this.option.series[0].line.style.stroke=a.options.series.line1.stroke,this.option.series[0].line.style.lineWidth=a.options.series.line1.lineWidth,this.option.series[0].splitArea.style.fill=a.options.axis.yAxis.fill,this.option.series[0].vertexLabel.style=d({},this.option.series[0].vertexLabel.style,a.options.series.line1.label.text,{textFill:a.options.series.line1.label.text.color,offset:[0,-60+a.options.series.line1.label.padding]}),this.option.series[0].animationDuration=e,this.option.series[1].line.style.stroke=a.options.series.line2.stroke,this.option.series[1].line.style.lineWidth=a.options.series.line2.lineWidth,this.option.series[1].vertexLabel.style=d({},this.option.series[1].vertexLabel.style,a.options.series.line2.label.text,{textFill:a.options.series.line2.label.text.color,offset:[0,-60+a.options.series.line2.label.padding]}),this.option.series[1].animationDuration=e,this.option.grid={left:a.options.chart.grid.left,right:a.options.chart.grid.right,top:a.options.chart.grid.top,bottom:a.options.chart.grid.bottom},this.chart.setOption(this.option),this.animation(e);var f=1e3*a.options.others.animation.animationDelay+1e3*a.options.others.animation.animationDuration;this.finish({data:b,duration:f})},destroy:function(){this.chart.clear()},getThemableConfig:function(a){if(!a)return null;var b={options:{chart:{moveLabel:{text:{color:a.textColor},textBackgroundColor:a.palette[5]}},axis:{xAxis:{label:{text:{color:a.textColor}},line:{stroke:a.axisColor}},yAxis:{label:{text:{color:a.textColor}},fill:a.palette[5],line:{stroke:a.axisColor}}},series:{line1:{stroke:a.palette[1],label:{text:{color:a.palette[1]}}},line2:{stroke:a.palette[3],label:{text:{color:a.palette[3]}}}}}};return b}}),a.exports});