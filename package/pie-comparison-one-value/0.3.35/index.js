// env=undefined => env=publish 
Cube("datav:/com/pie-comparison-one-value/0.3.35/template.html",[],function(e,l,a,t,i,n){return e.exports=function(){return'<div class="label-1 label"></div>\n<div class="chart"></div>\n<div class="label-2 label"></div>'},e.exports});;
Cube("datav:/com/pie-comparison-one-value/0.3.35",["datav:/com/counter/1.3.18","datav:/npm/bcore/0.0.22/event","datav:/npm/dchart-pie-crossover-one-value/0.4.7","datav:/npm/lodash/4.17.11","datav:/npm/jquery/2.1.4"],function(t,a,e,i,n,r){var o=e("datav:/npm/bcore/0.0.22/event"),s=e("datav:/com/counter/1.3.18"),l=e("datav:/npm/dchart-pie-crossover-one-value/0.4.7"),h=e("datav:/npm/lodash/4.17.11"),c=e("datav:/npm/jquery/2.1.4"),u=e("datav:/com/pie-comparison-one-value/0.3.35/template.html")();return t.exports=o.extend(function(t,a){this.config={theme:{bg:["#000","transparent"],font:["#eee","#252525"],colors:["RGB(77, 211, 225)","#A0AAB3"]},container:{padding:10},labels:{global:{align:{justifyContent:"center"},textStyle:{fontSize:"12px"}},interaction:{callbackId:""},numbers:{backgroundColor:"rgba(0,0,0,0)",textStyle:{}},prefix:{textStyle:{}},suffix:{textStyle:{}},color:"#999",aimsLabel:"本月销售目标",actualLabel:"本月累计销售额","font-size":14},chart:{border:12,crossAngle:Math.PI/6,_progressColor:{style:"single",value:"#44D3E2"},bgProgressColor:"rgba(1, 1, 1, 0)",excessColor:{style:"single",value:"#cd1616"},color4:"#fff",color5:"#fff",color6:"#fff","font-size":20,label:{size:20},rounding:!1,decimal:2,margin:{top:10,bottom:10},innerArc:{},arc:{}},labeled:{separate:!1,"inner-style":{}},animation:{show:!0,animationDuration:1e3,animationEasing:"cubicInOut",animationDurationUpdate:300,animationUpdateFromPrevious:!0}},this.template=u,this.container=c(t),this.mergeConfig(a),this.apis=a.apis,this.container.append(this.template),this.labelsDom=this.container.find(".label"),this.chartDom=this.container.find(".chart"),this.labels=[],this.chart=null,this.multicolors={},this.init()},{setColors:function(t){},mergeConfig:function(t){return t&&(this.config.theme=h.defaultsDeep(t.theme||{},this.config.theme),this.setColors(),this.config=h.defaultsDeep(t||{},this.config)),this.config},init:function(){var t=this.config;this.initLayout(),t.labeled=h.defaultsDeep(t.labels,t.labeled),this.labels[0]=new s(this.labelsDom[0],t.labeled||{}),this.chart=new l(this.chartDom[0],t.chart),this.labels[1]=new s(this.labelsDom[1],t.labeled||{}),this.labelsDom.find(".sub-header").hide()},initLayout:function(){var t=this.config,a=t.container.padding,a=(this.container.css({padding:a,"box-sizing":"border-box"}),this.container.height()||600),e=t.labels.height,i=t.chart.height;e||i?e?i=i||a-2*e:e=(a-i)/2:(e=.1*a,i=.8*a),t.labels.show||h.isUndefined(t.labels.show)||(e=0,i=a),this.container.height(a),this.labelsDom.outerHeight(e),this.chartDom.outerHeight(i),this.labelsDom.css("line-height",e+"px"),t.chart.arc.radius=t.chart.arc._radius=t.chart.radius*Math.min(i-t.chart.margin.top-t.chart.margin.bottom,this.chartDom.width())/2},trans:function(t){return t?[{value:t||0}]:[{value:0}]},data:function(t){return this._data=t?h.map(t,function(t){return t.actual=h.toNumber(t.actual)||0,t.aims=h.toNumber(t.aims)||0,t}):this._data||[{actual:0,aims:0}],this._data},render:function(t,a){var e,i;(t=this.data(t))&&t.length&&t[0].aims?(a=this.mergeConfig(a),this.initLayout(),a.chart.label.size=a.chart["font-size"],a.chart.label.fontWeight=a.chart.fontWeight,a.chart.label.decimal=a.chart.decimal,a.chart.label.rounding=a.chart.rounding,i=a.animation,(e=a.chart).animation=i.show,e.animationDuration=i.animationDuration,e.animationEasing=i.animationEasing,e.animationUpdateFromPrevious=i.animationUpdateFromPrevious,e.animationDurationUpdate=i.animationDurationUpdate,e.progressColor=t[0].color||a.chart._progressColor,i=.5*Math.min(this.chartDom.height()-e.margin.top-e.margin.bottom,this.chartDom.width()),e.innerArc.innerRadius=e.innerRadius*i-2*a.chart.border-1,e.innerArc.outerRadius=e.outerRadius*i-a.chart.border-1,e.arc.innerRadius=e.outerRadius*i-a.chart.border,e.arc.outerRadius=e.outerRadius*i,e.arc.radius=e.outerRadius*i,this.chart.render(this.calDiv(t[0].actual,t[0].aims),a.chart||{}),this.labelrender(t,a),this.updateStyle(),this._cfg=a):this.clear()},calMul:function(t,a){var t=t.toString(),a=a.toString(),e=0,e=(e+=-1===t.indexOf(".")?0:t.split(".")[1].length)+(-1===a.indexOf(".")?0:a.split(".")[1].length);return Number(t.replace(".",""))*Number(a.replace(".",""))/Math.pow(10,e)},calDiv:function(t,a){var t=t.toString(),a=a.toString(),e=-1===t.indexOf(".")?0:t.split(".")[1].length,i=-1===a.indexOf(".")?0:a.split(".")[1].length,t=Number(t.replace(".","")),a=Number(a.replace(".",""));return this.calMul(t/a,Math.pow(10,i-e))},labelrender:function(t,a){var e={fontSize:a.labels.fontSize,color:a.labels.color,fontWeight:a.labels.fontWeight},i=h.defaultsDeep({prefix:{content:a.labels.actualLabel+"："||"",textStyle:e}},a.labels),a=h.defaultsDeep({prefix:{content:a.labels.aimsLabel+"："||"",textStyle:e}},a.labels);i.numbers=a.numbers={textStyle:e},this.labels[0].render(this.trans(t[0].actual),i),this.labels[1].render(this.trans(t[0].aims),a)},resize:function(t,a){this.initLayout(),this.render()},clear:function(){var t=this.config,a=this.data(void 0);this.chart.render(0,t.chart),this.labelrender(a,t),this.updateStyle()},updateStyle:function(){var t=this.config,t=(this.data(),this.chart.el.select(".con-svg").style("background","transparent"),this.container.css("font-family",'"'.concat(t.labels.fontFamily,'"')||"Microsoft Yahei"),this.chart.el.selectAll("text").style("font-family",'"'.concat(t.labels.fontFamily,'"')||"Microsoft Yahei"),this.chart.svg.selectAll(".bg-inner-circle").style({fill:t.chart.color4,stroke:"none"}),this.chart.svg.selectAll(".bg-upper-line, .bg-lower-line").style("stroke",t.chart.color5),this.chart.svg.selectAll(".serie-label").style("fill",t.chart.color6),t.labels.show||h.isUndefined(t.labels.show));this.labelsDom.css({display:t?"flex":"none"})},destroy:function(){this.chart=null,this._data=null,this.container&&this.container.empty()},startAnimate:function(){if(!this.chart)return!1;var t,a,e,i;this._cfg&&(this.chart.clearAllAnimation(),a=(t=this._cfg.chart).animationUpdateFromPrevious,t.animationUpdateFromPrevious=!1,e=t.animationDurationUpdate,t.animationDurationUpdate=t.animationDuration,i=this.data(),this.chart.render(this.calDiv(i[0].actual,i[0].aims),this._cfg.chart||{}),this.labelrender(i,this._cfg),this.updateStyle(),t.animationDurationUpdate=e,t.animationUpdateFromPrevious=a)},clearAnimate:function(){this.chart&&this.chart.resumeToAnimationEnd()}}),t.exports});