// env=undefined => env=publish 
Cube("datav:/com/map2d-layer-series-scatter/0.1.1/index.css", [], function(m){m.exports=".map-2d-scatter-container .interactive-circle.active{animation-duration:.8s;animation-timing-function:ease-in-out;animation-iteration-count:infinite;animation-name:map-2d-scatter-circle-shining}@keyframes map-2d-scatter-circle-shining{from{transform:translate(0,0) scale(1,1)}to{transform:translate(-50%,-50%) scale(1.5,1.5)}}";return m.exports});;
Cube("datav:/com/map2d-layer-series-scatter/0.1.1",["datav:/npm/bcore/0.0.21/event","datav:/npm/bcore/0.0.21/utils","datav:/npm/ldmap/0.1.29/core/utils","datav:/npm/jquery/2.1.3","datav:/npm/lodash/3.10.0","datav:/npm/ldmap/0.1.29/layer/scatter_markers"],function(a,b,c){function d(a,b){this.options=f.deepMerge(this.options,b)}var e=c("datav:/npm/bcore/0.0.21/event"),f=c("datav:/npm/bcore/0.0.21/utils"),g=c("datav:/npm/ldmap/0.1.29/core/utils"),h=c("datav:/npm/jquery/2.1.3"),i=c("datav:/npm/lodash/3.10.0");c("datav:/com/map2d-layer-series-scatter/0.1.1/index.css","");var j=c("datav:/npm/ldmap/0.1.29/layer/scatter_markers");return d=e.extend(d,{options:{},addTo:function(a){a._map&&(a=a._map),this.map=a,this.initCom()},initCom:function(){if(this.options.series)var a=this.genOptions(this.options);var b=this.layer=new j(a);b.addTo(this.map);var c=this;b.on("child-mousedown",function(a){var b=a.data,d=c._getDotsConfig(),e=c._getDotConfig(d,b.key);c.emit("click-scatter-dot",b),c.emit("global_var",e["click-key"],b[e["click-key"]]),a.layer.textNode&&h(a.layer.textNode).addClass("active"),c.lastClickDot&&c.lastClickDot.removeClass("active"),c.lastClickDot=h(a.layer.textNode)})},_getDotsConfig:function(){var a={},b=this.options;return b.series.forEach(function(b){a[b.key]=b}),a},_getDotConfig:function(a,b){return b=b.toLowerCase(),a[b]||{}},_getDotRange:function(a){return this.dotsRange[a]},_calculateDotsRange:function(a){var b=this;this.dotsRange={},i.each(a,function(a,c){b.dotsRange[c]=g.getRange(a,"value")})},genData:function(a){if(a||(a=[]),this._dotData=a,!!a){for(var b=[],c={},d=0;d<a.length;d++)if(a[d].lat&&a[d].lng){a[d].type&&(a[d].key=a[d].type);var e=a[d].key;c[e]||(c[e]=[]),c[e].push(a[d]),b.push(a[d])}a=b,this._dotData=b,this._calculateDotsRange(c)}},genOptions:function(a){this.options=a;var b=this,a={lat:function(a){return a.lat},lng:function(a){return a.lng},id:function(a){var c=b._getDotsConfig(),d=b._getDotConfig(c,a.key);return a.lat+"_"+a.lng+(d["click-key"]&&a[d["click-key"]]?"_"+a[d["click-key"]]:"")},text:function(){return""},zoom:{max:20,min:1},popup:function(a){var c=b._getDotsConfig(),d=b._getDotConfig(c,a.key);d.tip||(d.tip={"font-size":12,color:"#fff"});var e="<div style=\"font-size:"+d.tip["font-size"]+"px;color:"+d.tip.color+";\">";if(a.name&&(e+=a.name+"<br/>"),"object"==typeof a.info)for(var f in a.info)e+=f+": "+a.info[f]+"<br/>";else e+=a.info||"";return e+="</div>",e},child:{css:function(a,c){c=h(c);var d=b._getDotsConfig(),e=b._getDotConfig(d,a.key),f={"border-color":e["border-color"],"border-width":e["border-width"]+"px","border-style":e["border-style"]||"none","background-size":"cover","border-radius":"50%"};if(e.ifDataBind){var i=b._getDotRange(a.key),j=i[0]||0,k=i[1]||1,l={from:e.colors.from,to:e.colors.to,default:e.colors.defaultColor},m=g.getColorFunc(l),n=e.size,o=n.min,p=n.max,q="undefined"===typeof a.value?0:(a.value-j)/(k-j)||0,r=m(q),s=o+q*(p-o);a.value||(s=e.size.none),f=h.extend(f,{background:r,left:-s,top:-s,width:2*s,height:2*s,"line-height":2*s+"px"})}else{var t=e.color,s=e.radius;f=h.extend(f,{background:t,left:-s,top:-s,width:2*s,height:2*s,"line-height":2*s+"px"})}c.css(f)}}};return a},updateOptions:function(a){if(a.series){var a=this.genOptions(a);this.layer.updateOptions(a),this.layer.render(this._dotData)}},destory:function(){this.layer.destroy(),this._dotData=[]},render:function(a){return a?void(this.genData(a),this.layer.render(this._dotData),document.querySelectorAll(".interactive-circle").forEach((a)=>{a.style.pointerEvents=this.map._container.style.pointerEvents||"auto"})):console.log("\u5730\u56FE\u7EC4\u4EF6Map2dLayerSeriesScatter\u672A\u6536\u5230\u6570\u636E...")}}),a.exports=d,a.exports});