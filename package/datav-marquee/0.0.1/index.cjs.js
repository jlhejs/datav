"use strict";var e=require("vue"),v=require("datav-vue"),$=(t,s)=>{const u=t.__vccOpts||t;for(const[c,a]of s)u[c]=a;return u};const M=e.defineComponent({name:"VMarquee",props:{com:{type:Object,required:!0}},setup(t){const s=v.useApiStore();v.useDataCenter(t.com);const u=e.computed(()=>{var n,_;return(_=(n=s.dataMap[t.com.id])==null?void 0:n.source)!=null?_:{}}),c=e.computed(()=>v.getFieldMap(t.com.apis.source.fields)),a=e.toRef(t.com,"config"),o=e.toRef(t.com,"attr"),S=e.ref(null),d=e.ref(null),r=e.ref(""),i=e.ref(""),l=e.ref(0),f=e.ref(0),m=e.ref(0),y=e.computed(()=>({width:`${o.value.w}px`,height:`${o.value.h}px`,fontFamily:`${a.value.textStyle.fontFamily}, Arial, sans-serif`,fontSize:`${a.value.textStyle.fontSize}px`,color:a.value.textStyle.color,"font-weight":a.value.textStyle.fontWeight})),q=e.computed(()=>({display:"inline-block",transform:r.value,transition:i.value})),h=e.computed(()=>u.value[c.value.value]||a.value.title),T=e.computed(()=>{let n=`<div style="display: inline-block;min-width: ${l.value}px">${h.value}<i style="display:inline-block; width:80px;"></i></div>`;return n+n}),p=()=>{e.nextTick(()=>{if(d.value&&(l.value=d.value.offsetWidth/2),l.value>o.value.w){let n=0;a.value.ifSpeed?n=a.value.speed/100*l.value:n=a.value.duration,r.value=`translateX(-${l.value}px)`,i.value=`transform ${n}ms linear 0s`,f.value=window.setTimeout(()=>{r.value="translateX(0)",i.value="none 0s ease 0s",a.value.loop&&(a.value.timeout>0?m.value=window.setTimeout(p,a.value.timeout):p())},n)}else l.value=o.value.w,r.value="translateX(0)",i.value="none 0s ease 0s"})},x=v._.debounce(p,500);return e.watch([y,h],()=>{clearTimeout(f.value),clearTimeout(m.value),l.value=o.value.w,r.value="translateX(0)",i.value="none 0s ease 0s",x()}),e.onMounted(()=>{x()}),e.onUnmounted(()=>{clearTimeout(f.value),clearTimeout(m.value)}),{marqueeRef:S,marqueeTextRef:d,wrapperStyle:y,textStyle:q,content:T}}}),V={ref:"marqueeRef",style:{"white-space":"nowrap",overflow:"hidden"}},g=["innerHTML"];function k(t,s,u,c,a,o){return e.openBlock(),e.createElementBlock("div",{class:"datav-wrapper",style:e.normalizeStyle(t.wrapperStyle)},[e.createElementVNode("div",V,[e.createElementVNode("div",{ref:"marqueeTextRef",style:e.normalizeStyle(t.textStyle),innerHTML:t.content},null,12,g)],512)],4)}var w=$(M,[["render",k],["__file","F:/datav-jlhe/src/components/text/marquee/src/index.vue"]]);w.install=t=>{t.component("VMarquee",w)};window.datavVue&&window.datavVue.app&&window.datavVue.app.use(w);
