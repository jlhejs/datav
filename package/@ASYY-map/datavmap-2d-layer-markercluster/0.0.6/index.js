// env=undefined => env=publish 
Cube("datav:/com/datavmap-2d-layer-markercluster/0.0.6/markercluster/markercluster.css", [], function(m){m.exports=".leaflet-cluster-anim .leaflet-marker-icon,.leaflet-cluster-anim .leaflet-marker-shadow{-webkit-transition:-webkit-transform .3s ease-out,opacity .3s ease-in;-moz-transition:-moz-transform .3s ease-out,opacity .3s ease-in;-o-transition:-o-transform .3s ease-out,opacity .3s ease-in;transition:transform .3s ease-out,opacity .3s ease-in}.leaflet-cluster-spider-leg{-webkit-transition:-webkit-stroke-dashoffset .3s ease-out,-webkit-stroke-opacity .3s ease-in;-moz-transition:-moz-stroke-dashoffset .3s ease-out,-moz-stroke-opacity .3s ease-in;-o-transition:-o-stroke-dashoffset .3s ease-out,-o-stroke-opacity .3s ease-in;transition:stroke-dashoffset .3s ease-out,stroke-opacity .3s ease-in}";return m.exports});;
Cube("datav:/com/datavmap-2d-layer-markercluster/0.0.6/markerClusterLayer.js",["datav:/npm/safely-merge/1.0.1"],function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"===typeof b||"function"===typeof b)?b:a}function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}();return a.exports=function(h){var a=h.BaseLayer,b=c("datav:/npm/safely-merge/1.0.1");c("datav:/com/datavmap-2d-layer-markercluster/0.0.6/markercluster/markercluster.css","");var j=30,i="cssKey_"+function(a){if(0<a){for(var b,c=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],d="",e=0;e<a;e++)b=parseInt(61*Math.random()),d+=c[b];return d}return!1}(10)+"_";h.MarkerClusterGroup=h.FeatureGroup.extend({options:{maxClusterRadius:80,iconCreateFunction:null,spiderfyOnMaxZoom:!0,showCoverageOnHover:!0,zoomToBoundsOnClick:!0,singleMarkerMode:!1,disableClusteringAtZoom:null,removeOutsideVisibleBounds:!0,animate:!0,animateAddingMarkers:!1,spiderfyDistanceMultiplier:1,spiderLegPolylineOptions:{weight:1.5,color:"#222",opacity:0.5},chunkedLoading:!1,chunkInterval:200,chunkDelay:50,chunkProgress:null,polygonOptions:{}},initialize:function(a){h.Util.setOptions(this,a),this.options.iconCreateFunction||(this.options.iconCreateFunction=this._defaultIconCreateFunction),this.options.clusterPane||(this.options.clusterPane=h.Marker.prototype.options.pane),this._featureGroup=h.featureGroup(),this._featureGroup.addEventParent(this),this._nonPointGroup=h.featureGroup(),this._nonPointGroup.addEventParent(this),this._inZoomAnimation=0,this._needsClustering=[],this._needsRemoving=[],this._currentShownBounds=null,this._queue=[],this._childMarkerEventHandlers={dragstart:this._childMarkerDragStart,move:this._childMarkerMoved,dragend:this._childMarkerDragEnd};var b=h.DomUtil.TRANSITION&&this.options.animate;h.extend(this,b?this._withAnimation:this._noAnimation),this._markerCluster=b?h.MarkerCluster:h.MarkerClusterNonAnimated},addLayer:function(a){if(a instanceof h.LayerGroup)return this.addLayers([a]);if(!a.getLatLng)return this._nonPointGroup.addLayer(a),this.fire("layeradd",{layer:a}),this;if(!this._map)return this._needsClustering.push(a),this.fire("layeradd",{layer:a}),this;if(this.hasLayer(a))return this;this._unspiderfy&&this._unspiderfy(),this._addLayer(a,this._maxZoom),this.fire("layeradd",{layer:a}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons();var b=a,c=this._zoom;if(a.__parent)for(;b.__parent._zoom>=c;)b=b.__parent;return this._currentShownBounds.contains(b.getLatLng())&&(this.options.animateAddingMarkers?this._animationAddLayer(a,b):this._animationAddLayerNonAnimated(a,b)),this},removeLayer:function(a){return a instanceof h.LayerGroup?this.removeLayers([a]):a.getLatLng?this._map?a.__parent?(this._unspiderfy&&(this._unspiderfy(),this._unspiderfyLayer(a)),this._removeLayer(a,!0),this.fire("layerremove",{layer:a}),this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),a.off(this._childMarkerEventHandlers,this),this._featureGroup.hasLayer(a)&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow()),this):this:(!this._arraySplice(this._needsClustering,a)&&this.hasLayer(a)&&this._needsRemoving.push({layer:a,latlng:a._latlng}),this.fire("layerremove",{layer:a}),this):(this._nonPointGroup.removeLayer(a),this.fire("layerremove",{layer:a}),this)},addLayers:function(a,b){if(!h.Util.isArray(a))return this.addLayer(a);var c,d=this._featureGroup,e=this._nonPointGroup,f=this.options.chunkedLoading,g=this.options.chunkInterval,i=this.options.chunkProgress,j=a.length,k=0,l=!0;if(this._map){var n=new Date().getTime(),o=h.bind(function(){for(var p=new Date().getTime();k<j;k++){if(f&&0===k%200){var q=new Date().getTime()-p;if(q>g)break}if(c=a[k],c instanceof h.LayerGroup){l&&(a=a.slice(),l=!1),this._extractNonGroupLayers(c,a),j=a.length;continue}if(!c.getLatLng){e.addLayer(c),b||this.fire("layeradd",{layer:c});continue}if(!this.hasLayer(c)&&(this._addLayer(c,this._maxZoom),b||this.fire("layeradd",{layer:c}),c.__parent&&2===c.__parent.getChildCount())){var r=c.__parent.getAllChildMarkers(),s=r[0]===c?r[1]:r[0];d.removeLayer(s)}}i&&i(k,j,new Date().getTime()-n),k===j?(this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds)):setTimeout(o,this.options.chunkDelay)},this);o()}else for(var p=this._needsClustering;k<j;k++){if(c=a[k],c instanceof h.LayerGroup){l&&(a=a.slice(),l=!1),this._extractNonGroupLayers(c,a),j=a.length;continue}if(!c.getLatLng){e.addLayer(c);continue}this.hasLayer(c)||p.push(c)}return this},removeLayers:function(a){var b,c,d=a.length,e=this._featureGroup,f=this._nonPointGroup,g=!0;if(!this._map){for(b=0;b<d;b++){if(c=a[b],c instanceof h.LayerGroup){g&&(a=a.slice(),g=!1),this._extractNonGroupLayers(c,a),d=a.length;continue}this._arraySplice(this._needsClustering,c),f.removeLayer(c),this.hasLayer(c)&&this._needsRemoving.push({layer:c,latlng:c._latlng}),this.fire("layerremove",{layer:c})}return this}if(this._unspiderfy){this._unspiderfy();var i=a.slice(),j=d;for(b=0;b<j;b++){if(c=i[b],c instanceof h.LayerGroup){this._extractNonGroupLayers(c,i),j=i.length;continue}this._unspiderfyLayer(c)}}for(b=0;b<d;b++){if(c=a[b],c instanceof h.LayerGroup){g&&(a=a.slice(),g=!1),this._extractNonGroupLayers(c,a),d=a.length;continue}if(!c.__parent){f.removeLayer(c),this.fire("layerremove",{layer:c});continue}this._removeLayer(c,!0,!0),this.fire("layerremove",{layer:c}),e.hasLayer(c)&&(e.removeLayer(c),c.clusterShow&&c.clusterShow())}return this._topClusterLevel._recalculateBounds(),this._refreshClustersIcons(),this._topClusterLevel._recursivelyAddChildrenToMap(null,this._zoom,this._currentShownBounds),this},clearLayers:function(){return this._map||(this._needsClustering=[],delete this._gridClusters,delete this._gridUnclustered),this._noanimationUnspiderfy&&this._noanimationUnspiderfy(),this._featureGroup.clearLayers(),this._nonPointGroup.clearLayers(),this.eachLayer(function(a){a.off(this._childMarkerEventHandlers,this),delete a.__parent},this),this._map&&this._generateInitialClusters(),this},getBounds:function(){var a=new h.LatLngBounds;this._topClusterLevel&&a.extend(this._topClusterLevel._bounds);for(var b=this._needsClustering.length-1;0<=b;b--)a.extend(this._needsClustering[b].getLatLng());return a.extend(this._nonPointGroup.getBounds()),a},eachLayer:function(a,b){var c,d,e,f=this._needsClustering.slice(),g=this._needsRemoving;for(this._topClusterLevel&&this._topClusterLevel.getAllChildMarkers(f),d=f.length-1;0<=d;d--){for(c=!0,e=g.length-1;0<=e;e--)if(g[e].layer===f[d]){c=!1;break}c&&a.call(b,f[d])}this._nonPointGroup.eachLayer(a,b)},getLayers:function(){var a=[];return this.eachLayer(function(b){a.push(b)}),a},getLayer:function(a){var b=null;return a=parseInt(a,10),this.eachLayer(function(c){h.stamp(c)===a&&(b=c)}),b},hasLayer:function(a){if(!a)return!1;var b,c=this._needsClustering;for(b=c.length-1;0<=b;b--)if(c[b]===a)return!0;for(c=this._needsRemoving,b=c.length-1;0<=b;b--)if(c[b].layer===a)return!1;return!!(a.__parent&&a.__parent._group===this)||this._nonPointGroup.hasLayer(a)},zoomToShowLayer:function(a,b){"function"!==typeof b&&(b=function(){});var c=function c(){(a._icon||a.__parent._icon)&&!this._inZoomAnimation&&(this._map.off("moveend",c,this),this.off("animationend",c,this),a._icon?b():a.__parent._icon&&(this.once("spiderfied",b,this),a.__parent.spiderfy()))};a._icon&&this._map.getBounds().contains(a.getLatLng())?b():a.__parent._zoom<Math.round(this._map._zoom)?(this._map.on("moveend",c,this),this._map.panTo(a.getLatLng())):(this._map.on("moveend",c,this),this.on("animationend",c,this),a.__parent.zoomToBounds())},onAdd:function(a){this._map=a;var b,c,d;for(!isFinite(this._map.getMaxZoom()),this._featureGroup.addTo(a),this._nonPointGroup.addTo(a),this._gridClusters||this._generateInitialClusters(),this._maxLat=a.options.crs.projection.MAX_LATITUDE,(b=0,c=this._needsRemoving.length);b<c;b++)d=this._needsRemoving[b],d.newlatlng=d.layer._latlng,d.layer._latlng=d.latlng;for(b=0,c=this._needsRemoving.length;b<c;b++)d=this._needsRemoving[b],this._removeLayer(d.layer,!0),d.layer._latlng=d.newlatlng;this._needsRemoving=[],this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds(),this._map.on("zoomend",this._zoomEnd,this),this._map.on("moveend",this._moveEnd,this),this._spiderfierOnAdd&&this._spiderfierOnAdd(),this._bindEvents(),c=this._needsClustering,this._needsClustering=[],this.addLayers(c,!0)},onRemove:function(a){a.off("zoomend",this._zoomEnd,this),a.off("moveend",this._moveEnd,this),this._unbindEvents(),this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim",""),this._spiderfierOnRemove&&this._spiderfierOnRemove(),delete this._maxLat,this._hideCoverage(),this._featureGroup.remove(),this._nonPointGroup.remove(),this._featureGroup.clearLayers(),this._map=null},getVisibleParent:function(a){for(var b=a;b&&!b._icon;)b=b.__parent;return b||null},_arraySplice:function(a,b){for(var c=a.length-1;0<=c;c--)if(a[c]===b)return a.splice(c,1),!0},_removeFromGridUnclustered:function(a,b){for(var c=this._map,d=this._gridUnclustered,e=Math.floor(this._map.getMinZoom());b>=e&&!!d[b].removeObject(a,c.project(a.getLatLng(),b));b--);},_childMarkerDragStart:function(a){a.target.__dragStart=a.target._latlng},_childMarkerMoved:function(a){if(!this._ignoreMove&&!a.target.__dragStart){var b=a.target._popup&&a.target._popup.isOpen();this._moveChild(a.target,a.oldLatLng,a.latlng),b&&a.target.openPopup()}},_moveChild:function(a,b,c){a._latlng=b,this.removeLayer(a),a._latlng=c,this.addLayer(a)},_childMarkerDragEnd:function(a){a.target.__dragStart&&this._moveChild(a.target,a.target.__dragStart,a.target._latlng),delete a.target.__dragStart},_removeLayer:function(a,b,c){var d=this._gridClusters,e=this._gridUnclustered,f=this._featureGroup,g=this._map,h=Math.floor(this._map.getMinZoom());b&&this._removeFromGridUnclustered(a,this._maxZoom);var i,j=a.__parent,k=j._markers;for(this._arraySplice(k,a);j&&(j._childCount--,j._boundsNeedUpdate=!0,!(j._zoom<h));)b&&1>=j._childCount?(i=j._markers[0]===a?j._markers[1]:j._markers[0],d[j._zoom].removeObject(j,g.project(j._cLatLng,j._zoom)),e[j._zoom].addObject(i,g.project(i.getLatLng(),j._zoom)),this._arraySplice(j.__parent._childClusters,j),j.__parent._markers.push(i),i.__parent=j.__parent,j._icon&&(f.removeLayer(j),!c&&f.addLayer(i))):j._iconNeedsUpdate=!0,j=j.__parent;delete a.__parent},_isOrIsParent:function(a,b){for(;b;){if(a===b)return!0;b=b.parentNode}return!1},fire:function(a,b,c){if(b&&b.layer instanceof h.MarkerCluster){if(b.originalEvent&&this._isOrIsParent(b.layer._icon,b.originalEvent.relatedTarget))return;a="cluster"+a}h.FeatureGroup.prototype.fire.call(this,a,b,c)},listens:function(a,b){return h.FeatureGroup.prototype.listens.call(this,a,b)||h.FeatureGroup.prototype.listens.call(this,"cluster"+a,b)},_defaultIconCreateFunction:function(a){var b=a.getChildCount(),d=" "+i+"marker-cluster-";return d+=10>b?"small":100>b?"medium":"large",new h.DivIcon({html:"<div><span>"+b+"</span></div>",className:i+"marker-cluster"+d,iconSize:new h.Point(2*j,2*j)})},_bindEvents:function(){var a=this._map,b=this.options.spiderfyOnMaxZoom,c=this.options.showCoverageOnHover,d=this.options.zoomToBoundsOnClick;(b||d)&&this.on("clusterclick",this._zoomOrSpiderfy,this),c&&(this.on("clustermouseover",this._showCoverage,this),this.on("clustermouseout",this._hideCoverage,this),a.on("zoomend",this._hideCoverage,this))},_zoomOrSpiderfy:function(a){for(var b=a.layer,c=b;1===c._childClusters.length;)c=c._childClusters[0];c._zoom===this._maxZoom&&c._childCount===b._childCount&&this.options.spiderfyOnMaxZoom?b.spiderfy():this.options.zoomToBoundsOnClick&&b.zoomToBounds(),a.originalEvent&&13===a.originalEvent.keyCode&&this._map._container.focus()},_showCoverage:function(a){var b=this._map;this._inZoomAnimation||(this._shownPolygon&&b.removeLayer(this._shownPolygon),2<a.layer.getChildCount()&&a.layer!==this._spiderfied&&(this._shownPolygon=new h.Polygon(a.layer.getConvexHull(),this.options.polygonOptions),b.addLayer(this._shownPolygon)))},_hideCoverage:function(){this._shownPolygon&&(this._map.removeLayer(this._shownPolygon),this._shownPolygon=null)},_unbindEvents:function(){var a=this.options.spiderfyOnMaxZoom,b=this.options.showCoverageOnHover,c=this.options.zoomToBoundsOnClick,d=this._map;(a||c)&&this.off("clusterclick",this._zoomOrSpiderfy,this),b&&(this.off("clustermouseover",this._showCoverage,this),this.off("clustermouseout",this._hideCoverage,this),d.off("zoomend",this._hideCoverage,this))},_zoomEnd:function(){this._map&&(this._mergeSplitClusters(),this._zoom=Math.round(this._map._zoom),this._currentShownBounds=this._getExpandedVisibleBounds())},_moveEnd:function(){if(!this._inZoomAnimation){var a=this._getExpandedVisibleBounds();return this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,a),this._topClusterLevel._recursivelyAddChildrenToMap(null,Math.round(this._map._zoom),a),void(this._currentShownBounds=a)}},_generateInitialClusters:function(){var a=Math.ceil(this._map.getMaxZoom()),b=Math.floor(this._map.getMinZoom()),c=this.options.maxClusterRadius,d=c;"function"!==typeof c&&(d=function(){return c}),null!==this.options.disableClusteringAtZoom&&(a=this.options.disableClusteringAtZoom-1),this._maxZoom=a,this._gridClusters={},this._gridUnclustered={};for(var e=a;e>=b;e--)this._gridClusters[e]=new h.DistanceGrid(d(e)),this._gridUnclustered[e]=new h.DistanceGrid(d(e));this._topClusterLevel=new this._markerCluster(this,b-1)},_addLayer:function(a,b){var c,d,e=this._gridClusters,f=this._gridUnclustered,g=Math.floor(this._map.getMinZoom());for(this.options.singleMarkerMode&&this._overrideMarkerIcon(a),a.on(this._childMarkerEventHandlers,this);b>=g;b--){c=this._map.project(a.getLatLng(),b);var h=e[b].getNearObject(c);if(h)return h._addChild(a),void(a.__parent=h);if(h=f[b].getNearObject(c),h){var i=h.__parent;i&&this._removeLayer(h,!1);var j=new this._markerCluster(this,b,h,a);e[b].addObject(j,this._map.project(j._cLatLng,b)),h.__parent=j,a.__parent=j;var k=j;for(d=b-1;d>i._zoom;d--)k=new this._markerCluster(this,d,k),e[d].addObject(k,this._map.project(h.getLatLng(),d));return i._addChild(k),void this._removeFromGridUnclustered(h,b)}f[b].addObject(a,c)}return this._topClusterLevel._addChild(a),void(a.__parent=this._topClusterLevel)},_refreshClustersIcons:function(){this._featureGroup.eachLayer(function(a){a instanceof h.MarkerCluster&&a._iconNeedsUpdate&&a._updateIcon()})},_enqueue:function(a){this._queue.push(a),this._queueTimeout||(this._queueTimeout=setTimeout(h.bind(this._processQueue,this),300))},_processQueue:function(){for(var a=0;a<this._queue.length;a++)this._queue[a].call(this);this._queue.length=0,clearTimeout(this._queueTimeout),this._queueTimeout=null},_mergeSplitClusters:function(){var a=Math.round(this._map._zoom);this._processQueue(),this._zoom<a&&this._currentShownBounds.intersects(this._getExpandedVisibleBounds())?(this._animationStart(),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),this._zoom,this._getExpandedVisibleBounds()),this._animationZoomIn(this._zoom,a)):this._zoom>a?(this._animationStart(),this._animationZoomOut(this._zoom,a)):this._moveEnd()},_getExpandedVisibleBounds:function(){return this.options.removeOutsideVisibleBounds?h.Browser.mobile?this._checkBoundsMaxLat(this._map.getBounds()):this._checkBoundsMaxLat(this._map.getBounds().pad(1)):this._mapBoundsInfinite},_checkBoundsMaxLat:function(a){var b=this._maxLat;return void 0!==b&&(a.getNorth()>=b&&(a._northEast.lat=Infinity),a.getSouth()<=-b&&(a._southWest.lat=-Infinity)),a},_animationAddLayerNonAnimated:function(a,b){if(b===a)this._featureGroup.addLayer(a);else if(2===b._childCount){b._addToMap();var c=b.getAllChildMarkers();this._featureGroup.removeLayer(c[0]),this._featureGroup.removeLayer(c[1])}else b._updateIcon()},_extractNonGroupLayers:function(a,b){var c,d=a.getLayers(),e=0;for(b=b||[];e<d.length;e++){if(c=d[e],c instanceof h.LayerGroup){this._extractNonGroupLayers(c,b);continue}b.push(c)}return b},_overrideMarkerIcon:function(a){var b=a.options.icon=this.options.iconCreateFunction({getChildCount:function(){return 1},getAllChildMarkers:function(){return[a]}});return b}}),h.MarkerClusterGroup.include({_mapBoundsInfinite:new h.LatLngBounds(new h.LatLng(-Infinity,-Infinity),new h.LatLng(Infinity,Infinity))}),h.MarkerClusterGroup.include({_noAnimation:{_animationStart:function(){},_animationZoomIn:function(a,b){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a),this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationZoomOut:function(a,b){this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a),this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds()),this.fire("animationend")},_animationAddLayer:function(a,b){this._animationAddLayerNonAnimated(a,b)}},_withAnimation:{_animationStart:function(){this._map._mapPane.className+=" leaflet-cluster-anim",this._inZoomAnimation++},_animationZoomIn:function(a,b){var d,e=this._getExpandedVisibleBounds(),f=this._featureGroup,c=Math.floor(this._map.getMinZoom());this._ignoreMove=!0,this._topClusterLevel._recursively(e,a,c,function(g){var c,h=g._latlng,i=g._markers;for(e.contains(h)||(h=null),g._isSingleParent()&&a+1===b?(f.removeLayer(g),g._recursivelyAddChildrenToMap(null,b,e)):(g.clusterHide(),g._recursivelyAddChildrenToMap(h,b,e)),d=i.length-1;0<=d;d--)c=i[d],e.contains(c._latlng)||f.removeLayer(c)}),this._forceLayout(),this._topClusterLevel._recursivelyBecomeVisible(e,b),f.eachLayer(function(a){!(a instanceof h.MarkerCluster)&&a._icon&&a.clusterShow()}),this._topClusterLevel._recursively(e,a,b,function(a){a._recursivelyRestoreChildPositions(b)}),this._ignoreMove=!1,this._enqueue(function(){this._topClusterLevel._recursively(e,a,c,function(a){f.removeLayer(a),a.clusterShow()}),this._animationEnd()})},_animationZoomOut:function(a,b){this._animationZoomOutSingle(this._topClusterLevel,a-1,b),this._topClusterLevel._recursivelyAddChildrenToMap(null,b,this._getExpandedVisibleBounds()),this._topClusterLevel._recursivelyRemoveChildrenFromMap(this._currentShownBounds,Math.floor(this._map.getMinZoom()),a,this._getExpandedVisibleBounds())},_animationAddLayer:function(a,b){var c=this,d=this._featureGroup;d.addLayer(a),b!==a&&(2<b._childCount?(b._updateIcon(),this._forceLayout(),this._animationStart(),a._setPos(this._map.latLngToLayerPoint(b.getLatLng())),a.clusterHide(),this._enqueue(function(){d.removeLayer(a),a.clusterShow(),c._animationEnd()})):(this._forceLayout(),c._animationStart(),c._animationZoomOutSingle(b,this._map.getMaxZoom(),this._zoom)))}},_animationZoomOutSingle:function(a,b,c){var d=this._getExpandedVisibleBounds(),e=Math.floor(this._map.getMinZoom());a._recursivelyAnimateChildrenInAndAddSelfToMap(d,e,b+1,c);var f=this;this._forceLayout(),a._recursivelyBecomeVisible(d,c),this._enqueue(function(){if(1===a._childCount){var g=a._markers[0];this._ignoreMove=!0,g.setLatLng(g.getLatLng()),this._ignoreMove=!1,g.clusterShow&&g.clusterShow()}else a._recursively(d,c,e,function(a){a._recursivelyRemoveChildrenFromMap(d,e,b+1)});f._animationEnd()})},_animationEnd:function(){this._map&&(this._map._mapPane.className=this._map._mapPane.className.replace(" leaflet-cluster-anim","")),this._inZoomAnimation--,this.fire("animationend")},_forceLayout:function(){h.Util.falseFn(document.body.offsetWidth)}}),h.markerClusterGroup=function(a){return new h.MarkerClusterGroup(a)},h.MarkerCluster=h.Marker.extend({initialize:function(c,d,e,a){h.Marker.prototype.initialize.call(this,e?e._cLatLng||e.getLatLng():new h.LatLng(0,0),{icon:this,pane:c.options.clusterPane}),this._group=c,this._zoom=d,this._markers=[],this._childClusters=[],this._childCount=0,this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._bounds=new h.LatLngBounds,e&&this._addChild(e),a&&this._addChild(a)},getAllChildMarkers:function(a){a=a||[];for(var b=this._childClusters.length-1;0<=b;b--)this._childClusters[b].getAllChildMarkers(a);for(var c=this._markers.length-1;0<=c;c--)a.push(this._markers[c]);return a},getChildCount:function(){return this._childCount},zoomToBounds:function(a){for(var b,c=this._childClusters.slice(),d=this._group._map,e=d.getBoundsZoom(this._bounds),f=this._zoom+1,g=d.getZoom();0<c.length&&e>f;){f++;var h=[];for(b=0;b<c.length;b++)h=h.concat(c[b]._childClusters);c=h}e>f?this._group._map.setView(this._latlng,f):e<=g?this._group._map.setView(this._latlng,g+1):this._group._map.fitBounds(this._bounds,a)},getBounds:function(){var a=new h.LatLngBounds;return a.extend(this._bounds),a},_updateIcon:function(){this._iconNeedsUpdate=!0,this._icon&&this.setIcon(this)},createIcon:function(){return this._iconNeedsUpdate&&(this._iconObj=this._group.options.iconCreateFunction(this),this._iconNeedsUpdate=!1),this._iconObj.createIcon()},createShadow:function(){return this._iconObj.createShadow()},_addChild:function(a,b){this._iconNeedsUpdate=!0,this._boundsNeedUpdate=!0,this._setClusterCenter(a),a instanceof h.MarkerCluster?(!b&&(this._childClusters.push(a),a.__parent=this),this._childCount+=a._childCount):(!b&&this._markers.push(a),this._childCount++),this.__parent&&this.__parent._addChild(a,!0)},_setClusterCenter:function(a){this._cLatLng||(this._cLatLng=a._cLatLng||a._latlng)},_resetBounds:function(){var a=this._bounds;a._southWest&&(a._southWest.lat=Infinity,a._southWest.lng=Infinity),a._northEast&&(a._northEast.lat=-Infinity,a._northEast.lng=-Infinity)},_recalculateBounds:function(){var a,b,c,d,e=this._markers,f=this._childClusters,g=0,i=0,j=this._childCount;if(0!==j){for(this._resetBounds(),a=0;a<e.length;a++)c=e[a]._latlng,this._bounds.extend(c),g+=c.lat,i+=c.lng;for(a=0;a<f.length;a++)b=f[a],b._boundsNeedUpdate&&b._recalculateBounds(),this._bounds.extend(b._bounds),c=b._wLatLng,d=b._childCount,g+=c.lat*d,i+=c.lng*d;this._latlng=this._wLatLng=new h.LatLng(g/j,i/j),this._boundsNeedUpdate=!1}},_addToMap:function(a){a&&(this._backupLatlng=this._latlng,this.setLatLng(a)),this._group._featureGroup.addLayer(this)},_recursivelyAnimateChildrenIn:function(a,b,c){this._recursively(a,this._group._map.getMinZoom(),c-1,function(a){var c,d,e=a._markers;for(c=e.length-1;0<=c;c--)d=e[c],d._icon&&(d._setPos(b),d.clusterHide())},function(a){var c,d,e=a._childClusters;for(c=e.length-1;0<=c;c--)d=e[c],d._icon&&(d._setPos(b),d.clusterHide())})},_recursivelyAnimateChildrenInAndAddSelfToMap:function(a,b,d,e){this._recursively(a,e,b,function(f){f._recursivelyAnimateChildrenIn(a,f._group._map.latLngToLayerPoint(f.getLatLng()).round(),d),f._isSingleParent()&&d-1===e?(f.clusterShow(),f._recursivelyRemoveChildrenFromMap(a,b,d)):f.clusterHide(),f._addToMap()})},_recursivelyBecomeVisible:function(a,b){this._recursively(a,this._group._map.getMinZoom(),b,null,function(a){a.clusterShow()})},_recursivelyAddChildrenToMap:function(a,b,d){this._recursively(d,this._group._map.getMinZoom()-1,b,function(e){if(b!==e._zoom)for(var c,f=e._markers.length-1;0<=f;f--)(c=e._markers[f],!!d.contains(c._latlng))&&(a&&(c._backupLatlng=c.getLatLng(),c.setLatLng(a),c.clusterHide&&c.clusterHide()),e._group._featureGroup.addLayer(c))},function(b){b._addToMap(a)})},_recursivelyRestoreChildPositions:function(a){for(var b,c=this._markers.length-1;0<=c;c--)b=this._markers[c],b._backupLatlng&&(b.setLatLng(b._backupLatlng),delete b._backupLatlng);if(a-1===this._zoom)for(var d=this._childClusters.length-1;0<=d;d--)this._childClusters[d]._restorePosition();else for(var e=this._childClusters.length-1;0<=e;e--)this._childClusters[e]._recursivelyRestoreChildPositions(a)},_restorePosition:function(){this._backupLatlng&&(this.setLatLng(this._backupLatlng),delete this._backupLatlng)},_recursivelyRemoveChildrenFromMap:function(a,b,c,d){var e,f;this._recursively(a,b-1,c-1,function(a){for(f=a._markers.length-1;0<=f;f--)e=a._markers[f],d&&d.contains(e._latlng)||(a._group._featureGroup.removeLayer(e),e.clusterShow&&e.clusterShow())},function(a){for(f=a._childClusters.length-1;0<=f;f--)e=a._childClusters[f],d&&d.contains(e._latlng)||(a._group._featureGroup.removeLayer(e),e.clusterShow&&e.clusterShow())})},_recursively:function(a,b,d,e,f){var g,h,c=this._childClusters,i=this._zoom;if(b<=i&&(e&&e(this),f&&i===d&&f(this)),i<b||i<d)for(g=c.length-1;0<=g;g--)h=c[g],a.intersects(h._bounds)&&h._recursively(a,b,d,e,f)},_isSingleParent:function(){return 0<this._childClusters.length&&this._childClusters[0]._childCount===this._childCount}}),h.Marker.include({clusterHide:function(){return this.options.opacityWhenUnclustered=this.options.opacity||1,this.setOpacity(0)},clusterShow:function(){var a=this.setOpacity(this.options.opacity||this.options.opacityWhenUnclustered);return delete this.options.opacityWhenUnclustered,a}}),h.DistanceGrid=function(a){this._cellSize=a,this._sqCellSize=a*a,this._grid={},this._objectPoint={}},h.DistanceGrid.prototype={addObject:function(a,b){var c=this._getCoord(b.x),d=this._getCoord(b.y),e=this._grid,f=e[d]=e[d]||{},g=f[c]=f[c]||[],i=h.Util.stamp(a);this._objectPoint[i]=b,g.push(a)},updateObject:function(a,b){this.removeObject(a),this.addObject(a,b)},removeObject:function(a,b){var c,d,e=this._getCoord(b.x),f=this._getCoord(b.y),g=this._grid,i=g[f]=g[f]||{},j=i[e]=i[e]||[];for(delete this._objectPoint[h.Util.stamp(a)],c=0,d=j.length;c<d;c++)if(j[c]===a)return j.splice(c,1),1===d&&delete i[e],!0},eachObject:function(a,b){var c,d,e,f,g,h,i,j=this._grid;for(c in j)for(d in g=j[c],g)for(h=g[d],e=0,f=h.length;e<f;e++)i=a.call(b,h[e]),i&&(e--,f--)},getNearObject:function(a){var b,c,d,e,f,g,i,j,k=this._getCoord(a.x),l=this._getCoord(a.y),m=this._objectPoint,n=this._sqCellSize,o=null;for(b=l-1;b<=l+1;b++)if(e=this._grid[b],e)for(c=k-1;c<=k+1;c++)if(f=e[c],f)for(d=0,g=f.length;d<g;d++)i=f[d],j=this._sqDist(m[h.Util.stamp(i)],a),j<n&&(n=j,o=i);return o},_getCoord:function(a){return Math.floor(a/this._cellSize)},_sqDist:function(a,b){var c=b.x-a.x,d=b.y-a.y;return c*c+d*d}},function(){h.QuickHull={getDistant:function(a,b){var c=b[1].lat-b[0].lat,d=b[0].lng-b[1].lng;return d*(a.lat-b[0].lat)+c*(a.lng-b[0].lng)},findMostDistantPointFromBaseLine:function(a,b){var c,e,f,d=0,g=null,h=[];for(c=b.length-1;0<=c;c--){if(e=b[c],f=this.getDistant(e,a),0<f)h.push(e);else continue;f>d&&(d=f,g=e)}return{maxPoint:g,newPoints:h}},buildConvexHull:function(a,b){var c=[],d=this.findMostDistantPointFromBaseLine(a,b);return d.maxPoint?(c=c.concat(this.buildConvexHull([a[0],d.maxPoint],d.newPoints)),c=c.concat(this.buildConvexHull([d.maxPoint,a[1]],d.newPoints)),c):[a[0]]},getConvexHull:function(a){var b,c=!1,d=!1,e=!1,f=!1,g=null,h=null,i=null,j=null,k=null,l=null;for(b=a.length-1;0<=b;b--){var m=a[b];(!1===c||m.lat>c)&&(g=m,c=m.lat),(!1===d||m.lat<d)&&(h=m,d=m.lat),(!1===e||m.lng>e)&&(i=m,e=m.lng),(!1===f||m.lng<f)&&(j=m,f=m.lng)}d===c?(l=j,k=i):(l=h,k=g);var n=[].concat(this.buildConvexHull([l,k],a),this.buildConvexHull([k,l],a));return n}}}(),h.MarkerCluster.include({getConvexHull:function(){var a,b,c=this.getAllChildMarkers(),d=[];for(b=c.length-1;0<=b;b--)a=c[b].getLatLng(),d.push(a);return h.QuickHull.getConvexHull(d)}}),h.MarkerCluster.include({_2PI:2*Math.PI,_circleFootSeparation:25,_circleStartAngle:Math.PI/6,_spiralFootSeparation:28,_spiralLengthStart:11,_spiralLengthFactor:5,_circleSpiralSwitchover:9,spiderfy:function(){if(!(this._group._spiderfied===this||this._group._inZoomAnimation)){var a,b=this.getAllChildMarkers(),c=this._group,d=c._map,e=d.latLngToLayerPoint(this._latlng);this._group._unspiderfy(),this._group._spiderfied=this,b.length>=this._circleSpiralSwitchover?a=this._generatePointsSpiral(b.length,e):(e.y+=10,a=this._generatePointsCircle(b.length,e)),this._animationSpiderfy(b,a)}},unspiderfy:function(a){this._group._inZoomAnimation||(this._animationUnspiderfy(a),this._group._spiderfied=null)},_generatePointsCircle:function(a,b){var c,d,e=this._group.options.spiderfyDistanceMultiplier*this._circleFootSeparation*(2+a),f=e/this._2PI,g=this._2PI/a,i=[];for(i.length=a,c=a-1;0<=c;c--)d=this._circleStartAngle+c*g,i[c]=new h.Point(b.x+f*Math.cos(d),b.y+f*Math.sin(d))._round();return i},_generatePointsSpiral:function(a,b){var c,d=this._group.options.spiderfyDistanceMultiplier,e=d*this._spiralLengthStart,f=d*this._spiralFootSeparation,g=d*this._spiralLengthFactor*this._2PI,i=0,j=[];for(j.length=a,c=a-1;0<=c;c--)i+=f/e+5e-4*c,j[c]=new h.Point(b.x+e*Math.cos(i),b.y+e*Math.sin(i))._round(),e+=g/i;return j},_noanimationUnspiderfy:function(){var a,b,c=this._group,d=c._map,e=c._featureGroup,f=this.getAllChildMarkers();for(c._ignoreMove=!0,this.setOpacity(1),b=f.length-1;0<=b;b--)a=f[b],e.removeLayer(a),a._preSpiderfyLatlng&&(a.setLatLng(a._preSpiderfyLatlng),delete a._preSpiderfyLatlng),a.setZIndexOffset&&a.setZIndexOffset(0),a._spiderLeg&&(d.removeLayer(a._spiderLeg),delete a._spiderLeg);c.fire("unspiderfied",{cluster:this,markers:f}),c._ignoreMove=!1,c._spiderfied=null}}),h.MarkerClusterNonAnimated=h.MarkerCluster.extend({_animationSpiderfy:function(a,b){var c,d,e,f,g=this._group,i=g._map,j=g._featureGroup,k=this._group.options.spiderLegPolylineOptions;for(g._ignoreMove=!0,c=0;c<a.length;c++)f=i.layerPointToLatLng(b[c]),d=a[c],e=new h.Polyline([this._latlng,f],k),i.addLayer(e),d._spiderLeg=e,d._preSpiderfyLatlng=d._latlng,d.setLatLng(f),d.setZIndexOffset&&d.setZIndexOffset(1e6),j.addLayer(d);this.setOpacity(0.3),g._ignoreMove=!1,g.fire("spiderfied",{cluster:this,markers:a})},_animationUnspiderfy:function(){this._noanimationUnspiderfy()}}),h.MarkerCluster.include({_animationSpiderfy:function(a,b){var c,d,e,f,g,i,j=this,k=this._group,l=k._map,m=k._featureGroup,n=this._latlng,o=l.latLngToLayerPoint(n),p=h.Path.SVG,q=h.extend({},this._group.options.spiderLegPolylineOptions),r=q.opacity;for(void 0===r&&(r=h.MarkerClusterGroup.prototype.options.spiderLegPolylineOptions.opacity),p?(q.opacity=0,q.className=(q.className||"")+" leaflet-cluster-spider-leg"):q.opacity=r,k._ignoreMove=!0,c=0;c<a.length;c++)d=a[c],i=l.layerPointToLatLng(b[c]),e=new h.Polyline([n,i],q),l.addLayer(e),d._spiderLeg=e,p&&(f=e._path,g=f.getTotalLength()+0.1,f.style.strokeDasharray=g,f.style.strokeDashoffset=g),d.setZIndexOffset&&d.setZIndexOffset(1e6),d.clusterHide&&d.clusterHide(),m.addLayer(d),d._setPos&&d._setPos(o);for(k._forceLayout(),k._animationStart(),c=a.length-1;0<=c;c--)i=l.layerPointToLatLng(b[c]),d=a[c],d._preSpiderfyLatlng=d._latlng,d.setLatLng(i),d.clusterShow&&d.clusterShow(),p&&(e=d._spiderLeg,f=e._path,f.style.strokeDashoffset=0,e.setStyle({opacity:r}));this.setOpacity(0.3),k._ignoreMove=!1,setTimeout(function(){k._animationEnd(),k.fire("spiderfied",{cluster:j,markers:a})},200)},_animationUnspiderfy:function(a){var b,c,d,e,f,g,i=this,j=this._group,k=j._map,l=j._featureGroup,m=a?k._latLngToNewLayerPoint(this._latlng,a.zoom,a.center):k.latLngToLayerPoint(this._latlng),n=this.getAllChildMarkers(),o=h.Path.SVG;for(j._ignoreMove=!0,j._animationStart(),this.setOpacity(1),c=n.length-1;0<=c;c--)(b=n[c],!!b._preSpiderfyLatlng)&&(b.closePopup(),b.setLatLng(b._preSpiderfyLatlng),delete b._preSpiderfyLatlng,g=!0,b._setPos&&(b._setPos(m),g=!1),b.clusterHide&&(b.clusterHide(),g=!1),g&&l.removeLayer(b),o&&(d=b._spiderLeg,e=d._path,f=e.getTotalLength()+0.1,e.style.strokeDashoffset=f,d.setStyle({opacity:0})));j._ignoreMove=!1,setTimeout(function(){var a=0;for(c=n.length-1;0<=c;c--)b=n[c],b._spiderLeg&&a++;for(c=n.length-1;0<=c;c--)(b=n[c],!!b._spiderLeg)&&(b.clusterShow&&b.clusterShow(),b.setZIndexOffset&&b.setZIndexOffset(0),1<a&&l.removeLayer(b),k.removeLayer(b._spiderLeg),delete b._spiderLeg);j._animationEnd(),j.fire("unspiderfied",{cluster:i,markers:n})},200)}}),h.MarkerClusterGroup.include({_spiderfied:null,unspiderfy:function(){this._unspiderfy.apply(this,arguments)},_spiderfierOnAdd:function(){this._map.on("click",this._unspiderfyWrapper,this),this._map.options.zoomAnimation&&this._map.on("zoomstart",this._unspiderfyZoomStart,this),this._map.on("zoomend",this._noanimationUnspiderfy,this),h.Browser.touch||this._map.getRenderer(this)},_spiderfierOnRemove:function(){this._map.off("click",this._unspiderfyWrapper,this),this._map.off("zoomstart",this._unspiderfyZoomStart,this),this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._map.off("zoomend",this._noanimationUnspiderfy,this),this._noanimationUnspiderfy()},_unspiderfyZoomStart:function(){this._map&&this._map.on("zoomanim",this._unspiderfyZoomAnim,this)},_unspiderfyZoomAnim:function(a){h.DomUtil.hasClass(this._map._mapPane,"leaflet-touching")||(this._map.off("zoomanim",this._unspiderfyZoomAnim,this),this._unspiderfy(a))},_unspiderfyWrapper:function(){this._unspiderfy()},_unspiderfy:function(a){this._spiderfied&&this._spiderfied.unspiderfy(a)},_noanimationUnspiderfy:function(){this._spiderfied&&this._spiderfied._noanimationUnspiderfy()},_unspiderfyLayer:function(a){a._spiderLeg&&(this._featureGroup.removeLayer(a),a.clusterShow&&a.clusterShow(),a.setZIndexOffset&&a.setZIndexOffset(0),this._map.removeLayer(a._spiderLeg),delete a._spiderLeg)}}),h.MarkerClusterGroup.include({refreshClusters:function(a){return a?a instanceof h.MarkerClusterGroup?a=a._topClusterLevel.getAllChildMarkers():a instanceof h.LayerGroup?a=a._layers:a instanceof h.MarkerCluster?a=a.getAllChildMarkers():a instanceof h.Marker&&(a=[a]):a=this._topClusterLevel.getAllChildMarkers(),this._flagParentsIconsNeedUpdate(a),this._refreshClustersIcons(),this.options.singleMarkerMode&&this._refreshSingleMarkerModeMarkers(a),this},_flagParentsIconsNeedUpdate:function(a){var b,c;for(b in a)for(c=a[b].__parent;c;)c._iconNeedsUpdate=!0,c=c.__parent},_refreshSingleMarkerModeMarkers:function(a){var b,c;for(b in a)c=a[b],this.hasLayer(c)&&c.setIcon(this._overrideMarkerIcon(c))}}),h.Marker.include({refreshIconOptions:function(a,b){var c=this.options.icon;return h.setOptions(c,a),this.setIcon(c),b&&this.__parent&&this.__parent._group.refreshClusters(this),this}});return function(a){function c(a){d(this,c);var f=e(this,(c.__proto__||Object.getPrototypeOf(c)).call(this));return f.options=b({},a),f.options.visibility=!0,j=f.options.circle.outRadius,f}return f(c,a),g(c,[{key:"init",value:function(){this.data=null,this.pane.style.pointerEvents="none",this.map.setMaxZoom(20),this.markers=h.markerClusterGroup(),this.map.addLayer(this.markers)}},{key:"render",value:function(a){if((this.markers.clearLayers(),a&&0!==a.length)&&(this.data=a,!!this.options.visibility)){var b=this.options;j=b.circle.outRadius;for(var c=0;c<a.length;c++){var e=a[c],f=e.info,g=h.divIcon({className:"",iconSize:null,popupAnchor:"center"===b.icon.offset?[0,-5]:[0,-b.icon.size/2-5],iconAnchor:"center"===b.icon.offset?[b.icon.size/2,b.icon.size/2]:[b.icon.size/2,b.icon.size],html:"<div><img class="+("center"===b.icon.offset?"leaflet-marker-icon-hover":"leaflet-marker-icon-bottom-hover")+" style=\"position: relative;width:"+b.icon.size+"px;height:"+b.icon.size+"px;\" src="+(e.iconUrl||b.icon.iconUrl)+"></div>"}),i=h.marker(new h.LatLng(e.lat,e.lng),{title:f,icon:g,attribution:e}),k=b.popupStyle,l=k.color,m=k.fontSize,n=k.fontWeight,o=k.fontFamily,p=e.info;i.bindPopup("<p style=\" color:"+l+"; font-size:"+m+"px; font-weight:"+n+"; font-family:"+o+"; \"> "+p+"</p>",{maxWidth:1200,maxHeight:1200}),this.markers.addLayer(i)}this.addCSS()}}},{key:"addCSS",value:function(){var a=document.createElement("style");a.type="text/css";var b=this.options.circle.outColor,c=this.options.circle.color,d=this.options.circle.radius,e=this.options.circle.outRadius;try{a.appendChild(document.createTextNode("\n              ."+i+"marker-cluster-small {\n                background-color: "+b+";\n              }\n              \n              ."+i+"marker-cluster-small div {\n                background-color: "+c+";\n              }\n              \n              ."+i+"marker-cluster-medium {\n                background-color: "+b+";\n              }\n              \n              ."+i+"marker-cluster-medium div {\n                background-color: "+c+";\n              }\n              \n              ."+i+"marker-cluster-large {\n                background-color: "+b+";\n              }\n              \n              ."+i+"marker-cluster-large div {\n                background-color: "+c+";\n              }\n              \n              ."+i+"marker-cluster {\n                background-clip: padding-box;\n                border-radius: "+e+"px;\n              }\n              \n              ."+i+"marker-cluster div {\n                width: "+2*d+"px;\n                height: "+2*d+"px;\n                margin-left: "+(e-d)+"px;\n                margin-top: "+(e-d)+"px;\n              \n                text-align: center;\n                border-radius: "+d+"px;\n                font: 12px \"Helvetica Neue\", Arial, Helvetica, sans-serif;\n              }\n              \n              ."+i+"marker-cluster span {\n                line-height: "+2*d+"px;\n              }\n            "))}catch(a){}var f=document.getElementsByTagName("head")[0];f.appendChild(a)}},{key:"onUpdateOptions",value:function(a){this.options=b(this.options,a),j=this.options.circle.outRadius,this.render(this.data)}},{key:"show",value:function(){this.options.visibility=!0,this.render(this.data)}},{key:"hide",value:function(){this.options.visibility=!1,this.markers.clearLayers()}},{key:"onRemove",value:function(){this.markers.clearLayers(),this.map.removeLayer(this.markers),this.markers=null,this.options=null}}]),c}(a)},a.exports});;
Cube("datav:/com/datavmap-2d-layer-markercluster/0.0.6",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"===typeof b||"function"===typeof b)?b:a}function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c("datav:/npm/eventemitter3/3.0.0"),i=c("datav:/npm/safely-merge/1.0.1"),j=c("datav:/com/datavmap-2d-layer-markercluster/0.0.6/markerClusterLayer.js"),k=function(a){function b(a,c){d(this,b);var f=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return f.container="string"===typeof a?document.querySelector(a):a,f.apis=c.apis,f.map=null,f._data=null,f.config=c,f.config.visibility=!0,f}return f(b,a),g(b,[{key:"init",value:function(){var a=this,b=j(this.map.L);this.layer=new b(this.config),this.layer.addTo(this.map),this.layer.markers.on("click",function(b){var c=b.layer.options.attribution;a.emit("markercluster-map-click",c)})}},{key:"addTo",value:function(a){this.map=a,this.init()}},{key:"render",value:function(a){this.layer.render(a)}},{key:"updateOptions",value:function(a){this.config=i(this.config,a),this.layer&&this.layer.updateOptions(this.config)}},{key:"show",value:function(){this.config.visibility=!0,this.layer&&this.layer.show&&this.layer.show()}},{key:"hide",value:function(){this.config.visibility=!1,this.layer&&this.layer.hide&&this.layer.hide()}},{key:"remove",value:function(){this.layer&&this.layer.remove&&this.layer.remove(),this.layer=null,this._data=null}}]),b}(h);return a.exports=k,a.exports});