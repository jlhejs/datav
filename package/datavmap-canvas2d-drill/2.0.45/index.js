// env=undefined => env=publish 
Cube("datav:/com/datavmap-canvas2d-drill/2.0.45/src/libs/geojson-bbox",[],function(a){function b(a){if(Array.isArray(a)){for(var b=0,c=Array(a.length);b<a.length;b++)c[b]=a[b];return c}return Array.from(a)}function c(a){var d;return"Point"==a.type?d=[a.coordinates]:"LineString"==a.type||"MultiPoint"==a.type?d=a.coordinates:"Polygon"==a.type||"MultiLineString"==a.type?d=a.coordinates.reduce(function(a,c){return a.push.apply(a,b(c)),a},[]):"MultiPolygon"==a.type?d=a.coordinates.reduce(function(a,c){return a.push.apply(a,b(c.reduce(function(a,c){return a.push.apply(a,b(c)),a},[]))),a},[]):"Feature"==a.type?d=c(a.geometry):"GeometryCollection"==a.type?d=a.geometries.reduce(function(a,d){return a.push.apply(a,b(c(d))),a},[]):"FeatureCollection"==a.type&&(d=a.features.reduce(function(a,d){return a.push.apply(a,b(c(d))),a},[])),d}return a.exports=function(a){var b;if(a.hasOwnProperty("type"))return b=c(a),b.reduce(function(a,b){return[Math.min(b[0],a[0]),Math.min(b[1],a[1]),Math.max(b[0],a[2]),Math.max(b[1],a[3])]},[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY,Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY])},a.exports});;
Cube("datav:/com/datavmap-canvas2d-drill/2.0.45/src/drillLayer",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1","datav:/npm/topojson-client/3.0.0","datav:/npm/chroma-js/1.3.3","datav:/npm/polylabel/1.0.2","datav:/npm/rbush/3.0.0"],function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"===typeof b||"function"===typeof b)?b:a}function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c("datav:/npm/eventemitter3/3.0.0"),i=c("datav:/npm/safely-merge/1.0.1"),j=c("datav:/npm/topojson-client/3.0.0"),k=c("datav:/npm/chroma-js/1.3.3"),l=c("datav:/npm/polylabel/1.0.2"),m=c("datav:/npm/rbush/3.0.0"),n=c("datav:/com/datavmap-canvas2d-drill/2.0.45/src/libs/geojson-bbox"),o=function(a){function b(a,c){d(this,b);var f=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return f.options=i({tolerance:0,smoothFactor:1,bounds:null,stroke:!0,weight:5,zoomRange:[0,18],minZoom:0,maxZoom:22,defaultStyle:{fill:{minFillColor:"rgba(5, 96, 125, 0.8)",maxFillColor:"rgba(0, 255, 240, 0.5)",fillColor:"rgba(77, 77, 77, 0.5)"},stroke:{color:"#fff",weight:1,dashArray:""}},labelStyle:{show:!0,fieldName:"name",textStyle:{fontFamily:"Microsoft Yahei",fontSize:12,color:"#FFFFFF",fontWeight:"normal",shadowColor:"#E8E36C",shadowBlur:5}},popupStyle:{isBorderShadow:!0,show:!0,infoField:!1,eventType:"click",styleType:"parent",textStyle:{fontFamily:"Microsoft Yahei",fontSize:12,color:"#FFFFFF",fontWeight:"normal"},lineHeight:1.4,borderRadius:5,margin:{top:10,bottom:10,left:10,right:10},backgroundColor:"rgba(22,138,214,0.73)",closeBtn:{color:"#fff",size:16,top:0,right:0}},interactive:{isHover:{show:!0,fillColor:"#FEE619",strokeColor:"green",weight:8},usePopupStyle:!0,isOpenPopup:!0,clickZoom:!0,zoomPad:1.5}},c),f.options.minZoom=c.zoomRange[0],f.options.maxZoom=c.zoomRange[1],f.options.visibility=!0,f.map=a,f.init(),f}return f(b,a),g(b,[{key:"init",value:function(){this.container=document.createElement("canvas");var a=this.padding=this.map.canvasLayer&&this.map.canvasLayer.options&&this.map.canvasLayer.options.padding?this.map.canvasLayer.options.padding:0.1,b=this.map.getSize();this.offset=b.multiplyBy(-a).round();var c=b.x-2*this.offset.x,d=b.y-2*this.offset.y,e=this.map.devicePixelRatio||1;this.container.width=c*e,this.container.height=d*e,this.container.style.width=c+"px",this.container.style.height=d+"px",this.ctx=this.container.getContext("2d"),this.ctx.scale(e,e),this.keyword="area_id",this.geojson_keyword="adcode",this.maxLevel=0,this.alldata={defaultArea:null,areaTree:null,areaTreeMap:null,areaTopojson:null,areaGeojson:null,mappingData:null,mappingDataMap:null},this.geojson=null,this.rbush=new m,this.rbush.dirty=0,this.rbush.total=0,this.rbushInBounds=new m,this.featuresInBounds=[],this.popups={}}},{key:"onRender",value:function(a){this.ctx.clearRect(0,0,this.container.width,this.container.height),this.geojson&&(a&&"needUpdata"===a&&this.getFeaturesInBounds(),this.draw())}},{key:"onResize",value:function(a,b){var c=this.map.devicePixelRatio||1;this.container.width=a*c,this.container.height=b*c,this.container.style.width=a+"px",this.container.style.height=b+"px",this.ctx.scale(c,c)}},{key:"setDefalutArea",value:function(a){a&&a.length&&(this.alldata.defaultArea=a,this.adcode=a[0].area_id||a[0].adcode,this.genGeojson())}},{key:"render",value:function(a){var b=this;if(a&&a[0]&&a[0].area_tree&&a[0].area_topo_json){this.keyword="area_id",this.geojson_keyword="adcode";var c=a[0].area_tree,d=a[0].area_topo_json;this.alldata.areaTreeMap={},fetch(c).then(function(a){return a.json()}).then(function(a){b.alldata.areaTree=a,fetch(d).then(function(a){return a.json()}).then(function(a){b.alldata.areaTopojson=a,b.topojsonToGeojson()})})}}},{key:"topojsonToGeojson",value:function(){this.alldata.areaGeojson_default={};var a,b;for(var c in this.alldata.areaTopojson)a=this.alldata.areaTopojson[c],b=j.feature(a,a.objects.collection),b.features=b.features.filter(function(a){var b=!0;return"district"===a.properties.level&&(b=!(""+a.properties.adcode).endsWith("00")),a.geometry&&("Polygon"===a.geometry.type||"MultiPolygon"===a.geometry.type)&&b}),b.features=b.features.filter(function(a){return a.properties.area_id&&!a.properties.adcode&&(a.properties.adcode=a.properties.area_id),a.properties.adcode,a}),this.alldata.areaGeojson_default[c]=b;this.alldata.areaTopojson=null,this.genGeojson()}},{key:"setMappingData",value:function(a){this.alldata.mappingData=a||[],this.range=this.getRange(),this.alldata.mappingDataMap={};for(var b=void 0,c=0;c<a.length;c++)b=a[c],this.alldata.mappingDataMap[b.area_id]=b;this.genGeojson()}},{key:"getRange",value:function(){if(!this.alldata.mappingData.length)return null;var a=this.alldata.mappingData.filter(function(a){return void 0!=a.value&&!isNaN(+a.value)&&""!==a.value}),b=a.reduce(function(c,a){return+c.value<=+a.value?c:a},{}),c=a.reduce(function(c,a){return+c.value>=+a.value?c:a},{});return[+b.value,+c.value]}},{key:"genGeojson",value:function(){var a=this,b=this;this.alldata.areaGeojson={},this.alldata.defaultArea&&this.alldata.areaTree&&this.alldata.areaGeojson_default&&function(){if(a.initAreaTreeMap(a.alldata.areaTree,a.alldata.areaTree[0].area_id,-1),a.alldata.areaTreeMap){a.isSumFlag=!1;for(var c=a.maxLevel;0<c;c--)a.calculateNodeValue(c)}var d=a.options.defaultStyle.fill;a.range&&(a.colorScale=k.scale([d.minFillColor,d.maxFillColor]).domain(a.range));var e=function(c){for(var e,f=JSON.parse(JSON.stringify(a.alldata.areaGeojson_default[c])),g=null,h=[],i=0;i<f.features.length;i++)e=f.features[i],e.geometry&&e.geometry.coordinates&&0<e.geometry.coordinates.length&&h.push(e);f.features=h.map(function(a){g=g||a.properties.ad_code&&"ad_code",g=g||a.properties.adcode&&"adcode",g=g||a.properties.id&&"id",g=g||a.properties.name&&"name";var c=[];if(b.alldata.mappingData&&0<b.alldata.mappingData.length&&(c=b.alldata.mappingData.find(function(b){return b.area_id==a.properties[g]})),a.properties=Object.assign(a.properties,c),b.alldata.areaTreeMap&&b.alldata.areaTreeMap[a.properties.adcode||a.properties.area_id]){var e=b.alldata.areaTreeMap[a.properties.adcode||a.properties.area_id].sumValue;a.properties._fillColor=a.properties.fillColor?a.properties.fillColor:"number"===typeof e&&!isNaN(e)&&b.range?e===b.range[0]?d.minFillColor:e>b.range[0]?b.colorScale(e).css():d.fillColor:d.fillColor}else a.properties._fillColor=d.fillColor;return a}),a.alldata.areaGeojson[c]=f};for(var f in a.alldata.areaGeojson_default)e(f);a.geojson=a.alldata.areaGeojson[a.adcode],a.initRBush(),a.getFeaturesInBounds(),a.onRender()}()}},{key:"initAreaTreeMap",value:function(a,b,c){c++,this.maxLevel<c&&(this.maxLevel=c);for(var d=0;d<a.length;d++){var e=a[d],f=b;e[this.keyword]==b&&(f=null);var g=0,h=0;e.children&&0<e.children.length&&(h=e.children.length),this.alldata.mappingDataMap&&this.alldata.mappingDataMap[e.area_id]&&this.alldata.mappingDataMap[e.area_id].value&&(g=this.alldata.mappingDataMap[e.area_id].value),this.alldata.areaTreeMap[e[this.keyword]]={area_id:e[this.keyword],name:e.name||"",parent:f,level:c,childrenNum:h,value:g,sumValue:g},e.children&&this.initAreaTreeMap(e.children,e[this.keyword],c)}}},{key:"calculateNodeValue",value:function(a){for(var b in this.alldata.areaTreeMap){var c=this.alldata.areaTreeMap[b];if(c.level===a)if(0===c.childrenNum&&0===c.value||null===c.parent)continue;else 0===c.childrenNum&&0<c.value?0===this.alldata.areaTreeMap[c.parent].value&&(this.alldata.areaTreeMap[c.parent].sumValue+=c.value):this.alldata.areaTreeMap[c.parent].sumValue+=c.sumValue}}},{key:"updateOptions",value:function(a){this.options=i(this.options,a),this.options.minZoom=a.zoomRange[0],this.options.maxZoom=a.zoomRange[1],this.genGeojson()}},{key:"draw",value:function(){if(this.options.visibility&&this.geojson){this.ctx.clearRect(0,0,this.container.width,this.container.height);var a=this.featuresInBounds;this.drawAreas(a),this.drawLabels(a)}}},{key:"initRBush",value:function(){var a=this.geojson,b=[],c=void 0,d=void 0;for(c=0,d=a.features.length;c<d;c++){var e=a.features[c],f=n(e);b.push({minX:f[0],minY:f[1],maxX:f[2],maxY:f[3],feature:e})}b.length&&(this.rbush.dirty=b.length,this.rbush.total=b.length,this.rbush.clear(),this.rbush.load(b))}},{key:"getFeaturesInBounds",value:function(){var a=this.map.getBounds(),b=a.pad(this.padding),c={minX:b.getWest(),minY:b.getSouth(),maxX:b.getEast(),maxY:b.getNorth()},d=this.rbush.search(c),e=void 0,f=void 0,g=void 0,h=void 0,i=void 0,j=void 0,k=void 0,l=void 0,m=void 0,n=void 0;for(e=0;h=d.length,e<h;e++){switch(k=d[e].feature,l=k.geometry.coordinates,n=[],k.geometry.type){case"Polygon":for(f=0;i=l.length,f<i;f++)m=this.pointsProject(l[f]),3<=m.length&&n.push(m);break;case"MultiPolygon":for(f=0;i=l.length,f<i;f++)for(g=0;j=l[f].length,g<j;g++)m=this.pointsProject(l[f][g]),3<=m.length&&n.push(m);break;default:}d[e].feature.geometry.coordinatesXY=n}return this.rbushInBounds.clear(),this.rbushInBounds.load(d),this.featuresInBounds=d,d}},{key:"drawAreas",value:function(a){this.ctx.shadowColor=null,this.ctx.shadowBlur=null;var b=this.options.defaultStyle,c=void 0,d=a.length;for(c=0;d,c<d;c++){var e=a[c].feature,f=Object.assign({},e.properties),g=f._fillColor||"rgba(2,111,222,0.3)",h=f.strokeColor||b.stroke.color,i=f.weight||b.stroke.weight,j=f.dashArray||b.stroke.dashArray;if(this.options.interactive.isHover.show&&this.map.featureSelect&&this.map.featureSelect.geometry.coordinates===e.geometry.coordinates){var k=Object.assign({},this.options.interactive.isHover);g=k.fillColor||"rgba(255,255,255,0.3)",h=k.strokeColor,i=k.weight||1,j=k.dashArray||""}var l={fill:!0,fillRule:"evenodd",fillColor:g,fillOpacity:1,stroke:!0,strokeColor:h,weight:i,lineJoin:"round",lineCap:"square",dashArray:j};switch(e.geometry.type){case"Polygon":this.drawPolygon(this.ctx,e.geometry.coordinatesXY,l);break;case"MultiPolygon":this.drawPolygon(this.ctx,e.geometry.coordinatesXY,l);break;default:}}}},{key:"drawLabels",value:function(a){if(this.options.labelStyle.show){var b=this.ctx,c=this.options.labelStyle,d=c.textStyle;b.font=""+d.fontWeight+" "+d.fontSize+"px "+d.fontFamily,b.fillStyle=d.color,b.textAlign="center",b.textBaseline="middle",b.shadowColor=d.shadowColor,b.shadowBlur=d.shadowBlur;for(var e=void 0,f=void 0,g=void 0,h=0;h<a.length;h++){e=a[h].feature,f=e.properties,g=f.customLabelPosition?f.customLabelPosition:this.calLabelPos(e,1);var i=this.map.latLngToContainerPoint([g[1],g[0]]);c.fieldName&&f[c.fieldName]&&b.fillText(f[c.fieldName],i.x-this.offset.x,i.y-this.offset.y)}b.save()}}},{key:"area",value:function(a){for(var b,c=0,d=0;d<a.length;d++){b=a[d];for(var e=0,f=b.length,g=f-1;e<f;g=e++)c+=(b[e][0]-b[g][0])*(b[e][1]+b[g][1])*(d?-1:1)}return Math.abs(c)/2}},{key:"calLabelPos",value:function(a,b){var c=this;if(a.geometry&&"Polygon"===a.geometry.type)return l(a.geometry.coordinates,b);if(a.geometry&&"MultiPolygon"===a.geometry.type){var d=a.geometry.coordinates.reduce(function(d,a){return c.area(d)>=c.area(a)?d:a},{});return l(d,b)}}},{key:"pointsProject",value:function(a){var b=[],c=void 0,e=void 0;for(c=0;e=a.length,c<e;c++){var f=a[c];if((f[0]||0==f[0])&&(f[1]||0==f[1])){var d=this.map.latLngToContainerPoint([f[1],f[0]]);b.push({x:d.x-this.offset.x,y:d.y-this.offset.y})}}var g=this.options.smoothFactor,h=b;return b.length&&(h=this.map.L.LineUtil.simplify(b,g)),h}},{key:"drawPolygon",value:function(a,b,c){if(b&&0!==b.length){a.beginPath();var d,e,f;for(d=0;d<b.length;d++){for(e=0;e<b[d].length;e++)f=b[d][e],a[e?"lineTo":"moveTo"](f.x,f.y);a.closePath()}this.fillStroke(a,c)}}},{key:"fillStroke",value:function(a,b){if(b.fill&&(a.globalAlpha=b.fillOpacity,a.fillStyle=b.fillColor||b.color,a.fill(b.fillRule||"evenodd")),b.stroke&&0!==b.weight){if(a.setLineDash){var c=this.getDashArray(b)||[];a.setLineDash(c)}a.globalAlpha=b.opacity,a.lineWidth=b.weight,a.strokeStyle=b.strokeColor,a.lineCap=b.lineCap,a.lineJoin=b.lineJoin,a.stroke()}}},{key:"getDashArray",value:function(a){if(""===a.dashArray)e=[];else if("string"===typeof a.dashArray){var b,c,d=a.dashArray.split(/[, ]+/),e=[];for(c=0;c<d.length;c++){if(b=+d[c],isNaN(b))return;e.push(b)}}else e=a.dashArray||[];return e}},{key:"containsLatLng",value:function(a){var b=void 0,c=void 0,d=void 0,e=void 0,f=!1,g={minX:a.lng,minY:a.lat,maxX:a.lng,maxY:a.lat},h=this.rbushInBounds.search(g);if(0===h.length)return{flag:f,feature:c};for(d=0;e=h.length,d<e;d++)if(b=h[d].feature,f=this.isFeatureContainsLatLng(b,a),f){c=b;break}return{flag:f,feature:c}}},{key:"isFeatureContainsLatLng",value:function(a,b){var c=void 0,d=void 0,e=!1,f=this.map.latLngToContainerPoint([b.lat,b.lng]);f.x-=this.offset.x,f.y-=this.offset.y;var g=a.geometry.coordinates;switch(a.geometry.type){case"Polygon":e=this.isPolygonContainsPoint(g,[b.lng,b.lat]);break;case"MultiPolygon":for(c=0;(d=g.length,c<d)&&(e=this.isPolygonContainsPoint(g[c],[b.lng,b.lat]),!e);c++);break;default:}return e}},{key:"clickTolerance",value:function(){return(this.options.stroke?this.options.weight/2:0)+this.options.tolerance}},{key:"isPolylineContainsPoint",value:function(a,b,c){var d,e,f,g=this.clickTolerance();for(d=0,f=a.length,e=f-1;d<f;e=d++)if((c||0!==d)&&this.map.L.LineUtil.pointToSegmentDistance(b,a[e],a[d])<=g)return!0;return!1}},{key:"isPolygonContainsPoint",value:function(a,b){var c,d,e,f,g,h,i,j,k=!1;for(f=0,i=a.length;f<i;f++)for(c=a[f],g=0,j=c.length,h=j-1;g<j;h=g++)d=c[g],e=c[h],d[1]>b[1]!==e[1]>b[1]&&b[0]<(e[0]-d[0])*(b[1]-d[1])/(e[1]-d[1])+d[0]&&(k=!k);return k}},{key:"onClick",value:function(a){this.options.popupStyle.show&&"click"===this.options.popupStyle.eventType&&this.openPopup(a)}},{key:"onMouseOver",value:function(a){this.options.popupStyle.show&&"mouseover"===this.options.popupStyle.eventType&&this.openPopup(a)}},{key:"onMouseOut",value:function(){}},{key:"openPopup",value:function(a){var b=a.feature.properties,c=void 0,d=void 0,e=void 0;"custom"===this.options.popupStyle.styleType?(d=this.options.popupStyle,b.type&&this.popups[b.type]&&(d=i(d,this.popups[b.type].popupStyle))):d=this.map.popupStyle;var f=d.margin,g=f.top+"px "+f.right+"px "+f.bottom+"px "+f.left+"px";if(b.type&&this.popups[b.type]){var h=this.popups[b.type].clientWidth,j=this.popups[b.type].clientHeight;c=this.popups[b.type].popup,e=this.popups[b.type].container,e.style.display="block",e.style.width=h+"px",e.style.height=j+"px",e.style.margin=g}else{if(d.infoField&&void 0===b.info)return;var k="";if(void 0!=b.info)k=""+b.info;else if(void 0!=b.name&&void 0!=b.value)k="\u540D\u79F0\uFF1A"+b.name+"<br/>\u6570\u503C\uFF1A"+b.value;else if(void 0!=b.name)k="\u540D\u79F0\uFF1A"+b.name;else if(void 0!=b.value)k="\u6570\u503C\uFF1A"+b.value;else return;var l=d.textStyle,m=d.lineHeight;e="<div style=\"\n        margin: "+g+";\n        padding: 0px;\n        font-family: "+l.fontFamily+";\n        font-size: "+l.fontSize+"px;\n        color: "+l.color+"; \n        font-weight: "+l.fontWeight+"; \n        line-height: "+m+";\n        white-space: nowrap;\n        display: inline-table;\n        text-align: left;\n      \"> "+k+"</div>",c=this.map.L.popup({maxWidth:1200,maxHeight:1200,isCustomPopup:!0})}var n;n=b.customLabelPosition?b.customLabelPosition:this.calLabelPos(a.feature,1),c.setLatLng([+n[1],+n[0]]),c.setContent(e),c.openOn(this.map),this.map.L.customPopup.updatePopupStyle(c,d),this.map._popup.minZoom=this.options.minZoom,this.map._popup.maxZoom=this.options.maxZoom}},{key:"onDblclick",value:function(a){var b=a.feature,c=this.adcode;if(b||this.alldata.areaTreeMap[c].parent){if(b&&b.properties){var d=b.properties,e=d.adcode||d.area_id;if(0===this.alldata.areaTreeMap[e].childrenNum)return;this.adcode=e}else{this.adcode=this.alldata.areaTreeMap[this.adcode].parent;var f=i({},this.alldata.areaTreeMap[this.adcode]);f=i(f,this.alldata.mappingDataMap[this.adcode]),this.emit("dblclick_up",f)}this.geojson=this.alldata.areaGeojson[this.adcode],this.initRBush(),this.onRender(),this.fitBounds(this.adcode)}}},{key:"dblclickUp",value:function(){if(this.alldata.areaTreeMap[this.adcode].parent){this.adcode=this.alldata.areaTreeMap[this.adcode].parent;var a=i({},this.alldata.areaTreeMap[this.adcode]);a=i(a,this.alldata.mappingDataMap[this.adcode]),this.emit("dblclick_up",a),this.geojson=this.alldata.areaGeojson[this.adcode],this.initRBush(),this.onRender(),this.fitBounds(this.adcode)}}},{key:"bindGroup",value:function(a,b,c){var d=+b.clientWidth,e=+b.clientHeight;b.style.transform="",b.style.position="",b.style.display="none";var f=this.map.L.popup({maxWidth:1200,maxHeight:1200,isCustomPopup:!0});this.popups[a]={popup:f,container:b,clientWidth:d,clientHeight:e,popupStyle:c}}},{key:"fitBounds",value:function(a){var b;if(this.alldata.mappingDataMap[a]&&this.alldata.mappingDataMap[a].bounds)b=this.alldata.mappingDataMap[a].bounds;else{var c=n(this.geojson),d=[[c[1],c[0]],[c[3],c[2]]];this.featureBounds=d,this.map.isMapMoving=this.options.interactive.clickZoom;var e=this.options.interactive.zoomPad-1;b=[[d[0][0]-(d[1][0]-d[0][0])*e/2,d[0][1]-(d[1][1]-d[0][1])*e/2],[d[1][0]+(d[1][0]-d[0][0])*e/2,d[1][1]+(d[1][1]-d[0][1])*e/2]]}this.map.fitBounds(b,{animate:!0,duration:3,easeLinearity:3,noMoveStart:!0})}},{key:"show",value:function(){this.options.visibility=!0,this.onRender("needUpdata")}},{key:"hide",value:function(){this.options.visibility=!1,this.ctx.clearRect(0,0,this.container.width,this.container.height)}},{key:"destroy",value:function(){this.rbushInBounds.clear(),this.rbushInBounds=null,this.rbush.clear(),this.rbush=null,this.options=null,this.ctx=null,this.container=null,this.alldata=null,this.geojson=null,this.adcode=null,this.alldata.areaGeojson_default=null,this.alldata.areaGeojson=null,delete this.options,this.ctx,this.container,this.alldata,this.geojson,this.adcode,this.alldata.areaGeojson_default,this.alldata.areaGeojson}}]),b}(h);return a.exports=o,a.exports});;
Cube("datav:/com/datavmap-canvas2d-drill/2.0.45",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"===typeof b||"function"===typeof b)?b:a}function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c("datav:/npm/eventemitter3/3.0.0"),i=c("datav:/npm/safely-merge/1.0.1"),j=c("datav:/com/datavmap-canvas2d-drill/2.0.45/src/drillLayer"),k=function(a){function b(a,c){d(this,b);var f=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return f.options=i({renderer:"canvas"},c),f.options.minZoom=c.zoomRange[0],f.options.maxZoom=c.zoomRange[1],f.options.visibility=!0,f}return f(b,a),g(b,[{key:"addTo",value:function(a){var b=this;this.layer=new j(a,this.options),this.layer.on("dblclick_up",function(a){b.emit("dblclick2",a)})}},{key:"onRender",value:function(){this.layer&&this.layer.onRender&&this.layer.onRender()}},{key:"onResize",value:function(a,b){this.layer&&this.layer.onResize&&this.layer.onResize(a,b)}},{key:"setDefaultArea",value:function(a){this.layer&&this.layer.setDefalutArea&&this.layer.setDefalutArea(a)}},{key:"render",value:function(a){this.layer&&this.layer.render&&this.layer.render(a)}},{key:"setMappingData",value:function(a){this.layer&&this.layer.setMappingData&&this.layer.setMappingData(a)}},{key:"containsLatLng",value:function(a){return this.layer.containsLatLng(a)}},{key:"updateOptions",value:function(a){this.options=i(this.options,a),this.options.minZoom=a.zoomRange[0],this.options.maxZoom=a.zoomRange[1],this.layer&&this.layer.updateOptions&&this.layer.updateOptions(a)}},{key:"onClick",value:function(a){var b=a.feature;b&&b.properties&&this.emit("click",b.properties),this.layer&&this.layer.onClick&&this.layer.onClick(a)}},{key:"onDblclick",value:function(a){var b=a.feature;b&&b.properties&&this.emit("dblclick",b.properties),this.layer&&this.layer.onDblclick&&this.layer.onDblclick(a)}},{key:"dblclickUp",value:function(){this.layer&&this.layer.dblclickUp&&this.layer.dblclickUp()}},{key:"onMouseOver",value:function(a){var b=a.feature;b&&b.properties&&this.emit("mouseover",b.properties),this.layer&&this.layer.onMouseOver&&this.layer.onMouseOver(a)}},{key:"onMouseOut",value:function(a){var b=a.feature;b&&b.properties&&this.emit("mouseout",b.properties),this.layer&&this.layer.onMouseOut&&this.layer.onMouseOut(a)}},{key:"bindGroup",value:function(a){var b=a.type||"",c=a.container||"<div></div>",d=a.popupStyle||{};this.layer&&this.layer.bindGroup&&this.layer.bindGroup(b,c,d)}},{key:"show",value:function(){this.options.visibility=!0,this.layer&&this.layer.show&&this.layer.show()}},{key:"hide",value:function(){this.options.visibility=!1,this.layer&&this.layer.hide&&this.layer.hide()}},{key:"destroy",value:function(){this.layer&&this.layer.destroy&&this.layer.destroy(),this.layer=null,this.options=null,delete this.layer,this.options}}]),b}(h);return a.exports=k,a.exports});