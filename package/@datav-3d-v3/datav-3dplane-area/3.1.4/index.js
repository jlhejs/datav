// env=undefined => env=publish 
Cube("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/shader/line_frag.glsl",[],function(n,e,a,l,t,o){return n.exports="#define GLSLIFY 1\nuniform vec3 color;\nuniform float opacity;\n\n#ifdef USE_MAP\n  uniform sampler2D map;\n  uniform sampler2D map1;\n#endif\n\n#ifdef USE_ALPHA_MAP\n  uniform sampler2D alphaMap;\n#endif\n\nuniform float visibility;\nuniform uint useDash;\nuniform float dashOffset0;\nuniform float dashOffset1;\n\nvarying float v_brightSegCount;\n\nuniform float alphaTest;\nuniform vec2 uvScale0;\n\nin vec2 vUv;\n// flat in float lineAspect;\n// flat in float v_symbolCount;\n\nvarying vec2 v_normal;\nvarying vec4 v_lineColor;\nvarying float v_blurWidthRatio;\nvarying float v_lineType;\n\nvarying vec4 v_lineHeadColor;\nvarying float v_lineHeadSpaceRatio;\n\n// varying vec4 v_symbolColor;\n// varying vec3 v_symbolParams;\n\n// varying float v_lineTextureNum;\n\n#include <common>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n#include <fog_pars_fragment>\n\nvoid main() {\n  #include <clipping_planes_fragment>\n  #include <logdepthbuf_fragment>\n    vec4 c = v_lineColor;\n\n    bool useMap = false;\n\n    // for line  \n    vec2 uv0 = vUv * uvScale0;\n    uv0.x *= v_brightSegCount;\n    uv0.x -= dashOffset0;\n\n    uv0.y = (v_lineType - 1.0 + vUv.y) * 0.2;\n   \n    // antialiase\n    // reference from https://blog.mapbox.com/drawing-antialiased-lines-with-opengl-8766f34192dc\n    float blur = 1.0;\n    float featherLen = length(v_normal) - (1.0 - v_blurWidthRatio);\n    if (featherLen > 0.0) {\n      blur =  1.0 - featherLen / v_blurWidthRatio;\n    }\n    blur *= blur;\n\n    vec4 texture1 = vec4(0.0);\n\n    // float symbolLen = 1.0;\n    \n    // #ifdef USE_MAP\n    //   vec4 texture0 = texture2D(map, uv0); //线条纹理\n\n    //   //使得不同长度的飞线上符号运动速度一致\n    //   float segU = mod(uv0.x + dashOffset0 - dashOffset1, 1.0);\n\n    //   symbolLen = v_symbolParams.z * 100.0 / lineAspect * v_brightSegCount; //保持符号贴图的纵横比\n      \n    //   if (segU < symbolLen) {\n    //     segU = segU / symbolLen;\n\n    //     vec2 uv1 = vec2( segU, vUv.y);\n    //     uv1.y = (v_symbolParams.x * 100.0 - 1.0 + vUv.y) / (v_symbolParams.y * 100.0);\n       \n    //     // 对每个分段的首尾两端做模糊处理\n    //     float endBlurLen = 0.08; //首尾两端模糊长度\n    //     float endBlurFactor = 1.0;\n    //     if(segU < endBlurLen){\n    //       endBlurFactor = pow((segU / endBlurLen), 3.0);\n    //     }else if(segU > 1.0 - endBlurLen){\n    //       endBlurFactor = pow((1.0 - segU) / endBlurLen, 3.0);\n    //     }\n    //     texture1 = v_symbolColor * texture2D(map1, uv1) * endBlurFactor;\n    //   }\n\n    //   texture0 *= blur; //仅对线条纹理做边缘模糊\n    //   texture0 = mix(vec4(.0), texture0, texture0.a);\n    //   texture1 = mix(texture1, vec4(1.0), texture1);\n\n    //   c = c * texture0;\n    //   if (v_symbolColor.w > 0.0) {\n    //     c += texture1;\n    //   }\n    // #endif\n\n    #ifdef USE_ALPHA_MAP\n      // c.a *= texture2D(alphaMap, vUv * repeat).a;\n      c.a *= texture2D(alphaMap, uv0).a;\n\n      texture1.a *= texture2D(alphaMap, uv0).a;\n    #endif\n\n    #include <alphatest_fragment>\n\n    // if (c.a < alphaTest) discard;\n\n    // 高亮线处理\n    float dist = 1.0;\n    float blurRange = 0.1;\n\n    float _spaceRatio = v_lineHeadSpaceRatio + blurRange;\n    float localSegLen = mod(uv0.x + v_lineHeadSpaceRatio, 1.0);\n    float localSegRatio = localSegLen;\n\n    if (v_lineHeadSpaceRatio == 0.0) {\n      dist = 0.0;\n      gl_FragColor = c;\n    } else {\n      if (localSegRatio > _spaceRatio) {\n        dist = pow((localSegRatio - _spaceRatio) / (1.0 - _spaceRatio), 4.0 );\n      } else if (localSegRatio > v_lineHeadSpaceRatio) {\n        // 对高亮线段的头部做模糊处理\n        dist = pow((localSegRatio - v_lineHeadSpaceRatio) * blurRange, 4.0 );\n      }\n    }\n    dist = saturate(dist);\n    \n    if (v_lineHeadColor.w > 0.0) {\n      gl_FragColor = mix(c, v_lineHeadColor, dist);\n    } else {\n      gl_FragColor = c;\n    }\n\n    gl_FragColor.a *= blur * opacity;\n    \n    #include <tonemapping_fragment>\n    #include <encodings_fragment>\n    #include <fog_fragment>\n    #include <premultiplied_alpha_fragment>\n\n}",n.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/shader/line_vert.glsl",[],function(e,n,t,i,r,o){return e.exports="#define GLSLIFY 1\nattribute vec3 previous;\nattribute vec3 next;\nattribute float side;\nattribute float len;\n// attribute float lineLength;\n// attribute float lineWidth;\n// attribute vec4 lineColor;\n// attribute vec4 lineHeadColor;\n// attribute vec4 symbolColor;\nattribute vec4 lineParams;\nattribute vec3 symbolParams;\n\nuniform float lineLengthMax;\nuniform float lineLength;\nuniform float lineWidth;\nuniform vec4 lineColor;\nuniform vec4 lineHeadColor;\nuniform vec4 symbolColor;\n\nuniform vec2 resolution;\nuniform float near;\nuniform float far;\nuniform uint sizeAttenuation;\nuniform float dashOffset0;\nuniform float drawScale;\n\nout vec2 vUv;\n\nvarying vec4 v_lineColor;\nvarying vec2 v_normal;\nvarying float v_lineType;\n// flat out float lineAspect;\n// flat out float v_symbolCount;\nvarying float v_blurWidthRatio;\n\nvarying vec4 v_lineHeadColor;\nvarying float v_lineHeadSpaceRatio;\nvarying float v_brightSegCount;\n// varying float v_lineTextureNum;\n\n// varying vec4 v_symbolColor;\n// varying vec3 v_symbolParams;\n\nvec2 fix(vec4 i, float aspect) {\n  vec2 res = i.xy / i.w;\n  res.x *= aspect;\n  return res;\n}\n\n#include <common>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n#include <fog_pars_vertex>\n\nvoid main() {\n  v_lineColor = lineColor;\n  v_lineHeadColor = lineHeadColor;\n  // v_symbolColor = symbolColor;\n\n  v_lineType = lineParams.x * 100.0;\n  v_blurWidthRatio = lineParams.y;\n  v_lineHeadSpaceRatio = lineParams.z;\n\n  // v_lineTextureNum = lineParams.w * 100.0;\n\n  // v_symbolParams = symbolParams;\n\n  float len_step = (lineLengthMax - lineLength) / 100.0 * 0.5;\n\n  v_brightSegCount = len * len_step / drawScale * 0.0000001;\n\n  vUv = uv;\n  // vPick = pick;\n  // vUnPick = pick;\n  float aspect = resolution.x / resolution.y;\n  float pixelWidthRatio = 1. / (resolution.x * projectionMatrix[0][0]);\n  vec2 aspectVec = vec2(aspect, 1.0);\n\n  // lineAspect = len / lineWidth / aspect;\n\n  mat4 mvp = projectionMatrix * modelViewMatrix;\n  // into clip space\n  vec4 currentProjected = mvp * vec4(position, 1.);\n  vec4 previousProjected = mvp * vec4(previous, 1.);\n  vec4 nextProjected = mvp * vec4(next, 1.);\n\n  // into NDC space [-1,1] and correct for aspect ratio(screenWidth/screenHeight)\n  vec2 currentScreen = currentProjected.xy / currentProjected.w * aspectVec;\n  vec2 previousScreen = previousProjected.xy / previousProjected.w * aspectVec;\n  vec2 nextScreen = nextProjected.xy / nextProjected.w * aspectVec;\n   \n  float pixelWidth = sizeAttenuation == 1u ? 1.0 : currentProjected.w * pixelWidthRatio;\n  \n  float width = lineWidth;\n\n  #ifdef USE_MAP\n\n  #else\n    float dist = 1.0;\n    float localSegLen = mod(uv.x - dashOffset0, 1.0 / v_brightSegCount);\n    float localSegRatio = localSegLen * v_brightSegCount;\n\n    \n    float blurRange = 0.1; \n    float spaceRatio = v_lineHeadSpaceRatio + blurRange;\n    if (localSegRatio > spaceRatio) {\n      dist = (localSegRatio - spaceRatio) / (1.0 - spaceRatio);\n    } else if (localSegRatio > spaceRatio - blurRange) {\n      //对高亮线段的头部做模糊处理\n      dist = pow((spaceRatio - localSegRatio) / blurRange, 3.0 );\n    }\n    width = mix(lineWidth, lineWidth, saturate(dist));\n  #endif\n\n  width *= 1.8 * pixelWidth;\n\n  // into NDC space [-1,1] and correct for aspect ratio(screenWidth/screenHeight)\n  // vec2 currentP = fix(currentProjected, aspect);\n  // vec2 prevP = fix(previousProjected, aspect);\n  // vec2 nextP = fix(nextProjected, aspect);\n\n  vec2 dir = vec2(0.0);\n  if (nextScreen == currentScreen) //next == position\n    dir = normalize(currentScreen - previousScreen);\n  else if (previousScreen == currentScreen) //previous == position\n    dir = normalize(nextScreen - currentScreen);\n  else {\n    vec2 dir1 = normalize(currentScreen - previousScreen);\n    vec2 dir2 = normalize(nextScreen - currentScreen);\n    dir = normalize(dir1 + dir2);\n\n    // vec2 perp = vec2(-dir1.y, dir1.x);\n    // vec2 miter = vec2(-dir.y, dir.x);\n    // width = clamp( width / dot( miter, perp ), width, 1.5 * width);\n  }\n\n  v_normal = normalize( vec2(-dir.y / aspect, dir.x) * side); //for antialiase line\n\n  vec4 normalVec4 = vec4( -dir.y, dir.x, 0., 1. );\n  normalVec4.xy *= .5 * width;\n  normalVec4 *= projectionMatrix;\n  vec2 normal = normalVec4.xy;\n\n  vec4 offset = vec4(normal * side, 0., 0.);\n\n  gl_Position = currentProjected + offset;\n\n  vec4 mvPosition = modelViewMatrix * vec4( position, 1.0 );\n\n  // v_symbolCount = len;\n\n  #include <logdepthbuf_vertex>\n  #include <clipping_planes_vertex>\n  #include <fog_vertex>\n\n}\n",e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/shader/top_frag.glsl",[],function(n,e,t,a,i,r){return n.exports="#define GLSLIFY 1\n#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t#define CLEARCOAT\n#endif\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n#ifdef USE_TRANSMISSION\n\tuniform float transmission;\n\tuniform float thickness;\n\tuniform vec3 attenuationColor;\n\tuniform float attenuationDistance;\n#endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n#ifdef CLEARCOAT\n\tuniform float clearcoat;\n\tuniform float clearcoatRoughness;\n#endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n// varying vec3 vViewPosition;\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n// #include <uv2_pars_fragment>\n// #include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n// #include <aomap_pars_fragment>\n// #include <lightmap_pars_fragment>\n// #include <emissivemap_pars_fragment>\n#include <bsdfs>\n#include <transmission_pars_fragment>\n// #include <cube_uv_reflection_fragment>\n// #include <envmap_common_pars_fragment>\n// #include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n// #include <lights_pars_begin>\n// #include <lights_physical_pars_fragment>\n// #include <shadowmap_pars_fragment>\n// #include <bumpmap_pars_fragment>\n// #include <normalmap_pars_fragment>\n// #include <clearcoat_pars_fragment>\n// #include <roughnessmap_pars_fragment>\n// #include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\nvoid main() {\n\t#include <clipping_planes_fragment>\n\tvec4 diffuseColor = vec4( diffuse, opacity );\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\t#ifdef USE_TRANSMISSION\n\t\tfloat totalTransmission = transmission;\n\t\tfloat thicknessFactor = thickness;\n\t#endif\n\t#include <logdepthbuf_fragment>\n\t// #include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t// #include <roughnessmap_fragment>\n\t// #include <metalnessmap_fragment>\n\t// #include <normal_fragment_begin>\n\t// #include <normal_fragment_maps>\n\t// #include <clearcoat_normal_fragment_begin>\n\t// #include <clearcoat_normal_fragment_maps>\n\t// #include <emissivemap_fragment>\n\tvec3 rawDiffuseColor = diffuseColor.rgb;\n\t#include <transmission_fragment>\n\t// #include <lights_physical_fragment>\n\t// #include <lights_fragment_begin>\n\t// #include <lights_fragment_maps>\n\t// #include <lights_fragment_end>\n\t// #include <aomap_fragment>\n\t// vec3 outgoingLight = reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular + totalEmissiveRadiance;\n\t\n    gl_FragColor = vec4( diffuseColor.rgb + totalEmissiveRadiance, diffuseColor.a );\n\n\t// #include <tonemapping_fragment>\n\t// #include <encodings_fragment>\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",n.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/shader/top_vert.glsl",[],function(n,e,t,i,r,d){return n.exports="#define GLSLIFY 1\n#define STANDARD\n// varying vec3 vViewPosition;\n// #ifndef FLAT_SHADED\n// \tvarying vec3 vNormal;\n// \t#ifdef USE_TANGENT\n// \t\tvarying vec3 vTangent;\n// \t\tvarying vec3 vBitangent;\n// \t#endif\n// #endif\n// #ifdef USE_TRANSMISSION\n// \tvarying vec4 vWorldPosition;\n// #endif\n#include <common>\n#include <uv_pars_vertex>\n// #include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n// #include <morphtarget_pars_vertex>\n// #include <skinning_pars_vertex>\n// #include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\nvoid main() {\n\t#include <uv_vertex>\n\t// #include <uv2_vertex>\n\t#include <color_vertex>\n\t// #include <beginnormal_vertex>\n\t// #include <morphnormal_vertex>\n\t// #include <skinbase_vertex>\n\t// #include <skinnormal_vertex>\n\t// #include <defaultnormal_vertex>\n// #ifndef FLAT_SHADED\n// \tvNormal = normalize( transformedNormal );\n// \t#ifdef USE_TANGENT\n// \t\tvTangent = normalize( transformedTangent );\n// \t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n// \t#endif\n// #endif\n\t#include <begin_vertex>\n\t// #include <morphtarget_vertex>\n\t// #include <skinning_vertex>\n\t// #include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\t// vViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t// #include <shadowmap_vertex>\n\t#include <fog_vertex>\n// #ifdef USE_TRANSMISSION\n// \tvWorldPosition = worldPosition;\n// #endif\n}",n.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/dataprocess/canvasTexture",[],function(t,e,i,o,h,a){function L(t,e,i,o){return n.font="".concat(i," ").concat(o,"px ").concat(e),{width:Math.ceil(n.measureText(t).width),height:o}}var n=document.createElement("canvas").getContext("2d"),Q=Math.max(devicePixelRatio,2);return t.exports={getTextCanvas:function(t){var e=t.name,i=(t=t.graph.textLabel).textStyle,o=t.textStroke,t=t.textShadow,h=i.fontSize*Q,a=(n=L(e,i.fontFamily,i.fontWeight,h)).width+.2*h,n=n.height+.2*h,l=document.createElement("canvas"),d=(l.width=a,l.height=n,l.getContext("2d"));return d.imageSmoothingQuality="high",d.textBaseline="middle",d.textAlign="center",d.font=i.fontWeight+" "+h+"px "+i.fontFamily,t.show&&(d.shadowColor=t.color,d.shadowOffsetX=t.offsetX,d.shadowOffsetY=t.offsetY,d.shadowBlur=t.blur),d.fillStyle=i.color||"red",d.fillText(e,a/2,n/2),o.show&&0<o.lineWidth&&(d.lineWidth=o.lineWidth,d.strokeStyle=o.strokeColor||"white",d.strokeText(e,a/2,n/2)),l},getLabelTexture:function(t){var e=t.properties,i=t.labelStyle,t=t.imageUrls,o=i.contentStyle,h=i.backgroundStyle,a=o.lineSeries,n=o.fieldWidth,l=o.lineHeight,d=o.textBorder,o=document.createElement("canvas");if(o.width=0,(o.height=0)!=a.length){for(var f=a[0].content,r=a[0].fieldName,g=(Object.assign({},i.offset),e[r],L(e[r]).width,f.fontSize,0),s=0,m=0,w=0;w<a.length;w++){var c,x=c=a[w],p=x.content,y=x.prefix,x=x.suffix,u=y.fontSize*Q,W=x.fontSize*Q,S=p.fontSize*Q,v=L(e[c.fieldName],p.fontFamily,p.fontWeight,S).width;switch(n.widthAdapt){case"adapt":v=Math.min(v,n.maxWidth);break;case"fixedWidth":v=n.fixedWidth}s=v,y.show&&(s+=+y.padding+L(y.name,y.fontFamily,y.fontWeight,u).width),x.show&&(s+=+x.padding+L(x.name,x.fontFamily,x.fontWeight,W).width),g=Math.max(s,g),m+=Math.max(u,S,W)}for(var b={left:0,right:0,top:0,bottom:0},i={width:g+(b=h.show?h.margin:b).left+b.right,height:m*l+b.top+b.bottom},r=h.border,T=("vector"===h.backgroundType?(o.width=i.width+2*r.weight,o.height=i.height+2*r.weight,o.style.width=i.width+2*r.weight+"px",o.style.height=i.height+2*r.weight+"px"):"image"==h.backgroundType&&(o.width=i.width,o.height=i.height,o.style.width=i.width+"px",o.style.height=i.height+"px"),o.getContext("2d")),k=(T.imageSmoothingQuality="high",h.show&&("vector"===h.backgroundType?T.roundRect(0,0,i.width,i.height,h):"image"==h.backgroundType&&t[h.imageUrl]&&T.drawImage(t[h.imageUrl],0,0,i.width,i.height)),T.strokeStyle=d.color,T.lineWidth=d.weight,T.textBaseline="bottom",b.top),w=0;w<a.length;w++){var F=c=a[w],z=F.content,M=F.prefix,F=F.suffix,u=M.fontSize*Q,W=F.fontSize*Q,S=z.fontSize*Q,C=(k+=Math.max(u,S,W)*l,L(e[c.fieldName],z.fontFamily,z.fontWeight,S).width,M.show&&(T.font=M.fontWeight+" "+u+"px "+M.fontFamily,T.fillStyle=M.color,d.show&&T.strokeText(M.name,b.left,k),T.fillText(M.name,b.left,k)),T.font=z.fontWeight+" "+S+"px "+z.fontFamily,T.fillStyle=z.color,e[c.fieldName]),B=L(C,z.fontFamily,z.fontWeight,S).width,v=0;switch(n.widthAdapt){case"adapt":v=Math.min(B,n.maxWidth);break;case"fixedWidth":v=n.fixedWidth}if(v<B){for(var N=0,A=0,E=T.measureText("...",z.fontFamily,z.fontWeight,S).width,O=0;O<C.length;O++)(N+=T.measureText(C[O],z.fontFamily,z.fontWeight,S).width)<v-E&&A++;C=C.substring(0,A)+"..."}var U=b.left;M.show&&(U+=M.padding+L(M.name,M.fontFamily,M.fontWeight,u).width),d.show&&T.strokeText(C,U,k),T.fillText(C,U,k),F.show&&(T.font=F.fontWeight+" "+W+"px "+F.fontFamily,T.fillStyle=F.color,v=Math.min(v,B),d.show&&T.strokeText(F.name,U+v+F.padding,k),T.fillText(F.name,U+v+F.padding,k))}}return o}},t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/dataprocess/mappingData",[],function(e,r,t,o,a,l){return e.exports=function(e){for(var r,t,o,a=e.options,l=e.data,i=e._,h=e.mergeOptions,g=(e=e.GuiUtils).validateCustomStyle,p=i.get(a,"condition.condition"),u=i.get(e,"scale.color"),s=u({config:i.get(a,"graph.colorMapping"),data:l,field:"colorField"}),n=u({config:i.get(a,"graph.texture.colorMapping"),data:l,field:"textureColorField"}),d=i.get(e,"scale.marker")({config:i.get(a,"graph.texture.markerMapping"),data:l,field:"textureShapeField"}),f={},x=0;x<l.length;x++){var c,w={};if((c=h({},l[x])).adcode){if(t=(o=g({config:p,data:c,ruleKey:"rules"}))&&o[0]?o[0]:null,c.fillColor)w.fillColor=c.fillColor;else for(r=o.length-1;0<=r&&(t=o[r]).graph.show;r--)if(t.graph.fillColor.show){w.fillColor=t.graph.fillColor.value;break}for(r=o.length-1;0<=r&&(t=o[r]).graph.show;r--)if(t.graph.texture.show&&t.graph.texture.fillColor.show){w.textureColor=t.graph.texture.fillColor.value;break}for(r=o.length-1;0<=r&&(t=o[r]).graph.show;r--)if(t.graph.texture.show&&t.graph.texture.iconUrl.show){w.textureShape=t.graph.texture.iconUrl.value;break}for(r=o.length-1;0<=r&&(t=o[r]).graph.show;r--)if(t.graph.texture.show&&t.graph.texture.size.show){w.textureSize={width:t.graph.texture.size.width,height:t.graph.texture.size.height};break}var C=a.graph;w.hasOwnProperty("fillColor")||(w.fillColor=s(c.colorField)),C.texture.show&&(w.hasOwnProperty("textureColor")||(w.textureColor=n(c.textureColorField)),w.hasOwnProperty("textureShape")||(w.textureShape=d(c.textureShapeField)),w.hasOwnProperty("textureSize")||(w.textureSize={width:C.texture.size.width,height:C.texture.size.height})),f[c.adcode]=h(c,w)}}return f},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/libs/uilts",["datav:/npm/polylabel/1.0.2"],function(t,o,e,n,r,u){function y(t){return(y="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}var a=e("datav:/npm/polylabel/1.0.2");function l(t){for(var o=0,e=0;e<t.length;e++)for(var n=t[e],r=0,u=n.length,a=u-1;r<u;a=r++)o+=(n[r][0]-n[a][0])*(n[r][1]+n[a][1])*(e?-1:1);return Math.abs(o)/2}return t.exports={uniq:function(t){for(var o,e,n={},r=[],u=t.length,a=0;a<u;a++)e=y(o=t[a]),n[o]?n[o].indexOf(e)<0&&(n[o].push(e),r.push(o)):(n[o]=[e],r.push(o));return r},calLabelPos:function(t,o){return t.geometry&&"Polygon"===t.geometry.type?a(t.geometry.coordinates,o):t.geometry&&"MultiPolygon"===t.geometry.type?(t=t.geometry.coordinates.reduce(function(t,o){return l(t)>=l(o)?t:o},{}),a(t,o)):void 0}},t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/libs/bufferAttributes",["datav:/npm/gl-vec3/1.1.3","datav:/npm/earcut/2.1.3"],function(t,r,n,e,o,a){function q(t,r){return function(t){if(Array.isArray(t))return t}(t)||function(t,r){var n=null==t?null:"undefined"!=typeof Symbol&&t[Symbol.iterator]||t["@@iterator"];if(null!=n){var e,o,a=[],i=!0,s=!1;try{for(n=n.call(t);!(i=(e=n.next()).done)&&(a.push(e.value),!r||a.length!==r);i=!0);}catch(t){s=!0,o=t}finally{try{i||null==n.return||n.return()}finally{if(s)throw o}}return a}}(t,r)||function(t,r){var n;if(t)return"string"==typeof t?i(t,r):"Map"===(n="Object"===(n=Object.prototype.toString.call(t).slice(8,-1))&&t.constructor?t.constructor.name:n)||"Set"===n?Array.from(t):"Arguments"===n||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?i(t,r):void 0}(t,r)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function i(t,r){(null==r||r>t.length)&&(r=t.length);for(var n=0,e=new Array(r);n<r;n++)e[n]=t[n];return e}var s=n("datav:/npm/gl-vec3/1.1.3"),B=s.subtract,D=s.length,u=s.cross,G=s.normalize,H=n("datav:/npm/earcut/2.1.3");var l=[],h=[];function J(t,r,n,e,o){var a=3<arguments.length&&void 0!==e?e:[],i=!(4<arguments.length&&void 0!==o)||o;B(l,n,r),B(h,t,r),u(a,l,h),i&&G(a,a)}return t.exports={top:function(t,I,C,O){var _={indices:[],positions:[],normals:[],uvs:[]};return t.forEach(function(t,r){for(var n,e,o,t=C&&2<t[0].length?t[0]:t,t=H.flatten([t]),a=t.vertices,i=t.holes,s=t.dimensions,u=H(a,i,s),l=[],h=[],c=[],f=[],p=[],v=_.indices,d=_.positions,g=_.normals,m=_.uvs,y=I[2]-I[0],b=I[3]-I[1],A=d.length/3,x=0,S=a.length;x<S;x+=s)l[0]=+a[x],l[1]=+a[x+1],l[2]=+O,d.push.apply(d,l),m.push((+l[0]-I[0])/y,(+l[1]-I[1])/b),g.push(0,0,0);for(var w=2,E=u.length;w<E;w+=3)n=u[w-2]+A,e=u[w-1]+A,o=u[w]+A,v.push(n,e,o),h[0]=d[n*=3],h[1]=d[1+n],h[2]=d[2+n],c[0]=d[e*=3],c[1]=d[1+e],c[2]=d[2+e],f[0]=d[o*=3],f[1]=d[1+o],f[2]=d[2+o],J(h,c,f,p,!1),g[n]+=p[0],g[1+n]+=p[1],g[2+n]+=p[2],g[e]+=p[0],g[1+e]+=p[1],g[2+e]+=p[2],g[o]+=p[0],g[1+o]+=p[1],g[2+o]+=p[2];for(var j=3*A,F=g.length;j<F;j+=3)p[0]=g[j],p[1]=g[j+1],p[2]=g[j+2],G(p,p),g[j]=p[0],g[j+1]=p[1],g[j+2]=p[2]}),_},side:function(t,I,C,O){var _=[],z=[],M=[],T=[],U=[],$=[],k={indices:[],positions:[],normals:[],uvs:[],f_attr0:[]};return t.forEach(function(t,i){for(var t=C&&2<t[0].length?t[0]:t,t=H.flatten([t]),s=t.vertices,r=t.holes,u=t.dimensions,n=(H(s,r,u),[]),l=[],h=k.indices,c=k.positions,f=k.normals,p=k.uvs,e=k.f_attr0,o=I[2]-I[0],a=I[3]-I[1],v=[],d=c.length/3,g=0,m=s.length;g<m;g+=u){n[0]=+s[g].toFixed(1),n[1]=+s[g+1].toFixed(1),n[2]=+O.toFixed(1),c.push.apply(c,n),f.push(0,0,0),n[2]=0,c.push.apply(c,n),f.push(0,0,0);var y=(n[0]-I[0])/o,b=(n[1]-I[1])/a;e.push(y,b),e.push(y,b)}var A,x,t=r&&0<r.length?r[0]:s.length/u;v.push([0,t]);for(var S,w=0,E=r.length;w<E;w++)A=r[w],x=w<E-1?r[w+1]:s.length/u,v.push([A,x]);v.forEach(function(t,r){var t=q(t,2),n=t[0],e=t[1];if((S=0)===r===function(t,r,n,e){for(var o=0,a=r,i=n-e;a<n;a+=e)o+=(t[i]-t[a])*(t[a+1]+t[i+1]),i=a;return 0<o}(s,n*u,e*u,u))for(var o=n+1;o<e;o++)i=2*(o-1)+d,i*=3,_[0]=c[i],_[1]=c[i+1],_[2]=c[i+2],z[0]=c[i+3],z[1]=c[i+4],z[2]=c[i+5],i=2*o+d,i*=3,M[0]=c[i],M[1]=c[i+1],M[2]=c[i+2],T[0]=c[i+3],T[1]=c[i+4],T[2]=c[i+5],i=2*(o-1)+d,p[i*=2]=S,p[i+1]=1,p[i+2]=S,p[i+3]=0,S+=D(B(l,T,z)),i=2*o+d,p[i*=2]=S,p[i+1]=1,p[i+2]=S,p[i+3]=0,J(z,T,_,U,!1),J(T,M,_,$,!1),i=2*(o-1)+d,f[i*=3]+=U[0]+$[0],f[i+1]+=U[1]+$[1],f[i+2]+=U[2]+$[2],f[i+3]+=U[0],f[i+4]+=U[1],f[i+5]+=U[2],i=2*o+d,f[i*=3]+=$[0],f[i+1]+=$[1],f[i+2]+=$[2],f[i+3]+=U[0]+$[0],f[i+4]+=U[1]+$[1],f[i+5]+=U[2]+$[2],i=2*(o-1)+d,h.push(i+1,i+3,i),h.push(i+3,i+2,i);else for(var a=e-2;n<=a;a--)i=2*(a+1)+d,i*=3,_[0]=c[i],_[1]=c[i+1],_[2]=c[i+2],z[0]=c[i+3],z[1]=c[i+4],z[2]=c[i+5],i=2*a+d,i*=3,M[0]=c[i],M[1]=c[i+1],M[2]=c[i+2],T[0]=c[i+3],T[1]=c[i+4],T[2]=c[i+5],i=2*(a+1)+d,p[i*=2]=S,p[i+1]=1,p[i+2]=S,p[i+3]=0,S+=D(B(l,T,z)),i=2*a+d,p[i*=2]=S,p[i+1]=1,p[i+2]=S,p[i+3]=0,J(z,T,_,U,!1),J(T,M,_,$,!1),i=2*(a+1)+d,f[i*=3]+=U[0]+$[0],f[i+1]+=U[1]+$[1],f[i+2]+=U[2]+$[2],f[i+3]+=U[0],f[i+4]+=U[1],f[i+5]+=U[2],i=2*a+d,f[i*=3]+=$[0],f[i+1]+=$[1],f[i+2]+=$[2],f[i+3]+=U[0]+$[0],f[i+4]+=U[1]+$[1],f[i+5]+=U[2]+$[2],i=2*(a+1)+d,h.push(i+1,i-1,i),h.push(i-1,i-2,i)});for(var j=3*d,F=f.length;j<F;j+=3)U[0]=f[j],U[1]=f[j+1],U[2]=f[j+2],G(U,U),f[j]=U[0],f[j+1]=U[1],f[j+2]=U[2]}),k}},t.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/libs/meshLine",[],function(e,t,r,i,n,s){function a(t,e){var r,i=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),i.push.apply(i,r)),i}function o(i){for(var e=1;e<arguments.length;e++){var n=null!=arguments[e]?arguments[e]:{};e%2?a(Object(n),!0).forEach(function(e){var t,r;t=i,r=n[e=e],e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach(function(e){Object.defineProperty(i,e,Object.getOwnPropertyDescriptor(n,e))})}return i}function l(e){return function(e){if(Array.isArray(e))return u(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var r;if(e)return"string"==typeof e?u(e,t):"Map"===(r="Object"===(r=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:r)||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?u(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function u(e,t){(null==t||t>e.length)&&(t=e.length);for(var r=0,i=new Array(t);r<t;r++)i[r]=e[r];return i}function h(e,t,r){e*=6,t*=6;return r[e]===r[t]&&r[1+e]===r[1+t]&&r[2+e]===r[2+t]}function f(e,t){e*=6;return[t[e],t[1+e],t[2+e]]}return e.exports=function(C){function e(){this.positions=[],this.previous=[],this.next=[],this.side=[],this.width=[],this.indices=[],this.uvs=[],this.counters=[],this.lens=[],this.lineLengths=[],this.lineWidths=[],this.lineColor=[],this.lineHeadColor=[],this.symbolColor=[],this.lineParams=[],this.symbolParams=[],this.geometry=new C.BufferGeometry,this.widthCallback=null,this.matrixWorld=new C.Matrix4}var M,O,W;function s(e,t,r,i,n){var s;if(e=e.subarray||e.slice?e:e.buffer,r=r.subarray||r.slice?r:r.buffer,e=t?e.subarray?e.subarray(t,n&&t+n):e.slice(t,n&&t+n):e,r.set)r.set(e,i);else for(s=0;s<e.length;s++)r[s+i]=e[s]}return((e.prototype=Object.create(C.Mesh.prototype)).constructor=e).prototype.setMatrixWorld=function(e){this.matrixWorld=e},e.prototype.setGeometry=function(e,t,r){this.widthCallback=r,this.process(e,t)},e.prototype.raycast=(M=new C.Matrix4,O=new C.Ray,W=new C.Sphere,function(e,t){var r=e.linePrecision,i=r*r,r=this.geometry;if(null===r.boundingSphere&&r.computeBoundingSphere(),W.copy(r.boundingSphere),W.applyMatrix4(this.matrixWorld),!1!==e.ray.intersectSphere(W)){M.getInverse(this.matrixWorld),O.copy(e.ray).applyMatrix4(M);var n=new C.Vector3,s=new C.Vector3,a=new C.Vector3,o=new C.Vector3,u=this instanceof C.LineSegments?2:1;if(r instanceof C.BufferGeometry){var l=r.index,h=r.attributes;if(null!==l)for(var f=l.array,p=h.position.array,c=0,m=f.length-1;c<m;c+=u){var y=f[c],v=f[c+1];n.fromArray(p,3*y),s.fromArray(p,3*v),i<O.distanceSqToSegment(n,s,o,a)||(o.applyMatrix4(this.matrixWorld),(y=e.ray.origin.distanceTo(o))<e.near||y>e.far||t.push({distance:y,point:a.clone().applyMatrix4(this.matrixWorld),index:c,face:null,faceIndex:null,object:this}))}else for(var b,d=h.position.array,g=0,w=d.length/3-1;g<w;g+=u)n.fromArray(d,3*g),s.fromArray(d,3*g+3),i<O.distanceSqToSegment(n,s,o,a)||(o.applyMatrix4(this.matrixWorld),(b=e.ray.origin.distanceTo(o))<e.near||b>e.far||t.push({distance:b,point:a.clone().applyMatrix4(this.matrixWorld),index:g,face:null,faceIndex:null,object:this}))}else if(r instanceof C.Geometry)for(var A,x=r.vertices,P=x.length,S=0;S<P-1;S+=u)i<O.distanceSqToSegment(x[S],x[S+1],o,a)||(o.applyMatrix4(this.matrixWorld),(A=e.ray.origin.distanceTo(o))<e.near||A>e.far||t.push({distance:A,point:a.clone().applyMatrix4(this.matrixWorld),index:S,face:null,faceIndex:null,object:this}))}}),e.prototype.createGeometry=function(){var e=new C.BufferAttribute(new Float32Array(this.positions),3),t=new C.BufferAttribute(new Float32Array(this.previous),3),r=new C.BufferAttribute(new Float32Array(this.next),3),i=new C.BufferAttribute(new Float32Array(this.side),1),n=new C.BufferAttribute(new Float32Array(this.uvs),2),s=new C.BufferAttribute(new Uint32Array(this.indices),1),a=new C.BufferAttribute(new Float32Array(this.counters),1),o=new C.BufferAttribute(new Float32Array(this.lens),1),u=new C.BufferAttribute(new Float32Array(this.lineLengths),1),l=new C.BufferAttribute(new Float32Array(this.lineWidths),1),h=new C.BufferAttribute(new Float32Array(this.lineColor),4),f=new C.BufferAttribute(new Float32Array(this.lineHeadColor),4),p=new C.BufferAttribute(new Float32Array(this.symbolColor),4),c=new C.BufferAttribute(new Float32Array(this.lineParams),4),m=new C.BufferAttribute(new Float32Array(this.symbolParams),3);this.geometry.setAttribute("position",e),this.geometry.setAttribute("previous",t),this.geometry.setAttribute("next",r),this.geometry.setAttribute("side",i),this.geometry.setAttribute("uv",n),this.geometry.setAttribute("counters",a),this.geometry.setAttribute("len",o),this.geometry.setAttribute("lineLength",u),this.geometry.setAttribute("lineWidth",l),this.geometry.setAttribute("lineColor",h),this.geometry.setAttribute("lineHeadColor",f),this.geometry.setAttribute("symbolColor",p),this.geometry.setAttribute("lineParams",c),this.geometry.setAttribute("symbolParams",m),this.geometry.setIndex(s)},e.prototype.clear=function(){this.positions.length=0,this.previous.length=0,this.next.length=0,this.side.length=0,this.width.length=0,this.indices.length=0,this.uvs.length=0,this.counters.length=0,this.lens.length=0,this.lineLengths.length=0,this.lineWidths.length=0,this.lineColor.length=0,this.lineHeadColor.length=0,this.symbolColor.length=0,this.lineParams.length=0,this.symbolParams.length=0},e.prototype._processPosition=function(e){for(var t,r,i=0,n=e.length/6;i<n;i++)this.counters.push(r=i/(n-1)),this.counters.push(r);(t=this.positions).push.apply(t,l(e));var s=e.length/6,a=h(0,s-1,e)?f(s-2,e):f(0,e);this.previous.push(a[0],a[1],a[2]),this.previous.push(a[0],a[1],a[2]);for(var o=0;o<s-1;o++)a=f(o,e),this.previous.push(a[0],a[1],a[2]),this.previous.push(a[0],a[1],a[2]);for(var u=1;u<s;u++)a=f(u,e),this.next.push(a[0],a[1],a[2]),this.next.push(a[0],a[1],a[2]);a=h(s-1,0,e)?f(1,e):f(s-1,e),this.next.push(a[0],a[1],a[2]),this.next.push(a[0],a[1],a[2])},e.prototype._processIndex=function(e){for(var t=this.positions.length/3,r=e.length/6,i=0;i<r-1;i++){var n=2*i+t;this.indices.push(n,1+n,2+n),this.indices.push(2+n,1+n,3+n)}},e.prototype._processUV=function(e,t){if(2<arguments.length&&void 0!==arguments[2]&&arguments[2]){this.uvs.push(0,0),this.uvs.push(0,1);for(var r,i,n=0,s=6,a=e.length;s<a;s+=6)r=[e[s-6],e[s-6+1],e[s-6+2]],i=[e[s],e[s+1],e[s+2]],n+=Math.sqrt(Math.pow(i[0]-r[0],2)+Math.pow(i[1]-r[1],2)+Math.pow(i[2]-r[2],2)),this.uvs.push(i=n/t,0),this.uvs.push(i,1)}else for(var o=e.length/6,u=0;u<o;u++)this.uvs.push(u/(o-1),0),this.uvs.push(u/(o-1),1)},e.prototype._processSide=function(e){for(var t=e.length/6,r=0;r<t;r++)this.side.push(1),this.side.push(-1)},e.prototype.process=function(e,t){for(var r=t.curveLen,i=t.isGeoUv,n=(t.lineColor,t.lineHeadColor,t.symbolColor,t.lineLength,t.lineWidth,t.lineParams),s=t.symbolParams,a=(this._processIndex(e),this._processSide(e),this._processUV(e,r,i),this._processPosition(e),e.length/6),o=0;o<a;o++)this.lens.push(r),this.lens.push(r),this.lineParams.push(n.lineType),this.lineParams.push(n.blurWidthRatio),this.lineParams.push(n.lineHeadSpaceRatio),this.lineParams.push(n.lineTextureNum),this.lineParams.push(n.lineType),this.lineParams.push(n.blurWidthRatio),this.lineParams.push(n.lineHeadSpaceRatio),this.lineParams.push(n.lineTextureNum),this.symbolParams.push(s.symbolType),this.symbolParams.push(s.symbolNum),this.symbolParams.push(s.symbolAspect),this.symbolParams.push(s.symbolType),this.symbolParams.push(s.symbolNum),this.symbolParams.push(s.symbolAspect)},e.prototype.advance=function(e){var t=this.attributes.position.array,r=this.attributes.previous.array,i=this.attributes.next.array,n=t.length;s(t,0,r,0,n),s(t,6,t,0,n-6),t[n-6]=e.x,t[n-5]=e.y,t[n-4]=e.z,t[n-3]=e.x,t[n-2]=e.y,t[n-1]=e.z,s(t,6,i,0,n-6),i[n-6]=e.x,i[n-5]=e.y,i[n-4]=e.z,i[n-3]=e.x,i[n-2]=e.y,i[n-1]=e.z,this.attributes.position.needsUpdate=!0,this.attributes.previous.needsUpdate=!0,this.attributes.next.needsUpdate=!0},{MeshLine:e,MeshLineMaterial:function(e){var t=new C.ShaderMaterial({depthWrite:!0,depthTest:!1,transparent:!0});return t.type="MeshLineMaterial",t.uniforms=o({drawScale:{value:1},opacity:{value:1},lineLengthMax:{value:110},lineLength:{value:60},lineWidth:{value:5},lineColor:{value:new C.Vector4},lineHeadColor:{value:new C.Vector4},symbolColor:{value:new C.Vector4},map:{value:null},map1:{value:null},alphaMap:{value:null},resolution:{value:new C.Vector2(1,1)},sizeAttenuation:{value:1},near:{value:1},far:{value:1},visibility:{value:1},dashOffset0:{value:0},dashOffset1:{value:0},useDash:{value:0},alphaTest:{value:0},repeat:{value:new C.Vector2(1,1)},uvScale0:{value:new C.Vector2(1,1)}},C.UniformsLib.fog),t.vertexShader=r("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/shader/line_vert.glsl"),t.fragmentShader=r("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/shader/line_frag.glsl"),Object.defineProperties(t,{drawScale:{enumerable:!0,get:function(){return this.uniforms.drawScale.value},set:function(e){this.uniforms.drawScale.value=e}},lineLengthMax:{enumerable:!0,get:function(){return this.uniforms.lineLengthMax.value},set:function(e){this.uniforms.lineLengthMax.value=e}},lineLength:{enumerable:!0,get:function(){return this.uniforms.lineLength.value},set:function(e){this.uniforms.lineLength.value=e}},lineWidth:{enumerable:!0,get:function(){return this.uniforms.lineWidth.value},set:function(e){this.uniforms.lineWidth.value=e}},lineColor:{enumerable:!0,get:function(){return this.uniforms.lineColor.value},set:function(e){this.uniforms.lineColor.value=e}},lineHeadColor:{enumerable:!0,get:function(){return this.uniforms.lineHeadColor.value},set:function(e){this.uniforms.lineHeadColor.value=e}},symbolColor:{enumerable:!0,get:function(){return this.uniforms.symbolColor.value},set:function(e){this.uniforms.symbolColor.value=e}},map:{enumerable:!0,get:function(){return this.uniforms.map.value},set:function(e){this.uniforms.map.value=e}},map1:{enumerable:!0,get:function(){return this.uniforms.map1.value},set:function(e){this.uniforms.map1.value=e}},alphaMap:{enumerable:!0,get:function(){return this.uniforms.alphaMap.value},set:function(e){this.uniforms.alphaMap.value=e}},opacity:{enumerable:!0,get:function(){return this.uniforms.opacity.value},set:function(e){this.uniforms.opacity.value=e}},resolution:{enumerable:!0,get:function(){return this.uniforms.resolution.value},set:function(e){this.uniforms.resolution.value=e}},sizeAttenuation:{enumerable:!0,get:function(){return this.uniforms.sizeAttenuation.value},set:function(e){this.uniforms.sizeAttenuation.value=e}},near:{enumerable:!0,get:function(){return this.uniforms.near.value},set:function(e){this.uniforms.near.value=e}},far:{enumerable:!0,get:function(){return this.uniforms.far.value},set:function(e){this.uniforms.far.value=e}},visibility:{enumerable:!0,get:function(){return this.uniforms.visibility.value},set:function(e){this.uniforms.visibility.value=e}},dashOffset0:{enumerable:!0,get:function(){return this.uniforms.dashOffset0.value},set:function(e){this.uniforms.dashOffset0.value=e}},dashOffset1:{enumerable:!0,get:function(){return this.uniforms.dashOffset1.value},set:function(e){this.uniforms.dashOffset1.value=e}},useDash:{enumerable:!0,get:function(){return this.uniforms.useDash.value},set:function(e){this.uniforms.useDash.value=e}},alphaTest:{enumerable:!0,get:function(){return this.uniforms.alphaTest.value},set:function(e){this.uniforms.alphaTest.value=e}},repeat:{enumerable:!0,get:function(){return this.uniforms.repeat.value},set:function(e){this.uniforms.repeat.value=e}},uvScale0:{enumerable:!0,get:function(){return this.uniforms.uvScale0.value},set:function(e){this.uniforms.uvScale0.value=e}}}),t.setValues(e),t}}},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/lineLayer.js",[],function(e,t,p,o,r,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function v(e){return function(e){if(Array.isArray(e))return a(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var o;if(e)return"string"==typeof e?a(e,t):"Map"===(o="Object"===(o=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:o)||"Set"===o?Array.from(e):"Arguments"===o||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(o)?a(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function a(e,t){(null==t||t>e.length)&&(t=e.length);for(var o=0,r=new Array(t);o<t;o++)r[o]=e[o];return r}function h(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function f(){return(f="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,o){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=O(e)););return e}(e,t);if(r)return(r=Object.getOwnPropertyDescriptor(r,t)).get?r.get.call(arguments.length<3?e:o):r.value}).apply(this,arguments)}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function w(o){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=O(o),t=(e=r?(e=O(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return S(t)}}function S(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function O(e){return(O=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}return e.exports=function(y){var m=y.THREE,e=y.Utils,r=e.mergeOptions,g=e.Chroma,o=e.deepClone,l=e.geojsonBBox,n=e.geojsonFlatten,u=e.BASE_HEIGHT_SCALE,e=p("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/libs/meshLine")(m),b=e.MeshLine,i=e.MeshLineMaterial,e=y.Layer,t=c;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&d(t,e);var a,s=w(c);function c(e){var t,o;if(this instanceof c)return(t=s.call(this,e)).options=r(t.options,{visible:!0,renderOrder:17}),t.options=r(t.options,e||{}),t.renderQueue=y.VOGO.Transparent,t.needsAutoUpdate=!1,o=(e=t.options).general,e=e.graph.lineStyle,g("red").gl(),t.updateOptions=t.updateOptions.bind(S(t)),t.addMesh=t.addMesh.bind(S(t)),t.draw=t.draw.bind(S(t)),t.checkVisible=t.checkVisible.bind(S(t)),t.material=i({resolution:new m.Vector2,sizeAttenuation:!1,side:m.DoubleSide,near:1,far:1e8,visibility:1,dashOffset0:0,dashOffset1:0,drawScale:y.drawScale,map:null,map1:null,uvScale0:new m.Vector2(1,1),depthWrite:!0,depthTest:!0,transparent:!0}),t.geojson=null,t.material.uniforms.USE_MAP=!1,t.material.uniforms.lineLengthMax.value=110,t.material.uniforms.lineLength.value=100,t.material.uniforms.lineWidth.value=e.weight,e=g(e.strokeColor).gl(),t.material.uniforms.opacity.value=e[3]*o.opacity*.01,t.material.uniforms.lineColor.value=e,t.material.uniforms.lineHeadColor.value=e,t.material.uniforms.symbolColor.value=e,o=new m.Vector2,y.engine.renderer.getDrawingBufferSize(o),t.material.uniforms.resolution.value=o,t.material.needsUpdate=!0,t;throw new TypeError("Cannot call a class as a function")}return t=c,(e=[{key:"setGeojson",value:function(e){if(this.clear(),e&&e.geojson_proj_bbox){this.material.uniforms.drawScale.value=y.drawScale;for(var t,o=Object.assign(e.geojson_proj),r={type:"FeatureCollection",features:[]},i=0;i<o.features.length;i++)(t=o.features[i]).properties.adcode&&"100000_JD"==t.properties.adcode||!t.geometry||"Polygon"!=t.geometry.type&&"MultiPolygon"!=t.geometry.type||r.features.push(t);this.geojson=n(r),this.draw()}}},{key:"draw",value:function(){this.clear();for(var e=y.baseHeightScale,t=y.lowHeightScale,o=y.drawScale,r=(this.group.position.z=~~(o*e*u),{type:"FeatureCollection",features:[]}),i={type:"FeatureCollection",features:[]},n=0;n<this.geojson.features.length;n++){var a=this.geojson.features[n],s=a.properties;a.geometry&&"JD"!=s.name&&(s=l(a),(1<Math.max(Math.abs(s[2]-s[0]),Math.abs(s[3]-s[1]))/y.bboxSize*y.bboxLowHeightScale?r:i).features.push(a))}this.addMesh({geojson:r,relativeHeight:~~(o*u*.01),isLowHeight:!1}),this.addMesh({geojson:i,relativeHeight:~~(o*u*.01*t),isLowHeight:!0}),this.checkVisible()}},{key:"addMesh",value:function(e){for(var t=e.geojson,o=e.relativeHeight,e=e.isLowHeight,r=new b,i=0;i<t.features.length;i++)for(var n,a=t.features[i].geometry.coordinates,s=[],l=(s.push.apply(s,v(a)),void 0),u=void 0,l=0;l<s.length;l++){for(var c=[],u=0;u<s[l].length;u++)n=s[l][u],c.push(n[0],n[1],0,n[0],n[1],0);var p,h,f=0;for(u=0;u<c.length-6;u+=6)p=[c[u],c[u+1]],h=[c[u+6],c[u+6+1]],f+=Math.sqrt(Math.pow(h[0]-p[0],2)+Math.pow(h[1]-p[1],2));0!=f&&r.setGeometry(c,{curveLen:f,isGeoUv:!1,lineColor:g("#fff").gl(),lineHeadColor:g("rgba(255,0,0,0)").gl(),symbolColor:g("rgba(255,0,0,0)").gl(),lineWidth:5,lineParams:{lineType:.01,blurWidthRatio:0,lineHeadSpaceRatio:0,lineTextureNum:.01},symbolParams:{symbolType:.01,symbolNum:.01,symbolAspect:.01}})}r.createGeometry(),this.material.needsUpdate=!0;var d=new m.Mesh(r.geometry,this.material);d.position.z=e?o-this.group.position.z*(1-y.lowHeightScale):o,d.userData.isLowHeight=e,d.meshType="1",d.frustumCulled=!1,this.add(d),d.renderOrder=this.options.renderOrder}},{key:"updateOptions",value:function(e){o(this.options);this.options=r(this.options,e||{});var e=this.options,t=e.general,e=e.graph.lineStyle,e=(this.material.uniforms.lineWidth.value=e.weight,g(e.strokeColor).gl());this.material.uniforms.opacity.value=e[3]*t.opacity*.01,this.material.uniforms.lineColor.value=e,this.material.uniforms.lineHeadColor.value=e,this.material.uniforms.symbolColor.value=e,this.draw()}},{key:"updateBaseHeight",value:function(){for(var e,t=y.baseHeightScale,o=y.lowHeightScale,r=y.drawScale,i=(this.group.position.z=~~(r*u*t),~~(r*u*.01*o)),n=0;n<this.group.children.length;n++)(e=this.group.children[n]).userData.isLowHeight&&(e.position.z=~~(i-this.group.position.z*(1-y.lowHeightScale)))}},{key:"checkVisible",value:function(){var e=this.options.graph.lineStyle;(this.options.visible&&e.show?f(O(c.prototype),"show",this):f(O(c.prototype),"hide",this)).call(this)}},{key:"show",value:function(){this.options.visible=!0;var e=this.options.graph.lineStyle;this.options.visible&&e.show&&f(O(c.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.options.visible=!1,f(O(c.prototype),"hide",this).call(this)}},{key:"destroy",value:function(){f(O(c.prototype),"remove",this).call(this),this.clear(),this.material&&this.material.dispose&&this.material.dispose(),this.options=null}}])&&h(t.prototype,e),a&&h(t,a),Object.defineProperty(t,"prototype",{writable:!1}),c},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/areaLayer.js",[],function(e,t,l,a,r,i){function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function W(e){return function(e){if(Array.isArray(e))return n(e)}(e)||function(e){if("undefined"!=typeof Symbol&&null!=e[Symbol.iterator]||null!=e["@@iterator"])return Array.from(e)}(e)||function(e,t){var a;if(e)return"string"==typeof e?n(e,t):"Map"===(a="Object"===(a=Object.prototype.toString.call(e).slice(8,-1))&&e.constructor?e.constructor.name:a)||"Set"===a?Array.from(e):"Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a)?n(e,t):void 0}(e)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function n(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,r=new Array(t);a<t;a++)r[a]=e[a];return r}function s(t,e){var a,r=Object.keys(t);return Object.getOwnPropertySymbols&&(a=Object.getOwnPropertySymbols(t),e&&(a=a.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,a)),r}function p(r){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?s(Object(i),!0).forEach(function(e){var t,a;t=r,a=i[e=e],e in t?Object.defineProperty(t,e,{value:a,enumerable:!0,configurable:!0,writable:!0}):t[e]=a}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(i)):s(Object(i)).forEach(function(e){Object.defineProperty(r,e,Object.getOwnPropertyDescriptor(i,e))})}return r}function h(e,t){for(var a=0;a<t.length;a++){var r=t[a];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,a){var r=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=A(e)););return e}(e,t);if(r)return(r=Object.getOwnPropertyDescriptor(r,t)).get?r.get.call(arguments.length<3?e:a):r.value}).apply(this,arguments)}function m(e,t){return(m=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function b(a){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=A(a),t=(e=r?(e=A(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===o(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return v(t)}}function v(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function A(e){return(A=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}return e.exports=function(I){var d=I.THREE,e=I.Utils,w=I.GuiUtils,r=I.VOGO,S=e._,x=e.mergeOptions,E=e.Chroma,H=e.geojsonBBox,O=e.geojsonFlatten,R=e.BASE_HEIGHT_SCALE,G=l("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/libs/bufferAttributes").top,e=l("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/libs/uilts"),D=e.uniq,g=e.calLabelPos,j=l("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/dataprocess/mappingData"),e=l("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/dataprocess/canvasTexture"),u=e.getTextCanvas,f=e.getLabelTexture,y=Math.max(devicePixelRatio,2),e=I.Layer,t=o;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&m(t,e);var a,i=b(o);function o(e){var t,a;if(this instanceof o)return t=i.call(this),a={visible:!0,renderOrder:10+Math.round(90*Math.random())},t.group.renderOrder=9,t.options=x(t.options,a),t.options=x(t.options,e||{}),t.classNameAlias="AreaLayer",t.renderQueue=r.Geometry,t.needsAutoUpdate=!1,t.eventsType={click:!0},t.selectFeatures=[],t.alldata=null,t.data=[],t.mappingData=[],t.imageUrls={},t.textureImageUrls={},t.addLabels=t.addLabels.bind(v(t)),t._addLabels=t._addLabels.bind(v(t)),t.removeLabels=t.removeLabels.bind(v(t)),t.deSelect=t.deSelect.bind(v(t)),t.draw=t.draw.bind(v(t)),t.addTop=t.addTop.bind(v(t)),t;throw new TypeError("Cannot call a class as a function")}return t=o,(e=[{key:"onClick",value:function(e){var t=this.options.interaction.graph;if(t.multiSelection||this.deSelect(),this.selectFeatures.push(p(p({},e.userData),{},{treeID:e.userData.treeName})),this.emit("click",this.selectFeatures),this.addLabels(),t.show&&t.clickStyle.show)for(var a,r,i,o=E(t.clickStyle.fillColor).gl(),n=new d.Color(o[0],o[1],o[2]),s=0;s<this.group.children.length;s++)if(this.group.children[s].userData.isClick)for(a=0;a<this.selectFeatures.length;a++)for(i=this.selectFeatures[a].adcode,r=0;r<this.group.children.length;r++){var l=this.group.children[r];l.userData.isClick&&l.userData.adcode==i&&(l.material.opacity=o[3]*l.userData.generalOpacity,l.material.color=n,l.material.needsUpdate=!0)}}},{key:"deSelect",value:function(){for(var e,t,a,r=!1,i=0;i<this.group.children.length;i++)if(this.group.children[i].userData.isClick)for(isClick=!0,e=0;e<this.selectFeatures.length;e++)for(a=this.selectFeatures[e].adcode,t=0;t<this.group.children.length;t++){var o=this.group.children[t];o.userData.isClick&&o.userData.adcode==a&&(r=o.userData,o.material.opacity=o.userData.opacity,o.material.color=o.userData.fillColor,o.material.needsUpdate=!0)}r&&0<this.selectFeatures.length&&this.emit("deSelect",r),this.selectFeatures=[];var n=this.options.label;n.isShow&&"all"==n.eventType||this.removeLabels()}},{key:"render",value:function(e){this.data=e||[],this.draw()}},{key:"setGeojson",value:function(e){this.clear(),this.alldata=e,this.draw()}},{key:"draw",value:function(){if(this.clear(),this.alldata&&this.alldata.geojson_proj_bbox){var e=this.alldata,t=e.geojson_proj,a=e.geojson_proj_bbox,C=e.geojson_proj_dissolve,P=e.geojson_proj_dissolve_bbox,U=Object.assign({},t);if(O(U),U&&U.features&&0!==U.features.length){this.mappingData=j({options:this.options,data:this.data,_:S,mergeOptions:x,GuiUtils:w});for(var e=I.baseHeightScale,r=I.lowHeightScale,_=I.drawScale,i=(this.group.position.z=_*e*R,this.addNames({geojson:t,mappingData:this.mappingData,relativeHeight:~~(_*R*.02),graph:this.options.graph}),this.addLabels(),_*R*.005),o=S.get(this.options,"graph.colorMapping"),n=0;n<U.features.length;n++){var s=U.features[n],l=[],p=s.geometry,h=p.type,u=p.coordinates;switch(h){case"Polygon":l.push.apply(l,W(u));break;case"MultiPolygon":for(var c=0;c<u.length;c++)l.push.apply(l,W(u[c]))}var p=H(s),h=1<l.length,p=G(l,p,h,1),h="red",h=s.properties.adcode&&this.mappingData[s.properties.adcode]&&this.mappingData[s.properties.adcode].fillColor?this.mappingData[s.properties.adcode].fillColor:o.mapping?o.scale.abnormal||"rgba(255,255,255,0)":o.fixed,d=H(s),g=!1;1<Math.max(Math.abs(d[2]-d[0]),Math.abs(d[3]-d[1]))/I.bboxSize*I.bboxLowHeightScale?this.addTop(p,h,i,s,g):this.addTop(p,h,i*r,s,g=!0)}var f,M,L=a,B=~~(Math.abs(L[2]-L[0])/5e3),F=~~(Math.abs(L[3]-L[1])/5e3),y=[];for(f in this.mappingData)(M=this.mappingData[f]).textureShape&&y.push(M.textureShape);for(var y=D(y),z=this,m=[],b=y.length,v=0;v<b;v++)!function(){var i=y[v],e=new Promise(function(a,e){var r;z.textureImageUrls[i]?a(!0):((r=new Image).crossOrigin="anonymous",r.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d");e.width=r.width,e.height=r.height,t.imageSmoothingQuality="high",t.drawImage(r,0,0,r.width,r.height),z.textureImageUrls[i]={canvas:e,colorCanvas:{}},a(!0)},r.onerror=function(){e(new Error("Could not load image at "+i))},r.src=i)});m.push(e)}();Promise.all(m).then(function(e){for(var t in z.mappingData)if(M=z.mappingData[t],z.textureImageUrls[M.textureShape]){var t=z.textureImageUrls[M.textureShape],a=t.canvas,t=t.colorCanvas;if(!t[M.textureColor]){for(var r=document.createElement("canvas"),i=(r.width=a.width,r.height=a.height,r.getContext("2d")),o=a.getContext("2d").getImageData(0,0,a.width,a.height),n=o.data,s=E(M.textureColor).rgba(),l=0;l<a.width*a.height;l++)(0<n[4*l+0]||0<n[4*l+1]||0<n[4*l+2]||0<n[4*l+3])&&(n[4*l+0]=s[0],n[4*l+1]=s[1],n[4*l+2]=s[2],n[4*l+3]=n[4*l+3]*s[3]);i.putImageData(o,0,0,0,0,a.width,a.height),t[M.textureColor]=r}}var p=document.createElement("canvas"),h=(p.width=B,p.height=F,p.style.width=B+"px",p.style.height=F+"px",p.getContext("2d"));h.imageSmoothingQuality="high";for(var u=0;u<U.features.length;u++){var c=U.features[u],d=H(c),d=Math.max(Math.abs(d[2]-d[0]),Math.abs(d[3]-d[1])),d=I.bboxSize/d;if(d<I.bboxLowHeightScale){var d=c.geometry,c=c.properties,g=[],f=d.type,y=d.coordinates;switch(f){case"Polygon":g.push.apply(g,W(y));break;case"MultiPolygon":for(var m=0;m<y.length;m++)g.push.apply(g,W(y[m]))}if(z.mappingData[c.adcode]&&z.mappingData[c.adcode].textureShape){d=z.mappingData[c.adcode],f=document.createElement("canvas"),c=(f.width=d.textureSize.width,f.height=d.textureSize.height,f.style.width=d.textureSize.width+"px",f.style.height=d.textureSize.height+"px",f.getContext("2d"));c.imageSmoothingQuality="high";var b=z.textureImageUrls[d.textureShape].colorCanvas[d.textureColor];if(c.drawImage(b,0,0,d.textureSize.width,d.textureSize.height),!y||0===y.length)return;h.beginPath();for(var v,w,S=void 0,x=void 0,S=0;S<y.length;S++){for(x=0;x<y[S].length;x++)v=((w=y[S][x])[0]-L[0])*B/Math.abs(L[2]-L[0]),w=(Math.abs(L[3]-L[1])-(w[1]-L[1]))*F/Math.abs(L[3]-L[1]),h[x?"lineTo":"moveTo"](v,w);h.closePath()}c=h.createPattern(f,"repeat");h.fillStyle=c,h.fill("evenodd")}}}var O=C.features[0],D=[],j=O.geometry,A=j.type,k=j.coordinates;switch(A){case"Polygon":D.push.apply(D,W(k));break;case"MultiPolygon":for(var T=0;T<k.length;T++)D.push.apply(D,W(k[T]))}j=1<D.length,A=G(D,P,j,1);z.addTopTexture(A,p,"red",~~(_*R*.008),O)}).catch(function(e){})}}}},{key:"addTop",value:function(e,t,a,r,i){var o=new d.BufferGeometry,e=(o.setAttribute||(o.setAttribute=o.addAttribute),o.setIndex(new d.BufferAttribute(new Uint32Array(e.indices),1)),o.setAttribute("position",new d.BufferAttribute(new Float32Array(e.positions),3)),o.setAttribute("normal",new d.BufferAttribute(new Float32Array(e.normals),3)),o.setAttribute("uv",new d.BufferAttribute(new Float32Array(e.uvs),2)),o.computeBoundingSphere(),o.computeBoundingBox(),.01*this.options.general.opacity),t=E(t).gl(),n=new d.Color(t[0],t[1],t[2]),s=new d.MeshStandardMaterial({transparent:!0,opacity:t[3]*e,color:n,depthWrite:!0,depthTest:!0,flatShading:d.FlatShading}),o=(s.onBeforeCompile=function(e){e.vertexShader=l("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/shader/top_vert.glsl"),e.fragmentShader=l("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/shader/top_frag.glsl"),this.userData.shader=e},s.needsUpdate=!0,new d.Mesh(o,s));o.position.z=i?a-this.group.position.z*(1-I.lowHeightScale):a,o.userData=x(p(p({},this.mappingData[r.properties.adcode]),r.properties),{isClick:!0,generalOpacity:e,opacity:t[3]*e,fillColor:n,isLowHeight:i}),o.renderOrder=10,this.add(o)}},{key:"addTopTexture",value:function(e,t,a,r,i){var o=new d.BufferGeometry,e=(o.setAttribute||(o.setAttribute=o.addAttribute),o.setIndex(new d.BufferAttribute(new Uint32Array(e.indices),1)),o.setAttribute("position",new d.BufferAttribute(new Float32Array(e.positions),3)),o.setAttribute("normal",new d.BufferAttribute(new Float32Array(e.normals),3)),o.setAttribute("uv",new d.BufferAttribute(new Float32Array(e.uvs),2)),o.computeBoundingSphere(),o.computeBoundingBox(),.01*this.options.general.opacity),t=new d.CanvasTexture(t),e=(t.wrapS=t.wrapT=d.RepeatWrapping,t.repeat.set(1,1),t.anisotropy=20,t.needsUpdate=!0,new d.MeshStandardMaterial({transparent:!0,opacity:e,map:t,depthWrite:!0,depthTest:!0})),t=new d.Mesh(o,e);t.position.z=2*r,t.scale.z=1,t.userData=x(this.mappingData[i.properties.adcode],i.properties),this.add(t),t.renderOrder=10}},{key:"addNames",value:function(e){for(var t,a=0;a<this.group.children.length;a++)"nameSprite"==(t=this.group.children[a]).userData.meshType&&(this.group.remove(t),a--);var r=e.geojson,i=e.mappingData,o=e.relativeHeight,n=e.graph;if(n.textLabel.show)for(a=0;a<r.features.length;a++){var s=r.features[a],l=s.properties,l=x(l,i[l.adcode]),s=g(s,1),s=[~~s[0],~~s[1],o],l=u({name:l.name,graph:n}),p=new d.CanvasTexture(l),p=(p.wrapS=p.wrapT=d.MirroredRepeatWrapping,p.minFilter=d.LinearFilter,p.repeat.set(1,1),p.anisotropy=20,p.needsUpdate=!0,new d.SpriteMaterial({map:p,transparent:!0,depthWrite:!0,depthTest:!0,sizeAttenuation:!1,opacity:1})),p=new d.Sprite(p),h=(p.center.set(.5,0),(h=p.position).set.apply(h,s),.36/y/I.container.clientHeight),s=l.width*h,l=l.height*h;p.scale.set(s,l,1),p.userData={meshType:"nameSprite"},this.add(p),p.renderOrder=+this.options.renderOrder}}},{key:"addLabels",value:function(){this.removeLabels();var i,o,e=this.options.label;e.isShow&&("vector"===(i=e.backgroundStyle).backgroundType||this.imageUrls[i.imageUrl]?this._addLabels():"image"!==i.backgroundType||this.imageUrls[i.imageUrl]||(o=this,new Promise(function(a,e){var r=new Image;r.crossOrigin="anonymous",r.onload=function(){var e=document.createElement("canvas"),t=e.getContext("2d");e.width=r.width,e.height=r.height,t.drawImage(r,0,0,e.width,e.height),o.imageUrls[i.imageUrl]=e,a(!0)},r.onerror=function(){e(new Error("Could not load image at "+url))},r.src=i.imageUrl}).then(function(e){e&&o._addLabels()})))}},{key:"_addLabels",value:function(){for(var e,t=this.options,a=t.label,r=t.renderOrder,i=I.drawScale*R*.02,o=this.alldata.geojson_proj,n=!1,s=0;s<o.features.length;s++){var l,p,h=o.features[s],u=h.properties,c=x(u,this.mappingData[u.adcode]),u=g(h,1),n=!(c.xyz=[~~u[0],~~u[1],i]);if("click"==a.eventType)for(e=0;e<this.selectFeatures.length;e++)if(this.selectFeatures[e].adcode==c.adcode){n=!0;break}"all"!=a.eventType&&!n||(h=[c.xyz[0],c.xyz[1],i],u=f({properties:c,labelStyle:a,imageUrls:this.imageUrls}),(l=new d.CanvasTexture(u)).minFilter=d.LinearFilter,l.wrapS=l.wrapT=d.MirroredRepeatWrapping,l.repeat.set(1,1),l.anisotropy=20,l.needsUpdate=!0,l=new d.SpriteMaterial({map:l,transparent:!0,depthWrite:!0,depthTest:!0,sizeAttenuation:!1,opacity:1}),(l=new d.Sprite(l)).center.set(.5,0),(p=l.position).set.apply(p,h),p=.36/y/2/I.container.clientHeight,h=u.width*p,u=u.height*p,l.scale.set(h,u,1),l.userData=x(c,{meshType:"labelSprite"}),this.add(l),l.renderOrder=+r+150)}this.checkVisible()}},{key:"removeLabels",value:function(){for(var e,t=0;t<this.group.children.length;t++)"labelSprite"==(e=this.group.children[t]).userData.meshType&&(this.group.remove(e),t--)}},{key:"updateOptions",value:function(e){this.options=x(this.options,e||{}),this.draw()}},{key:"updateBaseHeight",value:function(){for(var e,t=I.baseHeightScale,a=I.drawScale,r=I.lowHeightScale,i=(this.group.position.z=~~(a*t*R),~~(a*R*.005*r)),o=0;o<this.group.children.length;o++)(e=this.group.children[o]).userData.isLowHeight&&(e.position.z=~~(i-this.group.position.z*(1-I.lowHeightScale)))}},{key:"checkVisible",value:function(){(this.options.visible?c(A(o.prototype),"show",this):c(A(o.prototype),"hide",this)).call(this)}},{key:"show",value:function(){this.options.visible=!0,c(A(o.prototype),"show",this).call(this)}},{key:"hide",value:function(){this.options.visible=!1,c(A(o.prototype),"hide",this).call(this)}},{key:"destroy",value:function(){c(A(o.prototype),"remove",this).call(this),this.clear(),this.geojson=null,this.data=null,this.mappingData=null,this.options=null,this.imageUrls}}])&&h(t.prototype,e),a&&h(t,a),Object.defineProperty(t,"prototype",{writable:!1}),o},e.exports});;
Cube("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(e,t,o,r,n,i){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var o=0;o<t.length;o++){var r=t[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function y(o){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(o),t=(e=r?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");return u(t)}}function u(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var p=o("datav:/npm/eventemitter3/3.0.0"),f=o("datav:/npm/safely-merge/1.0.1"),h=o("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/areaLayer.js"),d=o("datav:/com/@datav-3d-v3/datav-3dplane-area/3.1.4/src/lineLayer.js"),o=function(){var e=n,t=p;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t);var o,r=y(n);function n(e,t){var o;if(this instanceof n)return(o=r.call(this)).options=f({},t.options),o.classNameAlias="AreaLayer",o.setGeojson=o.setGeojson.bind(u(o)),o._setGeojson=o._setGeojson.bind(u(o)),o.geojsonProcess=o.geojsonProcess.bind(u(o)),o.updateArea=o.updateArea.bind(u(o)),o.layer={areaLayer:null,lineLayer:null},Object.defineProperty(o.layer,"destroy",function(){o.destroy()}),o._geojson=null,o.geojson=null,o.visible=!0,o;throw new TypeError("Cannot call a class as a function")}return e=n,(t=[{key:"addTo",value:function(e,t){var o=this,t=(this.layerId=t,this.viewer=e,h(e)),t=(this.layer.areaLayer=new t(this.options),e.addLayer(this.layerId+"_layer",this.layer.areaLayer),d(e));if(this.layer.lineLayer=new t(this.options),e.addLayer(this.layerId+"_lineLayer",this.layer.lineLayer),this.updateArea(),this.visible)for(var r in this.layer)this.layer[r].show();else for(var n in this.layer)this.layer[n].hide();this.layer.areaLayer.on("click",function(e){o.emit("click",e)}),this.layer.areaLayer.on("deSelect",function(e){o.emit("deSelect",e)})}},{key:"render",value:function(e){this.data=e||[];for(var t,o=!1,r=0;r<e.length;r++)if((t=e[r]).geometry&&("Polygon"==t.geometry.type||"MultiPolygon"==t.geometry.type)){o=!0;break}var n={type:"FeatureCollection",features:[]};if(o){for(r=0;r<e.length;r++){var i=e[r];!i.geometry||"Polygon"!=i.geometry.type&&"MultiPolygon"!=i.geometry.type||(i={type:"Feature",properties:{},geometry:i.geometry},n.features.push(i))}this.geojson=this.geojsonProcess(n)}else this.geojson=null;var a,s=[];for(r=0;r<e.length;r++)!(t=f({},e[r])).geometry||"Polygon"!=t.geometry.type&&"MultiPolygon"!=t.geometry.type||delete t.geometry,s.push(t);for(a in this.layer)this.layer[a].render&&this.layer[a].render(s);this._setGeojson()}},{key:"geojsonProcess",value:function(e){if(e&&e.features){for(var t={type:"FeatureCollection",features:[]},o=0;o<e.features.length;o++){var r=e.features[o];r.properties.adcode&&"100000_JD"==r.properties.adcode||!r.geometry||"Polygon"!=r.geometry.type&&"MultiPolygon"!=r.geometry.type||t.features.push(r)}return t}}},{key:"setGeojson",value:function(e){var t=this;e&&e.type&&e.api?fetch(e.api).then(function(e){return e.json()}).then(function(e){t._geojson=t.geojsonProcess(e),t._setGeojson()}):e&&e.type&&("FeatureCollection"===e.type||"GeometryCollection"===e.type)&&(this._geojson=this.geojsonProcess(e),this._setGeojson())}},{key:"_setGeojson",value:function(){var e,t,o,r,n,i=this.geojson||this._geojson,a={geojson_proj:{type:"FeatureCollection",features:[]},geojson_proj_bbox:null,geojson_proj_dissolve:{type:"FeatureCollection",features:[]},geojson_proj_dissolve_bbox:null};for(n in i&&i.features&&0<i.features.length&&(i=Object.assign({},i),e=(o=this.viewer.Utils).geojsonFlatten,r=o.geojsonDissolve,t=o.geojsonBBox,o=o.coordtransformCli,a.geojson_bbox=t(i),a.geojson_proj=o.wgs84ToMecator(i,this.viewer.proj.proj),a.geojson_proj_bbox=t(a.geojson_proj),r={type:"Feature",properties:{},geometry:r(e(Object.assign({},i)))},r=o.wgs84ToMecator(r,this.viewer.proj.proj),a.geojson_proj_dissolve={type:"FeatureCollection",features:[r]},a.geojson_proj_dissolve_bbox=t(a.geojson_proj_dissolve)),this.layer)this.layer[n].setGeojson&&this.layer[n].setGeojson(a)}},{key:"updateArea",value:function(){var e;this.viewer&&this.viewer.mainTerrainData&&(e=null,this.viewer.mainTerrainData.geojson_main_children&&this.viewer.mainTerrainData.geojson_main_children.features&&0<this.viewer.mainTerrainData.geojson_main_children.features.length?e=this.viewer.mainTerrainData.geojson_main_children:this.viewer.mainTerrainData.geojson_main&&(e=this.viewer.mainTerrainData.geojson_main),e&&this.setGeojson(e))}},{key:"updateOptions",value:function(e){for(var t in this.options=f(this.options,e.options),this.layer)this.layer[t].updateOptions&&this.layer[t].updateOptions(this.options)}},{key:"updateBaseHeight",value:function(){for(var e in this.layer)this.layer[e].updateBaseHeight&&this.layer[e].updateBaseHeight()}},{key:"show",value:function(){for(var e in this.visible=!0,this.layer)null!=(e=this.layer[e])&&e.show()}},{key:"hide",value:function(){for(var e in this.visible=!1,this.layer)null!=(e=this.layer[e])&&e.hide()}},{key:"destroy",value:function(){for(var e in this.layer){var t;null!=(t=this.layer[e])&&t.destroy(),this.layer[e]=null}this.geojson=null,this._geojson=null,this.layer=null}}])&&s(e.prototype,t),o&&s(e,o),Object.defineProperty(e,"prototype",{writable:!1}),n}();return e.exports=o,e.exports});