// env=undefined => env=publish 
Cube("datav:/com/datav-expo-landmarker/0.0.2/LandmarkerLayer",["datav:/npm/chroma-js/1.3.4","datav:/npm/eventemitter3/2.0.3","datav:/npm/safely-merge/1.0.1"],function(a,b,c){let d=null;const e=c("datav:/npm/chroma-js/1.3.4"),f=c("datav:/npm/eventemitter3/2.0.3"),g=c("datav:/npm/safely-merge/1.0.1"),h={textureUrl:"https://img.alicdn.com/tfs/TB1hGrFSFXXXXXfapXXXXXXXXXX-128-128.png",spriteSizeScale:"",spriteOpacity:""};return a.exports=class extends f{constructor(a){super(),this.options=g(h,a||{})}init(){this.spriteGroup=[],this.meshGroup=new d.Group}addTo(a){a||console.error("marker need map"),d=a.three,this.scene=a.scene,this.init()}setData(a){this.data=a||[],this.clean(),this.createMeshGroup(),this.scene.add(this.meshGroup)}createMeshGroup(){let a=this.data;if(a.length)for(let b,c=0,d=a.length;c<d;c++)b=a[c],this.createMesh(b)}createMesh(a){let b=this.options,c=new d.Object3D,e=new d.TextureLoader().setCrossOrigin("*"),f=new d.SpriteMaterial({map:e.load(a.url||b.textureUrl),transparent:!0,opacity:b.spriteOpacity}),g=new d.Sprite(f);g.scale.x=g.scale.y=b.spriteSizeScale,c.add(g),this.spriteGroup.push(g),c.position.set(a.x||0,a.y||0,a.z||0),this.meshGroup.add(c)}updateOptions(a){this.options=g(this.options,a||{}),this.setData(this.data)}clean(){this.meshGroup&&(this.scene.remove(this.meshGroup),this.disposeNode(this.meshGroup)),this.spriteGroup=[],this.meshGroup=new d.Group}remove(){this.clean(),this.data=null,this.meshGroup=null,this.spriteGroup=null}disposeNode(a){a.traverse(function(a){a instanceof d.Mesh&&(a.geometry&&a.geometry.dispose(),a.material&&(a.material instanceof d.MeshFaceMaterial||a.material instanceof d.MultiMaterial?a.material.materials.forEach(function(a){a.map&&a.map.dispose(),a.lightMap&&a.lightMap.dispose(),a.bumpMap&&a.bumpMap.dispose(),a.normalMap&&a.normalMap.dispose(),a.specularMap&&a.specularMap.dispose(),a.envMap&&a.envMap.dispose(),a.dispose()}):(a.material.map&&a.material.map.dispose(),a.material.lightMap&&a.material.lightMap.dispose(),a.material.bumpMap&&a.material.bumpMap.dispose(),a.material.normalMap&&a.material.normalMap.dispose(),a.material.specularMap&&a.material.specularMap.dispose(),a.material.envMap&&a.material.envMap.dispose(),a.material.dispose())))})}},a.exports});;
Cube("datav:/com/datav-expo-landmarker/0.0.2",["datav:/npm/eventemitter3/2.0.3","datav:/npm/safely-merge/1.0.1"],function(a,b,c){const d=c("datav:/npm/eventemitter3/2.0.3"),e=c("datav:/npm/safely-merge/1.0.1"),f=c("datav:/com/datav-expo-landmarker/0.0.2/LandmarkerLayer"),g={};return a.exports=class extends d{constructor(a,b){super(),this.options=e(g,b||{})}initLayer(){this.layer=new f(this.options),this.layer.addTo(this.map)}addTo(a){return a?void(this.map=a,this.initLayer()):console.log("Land marker layer needs map layer")}remove(){this.layer&&this.layer.remove&&this.layer.remove(),this.layer=null}render(a){return a?void(this.layer&&this.layer.setData(a)):console.log("\u9759\u6B62\u6807\u8BC6\u7EC4\u4EF6\u9700\u8981\u6570\u636E......")}updateOptions(a){this.options=e(this.options,a||{}),this.layer&&this.layer.updateOptions(this.options)}},a.exports});