// env=undefined => env=publish 
Cube("datav:/com/@datav_shukongkeji/time-selector/0.1.0",["datav:/npm/bcore/0.0.18/event","datav:/npm/jquery/2.1.4","datav:/npm/lodash/4.6.1"],function(a,b,c){var d=c("datav:/npm/bcore/0.0.18/event"),e=c("datav:/npm/jquery/2.1.4"),f=c("datav:/npm/lodash/4.6.1");return a.exports=d.extend(function(a,b){this.config={theme:{}},this.container=e(a),this.apis=b.apis,this._data=null,this.chart=null,this.init(b)},{init:function(a){this.mergeConfig(a),this.updateLayout(),this.updateStyle()},render:function(a,b){a=this.data(a);var c=this.mergeConfig(b),d=this,f=e("<div class=\"date fl\" id=\"from\"><input type=\"text\" name=\"date\" class=\"date-check\" id=\"ECalendar_case\" value><div class=\"date-list\"><div class=\"header clearfix\"><div class=\"header-left fl\">&lt;</div><div class=\"fl\"><select class=\"year\" ></select></div><div class=\"fl\"><select class=\"month\"><option value=\"1\">1\u6708</option><option value=\"2\">2\u6708</option><option value=\"3\">3\u6708</option><option value=\"4\">4\u6708</option><option value=\"5\">5\u6708</option><option value=\"6\">6\u6708</option><option value=\"7\">7\u6708</option><option value=\"8\">8\u6708</option><option value=\"9\">9\u6708</option><option value=\"10\">10\u6708</option><option value=\"11\">11\u6708</option><option value=\"12\">12\u6708</option></select></div><div class=\"header-right fl\">&gt;</div><div class=\"fr today\">\u4ECA</div></div><table><thead><tr><th>\u4E00</th><th>\u4E8C</th><th>\u4E09</th><th>\u56DB</th><th>\u4E94</th><th>\u516D</th><th>\u65E5</th></tr></thead><tbody><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr><tr><td></td><td></td><td></td><td></td><td></td><td></td><td></td></tr></tbody></table></div></div>"),g=this.container;e(function(){function b(){g.find(".date").each(function(){var a=e(this).find(".year"),b=e(this).find(".month"),c=e(this).find(".year").val(),d=e(this).find(".month").val(),f=new Date(c,d,0).getDate();i=new Date(new Date(c,d-1,1));var g=i.getDay();0===g&&(g=7);var h=1;e(this).find("td").each(function(){e(this).removeClass("current");var c=e(this).index()+1;c<g&&0===e(this).parent("tr").index()?e(this).html(""):h<=f?(e(this).html(h),h++):e(this).html(""),""===e(this).html()&&""===e(this).siblings().html()?e(this).parents("tr").css("display","none"):e(this).parents("tr").css("display","table-row"),a.val()===o&&b.val()===p&&e(this).html()===q?e(this).addClass("current"):e(this).removeClass("current")}),h=1})}function h(a){return 10<=a?a:"0"+a}g.html(f);var j=g.find(".year"),k=g.find(".month"),l=j.val(),m=k.val(),n=new Date,o=n.getFullYear(),p=n.getMonth()+1,q=n.getDate();k.val(p),j.val(o);for(var r,s=1980;2029>s;s++)r="",r+="<option>"+s+"</option>",e(r).appendTo(j);j.val(o),b.bind(this)();var i=new Date;g.find(".today").unbind(),g.find(".today").on("click",function(){j.val(o),k.val(p),b.bind(d)(),e(this).parents(".date-list").css("display","none").siblings(".date-check").val(o+c.input.separator+h(p)+c.input.separator+h(q)),d.emit("global_var",c.chart.callbackId,o+c.input.separator+h(p)+c.input.separator+h(q))}),g.find(".header select").on("change",function(){b.bind(d)()});var t=0;g.find(".date-list").hover(function(){t=0},function(){t=1}),g.find(".date-check").each(function(){e(this).on("focus",function(){var a=e(this).siblings(".date-list"),b=e(this);a.css("display","block"),e(this).parents(".date").siblings(".date").find(".date-list").css("display","none"),a.find("td").each(function(){var d=e(this);d.on("click",function(){var f=e(this).parents(".date-list").find(".year").val(),g=e(this).parents(".date-list").find(".month").val(),i=e(this).html(),j="";""!==d.html()&&(j+=f+c.input.separator+h(g)+c.input.separator+h(i),b.val(j),a.css("display","none"))})})}),e(this).on("blur",function(){1===t&&(e(this).siblings(".date-list").css("display","none"),t=0)}),e(this).val(a[0].date),d.emit("global_var",c.chart.callbackId,a[0].date)}),g.find("#from td").unbind(),g.find("#from td,#from .today").on("click",function(){var a,b=e(this).parents(".date-list").find(".year").val(),f=e(this).parents(".date-list").find(".month").val();if("td"===e(this).prop("tagName").toLowerCase()&&(a=e(this).html(),""!==a)){var g=b+"-"+f+"-"+a;e(this).parents(".date-list").siblings(".date-check").val(g),d.emit("global_var",c.chart.callbackId,g)}}),g.find(".header-left").on("click",function(){var a=parseInt(e(this).parents(".header").find(".year").val()),c=parseInt(e(this).parents(".header").find(".month").val());2<=c?c-=1:(a-=1,c=12,e(this).parents(".header").find(".month").val(c),e(this).parents(".header").find(".year").val(a)),e(this).parents(".header").find(".month").val(c),b.bind(d)()}),g.find(".header-right").on("click",function(){var a=parseInt(e(this).parents(".header").find(".year").val()),c=parseInt(e(this).parents(".header").find(".month").val());12>c?c+=1:(a+=1,c=1,e(this).parents(".header").find(".month").val(c),e(this).parents(".header").find(".year").val(a)),e(this).parents(".header").find(".month").val(c),b.bind(d)()});var u=g.find("input").is(":focus");!0===u&&alert(1),g.find(".date-list td").click(function(){e(this).parents(".date-list").css("display","none")}),g.find("table").css({borderCollapse:"collapse",tableLayout:"fixed"}),g.find(".fl").css({float:"left"}),g.find(".fr").css({float:"right"}),g.find(".date").css({position:"relative"}),g.find(".date-check").css({width:c.input.size.width+"px",height:c.input.size.height+"px",lineHeight:c.input.size.height+"px",border:c.input.border.width+"px solid "+c.input.border.color,padding:"0 5px",textAlign:c.input.pos,borderRadius:c.input.border.radius,background:c.input.background,color:c.input.font.color,fontSize:c.input.font.fontSize}),g.find(".date-list").css({display:"none",position:"absolute",top:c.input.size.height+"px",paddingTop:"10px",background:c.calendar.background,borderRadius:c.calendar.border.radius+"px",overflow:"hidden",border:c.calendar.border.width+"px solid "+c.calendar.border.color,borderColor:c.calendar.border.width+" "+c.calendar.border.width+" transparent "+c.calendar.border.width,zIndex:"999"}),g.find(".header").css({marginBottom:"4px",padding:"0 5px"}),g.find(".header .fl").css({marginRight:"5px",cursor:"pointer",height:"20px"}),g.find(".header select").css({padding:c.calendar.select.time+"px",verticalAlign:"top",background:c.calendar.selectBackground,border:"0",color:c.calendar.chart.font.color,fontSize:c.calendar.chart.font.fontSize}),g.find(".header-right").css({marginRight:"8px"}),g.find(".header-right , .header-left").css({borderRadius:"50%",fontSize:c.calendar.chart.font.fontSize+"px",height:c.calendar.chart.font.fontSize+c.calendar.select.time+2+"px",width:c.calendar.chart.font.fontSize+"px",textAlign:"center",verticalAlign:"middle",border:"0px solid #ccc",lineHeight:c.calendar.chart.font.fontSize+c.calendar.select.time+2+"px",color:c.calendar.chart.font.color}),g.find(".today").css({border:"0px solid #ccc",borderRadius:"5px",background:c.calendar.selectBackground,color:c.calendar.chart.font.color,fontSize:c.calendar.chart.font.fontSize,padding:c.calendar.select.today/2+"px "+c.calendar.select.today+"px",textAlign:"center",verticalAlign:"middle",cursor:"pointer"}),g.find(".date-list , .date-list table").css({}),g.find(".date-list thead").css({background:c.calendar.selectBackground}),g.find(".date-list th").css({padding:c.calendar.paddingBorder.padding+"px",color:c.calendar.chart.font.color,border:c.calendar.paddingBorder.width+"px solid "+c.calendar.paddingBorder.color,fontSize:c.calendar.chart.font.fontSize,fontWeight:"normal"}),g.find(".date-list td").css({border:c.calendar.paddingBorder.width+"px solid "+c.calendar.paddingBorder.color,padding:c.calendar.paddingBorder.padding+"px",textAlign:"center",fontSize:c.calendar.chart.font.fontSize,color:c.calendar.chart.font.color}),g.find(".date-list td").mouseover(function(){e(this).css({background:c.calendar.selectBackground,color:"#000"})}),g.find(".date-list td").mouseout(function(){e(this).css({background:"transparent",color:"#fff"})})}),this.updateStyle()},resize:function(a,b){this.updateLayout(a,b),this.render()},setColors:function(){},data:function(a){return a&&(this._data=a),this._data},mergeConfig:function(a){return a?(this.config.theme=f.defaultsDeep(a.theme||{},this.config.theme),this.setColors(),this.config=f.defaultsDeep(a||{},this.config),this.config):this.config},updateLayout:function(){},updateStyle:function(){var a=this.config;this.container.css({"font-family":a.chart.font||"\u5FAE\u8F6F\u96C5\u9ED1"})},destroy:function(){console.log("\u8BF7\u5B9E\u73B0 destroy \u65B9\u6CD5")}}),a.exports});