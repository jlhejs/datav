// env=undefined => env=publish 
Cube("datav:/com/datavmap-3d-layer-postprocessing/0.0.2/postprocessing-layer.js",["datav:/npm/eventemitter3/2.0.3","datav:/npm/safely-merge/1.0.1"],function(a,b,c){const d=c("datav:/npm/eventemitter3/2.0.3"),e=c("datav:/npm/safely-merge/1.0.1");return a.exports=function(a){const b=a.datavgl,c=b.THREE,f=a.glLayer||a,g=b.postprocessing,h={type:"bloom",bloom:{resolutionScale:0.5,kernelSize:1,intensity:1,distinction:1,screenMode:!0}};return class extends d{constructor(a){super(),a=e(h,a),this.options=e(this.options,a),this.initPostprocessing()}initPostprocessing(){switch(this.options.type){case"bloom":this.pass=new g.BloomPass(this.options[this.options.type]),this.pass.renderToScreen=!1;break;default:this.pass=null;}this.pass&&f.composer.addPass(this.pass,f.composer.passes.length-1)}setData(){}updateOptions(a){this.pass&&f.composer.removePass(this.pass),this.options=e(this.options,a),this.initPostprocessing()}remove(){f.composer.removePass(this.pass)}}},a.exports});;
Cube("datav:/com/datavmap-3d-layer-postprocessing/0.0.2",["datav:/npm/eventemitter3/2.0.3","datav:/npm/safely-merge/1.0.1"],function(a,b,c){const d=c("datav:/npm/eventemitter3/2.0.3"),e=c("datav:/npm/safely-merge/1.0.1"),f=c("datav:/com/datavmap-3d-layer-postprocessing/0.0.2/postprocessing-layer.js"),g={};return a.exports=class extends d{constructor(a,b){super(),this.container="string"===typeof a?document.querySelector(a):a,this.apis=b.apis,this.map=null,this._data=null,this.config=b}initLayer(){let a=this.getOptions(),b=f(this.map);this.layer=new b(a)}addTo(a){this.map=a,this.resetID&&clearTimeout(this.resetID),this.init(),this.endID=setTimeout(()=>{this.resetID&&clearTimeout(this.resetID)},100000)}init(){this.map.loaded()&&this.map.isStyleLoaded()?(this.resetID&&clearTimeout(this.resetID),this.initLayer(),this.data&&this.render(this.data)):(this.resetID&&clearTimeout(this.resetID),this.resetID=setTimeout(()=>{this.init()},100))}getOptions(){return this.config=e(g,this.config),this.config}remove(){this.endID&&clearTimeout(this.endID),this.resetID&&clearTimeout(this.resetID),this.layer&&this.layer.remove&&this.layer.remove(),this.layer=null,this._data=null}render(a){a&&(this.data=a)}updateOptions(a){this.config=e(this.config,a),a=this.getOptions(),this.layer&&this.layer.updateOptions(a)}},a.exports});