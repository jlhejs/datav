// env=undefined => env=publish 
Cube("datav:/com/datavmap-2d-layer-stream-popups/0.1.16/streamPopupsLayer.js",["datav:/npm/jquery/3.4.1","datav:/npm/lodash/4.17.15"],function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"===typeof b||"function"===typeof b)?b:a}function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c("datav:/npm/jquery/3.4.1"),i=c("datav:/npm/lodash/4.17.15"),j=null;return a.exports=function(a){var b=a.datavUtils,c=a.BaseLayer,h={isCircle:!0,isCache:!1,cacheCount:1e3,popupNum:10,isOrder:!1,iconUrl:"",iconSize:50,iconWidth:50,iconHeight:50,iconOffsetX:25,iconOffsetY:50,fontFamily:"Microsoft Yahei",contentBack:"#94E55D",contentWidth:80,contentHeight:20,contentALign:"center",contentOffsetX:25,contentOffsetY:50,fontColor:"#fff",fontSize:12,spreadTime:0.5,keepTime:1,fadeTime:1,updateTime:1,radius:5,margin:5,getLat:function(a){return+a.lat},getLng:function(a){return+a.lng},getContent:function(a){return a.info||"\u8BF7\u8865\u5145info\u5B57\u6BB5"}};return j||(j=function(c){function j(a){d(this,j);var c=e(this,(j.__proto__||Object.getPrototypeOf(j)).call(this));return a=b.mergeOptions(h,a),c.options=b.mergeOptions(c.options,a),c.visibility=!0,c}return f(j,c),g(j,[{key:"init",value:function(){this.data=[],this.group=a.layerGroup(),this.group.addTo(this.map),this.cssKeyframesName="keyframes_"+this.getRandomCode(10),this.addCSS()}},{key:"addCSS",value:function(){var a=document.createElement("style");a.type="text/css";try{a.appendChild(document.createTextNode("\n                @keyframes "+this.cssKeyframesName+" {\n                  0% {\n                    clip: rect(0, 0, 999px, 0);\n                    opacity: 0.2;\n                  }\n                  50% {\n                    clip: rect(0, 600px, 999px, 0 );\n                    opacity: 0.6;\n                  }\n                  100% {\n                    clip: rect(0, 600px, 999px, 0 );\n                    opacity: 1;\n                  }\n                }\n              "))}catch(a){}var b=document.getElementsByTagName("head")[0];b.appendChild(a)}},{key:"setData",value:function(a){return a&&0!==a.length?void(this.options.isCache?([].push.apply(this.data,a),this.data=i.slice(this.data,0,this.options.cacheCount)):(this.data=a||[],this.removeAllPopups()),this.timer&&clearTimeout(this.timer),this.visibility&&this.random(this.data)):(this.removeAllPopups(),void(this.data=[]))}},{key:"random",value:function(){if(this.removeAllPopups(),this.options.isOrder){var a=this.data.splice(0,this.options.popupNum);this.addPopups(a),[].push.apply(this.data,a)}else{var a=i.shuffle(this.data);this.addPopups(i.slice(a,0,this.options.popupNum))}this.timer=setTimeout(this.random.bind(this),2e3*this.options.updateTime)}},{key:"initPopup",value:function(b){this.options.isCircle&&a.circleMarker(a.latLng(this.options.getLat(b),this.options.getLng(b)),{radius:4,fillColor:"#0ff",fillOpacity:0,stroke:!0,weight:2,color:"#0ff"}).addTo(this.group);var c="<div style=\"position: absolute;background: "+this.options.contentBack+"; border-radius: "+this.options.radius+"px; animation: "+this.cssKeyframesName+" 2s linear 0s 1\">\n            <div style=\"margin: "+this.options.margin+"px;min-width: "+this.options.contentWidth+"px;word-wrap: break-word; display: inline-block; text-align: "+this.options.contentALign+"; text-overflow: ellipsis; font-family: "+this.options.fontFamily+"; color: "+this.options.fontColor+"; font-size: "+this.options.fontSize+"px;\">"+this.options.getContent(b)+"</div>\n          </div>";a.marker(a.latLng(this.options.getLat(b),this.options.getLng(b)),{icon:a.divIcon({iconSize:null,className:"stream-popup-icon",iconAnchor:[this.options.contentOffsetX,this.options.contentOffsetY],html:c}),zIndexOffset:6e3}).addTo(this.group),a.marker(a.latLng(this.options.getLat(b),this.options.getLng(b)),{icon:a.icon({iconUrl:this.options.iconUrl||"data:image/png;base64,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",iconSize:[this.options.iconWidth,this.options.iconHeight],iconAnchor:[this.options.iconOffsetX,this.options.iconOffsetY]}),zIndexOffset:1e4}).addTo(this.group)}},{key:"addPopups",value:function(a){var b=this;a.forEach(function(a){return b.initPopup(a)})}},{key:"removeAllPopups",value:function(){var a=this;this.group.eachLayer(function(b){a.group.removeLayer(b)})}},{key:"show",value:function(){this.visibility=!0,this.setData(this.data)}},{key:"hide",value:function(){this.visibility=!1,this.timer&&clearTimeout(this.timer),this.timer=null,this.removeAllPopups()}},{key:"updateOptions",value:function(a){this.options=b.mergeOptions(this.options,a)}},{key:"onRemove",value:function(){this.timer&&clearTimeout(this.timer),this.removeAllPopups(),this.group&&(this.map.removeLayer(this.group),this.group=null),this.data=null,this.timer=null}},{key:"getRandomCode",value:function(a){if(0<a){for(var b,c=["0","1","2","3","4","5","6","7","8","9","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z"],d="",e=0;e<a;e++)b=parseInt(61*Math.random()),d+=c[b];return d}return!1}}]),j}(c))},a.exports});;
Cube("datav:/com/datavmap-2d-layer-stream-popups/0.1.16",["datav:/npm/bcore/0.0.21/event"],function(a,b,c){function d(a,b){if(!(a instanceof b))throw new TypeError("Cannot call a class as a function")}function e(a,b){if(!a)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return b&&("object"===typeof b||"function"===typeof b)?b:a}function f(a,b){if("function"!==typeof b&&null!==b)throw new TypeError("Super expression must either be null or a function, not "+typeof b);a.prototype=Object.create(b&&b.prototype,{constructor:{value:a,enumerable:!1,writable:!0,configurable:!0}}),b&&(Object.setPrototypeOf?Object.setPrototypeOf(a,b):a.__proto__=b)}var g=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,"value"in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),h=c("datav:/npm/bcore/0.0.21/event"),i=c("datav:/com/datavmap-2d-layer-stream-popups/0.1.16/streamPopupsLayer.js"),j=void 0,k={},l=function(a){function b(a,c){d(this,b);var f=e(this,(b.__proto__||Object.getPrototypeOf(b)).call(this));return f.container="string"===typeof a?document.querySelector(a):a,f.apis=c.apis,f.map=null,f.config=c,f.config.visibility=!0,f}return f(b,a),g(b,[{key:"init",value:function(){var a=this.getOptions(),b=i(this.map.L);this.layer=new b(a),this.layer.addTo(this.map)}},{key:"addTo",value:function(a){this.map=a,j=a.L.datavUtils,this.init()}},{key:"setData",value:function(a){this.layer&&this.layer.setData&&this.layer.setData(a)}},{key:"show",value:function(){this.config.visibility=!0,this.layer&&this.layer.show&&this.layer.show()}},{key:"hide",value:function(){this.config.visibility=!1,this.layer&&this.layer.hide&&this.layer.hide()}},{key:"remove",value:function(){this.layer&&(this.layer.remove&&this.layer.remove(),this.layer=null)}},{key:"getOptions",value:function(){var a=this.config=j&&j.mergeOptions(k,this.config),b={};return j&&(b=j.mergeOptions(a,b)),b}},{key:"updateOptions",value:function(a){if(this.layer){this.config=j.mergeOptions(this.config,a);var a=this.getOptions(a);this.layer.updateOptions(a),this.config.visibility?this.show():this.hide()}}}]),b}(h);return a.exports=l,a.exports});