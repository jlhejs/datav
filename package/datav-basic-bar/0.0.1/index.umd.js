(function(o,u){typeof exports=="object"&&typeof module!="undefined"?u(require("vue"),require("accounting"),require("datav-vue")):typeof define=="function"&&define.amd?define(["vue","accounting","datav-vue"],u):(o=typeof globalThis!="undefined"?globalThis:o||self,u(o.Vue,o.Accounting,o.datavVue))})(this,function(o,u,c){"use strict";function _(t){return t&&typeof t=="object"&&"default"in t?t:{default:t}}var s=_(u);const L=t=>typeof t=="number"?t:parseFloat(t)||null,S=t=>t==="dataMin"||t==="dataMax"?t:L(t),k=(t,l)=>l==="d"?s.default.toFixed(+t):l===".1f"?s.default.toFixed(+t,1):l===".2f"?s.default.toFixed(+t,2):l===".0%"?`${s.default.toFixed(parseFloat(t)*100)}%`:l===".1%"?`${s.default.toFixed(parseFloat(t)*100,1)}%`:l===".2%"?`${s.default.toFixed(parseFloat(t)*100,2)}%`:l==="th"?s.default.formatNumber(+t):l===".1t"?s.default.formatNumber(+t,1):l===".2t"?s.default.formatNumber(+t,2):t;var T=(t,l)=>{const y=t.__vccOpts||t;for(const[m,h]of l)y[m]=h;return y};const C=o.defineComponent({name:"DatavBasicBar",components:{},props:{com:{type:Object,required:!0}},setup(t){const l=c.useApiStore(),{datavEmit:y}=c.useDataCenter(t.com),m=o.computed(()=>{var n,e;return(e=(n=l.dataMap[t.com.id])==null?void 0:n.source)!=null?e:[]}),h=o.computed(()=>c.getFieldMap(t.com.apis.source.fields)),b=o.toRef(t.com,"config"),x=o.toRef(t.com,"attr"),G=o.computed(()=>({width:`${x.value.w}px`,height:`${x.value.h}px`})),v=o.computed(()=>{const n=c._.groupBy(m.value,e=>e[h.value.x]);return{keys:Object.keys(n),values:Object.values(n)}}),B=()=>{const{global:n,label:e,series:i}=b.value,{values:r}=v.value;return i.map((a,p)=>({type:a.type,name:a.name,label:{show:e.show,position:e.position,...e.textStyle,offset:[e.offsetX,e.offsetY]},itemStyle:{color:a.color.type==="gradient"?new c.echarts.graphic.LinearGradient(0,0,0,1,[{offset:0,color:a.color.from},{offset:1,color:a.color.to}]):a.color.value},barGap:`${n.innerPadding}%`,barCategoryGap:`${n.outerPadding}%`,showBackground:n.background.show,backgroundStyle:{color:n.background.color},data:r.map(w=>{const d=w[p];return{value:d?d[h.value.y]:null,dataRef:d!=null?d:{}}})}))},N=o.computed(()=>{const{global:n,xAxis:e,yAxis:i,tooltip:r,legend:a,animation:p}=b.value,[w,d]=a.position.split("-"),F={type:r.pointer.line.type==="dashed"?[r.pointer.line.dashedLength,r.pointer.line.dashedSpace]:r.pointer.line.type,width:r.pointer.line.width,color:r.pointer.line.color},A={textStyle:{fontFamily:n.fontFamily},grid:{...n.margin},tooltip:{show:r.show,textStyle:{...r.textStyle},padding:[r.background.padding.v,r.background.padding.h],backgroundColor:r.background.color,trigger:r.pointer.show?"axis":"item",axisPointer:{type:r.pointer.show?"cross":"none",label:{show:!1},lineStyle:F,crossStyle:F},borderWidth:0},legend:{show:a.show,top:w,left:d,orient:a.orient,textStyle:{...a.textStyle},icon:a.symbol.show?a.symbol.icon==="auto"?null:a.symbol.icon:"none",itemWidth:a.symbol.width,itemHeight:a.symbol.height,itemGap:a.symbol.gap,type:a.page.enabled?"scroll":"plain",width:a.page.enabled?a.page.size.width:"auto",height:a.page.enabled?a.page.size.height:"auto",pageIconSize:a.page.button.size,pageIconColor:a.page.button.color,pageIconInactiveColor:a.page.button.inactiveColor,pageTextStyle:{color:a.page.pageNumColor}},xAxis:{show:e.show,type:e.type,boundaryGap:e.boundaryGap,name:e.title.show?e.title.name:"",nameLocation:e.title.location,nameRotate:e.title.display.rotate,nameGap:e.title.display.offset,nameTextStyle:{...e.title.textStyle},axisLine:{show:e.axisLine.show,lineStyle:{type:e.axisLine.type,width:e.axisLine.width,color:e.axisLine.color}},axisTick:{show:e.axisTick.show,lineStyle:{type:e.axisTick.type,width:e.axisTick.width,color:e.axisTick.color},alignWithLabel:!0},axisLabel:{show:e.axisLabel.show,interval:L(e.axisLabel.interval),rotate:e.axisLabel.display.rotate,margin:e.axisLabel.display.margin,align:e.axisLabel.align,...e.axisLabel.textStyle,timeFormat:e.axisLabel.timeFormat,valueFormat:e.axisLabel.valueFormat,formatter:g=>e.type==="time"?c.dayjs(g).format(e.axisLabel.timeFormat):e.type==="value"?k(g,e.axisLabel.valueFormat):g},splitLine:{show:e.grid.show,lineStyle:{type:e.grid.line.type==="dashed"?[e.grid.line.dashedLength,e.grid.line.dashedSpace]:e.grid.line.type,width:e.grid.line.width,color:e.grid.line.color}},data:v.value.keys},yAxis:{show:i.show,type:"value",name:i.title.show?i.title.name:"",nameLocation:i.title.location,nameRotate:i.title.display.rotate,nameGap:i.title.display.offset,nameTextStyle:{...i.title.textStyle},axisLine:{show:i.axisLine.show,lineStyle:{type:i.axisLine.type,width:i.axisLine.width,color:i.axisLine.color}},axisTick:{show:i.axisTick.show,lineStyle:{type:i.axisTick.type,width:i.axisTick.width,color:i.axisTick.color},alignWithLabel:!0},boundaryGap:[`${i.axisLabel.boundaryGap}%`,`${i.axisLabel.boundaryGap}%`],axisLabel:{show:i.axisLabel.show,rotate:i.axisLabel.display.rotate,margin:i.axisLabel.display.margin,align:i.axisLabel.align,...i.axisLabel.textStyle,valueFormat:i.axisLabel.valueFormat,formatter:g=>k(g,i.axisLabel.valueFormat)},splitLine:{show:i.grid.show,lineStyle:{type:i.grid.line.type==="dashed"?[i.grid.line.dashedLength,i.grid.line.dashedSpace]:i.grid.line.type,width:i.grid.line.width,color:i.grid.line.color}},min:S(i.extent.min),max:S(i.extent.max),splitNumber:i.splitNumber>0?i.splitNumber:null},animation:p.enabled,animationDuration:p.duration,animationEasing:p.easing,animationDelay:p.delay,series:B()};return JSON.parse(JSON.stringify(A))});return{wrapperStyle:G,option:N,onClick:n=>{y("click",{...n.data.dataRef,x:n.name,y:n.value})}}}});function $(t,l,y,m,h,b){const x=o.resolveComponent("v-echart");return o.openBlock(),o.createElementBlock("div",{class:"datav-wrapper",style:o.normalizeStyle(t.wrapperStyle)},[o.createVNode(x,{option:t.option,autoresize:"",onClick:t.onClick},null,8,["option","onClick"])],4)}var f=T(C,[["render",$],["__file","F:/datav-jlhe/src/components/bar/basic-bar/src/index.vue"]]);f.install=t=>{t.component("DatavBasicBar",f)},window.datavVue&&window.datavVue.app&&window.datavVue.app.use(f)});
