// env=undefined => env=publish 
Cube("datav:/com/datav-2dmap-vector-scatter/3.0.24/src/polygon.js",[],function(t,e,s,i,r,o){function c(t,e){this.x=t,this.y=e}function h(t,e,s,i){this.x=t,this.y=e,this.radius=s,this.sides=i,this.vertices=function(t,e,s,i){for(var r=[],o=0,h=2*Math.PI/i,a=0;a<i;a++)r.push(new c(t+s*Math.sin(o),e-s*Math.cos(o))),o+=h;return r}(t,e,s,i),this.strokeStyle="black",this.fillStyle="rgba(200, 200, 200, 1)"}return h.prototype={createPath:function(t){t.save(),t.beginPath(),t.moveTo(this.vertices[0].x,this.vertices[0].y);for(var e=1;e<this.sides;e++)t.lineTo(this.vertices[e].x,this.vertices[e].y);t.closePath(),t.restore()},stroke:function(t){t.save(),this.createPath(t),t.strokeStyle=this.strokeStyle,t.stroke(),t.restore()},fill:function(t){t.save(),this.createPath(t),t.fillStyle=this.fillStyle,t.fill(),t.restore()}},t.exports=h,t.exports});;
Cube("datav:/com/datav-2dmap-vector-scatter/3.0.24/src/vector",[],function(t,e,c,a,i,o){function f(t,e){for(var a=0;a<e.length;a++){var i=e[a];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,i.key,i)}}function g(t){return(g="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}return t.exports=function(t){var q=t.map,s=t.L,t=t.Utils,d=t.Chroma,e=t.RBush,h=t.geojsonBBox,J=t.measureText,r=t.mergeOptions,u=t.getDashArray,l=q.options.padding;function m(t,e){return t.offset-e.offset}CanvasRenderingContext2D.prototype.roundRect=function(t,e,a,i,o){var r=o.border,n=o.borderRadius,o=o.background,n={topRight:n.topRight>a||n.topRight>i?Math.min(a,i):n.topRight,bottomRight:n.bottomRight>a||n.bottomRight>i?Math.min(a,i):n.bottomRight,bottomLeft:n.bottomLeft>a||n.bottomLeft>i?Math.min(a,i):n.bottomLeft,topLeft:n.topLeft>a||n.topLeft>i?Math.min(a,i):n.topLeft},h=n.topLeft,s=n.topRight,l=n.bottomLeft,n=n.bottomRight;if(t+=r.weight/2,e+=r.weight/2,this.beginPath(),this.moveTo(t+h,e),this.arcTo(t+a,e,t+a,e+i,s),this.arcTo(t+a,e+i,t,e+i,n),this.arcTo(t,e+i,t,e,l),this.arcTo(t,e,t+a,e,h),this.closePath(),"linearGradient"===o.type){for(var c,s=o.value,n=s.angle,f=s.stops.sort(m),l=[a/2+Math.cos((n+180)/180*Math.PI)*a/2,i/2+Math.sin((n+180)/180*Math.PI)*i/2],t=[a/2+Math.cos(n/180*Math.PI)*a/2,i/2+Math.sin(n/180*Math.PI)*i/2],g=this.createLinearGradient(l[0],l[1],t[0],t[1]),d=0;d<f.length;d++)c=f[d],g.addColorStop(c.offset/100,c.color);this.fillStyle=g}else"flat"==o.type&&(this.fillStyle=o.value||"rgba(255,255,0,0.1)");return this.fill(),0<r.weight&&(this.lineWidth=r.weight,this.strokeStyle=r.color,this.setLineDash&&(e=u(r.dashArray),this.setLineDash(e)),this.stroke()),this};var a,i,n=c("datav:/com/datav-2dmap-vector-scatter/3.0.24/src/polygon.js");return t=o,(a=[{key:"setData",value:function(t){for(var e,a,i=t.features,o=[],r=0,n=i.length;r<n;r++)e=i[r],a=h(e),o.push({minX:a[0],minY:a[1],maxX:a[2],maxY:a[3],feature:e});this.rbush.dirty=o.length,this.rbush.total=o.length,this.rbush.clear(),0<o.length&&this.rbush.load(o)}},{key:"setOptions",value:function(t){this.options=r(this.options,t);var e,a,i=this.options.mappingStyle,s=this,l=[];for(e in i)"symbol"===(a=i[e]).style.markerType&&a.style.marker&&l.push(a.style.marker);l=function(t){for(var e,a,i={},o=[],r=t.length,n=0;n<r;n++)a=g(e=t[n]),i[e]?i[e].indexOf(a)<0&&(i[e].push(a),o.push(e)):(i[e]=[a],o.push(e));return o}(l),new Promise(function(e,a){for(var t,i=[],r=l.length,n=0,h=0;h<r;h++)!function(){var o=l[h];t=new Promise(function(a,t){s.imageUrls[o]&&a(!0);var i=new Image;i.crossOrigin="anonymous",i.onload=function(){var t=document.createElement("canvas"),e=t.getContext("2d");t.width=i.width,t.height=i.height,e.imageSmoothingQuality="high",e.drawImage(i,0,0,i.width,i.height),s.imageUrls[o]={canvas:t,colorCanvas:{}},a(!0)},i.onerror=function(){t(new Error("Could not load image at ".concat(o)))},i.src=o}),i.push(t),Promise.all(i).then(function(t){++n==r&&e(!0)}).catch(function(t){++n==r&&a(!1)})}()}).then(function(t){t&&s.layer.onRender()}).catch(function(t){})}},{key:"getFeaturesInBounds",value:function(){for(var t=q.getBounds().pad(l),t={minX:t.getWest(),minY:t.getSouth(),maxX:t.getEast(),maxY:t.getNorth()},e=(this.options.labelStyle.fieldName,this.rbush.search(t)),a=0;a<e.length;a++){var i=(o=e[a].feature).geometry,o=o.properties,i=i.coordinates,i=q.latLngToContainerPoint([i[1],i[0]]),r=[],n=Math.round(i.x-q.options.offset.x),h=Math.round(i.y-q.options.offset.y),h=(e[a].feature.geometry._coordinates=r=i?[n,h]:r,h=(n=this.options.mappingStyle[o.data_index].style).radius,r=n.radius,o=s.point(i.x-h,i.y+r),n=s.point(i.x+h,i.y-r),q.containerPointToLatLng(o)),i=q.containerPointToLatLng(n);e[a].minX=h.lng,e[a].minY=h.lat,e[a].maxX=i.lng,e[a].maxY=i.lat}this.featuresInBounds=e,this.rbushInBounds.clear(),this.rbushInBounds.load(e)}},{key:"getFeatures",value:function(){for(var t=this.featuresInBounds,e=[],a=0;a<t.length;a++){var i,o=(i=t[a].feature).properties.data_index;o&&this.options.mappingStyle[o]&&(i.properties=r(i.properties,this.options.mappingStyle[o])),e.push(i)}return this.features=e,this.features}},{key:"onRender",value:function(t,e){if(e&&(this.getFeaturesInBounds(),this.getFeatures()),this.options.interaction)for(var a,i=0;i<this.features.length;i++)if(a=this.features[i],q.featureSelect&&q.featureSelect.geometry.coordinates==a.geometry.coordinates){this.features.push(this.features.splice(i,1)[0]);break}this.draw(t)}},{key:"draw",value:function(t){var s,l=this,e=l.options,a=e.general,e=e.label;t.globalAlpha=.01*+a.opacity,l.drawMarkers(t),e.isShow&&("vector"===e.backgroundStyle.backgroundType||l.imageUrls[e.backgroundStyle.imageUrl]?l.drawLables(t):"image"!==e.backgroundStyle.backgroundType||l.imageUrls[e.backgroundStyle.imageUrl]||(s=[e.backgroundStyle.imageUrl],new Promise(function(e,a){for(var t,i=[],r=s.length,n=0,h=0;h<r;h++)!function(){var o=s[h];t=new Promise(function(a,t){var i=new Image;i.onload=function(){var t=document.createElement("canvas"),e=t.getContext("2d");t.width=i.width,t.height=i.height,e.drawImage(i,0,0,t.width,t.height),l.imageUrls[o]=t,a(!0)},i.onerror=function(){t(new Error("Could not load image at ".concat(o)))},i.src=o}),i.push(t),Promise.all(i).then(function(t){++n==r&&e(!0)}).catch(function(t){++n==r&&a(!1)})}()}).then(function(t){t&&l.layer.onRender()}).catch(function(t){})))}},{key:"drawMarkers",value:function(t){for(var e,a,i=this.options,o=i.graph,r=i.interaction,n=1,h=0;h<this.features.length;h++)if(e=this.features[h],n=1,r.graph.show&&q.featureSelect&&q.featureSelect.geometry.coordinates==e.geometry.coordinates&&(n=r.graph.sizeScale),0<(a=this.options.mappingStyle[e.properties.data_index].style).radius)switch(o.markerType){case"vector":this.drawVectorMarker(t,e,a.radius*n,a);break;case"symbol":this.drawSymbolMarker(t,e,a.radius*n,a)}}},{key:"drawVectorMarker",value:function(t,e,a,i){var e=e.geometry._coordinates,o=e[0],e=e[1];if(t.fillStyle=i.fillColor,t.beginPath(),"circle"===i.marker||"Circle"===i.marker||"圆"===i.marker)this.drawCircle(t,o,e,a);else if("rectangle"===i.marker||"Rectangle"===i.marker||"矩形"===i.marker)t.rect(o-a,e-a,2*a,2*a);else if("pentacle"===i.marker||"Pentacle"===i.marker||"五角形"===i.marker)this.drawStar(t,.5*a,a,o,e,0);else{var r=3;switch(i.marker){case"三角形":case"triangle":case"Triangle":r=3;break;case"五边形":case"pentagon":case"Pentagon":r=5;break;case"六边形":case"hexagon":case"Hexagon":r=6}new n(o,e,a,r).createPath(t)}t.fill();o=i.weight;0<o&&(t.lineWidth=o,t.strokeStyle=i.strokeColor,t.stroke())}},{key:"drawSymbolMarker",value:function(t,e,a,i){var e=e.geometry._coordinates,o=e[0],e=e[1];if(this.imageUrls[i.marker]){var r=this.imageUrls[i.marker],n=r.canvas,r=r.colorCanvas;if(!r[i.fillColor]){for(var h=document.createElement("canvas"),s=(h.width=n.width,h.height=n.height,h.getContext("2d")),l=n.getContext("2d").getImageData(0,0,n.width,n.height),c=l.data,f=d(i.fillColor).rgba(),g=0;g<n.width*n.height;g++)(0<c[4*g+0]||0<c[4*g+1]||0<c[4*g+2]||0<c[4*g+3])&&(c[4*g+0]=f[0],c[4*g+1]=f[1],c[4*g+2]=f[2],c[4*g+3]=c[4*g+3]*f[3]);s.putImageData(l,0,0,0,0,n.width,n.height),r[i.fillColor]=h}t.drawImage(r[i.fillColor],o-a,e-a,2*a,2*a)}}},{key:"drawCircle",value:function(t,e,a,i){t.arc(e,a,i,0,2*Math.PI)}},{key:"drawStar",value:function(t,e,a,i,o,r){for(var n=0;n<5;n++)t.lineTo(Math.cos((18+72*n-r)/180*Math.PI)*a+i,-Math.sin((18+72*n-r)/180*Math.PI)*a+o),t.lineTo(Math.cos((54+72*n-r)/180*Math.PI)*e+i,-Math.sin((54+72*n-r)/180*Math.PI)*e+o);t.closePath()}},{key:"drawLables",value:function(t){var e=this.options,E=e.interaction,e=e.label,a=e.eventType,X=e.position,i=e.contentStyle,o=e.backgroundStyle,r=i.lineSeries,n=i.fieldWidth,Y=i.lineHeight,h=i.textBorder;if(0!=r.length)for(var _=r[0].content,D=r[0].fieldName,O=(t.textAlign="left",t.textBaseline="middle",Object.assign({},e.offset)),s=0;s<this.features.length;s++){var l,c=(l=this.features[s]).geometry,f=l.properties;if(q.featureSelect&&q.featureSelect.geometry.coordinates==l.geometry.coordinates){if("click"==a&&"click"!=q.EventType||"mouseover"==a&&"mouseover"!=q.EventType)continue}else if("all"!=a)continue;if(u=this.options.mappingStyle[f.data_index].style,f[D]){for(var g=+u.radius,d=+u.radius,u=c._coordinates,m=(J(f[D]).width,_.fontSize,u[0]+O.x),p=u[1]-O.y,y=void 0,w=0,b=0,A=0,v=0;v<r.length;v++){var k=y=r[v],S=k.content,x=k.prefix,k=k.suffix,M=J(f[y.fieldName],S.fontFamily,S.fontWeight,S.fontSize).width;switch(n.widthAdapt){case"adapt":M=Math.min(M,n.maxWidth);break;case"fixedWidth":M=n.fixedWidth}b=M,x.show&&(b+=+x.padding+J(x.name,x.fontFamily,x.fontWeight,x.fontSize).width),k.show&&(b+=+k.padding+J(k.name,k.fontFamily,k.fontWeight,k.fontSize).width),w=Math.max(b,w),A+=Math.max(x.fontSize,S.fontSize,k.fontSize)}for(var T={left:0,right:0,top:0,bottom:0},I={width:w+(T=o.show?o.margin:T).left+T.right,height:A*Y+T.top+T.bottom},c=o.border,u=document.createElement("canvas"),P=("vector"===o.backgroundType?(u.width=2*(I.width+c.weight),u.height=2*(I.height+c.weight),u.style.width="".concat(I.width+c.weight,"px"),u.style.height="".concat(I.height+c.weight,"px")):"image"==o.backgroundType&&(u.width=2*I.width,u.height=2*I.height,u.style.width="".concat(I.width,"px"),u.style.height="".concat(I.height,"px")),u.getContext("2d")),C=(P.scale(2,2),o.show&&("vector"===o.backgroundType?P.roundRect(0,0,I.width,I.height,o):"image"==o.backgroundType&&this.imageUrls[o.imageUrl]&&P.drawImage(this.imageUrls[o.imageUrl],0,0,I.width,I.height)),P.strokeStyle=h.color,P.lineWidth=h.weight,P.textBaseline="bottom",T.top),N=0;N<r.length;N++){var W=y=r[N],z=W.content,L=W.prefix,W=W.suffix,R=(C+=Math.max(L.fontSize,z.fontSize,W.fontSize)*Y,J(f[y.fieldName],z.fontFamily,z.fontWeight,z.fontSize).width,L.show&&(P.font="".concat(L.fontWeight," ").concat(L.fontSize,"px ").concat(L.fontFamily),P.fillStyle=L.color,h.show&&P.strokeText(L.name,T.left,C),P.fillText(L.name,T.left,C)),P.font="".concat(z.fontWeight," ").concat(z.fontSize,"px ").concat(z.fontFamily),P.fillStyle=z.color,f[y.fieldName]),j=J(R,z.fontFamily,z.fontWeight,z.fontSize).width,B=0;switch(n.widthAdapt){case"adapt":B=Math.min(j,n.maxWidth);break;case"fixedWidth":B=n.fixedWidth}if(B<j){for(var G=0,H=0,V=P.measureText("...",z.fontFamily,z.fontWeight,z.fontSize).width,Q=0;Q<R.length;Q++)(G+=P.measureText(R[Q],z.fontFamily,z.fontWeight,z.fontSize).width)<B-V&&H++;R="".concat(R.substring(0,H),"...")}var F=T.left;L.show&&(F+=L.padding+J(L.name,L.fontFamily,L.fontWeight,L.fontSize).width),h.show&&P.strokeText(R,F,C),P.fillText(R,F,C),W.show&&(P.font="".concat(W.fontWeight," ").concat(W.fontSize,"px ").concat(W.fontFamily),P.fillStyle=W.color,B=Math.min(B,j),h.show&&P.strokeText(W.name,F+B+W.padding,C),P.fillText(W.name,F+B+W.padding,C))}var U;if(E.graph.show&&q.featureSelect&&q.featureSelect.geometry.coordinates==l.geometry.coordinates){switch(U=E.graph.sizeScale,X){case"top":m-=I.width/2*U,p-=d+I.height*U+f.style.radius*(U-1);break;case"bottom":m-=I.width/2*U,p+=f.style.radius*U;break;case"left":m-=g+I.width*U+f.style.radius*(U-1),p-=I.height/2*U;break;case"right":m+=g+f.style.radius*(U-1),p-=I.height/2*U;break;case"center":m-=I.width/2*U,p-=I.height/2*U}t.drawImage(u,m,p,(I.width+c.weight)*U,(I.height+c.weight)*U)}else{switch(X){case"top":m-=I.width/2,p-=d+I.height;break;case"bottom":m-=I.width/2,p+=d;break;case"left":m-=g+I.width,p-=I.height/2;break;case"right":m+=g,p-=I.height/2;break;case"center":m-=I.width/2,p-=I.height/2}t.drawImage(u,m,p,I.width+c.weight,I.height+c.weight)}}}}},{key:"contains",value:function(t){var e,a,i,o,t={minX:t.lng,minY:t.lat,maxX:t.lng,maxY:t.lat},t=this.rbushInBounds.search(t);return 0===t.length?{flag:!1,feature:null}:(e=t[t.length-1].feature,a=t[t.length-1].minX,i=t[t.length-1].minY,o=t[t.length-1].maxX,{flag:!0,feature:e,featureBounds:[[i,a],[t[t.length-1].maxY,o]]})}}])&&f(t.prototype,a),i&&f(t,i),Object.defineProperty(t,"prototype",{writable:!1}),o;function o(t){if(!(this instanceof o))throw new TypeError("Cannot call a class as a function");this.options=r({zIndex:0,tolerance:3,smoothFactor:1,mappingStyle:{},labelStyle:{}},t),this.rbush=new e,this.rbush.dirty=0,this.rbush.total=0,this.rbushInBounds=new e,this.featuresInBounds=[],this.features=[],this.imageUrls={}}},t.exports});;
Cube("datav:/com/datav-2dmap-vector-scatter/3.0.24/config",[],function(o,e,t,r,a,i){return o.exports={DEFAULT_OPTIONS:{renderer:"canvas",general:{zoomRange:[0,18],minZoom:0,maxZoom:22},graph:{},popupStyle1:{isBorderShadow:!0,show:!0,infoField:!1,eventType:"click",styleType:"parent",textStyle:{fontFamily:"Microsoft Yahei",fontSize:12,color:"#FFFFFF",fontWeight:"normal"},lineHeight:1.4,borderRadius:5,margin:{top:10,bottom:10,left:10,right:10},backgroundColor:"rgba(22,138,214,0.73)",closeBtn:{color:"#fff",size:16,top:0,right:0}},interaction:{isHover:{hoverScale:1.5},usePopupStyle:!1,isOpenPopup:!0}}},o.exports});;
Cube("datav:/com/datav-2dmap-vector-scatter/3.0.24/src/vertorLayer",[],function(t,e,c,o,r,n){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function p(e,t){var o,r=Object.keys(e);return Object.getOwnPropertySymbols&&(o=Object.getOwnPropertySymbols(e),t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),r.push.apply(r,o)),r}function h(r){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?p(Object(n),!0).forEach(function(t){var e,o;e=r,o=n[t=t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(r,Object.getOwnPropertyDescriptors(n)):p(Object(n)).forEach(function(t){Object.defineProperty(r,t,Object.getOwnPropertyDescriptor(n,t))})}return r}function f(t,e){for(var o=0;o<e.length;o++){var r=e[o];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(t,r.key,r)}}function y(){return(y="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(t,e,o){var r=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=b(t)););return t}(t,e);if(r)return(r=Object.getOwnPropertyDescriptor(r,e)).get?r.get.call(arguments.length<3?t:o):r.value}).apply(this,arguments)}function g(t,e){return(g=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(t,e){return t.__proto__=e,t})(t,e)}function v(o){var r=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=b(o),e=(t=r?(t=b(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===i(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}return t.exports=function(t){var s=t.L,l=t.map,e=t.Utils,o=t.Layer,d=t.GuiUtils,m=e._,r=e.arr2geojson,u=e.mergeOptions,n=c("datav:/com/datav-2dmap-vector-scatter/3.0.24/src/vector")(t),e=a,t=o;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&g(e,t);var i,p=v(a);function a(t){var e;if(this instanceof a)return(e=p.call(this)).addTo(l),e.options=u({},t),e.options.general.minZoom=t.general.zoomRange[0],e.options.general.maxZoom=t.general.zoomRange[1],e.options.visibility=!0,e.init(),e;throw new TypeError("Cannot call a class as a function")}return e=a,(t=[{key:"init",value:function(){this.mappingData=[],this.geojson=null,this.popups={},this.getGeojsonStyle=this.getGeojsonStyle.bind(this),this.getMappingStyle=this.getMappingStyle.bind(this);var t=u({zIndex:0},this.options);this.vector=new n(t),(this.vector.layer=this).addLayer(this.vector)}},{key:"render",value:function(t){this.mappingData=[],t&&0<t.length&&(this.mappingData=t);t=this.getGeojsonStyle(),this.vector.setOptions(t),t=r(this.mappingData);this.vector.setData(t),this.onRender(!0)}},{key:"getGeojsonStyle",value:function(){var t=this.options,e=t.general,o=t.graph,r=t.interaction;return{general:e,label:t.label,graph:o,interaction:r,mappingStyle:this.getMappingStyle()}}},{key:"getMappingStyle",value:function(){for(var t,e,o=this.options.graph,r=o.stroke,n=this.mappingData,i=d.validateCustomStyle,p=m.get(this.options,"condition.condition"),a=m.get(d,"scale.marker")({config:m.get(this.options,"graph.markerMapping"),data:n,field:"shapeField"}),s=m.get(d,"scale.marker")({config:m.get(this.options,"graph.symbolMarkerMapping"),data:n,field:"shapeField"}),l=m.get(d,"scale.size")({config:m.get(this.options,"graph.sizeMapping"),data:n,field:"radiusField"}),u=m.get(d,"scale.color")({config:m.get(this.options,"graph.colorMapping"),data:n,field:"colorField"}),c={},h=0;h<n.length;h++){var f,y,g={};if((y=i({config:p,data:f=n[h],ruleKey:"rules"}))&&y.length){if("vector"==o.markerType){for(t=y.length-1;0<=t&&(e=y[t]).graph.show;t--)if(e.graph.marker.show){g.marker=e.graph.marker.value;break}for(t=y.length-1;0<=t&&(e=y[t]).graph.show;t--)if(e.graph.stroke.show){g.strokeColor=e.graph.stroke.strokeColor,g.weight=e.graph.stroke.weight;break}}else if("symbol"==o.markerType)for(t=y.length-1;0<=t&&(e=y[t]).graph.show;t--)if(e.graph.symbolMarker.show){g.marker=e.graph.symbolMarker.value;break}for(t=y.length-1;0<=t&&(e=y[t]).graph.show;t--)if(e.graph.radius.show){g.radius=e.graph.radius.value;break}for(t=y.length-1;0<=t&&(e=y[t]).graph.show;t--)if(e.graph.fillColor.show){g.fillColor=e.graph.fillColor.value;break}}g.hasOwnProperty("marker")||("vector"==o.markerType?(g.markerType="vector",g.marker=a(f.shapeField)):"symbol"==o.markerType&&(g.markerType="symbol",g.marker=s(f.shapeField))),g.hasOwnProperty("radius")||(g.radius=l(f.radiusField)),g.hasOwnProperty("fillColor")||(g.fillColor=u(f.colorField)),"vector"==o.markerType&&(g.hasOwnProperty("strokeColor")||(g.strokeColor=r.strokeColor),g.hasOwnProperty("weight")||(g.weight=r.weight)),f.style=g,c[f.data_index]=f}return c}},{key:"updateOptions",value:function(t){this.options=u(this.options,t),this.options.general.minZoom=t.general.zoomRange[0],this.options.general.maxZoom=t.general.zoomRange[1],this.infoPopup&&(this.infoPopup&&!this.options.popupStyle.isShow&&this.infoPopup.remove(),s.customPopup.updatePopupStyle(this.infoPopup,this.convertToRootPopupStyle(this.options.popupStyle)));t=this.getGeojsonStyle();this.vector.setOptions(t),this.onRender(!0)}},{key:"onClick",value:function(t){var e=this.options.popupStyle;e.isShow&&"click"===e.eventType&&this._openPopup(t)}},{key:"onMouseOver",value:function(t){var e=this.options.popupStyle;e.isShow&&"mouseover"===e.eventType&&this._openPopup(t)}},{key:"convertToRootPopupStyle",value:function(t){var e=t.domStyle,o=e.padding,r=e.border,n=e.boxShadow,i=e.backgroundColor,p=e.closeBtn,e=e.tipBtn,a=t.textStyle,t=t.offset;return{background:h({color:i},n),padding:o,border:r,closeBtn:p,tipBtn:e,textStyle:a,offset:t}}},{key:"_openPopup",value:function(t){var e=t.feature,o=e.geometry,r=e.properties,n=r.popupType,i=this.popups[n],p=this.options,a=p.general,p=p.popupStyle,o=o.coordinates,t="click"===p.eventType?t.latlng:{lat:o[1],lng:o[0]};if(n&&i){o=p.offset,n=u({},o),p={L:s,map:l,latlng:t,feature:e,offset:n,bindPopup:i,minZoom:a.minZoom,maxZoom:a.maxZoom};s.customPopup.openPopup(p)}else{o=this.convertToRootPopupStyle(this.options.popupStyle);if(!m.isEmpty(r.info))return e=s.popup({}).setLatLng(t).setContent(r.info).openOn(l),this.infoPopup=e,void s.customPopup.updatePopupStyle(e,o);if(this.options.popupStyle.isEmptyShow)return n=s.popup({}).setLatLng(t).setContent("无数据").openOn(l),this.infoPopup=n,void s.customPopup.updatePopupStyle(n,o);this.infoPopup&&this.infoPopup.remove()}this.infoPopup=null}},{key:"bindGroup",value:function(t,e,o){var r=+e.clientWidth,n=+e.clientHeight,i=(e.style.transform="",e.style.position="",e.style.display="none",s.popup({maxWidth:1200,maxHeight:1200,isCustomPopup:!0}));this.popups[t]={popup:i,container:e,clientWidth:r,clientHeight:n,popupStyle:o}}},{key:"draw",value:function(t){var e=this.options.general;this.ctx.clearRect(0,0,this.container.width,this.container.height),this.vector&&this.vector.draw(this.ctx),t.globalAlpha=.01*+e.opacity,this.container&&t.drawImage(this.container,0,0,this.container.width,this.container.height)}},{key:"show",value:function(){this.onRender(!0),this.options.visibility=!0}},{key:"hide",value:function(){y(b(a.prototype),"hide",this).call(this),this.options.visibility=!1}},{key:"destroy",value:function(){this.options=null,this.mappingData=null,this.geojson=null,this.group=null,delete this.options,this.mappingData,this.geojson,this.group}}])&&f(e.prototype,t),i&&f(e,i),Object.defineProperty(e,"prototype",{writable:!1}),a},t.exports});;
Cube("datav:/com/datav-2dmap-vector-scatter/3.0.24",["datav:/npm/eventemitter3/3.0.0","datav:/npm/safely-merge/1.0.1"],function(e,t,r,o,n,i){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function s(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function l(e,t){return(l=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function u(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=c(r),t=(e=o?(e=c(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var y=r("datav:/npm/eventemitter3/3.0.0"),p=r("datav:/npm/safely-merge/1.0.1"),f=r("datav:/com/datav-2dmap-vector-scatter/3.0.24/src/vertorLayer"),h=r("datav:/com/datav-2dmap-vector-scatter/3.0.24/config").DEFAULT_OPTIONS,r=function(){var e=n,t=y;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&l(e,t);var r,o=u(n);function n(e,t){var r;if(this instanceof n)return r=o.call(this),t=t.options,r.options=p(h,t),r.options.general.minZoom=t.general.zoomRange[0],r.options.general.maxZoom=t.general.zoomRange[1],r.options.visibility=!0,r;throw new TypeError("Cannot call a class as a function")}return e=n,(t=[{key:"addTo",value:function(e,t){this.options.id=t;t=f(e);return this.layer=new t(this.options),this}},{key:"render",value:function(e){var t=[],r=0;if(e&&e.length){for(var o,n=0;n<e.length;n++)(o=e[n]).data_index=n+1,Number.isFinite(parseFloat(o.lng))&&Number.isFinite(parseFloat(o.lat))?t.push(o):r++;0<r&&console.log("矢量散点层：有 ".concat(r," 条异常数据。"))}this.layer&&this.layer.render&&this.layer.render(t)}},{key:"resize",value:function(e,t){this.layer&&this.layer.resize&&this.layer.resize(e,t)}},{key:"updateOptions",value:function(e){e=e.options;this.options=p(this.options,e),this.options.general.minZoom=e.general.zoomRange[0],this.options.general.maxZoom=e.general.zoomRange[1],this.layer&&this.layer.updateOptions&&this.layer.updateOptions(e)}},{key:"onZoomEnd",value:function(e){}},{key:"onClick",value:function(e){var t=e.feature;t&&t.properties&&this.emit("click",t.properties),this.layer&&this.layer.onClick&&this.layer.onClick(e)}},{key:"onMouseOver",value:function(e){var t=e.feature;t&&t.properties&&this.emit("mouseover",t.properties),this.layer&&this.layer.onMouseOver&&this.layer.onMouseOver(e)}},{key:"bindGroup",value:function(e){var t=e.popupType||"",r=e.container||"<div></div>",e=e.popupStyle||{};this.layer&&this.layer.bindGroup&&this.layer.bindGroup(t,r,e)}},{key:"draw",value:function(e){this.layer&&this.layer.draw&&this.layer.draw(e)}},{key:"show",value:function(){this.options.visibility=!0,this.layer&&this.layer.show&&this.layer.show()}},{key:"hide",value:function(){this.options.visibility=!1,this.layer&&this.layer.hide&&this.layer.hide()}},{key:"contains",value:function(e){var t=this.options.interaction,r=t.graph,t=t.popup;return!(!r.show&&!t.show)&&this.layer.contains(e)}},{key:"onRender",value:function(e){this.layer&&this.layer.onRender&&this.layer.onRender(e)}},{key:"destroy",value:function(){this.layer&&this.layer.destroy&&this.layer.destroy(),this.layer=null,delete this.layer}}])&&s(e.prototype,t),r&&s(e,r),Object.defineProperty(e,"prototype",{writable:!1}),n}();return e.exports=r,e.exports});