// env=undefined => env=publish 
Cube("datav:/com/@double11-2017/double11-2017-icon-chart/0.2.3",["datav:/npm/bcore/0.0.18/event","datav:/npm/jquery/2.1.4","datav:/npm/lodash/4.6.1"],function(a,b,c){var d=c("datav:/npm/bcore/0.0.18/event"),e=c("datav:/npm/jquery/2.1.4"),f=c("datav:/npm/lodash/4.6.1");return a.exports=d.extend(function(a,b){this.config={theme:{}},this.container=e(a),this.apis=b.apis,this._data=null,this.chart=null,this.init(b)},{init:function(a){this.mergeConfig(a),this.updateLayout(),this.updateStyle()},render:function(a,b){if(a=this.data(a),a&&a.length){this.container.empty(),this.container.append("<div class=\"icons\"></div><div class=\"text\"></div>");var c=this.container.find(".icons"),d=this.container.find(".text");c.css("position","relative");var g=this.mergeConfig(b);this.container.css({"font-family":"\""+g.style.fontFamily+"\""});var h=g.women,j=g.men,k=g.textDistance,l=g.iconDistance,m=0,n=0;if(a.length)for(var o=0;o<a.length;o++)"men"==a[o].name?m=a[o].value:"women"==a[o].name&&(n=a[o].value);1!==m+n&&0!==n?(m=f.toNumber((1-n).toFixed(g.decimal+2)),n=f.toNumber(n.toFixed(g.decimal+2))):this.trueValue(a,g);var i=this.container.width(),p=this.container.height()-d.outerHeight();c.height(p);var q=e("<div></div>"),r=e("<div></div>");if(q.css({width:g.style.iconWidth,height:g.style.iconHeight,background:j?"url("+j+")":"#1371FB",top:p/4,position:"absolute","background-size":"100% 100%","background-position":"center center","background-repeat":"no-repeat"}),c.append(q),r.css({width:g.style.iconWidth,height:g.style.iconHeight,background:h?"url("+h+")":"#922EF4",top:p/4,position:"absolute","background-size":"100% 100%","background-position":"center center","background-repeat":"no-repeat"}),c.append(r),"men"===a[0].name?(q.css({left:this.container.width()/2-g.style.iconWidth/2-g.style.iconPosition+"px"}),r.css({right:this.container.width()/2-g.style.iconWidth/2-g.style.iconPosition+"px"})):(q.css({right:this.container.width()/2-g.style.iconWidth/2-g.style.iconPosition+"px"}),r.css({left:this.container.width()/2-g.style.iconWidth/2-g.style.iconPosition+"px"})),"vertical"===g.direction)d.css({"font-size":g.style.fontSize,color:g.style.color,"margin-top":-g.textDis,"font-family":"\""+g.style.fontFamily+"\""}),d.append("<span>"+("men"===a[0].name?(100*m).toFixed(g.decimal):(100*n).toFixed(g.decimal))+"%</span>"),d.append("<span>"+("men"===a[0].name?(100*n).toFixed(g.decimal):(100*m).toFixed(g.decimal))+"%</span>"),d.find("span").eq(1).css({float:"right","margin-right":l+"px"}),d.find("span").eq(0).css({"padding-left":l+"px"});else{q.append("<div class=\"menSpan\"><p>"+g.menLabel+"</p><p>"+(100*m).toFixed(g.decimal)+"%</p></div>"),r.append("<div class=\"womenSpan\"><p>"+g.womenLabel+"</p><p>"+(100*n).toFixed(g.decimal)+"%</p></div>");var s=this.container.find(".menSpan"),t=this.container.find(".womenSpan");s.css({"margin-left":k+"px",display:"inline-block","font-size":g.style.fontSize,color:g.style.color}),t.css({"margin-left":k+"px",display:"inline-block","font-size":g.style.fontSize,color:g.style.color}),s.find("p").css({margin:0,"padding-top":g.textPadding+"px","font-family":"\""+g.style.fontFamily+"\""}),t.find("p").css({margin:0,"font-family":"\""+g.style.fontFamily+"\"","padding-top":g.textPadding+"px"})}}},resize:function(a,b){this.updateLayout(a,b)},setColors:function(){},data:function(a){return a&&(this._data=a),this._data},mergeConfig:function(a){return a?(this.config.theme=f.defaultsDeep(a.theme||{},this.config.theme),this.setColors(),this.config=f.defaultsDeep(a||{},this.config),this.config):this.config},updateLayout:function(){},updateStyle:function(){var a=this.config;this.container.css({"font-size":a.size+"px",color:a.color||"#fff"})},destroy:function(){this._data=null,this.container.empty()},trueValue:function(a){if(a&&a.length){this.container.empty(),this.container.append("<div class=\"icons\"></div><div class=\"text\"></div>");var b=this.container.find(".icons"),c=this.container.find(".text");b.css("position","relative");var d=this.config;this.container.css({"font-family":"\""+d.style.fontFamily+"\""});var g=d.women,h=d.men,j=d.textDistance,k=d.iconDistance,l=0,m=0;if(a.length)for(var n=0;n<a.length;n++)"men"==a[n].name?l=a[n].value:"women"==a[n].name&&(m=a[n].value);l=f.toNumber(l.toFixed(d.decimal+2)),m=f.toNumber(m.toFixed(d.decimal+2));var i=this.container.width(),o=this.container.height()-c.outerHeight();b.height(o);var p=e("<div></div>"),q=e("<div></div>");if(p.css({width:d.style.iconWidth,height:d.style.iconHeight,background:h?"url("+h+")":"#1371FB",top:o/4,position:"absolute","background-size":"100% 100%","background-position":"center center","background-repeat":"no-repeat"}),b.append(p),q.css({width:d.style.iconWidth,height:d.style.iconHeight,background:g?"url("+g+")":"#922EF4",top:o/4,position:"absolute","background-size":"100% 100%","background-position":"center center","background-repeat":"no-repeat"}),b.append(q),"men"===a[0].name?(p.css({left:this.container.width()/2-d.style.iconWidth/2-d.style.iconPosition+"px"}),q.css({right:this.container.width()/2-d.style.iconWidth/2-d.style.iconPosition+"px"})):(p.css({right:this.container.width()/2-d.style.iconWidth/2-d.style.iconPosition+"px"}),q.css({left:this.container.width()/2-d.style.iconWidth/2-d.style.iconPosition+"px"})),"vertical"===d.direction)c.css({"font-size":d.style.fontSize,color:d.style.color,"margin-top":-d.textDis,"font-family":"\""+d.style.fontFamily+"\""}),c.append("<span>"+("men"===a[0].name?(100*l).toFixed(d.decimal):(100*m).toFixed(d.decimal))+"%</span>"),c.append("<span>"+("men"===a[0].name?(100*m).toFixed(d.decimal):(100*l).toFixed(d.decimal))+"%</span>"),c.find("span").eq(1).css({float:"right","margin-right":k+"px"}),c.find("span").eq(0).css({"padding-left":k+"px"});else{p.append("<div class=\"menSpan\"><p>"+d.menLabel+"</p><p>"+(100*l).toFixed(d.decimal)+"%</p></div>"),q.append("<div class=\"womenSpan\"><p>"+d.womenLabel+"</p><p>"+(100*m).toFixed(d.decimal)+"%</p></div>");var r=this.container.find(".menSpan"),s=this.container.find(".womenSpan");r.css({"margin-left":j+"px",display:"inline-block","font-size":d.style.fontSize,color:d.style.color}),s.css({"margin-left":j+"px",display:"inline-block","font-size":d.style.fontSize,color:d.style.color}),r.find("p").css({margin:0,"padding-top":d.textPadding+"px","font-family":"\""+d.style.fontFamily+"\""}),s.find("p").css({margin:0,"font-family":"\""+d.style.fontFamily+"\"","padding-top":d.textPadding+"px"})}}},clean:function(){this.trueValue([{name:"men",value:0},{name:"women",value:0}])}}),a.exports});