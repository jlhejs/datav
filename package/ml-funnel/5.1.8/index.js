// env=undefined => env=publish 
Cube("datav:/com/ml-funnel/5.1.8/customRuleStyle",["datav:/npm/lodash/4.17.11/get","datav:/npm/lodash/4.17.11/set","datav:/npm/alibabacloud-datav-tool-gui-utils/1.0.0"],function(t,e,o,n,l,r){function a(e,t){var o,n=Object.keys(e);return Object.getOwnPropertySymbols&&(o=Object.getOwnPropertySymbols(e),t&&(o=o.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,o)),n}function c(n){for(var t=1;t<arguments.length;t++){var l=null!=arguments[t]?arguments[t]:{};t%2?a(Object(l),!0).forEach(function(t){var e,o;e=n,o=l[t=t],t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o}):Object.getOwnPropertyDescriptors?Object.defineProperties(n,Object.getOwnPropertyDescriptors(l)):a(Object(l)).forEach(function(t){Object.defineProperty(n,t,Object.getOwnPropertyDescriptor(l,t))})}return n}var u=o("datav:/npm/lodash/4.17.11/get"),s=o("datav:/npm/lodash/4.17.11/set"),d=o("datav:/com/ml-funnel/5.1.8/utils").transformGradientColor,i=o("datav:/npm/alibabacloud-datav-tool-gui-utils/1.0.0"),f=i.scale,p=i.validateCustomStyle,v=o("datav:/com/ml-funnel/5.1.8/utils").transLineDash,b=["fill"];return t.exports=function(){var t,o,n,e=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{},l=e.props,r=e.guiConfig,e=e.data,r=(void 0===r?{}:r).options,a=r.chart,i=a.fill,a=a.line,r=r.condition.customStyle;r=(l={props:void 0===l?{}:l,customStyle:r,fill:i,line:a,data:e}).props,t=l.customStyle,i=l.fill,o=l.line,l=l.data,n=u(f,"color.g2plot")({config:i,data:l,field:"type"}),s(r,"color",n),s(r,"funnelStyle",function(){var e={fill:n(arguments.length<=0?void 0:arguments[0]),lineDash:v(o),lineWidth:o.lineWidth,stroke:o.lineColor};return p({config:t,data:arguments.length<=0?void 0:arguments[0],ruleKey:"rules"}).forEach(function(o){var t=b.reduce(function(t,e){return o[e]&&o[e].show&&(t[e]=o[e]&&o[e].value),c(c({},t),d(t.fill))},{});Object.assign(e,t)}),e})},t.exports});;
Cube("datav:/com/ml-funnel/5.1.8/utils",["datav:/npm/lodash/4.17.11/toNumber","datav:/npm/lodash/4.17.11/map","datav:/npm/lodash/4.17.11/isUndefined","datav:/npm/lodash/4.17.11/forEach","datav:/npm/lodash/4.17.11/trim","datav:/npm/lodash/4.17.11/isNull","datav:/npm/lodash/4.17.11/isNumber","datav:/npm/lodash/4.17.11/isNaN","datav:/npm/moment/2.27.0","datav:/npm/d3-format/3.1.0"],function(t,a,n,L,o,e){function i(t){return(i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){var a=t.x,n=t.y,L=t.r,t=t.type,o=L/2*Math.sqrt(3),e=L*Math.sin(1/3*Math.PI);return{line:[["M",a-3*L,n],["L",a+3*L,n]],lineEllipsis:[["M",a-3*L,n],["L",a-2*L,n],["M",a-L,n],["L",a,n],["M",a+L,n],["L",a+2*L,n],["M",a+3*L,n],["L",a+4*L,n]],smooth:[["M",a-L,n],["A",L/2,L/2,0,1,1,a,n],["A",L/2,L/2,0,1,0,a+L,n]],smoothEllipsis:[["M",150,100],["C",150,72.4,72.4,50,100,50]],step:[["M",a-L-1,n-2.5],["L",a,n-2.5],["L",a,n+2.5],["L",a+L+1,n+2.5]],stepEllipsis:[["M",a-L-1,n-2.5],["L",a-L+3,n-2.5],["M",a-L/2+2,n-2.5],["L",a,n-2.5],["L",a,n+2.5],["L",a+4,n+2.5],["M",a+L/2+3,n+2.5],["L",a+L+1,n+2.5]],circle:[["M",a,n+L],["A",L,L,0,0,0,a+L,n],["M",a,n+L],["A",L,L,0,1,1,a+L,n]],circleLine:[["M",a-3*L,n],["L",a-L,n],["M",a+L,n],["L",a+3*L,n],["M",a,n+L],["A",L,L,0,0,0,a+L,n],["M",a,n+L],["A",L,L,0,1,1,a+L,n]],circleEllipsis:[["M",a-3*L,n],["L",a-2*L,n],["M",a-L-L/2,n],["L",a-L-2,n],["M",a+L+2,n],["L",a+L+L/2,n],["M",a+3*L,n],["L",a+2*L,n],["M",a,n+L],["A",L,L,0,0,0,a+L,n],["M",a,n+L],["A",L,L,0,1,1,a+L,n]],square:[["M",a-L,n-L],["L",a+L,n-L],["L",a+L,n+L],["L",a-L,n+L],["Z"]],squareLine:[["M",a-3*L,n],["L",a-L,n],["M",a+L,n],["L",a+3*L,n],["M",a-L,n-L],["L",a+L,n-L],["L",a+L,n+L],["L",a-L,n+L],["Z"]],squareEllipsis:[["M",a-3*L,n],["L",a-2*L,n],["M",a-L-L/2,n],["L",a-L-2,n],["M",a+L+2,n],["L",a+L+L/2,n],["M",a+3*L,n],["L",a+2*L,n],["M",a-L,n-L],["L",a+L,n-L],["L",a+L,n+L],["L",a-L,n+L],["Z"]],hexagon:[["M",a,n-L-2],["L",a+o+1,n-L/2-1],["L",a+o+1,n+L/2+1],["L",a,n+L+1+1],["L",a-o-1,n+L/2+1],["L",a-o-1,n-L/2-1],["Z"]],hexagonLine:[["M",a-3*L,n],["L",a-L-(L<=3?1:0),n],["M",a+L+(L<=3?1:0),n],["L",a+3*L,n],["M",a,n-L-2],["L",a+o+1,n-L/2-1],["L",a+o+1,n+L/2+1],["L",a,n+L+1+1],["L",a-o-1,n+L/2+1],["L",a-o-1,n-L/2-1],["Z"]],hexagonEllipsis:[["M",a-3*L,n],["L",a-2*L,n],["M",a-L-L/2,n],["L",a-L-1,n],["M",a+L+1,n],["L",a+L+L/2,n],["M",a+3*L,n],["L",a+2*L,n],["M",a,n-L-2],["L",a+o+1,n-L/2-1],["L",a+o+1,n+L/2+1],["L",a,n+L+1+1],["L",a-o-1,n+L/2+1],["L",a-o-1,n-L/2-1],["Z"]],diamond:[["M",a-L-2,n],["L",a,n-L-2],["L",a+L+2,n],["L",a,n+L+2],["Z"]],diamondLine:[["M",a-3*L,n],["L",a-L-1,n],["M",a+L+1,n],["L",a+3*L,n],["M",a-L-2,n],["L",a,n-L-2],["L",a+L+2,n],["L",a,n+L+2],["Z"]],diamondEllipsis:[["M",a-3*L,n],["L",a-2*L,n],["M",a-L-L/2,n],["L",a-L-2,n],["M",a+L+2,n],["L",a+L+L/2,n],["M",a+3*L,n],["L",a+2*L,n],["M",a-L-2,n],["L",a,n-L-2],["L",a+L+2,n],["L",a,n+L+2],["Z"]],triangle:[["M",a-L,n+e],["L",a,n-e],["L",a+L,n+e],["z"]],triangleLine:[["M",a-3*L,n],["L",a-L+L/2,n],["M",a+L-L/2,n],["L",a+3*L,n],["M",a-L,n+e],["L",a,n-e],["L",a+L,n+e],["z"]],triangleEllipsis:[["M",a-3*L,n],["L",a-2*L,n],["M",a-L-L/2,n],["L",a-L/2,n],["M",a+L/2,n],["L",a+L+L/2,n],["M",a+3*L,n],["L",a+2*L,n],["M",a-L,n+e],["L",a,n-e],["L",a+L,n+e],["z"]],"triangle-down":[["M",a-L,n-e],["L",a+L,n-e],["L",a,n+e],["Z"]],triangleDownLine:[["M",a-3*L,n],["L",a-L+L/2,n],["M",a+L-L/2,n],["L",a+3*L,n],["M",a-L,n-e],["L",a+L,n-e],["L",a,n+e],["Z"]],triangleDownEllipsis:[["M",a-3*L,n],["L",a-2*L,n],["M",a-L-L/2,n],["L",a-L/2,n],["M",a+L/2,n],["L",a+L+L/2,n],["M",a+3*L,n],["L",a+2*L,n],["M",a-L,n-e],["L",a+L,n-e],["L",a,n+e],["Z"]],bowtie:[["M",a-L,n-e],["L",a+L,n+e],["L",a+L,n-e],["L",a-L,n+e],["Z"]],bowtieLine:[["M",a-3*L,n],["L",a-L,n],["M",a+L,n],["L",a+3*L,n],["M",a-L,n-e],["L",a+L,n+e],["L",a+L,n-e],["L",a-L,n+e],["Z"]],bowtieEllipsis:[["M",a-3*L,n],["L",a-2*L,n],["M",a-L-L/2,n],["L",a-L-2,n],["M",a+L+2,n],["L",a+L+L/2,n],["M",a+3*L,n],["L",a+2*L,n],["M",a-L,n-e],["L",a+L,n+e],["L",a+L,n-e],["L",a-L,n+e],["Z"]]}[t]}var r=n("datav:/npm/lodash/4.17.11/toNumber"),s=n("datav:/npm/lodash/4.17.11/map"),M=n("datav:/npm/lodash/4.17.11/isUndefined"),d=n("datav:/npm/lodash/4.17.11/forEach"),m=n("datav:/npm/lodash/4.17.11/trim"),p=n("datav:/npm/lodash/4.17.11/isNull"),f=n("datav:/npm/lodash/4.17.11/isNumber"),c=n("datav:/npm/lodash/4.17.11/isNaN"),u="linear",h=n("datav:/npm/moment/2.27.0"),v=n("datav:/npm/d3-format/3.1.0").format;return t.exports={transLineDash:function(t){var a=t.lineStyle,n=t.dashedLength,L=t.dashedSpace,o=t.dottedLength,t=t.dottedSpace,e=[];return"solid"===a?e=[1,0]:"dashed"===a?e=[n,L]:"dotted"===a&&(e=[o,t]),e},transformGradientColor:function(t){var a,n,L;return"object"===i(t)?(n=t.type,a=t.value,"flat"===n?{fill:a}:(a=(n=t.value).angle,n=n.stops,L="",s(n,function(t){var a=t.offset,t=t.color;L+="".concat(a/100,":").concat(t," ")}),{fill:"l(".concat(a,") ").concat(m(L))})):{fill:t}},pathDFn:function(){var t=l(arguments.length<=0?void 0:arguments[0]),a="";return d(t,function(t){d(t,function(t){f(t)?a+=t+",":a+=t}),a+=" "}),a},transformSVGGradientColor:function(t){var a="",t=get(t,"fixed.value"),n=t.angle,t=t.stops,L="grad"+ +new Date,a="<defs><linearGradient id='".concat(L,"' gradientTransform='rotate(").concat(n,")'>");return s(t,function(t){a+='<stop offset="'.concat(t.offset,'" stop-color="').concat(t.color,'"/>')}),{gradientHtml:a+="</linearGradient></defs>",id:L}},transNumberFormatterTooltip:function(t){var a=t.v,n=t.type,L=t.format,o=t.prefix,t=t.suffix;return n===u&&"null"!==L?o+v(L)(a)+t:n===u&&"null"===L?o+r(a)+t:n===TIME_TYPE&&"null"!==L?o+h(a).format(L)+t:o+a+t},isValid:function(t){return!M(t)&&!p(t)&&!c(t)}},t.exports});;
Cube("datav:/com/ml-funnel/5.1.8/transform",["datav:/npm/lodash/4.17.11/get","datav:/npm/lodash/4.17.11/map","datav:/npm/lodash/4.17.11/forEach","datav:/npm/lodash/4.17.11/isUndefined","datav:/npm/lodash/4.17.11/find"],function(t,e,n,o,i,a){function l(e,t){var n,o=Object.keys(e);return Object.getOwnPropertySymbols&&(n=Object.getOwnPropertySymbols(e),t&&(n=n.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,n)),o}function rt(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){ct(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}function ct(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}var pt=n("datav:/npm/lodash/4.17.11/get"),st=n("datav:/npm/lodash/4.17.11/map"),ft=n("datav:/npm/lodash/4.17.11/forEach"),dt=n("datav:/npm/lodash/4.17.11/isUndefined"),mt=n("datav:/npm/lodash/4.17.11/find"),ut=n("datav:/com/ml-funnel/5.1.8/customRuleStyle"),n=n("datav:/com/ml-funnel/5.1.8/utils"),gt=n.transLineDash,ht=n.transformGradientColor,yt=n.pathDFn,vt=n.transformSVGGradientColor,xt=n.transNumberFormatterTooltip;return t.exports={transOptionKey:function(R,t,e){var n=t.options,o=n.chart,i=o.margin,m=o.fill,a=o.line,X=o.shape,Y=o.direction,l=o.isGroup,r=l.show,l=l.dataGroup,B=o.size,o=o.label,H=o.show,c=o.offset,p=o.labelField,s=o.valueField,M=o.valueFormat,$=o.percentFormat,I=o.typeDescribe,f=o.valueDescribe,L=o.isBreak,d=o.lineHeight,u=o.textStyle,o=o.stroke,g=n.legend,U=g.isShow,h=g.layout,y=g.textStyle,v=g.spaceToChart,K=v.spaceChartX,v=v.spaceChartY,g=g.cateLegend,x=g.marker,b=g.markerSpace,S=g.maxItemWidth,g=g.flip,w=g.show,k=g.textStyle,F=g.pageMarker,V=F.flipColor,q=F.inactiveFill,F=F.pageSize,g=g.maxRow,O=n.animation,A=O.isShow,z=O.animationEasing,O=O.duration,n=n.tooltip,C=n.tooltipSet,J=C.show,Q=C.position,W=C.contentTextStyle,j=C.contentSpace,Z=C.trigger,_=C.suffix,D=C.bgBox,tt=D.padding,et=D.borderRadius,nt=D.backgroundColor,D=D.border,P=C.series,C=n.active,n=C.show,N=C.fillSet,ot=N.show,N=N.fill,T=C.line,G=C.trigger,C=C.selectType,it=U&&m.mapping,i=i.show?{padding:[i.top,i.right,i.bottom,i.left]}:{padding:"auto"},H=H?{label:{offsetX:c.offsetX,offsetY:c.offsetY,style:rt(rt({lineHeight:d,fill:u.color},u),{},{stroke:o.strokeColor,lineWidth:o.lineWidth}),formatter:function(t){var e=t.type,n=t.value,t=t.$$percentage$$,e=I.prefix+e+I.suffix;return"type"===p?e:"value"===p&&"number"===s?xt({v:n,type:"linear",format:M,prefix:f.prefix,suffix:f.suffix}):"type + value"===p&&"number"===s?e+(L?"\n":"")+xt({v:n,type:"linear",format:M,prefix:f.prefix,suffix:f.suffix}):"value"===p&&"percent"===s?f.prefix+"".concat((100*t).toFixed($.split("%")[0].split(".")[1]),"%")+f.suffix:"type + value"===p&&"percent"===s?e+(L?"\n":"")+(f.prefix+"".concat((100*t).toFixed($.split("%")[0].split(".")[1]),"%")+f.suffix):void 0},animate:A&&{appear:{animation:"scale-in-x"===z||"scale-in-y"===z?"zoom-in":z,duration:O},update:{duration:O}}}}:{label:{formatter:function(){return null}}},c=S.show?{maxItemWidth:S.width}:{maxItemWidth:null},d=b.openselfSpacing?{itemSpacing:b.itemSpacing}:null,u=b.openselfSpacing?{itemMarginBottom:b.itemMarginBottom}:null,o=it?{legend:rt(rt(rt(rt({},d),u),{},{position:h,flipPage:w,maxRow:g,offsetX:K,offsetY:v,pageNavigator:{marker:{style:{size:F,fill:V,inactiveFill:q}},text:{style:{fontSize:k.fontSize,fill:k.color,fontWeight:k.fontWeight,fontFamily:k.fontFamily}}},itemHeight:16,marker:{style:{r:x.size},spacing:b.openselfSpacing?b.spacing:4,symbol:x.shape},itemName:{style:{fill:y.color,fontFamily:y.fontFamily,fontSize:y.fontSize,fontWeight:y.fontWeight,border:0}}},c),{},{radio:{style:{fill:"rgba(0,0,0,0)",stroke:y.color}}})}:{legend:!1},at=[],lt=(st(P,function(t){return at.push(t.columnName)}),yt({x:9,y:9,r:5,type:U?x.shape:"circle"})),E=pt(t,"options.tooltip.tooltipSet.mode"),S=J?{tooltip:{fields:"simple"===E?null:["type","value"],showMarkers:!1,customContent:function(t,f){var d="";return st(f,function(t,e){var i=null,n=t.data,t=t.color,a="",l=t,t=pt(m,"fixed").type;if(pt(m,"mapping")||"linearGradient"!==t||(o=(t=vt(m)).gradientHtml,t=t.id,l="url(#".concat(t,")"),a=o),"simple"===E){var t=pt(n,"type"),o=pt(n,"trace"),r=pt(n,"value"),t=dt(o)?t+"："+r:t+"-"+o+"："+r;d+='\n                    <div\n                      style="\n                        display: flex;\n                        justify-content: left;\n                        align-items: center;\n                        font-size: '.concat(W.fontSize,"px;\n                        line-height: ").concat(W.fontSize,"px;\n                        color: ").concat(W.color,";\n                        font-weight: ").concat(W.fontWeight,";\n                        font-family: ").concat(W.fontFamily,";\n                        margin-bottom: ").concat(j,'px;\n                      "\n                      >\n                      <div style="width: 18px;height: 18px; margin-right: 6px; overflow: hidden;">\n                        <svg>\n                          ').concat(a,'\n                          <path\n                            d="').concat(lt,'"\n                            stroke="').concat(l,'"\n                            stroke-opacity="1"\n                            opacity="1"\n                            fill="').concat(l,'"\n                          >\n                          </path>\n                        </svg>\n                      </div>\n                      <span style="\n                        display: inline-block;\n                        vertical-align: middle;\n                      ">').concat(t).concat(_,"</span>\n                    </div>\n                  ")}else if(P&&0<P.length){for(var c in n)!function(e){ft(P,function(t){t.columnName===e&&(i=rt(rt({},i),{},ct({},e,n[e])))})}(c);e===f.length-1&&(isSpace=0);var p,s=0;for(p in i)!function(e){var t=i[e],n=mt(P,function(t){return t.columnName===e})||{},n=n.displayName||n.columnName||"",o=pt(mt(P,function(t){return e===t.columnName}),"suffix");d+='\n                      <div\n                        style="\n                          display: flex;\n                          justify-content: left;\n                          align-items: center;\n                          margin-bottom: '.concat(j,"px;\n                          font-size: ").concat(W.fontSize,"px;\n                          line-height: ").concat(W.fontSize,"px;\n                          color: ").concat(W.color,";\n                          font-weight: ").concat(W.fontWeight,";\n                          font-family: ").concat(W.fontFamily,';\n                        "\n                        >\n                        <div style="opacity: ').concat(s%P.length==0?1:0,';width: 18px;height: 18px; margin-right: 6px; overflow: hidden;">\n                          <svg>\n                            ').concat(a,'\n                            <path\n                              d="').concat(lt,'"\n                              stroke="').concat(l,'"\n                              stroke-opacity="1"\n                              opacity="1"\n                              fill="').concat(l,'"\n                            >\n                            </path>\n                          </svg>\n                        </div>\n                        <span style="\n                          display: inline-block;\n                          vertical-align: middle;\n                        ">').concat(n,"： ").concat(t).concat(o,"</span>\n                      </div>\n                    "),s++}(p)}}),'\n                <div style="margin-bottom: -'.concat(j,'px;">\n                  ').concat(d,"\n                </div>\n            ")},position:Q,domStyles:{"g2-tooltip":{display:"".concat("common"===E&&P.length<=0?"none":"block"),backgroundColor:nt,border:"".concat(D.borderWidth,"px ").concat(D.borderStyle," ").concat(D.borderColor),padding:"".concat(tt.paddingY,"px ").concat(tt.paddingX,"px"),borderRadius:"".concat(et,"px"),boxShadow:"none"}}}}:{tooltip:!1},it=A?{animation:{appear:{animation:z,duration:O},update:{duration:O}}}:{animation:!1},d=ot?ht(N):null,u=ct({},"click"===G?"selected":"active",!!n&&{style:rt({lineWidth:T.lineWidth,lineDash:gt(T),stroke:T.lineColor},d)}),h="multi"===C,w=!dt(mt(e,"trace")),g=rt(rt(rt(rt(rt({data:e,xField:"type",yField:"value",autoFit:!0},i),{},{supportCSSTransform:!0,shape:X,isTransposed:"level"===Y,minSize:B[0],maxSize:B[1],compareField:r&&"twoCompare"===l&&w?"trace":"",seriesField:r&&"multiple"===l&&w?"trace":"",funnelStyle:{lineDash:gt(a),lineWidth:a.lineWidth,stroke:a.lineColor}},H),{},{conversionTag:!1},o),S),{},{state:rt({default:{style:{lineWidth:2,fillOpacity:1,stroke:"red",fill:"red"}}},u),interactions:[{type:"element-selected",enable:"click"===G&&h},{type:"element-single-selected",enable:"click"===G&&!h},{type:"element-active",enable:"hover"===G&&h},{type:"element-single-active",enable:"hover"===G&&!h},{type:"tooltip",cfg:{start:[{trigger:"element:".concat(Z),action:"tooltip:show"}]}}]},it);return ut({props:g,guiConfig:R,data:e}),g}},t.exports});;
Cube("datav:/com/ml-funnel/5.1.8",["datav:/npm/bcore/0.0.22/event","datav:/npm/lodash/4.17.11/get","datav:/npm/lodash/4.17.11/set","datav:/npm/lodash/4.17.11/cloneDeep","datav:/npm/lodash/4.17.11/filter","datav:/npm/lodash/4.17.11/every","datav:/npm/lodash/4.17.11/includes","datav:/npm/lodash/4.17.11/some","datav:/npm/lodash/4.17.11/map","datav:/npm/lodash/4.17.11/isArray","datav:/npm/lodash/4.17.11/defaultsDeep","datav:/npm/lodash/4.17.11/floor","datav:/npm/lodash/4.17.11/isUndefined","datav:/npm/lodash/4.17.11/isEmpty","datav:/npm/lodash/4.17.11/isEqual","datav:/npm/lodash/4.17.11/toNumber","datav:/npm/lodash/4.17.11/pick","datav:/npm/@antv/g2plot/2.4.23/dist/g2plot.min.js"],function(t,e,i,n,a,o){function l(e,t){var i,n=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)),n}function m(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?l(Object(i),!0).forEach(function(t){v(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function v(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var r=i("datav:/npm/bcore/0.0.22/event"),y=i("datav:/npm/lodash/4.17.11/get"),s=i("datav:/npm/lodash/4.17.11/set"),c=i("datav:/npm/lodash/4.17.11/cloneDeep"),h=i("datav:/npm/lodash/4.17.11/filter"),p=i("datav:/npm/lodash/4.17.11/every"),d=i("datav:/npm/lodash/4.17.11/includes"),f=i("datav:/npm/lodash/4.17.11/some"),g=i("datav:/npm/lodash/4.17.11/map"),u=i("datav:/npm/lodash/4.17.11/isArray"),b=i("datav:/npm/lodash/4.17.11/defaultsDeep"),S=i("datav:/npm/lodash/4.17.11/floor"),C=i("datav:/npm/lodash/4.17.11/isUndefined"),O=i("datav:/npm/lodash/4.17.11/isEmpty"),w=i("datav:/npm/lodash/4.17.11/isEqual"),x=i("datav:/npm/lodash/4.17.11/toNumber"),j=i("datav:/npm/lodash/4.17.11/pick"),k=i("datav:/npm/@antv/g2plot/2.4.23/dist/g2plot.min.js"),D=k.Funnel,k=k.G2,z=i("datav:/com/ml-funnel/5.1.8/transform").transOptionKey,i=i("datav:/com/ml-funnel/5.1.8/utils"),P=i.transformGradientColor,_=i.isValid;return k.registerInteraction("element-single-active",{start:[{trigger:"element:mouseenter",action:"element-active:active"}],end:[{trigger:"element:mouseleave",action:"element-active:reset"}]}),k.registerInteraction("element-active",{start:[{trigger:"element:mouseenter",action:"element-active:toggle"}]}),t.exports=r.extend(function(t,e){this.config={options:{legend:{spaceToChart:{spaceChartX:0,spaceChartY:0},cateLegend:{maxItemWidth:{show:!1,width:100},markerSpace:{openselfSpacing:!1,itemSpacing:24,itemMarginBottom:12},flip:{maxRow:1}}}}},this.container=t,this.apis=e.apis,this._data=null,this.chart=null,this.guiConfig=null,this.init(e)},{init:function(t){this.mergeConfig(t)},initChart:function(t){this.chart=new D(this.container,t),this.chart.render()},handleNonstandardData:function(t){var i=["type","value","trace"],t=c(t);return h(t,function(t){return p(t,function(t,e){return d(i,e)})})},isHighlight:function(t){var e=t.item,t=t.data;return f(t,function(t){return f([e],t)})},render:function(t,e){var n=this,a=this.mergeConfig(e);(t=this.data(t,a))&&(this.guiConfig=z(this.config,a,c(t)),this.chart&&this.chart.destroy(),this.initChart(this.guiConfig),this.chart.off(),a.options.tooltip&&a.options.tooltip.active&&a.options.tooltip.active.trigger&&a.options.tooltip.active.show&&(e=a.options.tooltip.active.trigger,this.chart.on("element:".concat("click"===e?e:"mouseenter"),function(t){var t=j(y(t,"data.data"),["type","value","trace"]),e=g(n.chart.getStates(),"data"),i=[];g(e,function(t){return i.push(j(t,["type","value","trace"]))}),n.emit("itemSelect","multi"===a.options.tooltip.active.selectType?i:t)})),this.chart.on("contextmenu",function(t){var e=y(t,"data.data"),e=j(e,["type","value","trace"]);n.emit("onContextMenu",e,t)}),this.chart.on("legend-item:click",function(t){var t=y(t,"target.cfg.delegateObject.item"),e=t.value,t=t.unchecked;n.emit("legendClick",{value:e,checked:!t})}))},resize:function(t,e){},setColors:function(){},data:function(t,e){return t&&(this.__data=t),this._data=c(this.__data),u(this._data)&&this._data.filter(function(t){return _(t.type)&&_(t.value)}).map(function(t){return isNaN(x(t.type))||(t.type=t.type+""),t.value&&(t.value=x(t.value)),t})},mergeConfig:function(t){return t&&(0===Object.keys(this.config).length?this.config=t:(this.config.theme=b(t.theme||{},this.config.theme),this.setColors(),y(t,"options.chart.fill.scale.range")&&s(this.config,"options.chart.fill.scale.range",y(t,"options.chart.fill.scale.range")),y(t,"options.chart.label.labelField")&&s(this.config,"options.chart.label.labelField",y(t,"options.chart.label.labelField")),y(t,"options.condition")&&s(this.config,"options.condition",y(t,"options.condition")),y(t,"options.tooltip.tooltipSet.series")&&s(this.config,"options.tooltip.tooltipSet.series",y(t,"options.tooltip.tooltipSet.series")),this.config=b(t||{},this.config))),this.config},getColorableConfig:function(t){var e,i,n;return!t||O(t)?{}:(e=t.textColor,i=t.palette,t=t.bgColor,n="",{options:{chart:{fill:{fixed:{type:"flat",value:n=i&&0<i.length?i[S(i.length/2)]:n},scale:{range:g(y(this.config,"options.chart.fill.scale.range"),function(t,e){return i[e]||i[e%i.length]})}},label:{textStyle:{color:e}}},legend:{textStyle:{color:e},continuousLegend:{handler:{fill:e},track:{railColor:t}}}}})},getThemableConfig:function(t,e){var i,n,a,o,l,r,s,c,h,p=this.config.options,d=p.chart.label.textStyle,f=p.tooltip,p=p.legend,e=e||{},g=e.color,u=e.font,e=e.complexity,g=this.getColorableConfig(g||t),t={},d=(u&&(i=function(t,e){return void 0===y(u,t)?{}:v({},e,y(u,t))},a="family",o="fontFamily",l="weight",r="fontWeight",s="color.primary",c="color.secondary",h="color",t={options:{chart:{label:{textStyle:m(m(m({fontSize:y(u,n="size",0)+d.fontSize},i(a,o)),i(l,r)),i(s,h))}},tooltip:{tooltipSet:{contentTextStyle:m(m(m({fontSize:y(u,n,0)+f.tooltipSet.contentTextStyle.fontSize},i(a,o)),i(l,r)),i(s,h))}},legend:{textStyle:m(m(m({fontSize:y(u,n,0)+p.textStyle.fontSize},i(a,o)),i(l,r)),i(c,h)),cateLegend:{flip:{textStyle:m(m(m({fontSize:y(u,n,0)+p.cateLegend.flip.textStyle.fontSize},i(a,o)),i(l,r)),i(c,h))}}}}}),{});return"L0"===e?d={options:{chart:{label:{show:!1}},tooltip:{tooltipSet:{show:!0},active:{show:!1}},legend:{isShow:!1}}}:"L1"===e&&(d={options:{chart:{label:{show:!0}},tooltip:{tooltipSet:{show:!0},active:{show:!0}},legend:{isShow:!0}}}),b({},d,t,g)},highlight:function(t){var e=t.data,t=t.style;if(Object.keys(e).length<=0)return!1;var i=this,n=y(this.config,"options.tooltip.active"),a=n.show,o=n.selectType,l=n.fillSet,r=l.fillShow,l=l.fill,s=n.line,n="click"===n.trigger?"selected":"active",r=C(t)||O(t)?{fillStyle:r?P(l).fill:"",stroke:s.lineColor}:m({},t),l=v({},n,!!a&&{style:m({},r)}),c=(this.chart.update(m(m({},this.guiConfig),{},{state:m(m({},this.guiConfig.state),l)})),u(e)?e:[e]),c=w(this.prevOriginData,e)?this.prevFilterData:this.handleNonstandardData(c);c="single"===o?[c[0]]:c,this.chart.setState(n,function(t){return i.isHighlight({item:t,data:c})}),this.prevOriginData=e,this.prevFilterData=c},reset:function(){var t="click"===y(this.config,"options.tooltip.active").trigger?"selected":"active";this.chart.update(this.guiConfig),this.chart.setState(t,function(){})},destroy:function(){this.chart&&this.chart.destroy(),this.chart=null,this._data=null,this.container&&(this.container.innerHTML="")}}),t.exports});