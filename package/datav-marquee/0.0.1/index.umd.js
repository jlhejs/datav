(function(e,o){typeof exports=="object"&&typeof module!="undefined"?o(require("vue"),require("datav-vue")):typeof define=="function"&&define.amd?define(["vue","datav-vue"],o):(e=typeof globalThis!="undefined"?globalThis:e||self,o(e.Vue,e.datavVue))})(this,function(e,o){"use strict";var S=(t,c)=>{const r=t.__vccOpts||t;for(const[d,n]of c)r[d]=n;return r};const T=e.defineComponent({name:"VMarquee",props:{com:{type:Object,required:!0}},setup(t){const c=o.useApiStore();o.useDataCenter(t.com);const r=e.computed(()=>{var a,_;return(_=(a=c.dataMap[t.com.id])==null?void 0:a.source)!=null?_:{}}),d=e.computed(()=>o.getFieldMap(t.com.apis.source.fields)),n=e.toRef(t.com,"config"),i=e.toRef(t.com,"attr"),k=e.ref(null),m=e.ref(null),s=e.ref(""),u=e.ref(""),l=e.ref(0),p=e.ref(0),v=e.ref(0),y=e.computed(()=>({width:`${i.value.w}px`,height:`${i.value.h}px`,fontFamily:`${n.value.textStyle.fontFamily}, Arial, sans-serif`,fontSize:`${n.value.textStyle.fontSize}px`,color:n.value.textStyle.color,"font-weight":n.value.textStyle.fontWeight})),b=e.computed(()=>({display:"inline-block",transform:s.value,transition:u.value})),h=e.computed(()=>r.value[d.value.value]||n.value.title),g=e.computed(()=>{let a=`<div style="display: inline-block;min-width: ${l.value}px">${h.value}<i style="display:inline-block; width:80px;"></i></div>`;return a+a}),w=()=>{e.nextTick(()=>{if(m.value&&(l.value=m.value.offsetWidth/2),l.value>i.value.w){let a=0;n.value.ifSpeed?a=n.value.speed/100*l.value:a=n.value.duration,s.value=`translateX(-${l.value}px)`,u.value=`transform ${a}ms linear 0s`,p.value=window.setTimeout(()=>{s.value="translateX(0)",u.value="none 0s ease 0s",n.value.loop&&(n.value.timeout>0?v.value=window.setTimeout(w,n.value.timeout):w())},a)}else l.value=i.value.w,s.value="translateX(0)",u.value="none 0s ease 0s"})},x=o._.debounce(w,500);return e.watch([y,h],()=>{clearTimeout(p.value),clearTimeout(v.value),l.value=i.value.w,s.value="translateX(0)",u.value="none 0s ease 0s",x()}),e.onMounted(()=>{x()}),e.onUnmounted(()=>{clearTimeout(p.value),clearTimeout(v.value)}),{marqueeRef:k,marqueeTextRef:m,wrapperStyle:y,textStyle:b,content:g}}}),q={ref:"marqueeRef",style:{"white-space":"nowrap",overflow:"hidden"}},$=["innerHTML"];function M(t,c,r,d,n,i){return e.openBlock(),e.createElementBlock("div",{class:"datav-wrapper",style:e.normalizeStyle(t.wrapperStyle)},[e.createElementVNode("div",q,[e.createElementVNode("div",{ref:"marqueeTextRef",style:e.normalizeStyle(t.textStyle),innerHTML:t.content},null,12,$)],512)],4)}var f=S(T,[["render",M],["__file","F:/datav-jlhe/src/components/text/marquee/src/index.vue"]]);f.install=t=>{t.component("VMarquee",f)},window.datavVue&&window.datavVue.app&&window.datavVue.app.use(f)});
