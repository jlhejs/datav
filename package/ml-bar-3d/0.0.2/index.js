// env=undefined => env=publish 
Cube("datav:/com/ml-bar-3d/0.0.2/utils",["datav:/npm/lodash/4.6.1","datav:/npm/moment/2.27.0"],function(t,e,n,i,l,s){var u=n("datav:/npm/lodash/4.6.1"),o="linear",c=n("datav:/npm/moment/2.27.0"),m=function(t){return u.includes(t+="",".")||(t+="."),u.replace(u.replace(t,/(\d)(?=(\d{3})+\.)/g,"$1,"),/\.$/,"")};return t.exports={transNumberFormatter:function(t){var e,n,i,l,s=t.v,r=t.type,d=t.format,a=t.prefix,t=t.suffix;return("d"===d||/.[0-9]f/.test(d)||/.[0-9]%/.test(d)||"th"===d||/.[0-9]t/.test(d))&&r===o?(e=u.toNumber(s),i=a,l=t,(n=d)?n.includes(".")&&n.includes("t")?i+m((+e).toFixed(n.split(".")[1].split("t")[0]))+l:n.includes("th")?i+m(u.floor(e))+l:n.includes(".")&&n.includes("f")?i+(+e).toFixed(n.split(".")[1].split("f")[0])+l:n.includes("%")?i+"".concat((100*e).toFixed(+n.split("%")[0].split(".")[1]),"%")+l:n.includes("d")?i+u.floor(e)+l:e:e):r===o&&"null"===d?a+u.toNumber(s)+t:"time"===r&&"null"!==d?a+c(s).format(d)+t:a+s+t},isValid:function(t){return!u.isUndefined(t)&&!u.isNull(t)&&!u.isNaN(t)}},t.exports});;
Cube("datav:/com/ml-bar-3d/0.0.2",["datav:/npm/bcore/0.0.18/event","datav:/npm/jquery/2.1.4","datav:/npm/lodash/4.6.1","datav:/npm/echarts/4.1.0","datav:/npm/datav-echartsgl-adaptor/0.0.3"],function(t,e,i,n,a,o){function l(e,t){var i,n=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,i)),n}function Ce(e){for(var t=1;t<arguments.length;t++){var i=null!=arguments[t]?arguments[t]:{};t%2?l(Object(i),!0).forEach(function(t){s(e,t,i[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(i)):l(Object(i)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(i,t))})}return e}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var r=i("datav:/npm/bcore/0.0.18/event"),h=i("datav:/npm/jquery/2.1.4"),De=i("datav:/npm/lodash/4.6.1"),c=i("datav:/npm/echarts/4.1.0"),i=(i("datav:/npm/datav-echartsgl-adaptor/0.0.3"),i("datav:/com/ml-bar-3d/0.0.2/utils")),Oe=i.transNumberFormatter,Ae=i.isValid;return t.exports=r.extend(function(t,e){this.config={},this.container=h(t),this.apis=e.apis,this._data=null,this.chart=null,this.dataLists=null,this.init(e)},{init:function(t){this.mergeConfig(t),this.chart=c.init(this.container[0]),this.container.css({padding:"8px"})},render:function(t,e){var i=this,e=this.mergeConfig(e);!(t=this.data(t,e))||t.length<=0||(this.chart&&this.chart.clear(),this.chart=c.init(this.container[0]),this.setEChartsOptions(e),this.chart.on("click",function(t){t=t.value,t={x:i.dataLists.xAxis[t[0]],y:i.dataLists.yAxis[t[1]],z:t[2]};i.emit("itemSelect",t)}))},getEChartsData:function(t){var e=this.handleData(t,"x"),i=this.handleData(t,"y"),t=De.map(t,function(t){return[e.keyMap[t.x],i.keyMap[t.y],t.z]});return{xAxis:e.keyArr,yAxis:i.keyArr,zAxis:t}},handleData:function(t,e){t=De.uniqBy(t,e),t=De.map(t,function(t){return t[e]});return{keyArr:t,keyMap:De.reduce(t,function(t,e,i){return Ce(Ce({},t),{},s({},e,i))},{})}},setEChartsOptions:function(t){var i=this,t=t.bar3D,e=t.chart,n=e.boxSize,N=n.boxWidth,E=n.boxHeight,_=n.boxDepth,n=n.distance,a=e.fill,G=e.bevel,B=G.bevelSize,G=G.bevelSmoothness,H=e.projection,I=e.view,M=I.alpha,I=I.beta,o=e.center,q=o.x,Q=o.y,o=o.z,e=e.label,V=e.show,K=e.textStyle,X=e.distance,Y=e.labelContent,J=e.valueFormat,l=e.describe,e=t.axis,s=e.xaxis,U=s.isShow,r=s.type,h=s.label,Z=h.show,$=h.timeFormat,tt=h.valueFormat,c=h.display,et=c.offset,it=c.prefix,nt=c.suffix,c=h.textStyle,h=s.title,d=s.axisLine,p=s.tickLine,f=s.axisPointer,at=f.show,ot=f.margin,lt=f.lineStyle,st=lt.color,lt=lt.width,f=f.label,s=s.grid,x=e.yaxis,rt=x.isShow,ht=x.type,m=x.label,ct=m.show,dt=m.valueFormat,pt=m.timeFormat,u=m.display,ft=u.offset,xt=u.prefix,mt=u.suffix,u=m.textStyle,m=x.title,ut=x.axisLine,y=x.tickLine,g=x.axisPointer,yt=g.show,gt=g.margin,wt=g.lineStyle,bt=wt.color,wt=wt.width,g=g.label,x=x.grid,e=e.zaxis,St=e.isShow,w=e.extent,b=e.label,vt=b.show,Lt=b.valueFormat,S=b.display,zt=S.offset,kt=S.prefix,Ct=S.suffix,S=b.textStyle,b=e.title,Dt=e.axisLine,v=e.tickLine,L=e.axisPointer,Ot=L.show,At=L.margin,Pt=L.lineStyle,jt=Pt.color,Pt=Pt.width,L=L.label,e=e.grid,z=t.animation.autoRotate,Wt=z.show,Tt=z.autoRotateDirection,z=z.autoRotateSpeed,k=t.legend,Ft=k.isShow,Rt=k.textStyle,Nt=k.orient,Et=k.horAlignment,_t=k.verAlignment,Gt=k.dimension,Bt=k.legendType,Ht=k.inverse,C=k.cateLegend,It=C.markerSpace,Mt=It.itemGap,It=It.textGap,qt=C.marker,C=C.splitNumber,k=k.continuousLegend,D=k.handler,Qt=k.trackHor,k=k.trackVer,O=t.tooltip,A=O.mouse,Vt=A.xSensitivitySet,Kt=Vt.show,Vt=Vt.xSensitivity,Xt=A.ySensitivitySet,Yt=Xt.show,Xt=Xt.ySensitivity,Jt=A.zoomSensitivitySet,Ut=Jt.show,Jt=Jt.zoomSensitivity,A=A.dampingSet,Zt=A.show,A=A.damping,P=O.tooltipSet,$t=P.show,j=P.titleTextStyle,W=P.contentTextStyle,te=P.trigger,ee=P.titleSpace,ie=P.contentSpace,T=P.bgBox,ne=T.padding,ae=T.backgroundColor,T=T.border,oe=P.series,P=O.active,O=P.show,P=P.barColor,t=t.special,le=t.shading,F=t.postEffect,se=F.show,re=F.bloom,he=re.show,re=re.bloomIntensity,F=F.depthOfField,ce=F.show,de=F.fstop,F=F.blurRadius,t=t.light,pe=t.show,R=t.main,fe=R.show,xe=R.color,me=R.intensity,ue=R.isShadow,ye=R.shadowQuality,ge=R.beta,R=R.alpha,t=t.ambient,we=t.show,be=t.color,t=t.intensity,Se=this.data(),ve=(this.dataLists=this.getEChartsData(Se),a.fixed),Le=a.mapping,a=a.scale,Le=Le?De.get(a,"range"):ve,a=De.map(this.dataLists.zAxis,function(t){return t[Gt]}),ve=d.show?{axisLine:{lineStyle:{color:d.line.lineColor,width:d.line.lineWidth}}}:{axisLine:{lineStyle:{width:0}}},d=h.show?{name:h.text,nameGap:h.offset,nameTextStyle:Ce({},h.textStyle)}:{name:null},ze="value"===r?tt:$,h=Z?{axisLabel:{margin:et,textStyle:Ce({},c),formatter:function(t){return Oe({v:t,type:r,format:ze,prefix:it,suffix:nt})}}}:{axisLabel:{show:!1}},tt=U?Ce(Ce(Ce(Ce({},d),ve),{},{axisTick:{show:p.show,length:p.line.length,lineStyle:{color:p.line.lineColor,width:p.line.lineWidth}},splitLine:{show:s.show,lineStyle:{color:s.line.lineColor,width:s.line.lineWidth}}},h),{},{axisPointer:{show:at,lineStyle:{color:st,width:lt},label:{show:at,margin:ot,textStyle:Ce({backgroundColor:"rgba(0, 0, 0, 0)"},f)}}}):{axisLabel:{show:!1},axisTick:{lineStyle:{width:0}},axisLine:{lineStyle:{width:0}},splitLine:{lineStyle:{width:0}},name:null,axisPointer:{show:!1}},$=ut.show?{axisLine:{lineStyle:{color:ut.line.lineColor,width:ut.line.lineWidth}}}:{axisLine:{lineStyle:{width:0}}},Z=m.show?{name:m.text,nameGap:m.offset,nameTextStyle:Ce({},m.textStyle)}:{name:null},ke="value"===ht?dt:pt,et=ct?{axisLabel:{margin:ft,textStyle:Ce({},u),formatter:function(t){return Oe({v:t,type:ht,format:ke,prefix:xt,suffix:mt})}}}:{axisLabel:{show:!1}},c=rt?Ce(Ce(Ce(Ce({},Z),$),{},{axisTick:{show:y.show,length:y.line.length,lineStyle:{color:y.line.lineColor,width:y.line.lineWidth}},splitLine:{show:x.show,lineStyle:{color:x.line.lineColor,width:x.line.lineWidth}}},et),{},{axisPointer:{show:yt,lineStyle:{color:bt,width:wt},label:{show:yt,margin:gt,textStyle:Ce({backgroundColor:"rgba(0, 0, 0, 0)"},g)}}}):{axisLabel:{show:!1},axisTick:{lineStyle:{width:0}},axisLine:{lineStyle:{width:0}},splitLine:{lineStyle:{width:0}},name:"",axisPointer:{show:!1}},U=Dt.show?{axisLine:{lineStyle:{color:Dt.line.lineColor,width:Dt.line.lineWidth}}}:{axisLine:{lineStyle:{width:0}}},d=b.show?{name:b.text,nameGap:b.offset,nameTextStyle:Ce({},b.textStyle)}:{name:null},ve=vt?{axisLabel:{margin:zt,textStyle:Ce({},S),formatter:function(t){return Oe({v:t,type:"linear",format:Lt,prefix:kt,suffix:Ct})}}}:{axisLabel:{show:!1}},p=St?Ce(Ce(Ce(Ce({},d),U),{},{axisTick:{show:v.show,length:v.line.length,lineStyle:{color:v.line.lineColor,width:v.line.lineWidth}},splitLine:{show:e.show,lineStyle:{color:e.line.lineColor,width:e.line.lineWidth}}},ve),{},{axisPointer:{show:Ot,lineStyle:{color:jt,width:Pt},label:{show:Ot,margin:At,textStyle:Ce({backgroundColor:"rgba(0, 0, 0, 0)"},L)}}}):{axisLabel:{show:!1},axisTick:{lineStyle:{width:0}},axisLine:{lineStyle:{width:0}},splitLine:{lineStyle:{width:0}},name:null,axisPointer:{show:!1}},s=we?{ambient:{color:be,intensity:t}}:{},h="color"!==le&&pe?{light:Ce(Ce({},fe?{main:{color:xe,intensity:me,shadow:ue,shadowQuality:ye,alpha:R,beta:ge}}:{}),s)}:{},st=O?{emphasis:{itemStyle:{color:P}}}:{};this.chart.setOption({grid3D:Ce(Ce({show:!0,boxWidth:N,boxHeight:E,boxDepth:_,postEffect:{enable:se,bloom:{enable:he,bloomIntensity:re},depthOfField:{enable:ce,fstop:de,blurRadius:F}}},h),{},{viewControl:{projection:H,distance:n,alpha:M,beta:I,center:[q,Q,o],autoRotate:Wt,autoRotateDirection:Tt,autoRotateSpeed:z,rotateSensitivity:[Kt?Vt:0,Yt?Xt:0],zoomSensitivity:Ut?Jt:0,damping:Zt?A:0}}),xAxis3D:Ce({type:"category",data:this.dataLists.xAxis},tt),yAxis3D:Ce({data:this.dataLists.yAxis,type:"category"},c),zAxis3D:Ce({type:"value",data:this.dataLists.zAxis,min:"min"===w.min?null:w.min,max:"max"===w.max?null:w.max},p),tooltip:{show:$t,triggerOn:te,backgroundColor:ae,padding:[ne.paddingY,ne.paddingX],borderColor:T.borderColor,borderWidth:T.borderWidth,borderRadius:T.borderRadius,textStyle:Ce({},W),formatter:function(t){var a,e,o,l,s=De.uniqBy(oe,"columnName");if(s&&0<s.length)return e=t.value,a=t.color,t=De.find(Se,{x:i.dataLists.xAxis[e[0]],y:i.dataLists.yAxis[e[1]],z:e[2]}),e=Oe({v:t.x,type:r,format:ze,prefix:it,suffix:nt}),o=De.map(s,function(t){return t.columnName}),t=De.pick(t,o),l="",De.mapKeys(t,function(t,e){"x"===e&&(t=Oe({v:t,type:r,format:ze,prefix:it,suffix:nt})),"y"===e&&(t=Oe({v:t,type:ht,format:ke,prefix:xt,suffix:mt})),"z"===e&&(t=Oe({v:t,type:"linear",format:Lt,prefix:kt,suffix:Ct}));var i=De.findIndex(o,function(t){return t===e}),n=De.find(s,function(t){return t.columnName===e}),n=n.displayName||n.columnName;l+='\n                  <div style="margin-bottom: '.concat(ie,'px">\n                    <span style="\n                      display: inline-block;\n                      opacity: ').concat(0===i?1:0,";margin-right: 5px; width: 10px; height: 10px; background-color: ").concat(a,';\n                    "></span>\n                    <span\n                      style="\n                        font-size: ').concat(W.fontSize,"px;\n                        line-height: ").concat(W.fontSize,"px;\n                        color: ").concat(W.color,";\n                        font-weight: ").concat(W.fontWeight,";\n                        font-family: ").concat(W.fontFamily,';\n                      "\n                    >').concat(n,"：").concat(t,"</span>\n                  </div>\n                ")}),'\n                  <div style="margin-bottom: -'.concat(ie,'px">\n                    <div\n                      style="\n                        font-size: ').concat(j.fontSize,"px;\n                        line-height: ").concat(j.fontSize,"px;\n                        color: ").concat(j.color,";\n                        font-weight: ").concat(j.fontWeight,";\n                        font-family: ").concat(j.fontFamily,";\n                        margin-bottom: ").concat(ee,'px;\n                      "\n                    >').concat(e,"</div>\n                    ").concat(l,"\n                  </div>\n              ")}},visualMap:{show:Ft,type:Bt,orient:Nt,left:Et,top:_t,textStyle:Ce(Ce({},Rt),{},{fontStyle:"normal"}),itemWidth:"piecewise"===Bt?qt.width:"horizontal"===Nt?Qt.height:k.width,itemHeight:"piecewise"===Bt?qt.height:"horizontal"===Nt?Qt.width:k.height,itemGap:Mt,textGap:It,splitNumber:C,dimension:Gt,inRange:{color:Le,symbol:qt.shape},indicatorSiz:10,min:"auto"===D.min?De.minBy(a):parseInt(D.min),max:"auto"===D.max?De.maxBy(a):parseInt(D.max),calculable:!0,realtime:!0,hoverLink:!0,inverse:Ht},series:[Ce({type:"bar3D",coordinateSystem:"cartesian3D",bevelSize:B,bevelSmoothness:G,shading:le,data:this.dataLists.zAxis.map(function(t,e){return{name:t[2],value:[t[0],t[1],t[2]]}}),label:{show:V,textStyle:Ce(Ce({},K),{},{backgroundColor:"transparent"}),distance:X,formatter:function(t){t=t.value,t={x:i.dataLists.xAxis[t[0]],y:i.dataLists.yAxis[t[1]],z:t[2]},t=De.get(t,Y);if(Ae(t))return"z"===Y?Oe({v:t,type:"linear",format:J,prefix:l.prefix,suffix:l.suffix}):l.prefix+t+l.suffix}}},st)]},!0)},resize:function(t,e){this.chart.resize({width:t,height:e})},setColors:function(){},data:function(t){return t&&(this.__data=t),this._data=De.cloneDeep(this.__data),De.isArray(this._data)&&this._data.filter(function(t){return Ae(t.x)&&Ae(t.y)&&Ae(t.z)}).map(function(t){return t.z&&(t.z=De.toNumber(t.z)),t})},mergeConfig:function(t){return t&&(this.config.theme=De.defaultsDeep(t.theme||{},this.config.theme),this.setColors(),De.get(t,"bar3D.chart.fill")&&De.set(this.config,"bar3D.chart.fill",De.get(t,"bar3D.chart.fill")),De.get(t,"bar3D.tooltip.tooltipSet.series")&&De.set(this.config,"bar3D.tooltip.tooltipSet.series",De.get(t,"bar3D.tooltip.tooltipSet.series")),this.config=De.defaultsDeep(t||{},this.config)),this.config},updateLayout:function(){},updateStyle:function(){var t=this.config;this.container.css({"font-size":t.size+"px",color:t.color||"#fff"})},clear:function(){this.chart&&this.chart.clear&&this.chart.clear()},destroy:function(){this.chart&&this.chart.dispose&&this.chart.dispose(),this.chart=null,this.container&&(this.container.innerHTML="")}}),t.exports});