// env=undefined => env=publish 
Cube("datav:/com/ml-search-input/0.1.12",["datav:/npm/bcore/0.0.18/event","datav:/npm/jquery/2.1.4","datav:/npm/lodash/4.6.1"],function(t,e,o,n,i,r){var l=o("datav:/npm/bcore/0.0.18/event"),a=o("datav:/npm/jquery/2.1.4"),s=o("datav:/npm/lodash/4.6.1"),u=s.template('<a class="result"><div class="resultTitle" tName="<%= name %>" key="<%= key %>"> <%= value %>(<%= adcode %>)</div></a>');return t.exports=l.extend(function(t,e){this.config={theme:{}},this.container=a(t),this.apis=e.apis,this._data=null,this.chart=null,this.inputValue=null,this.init(e)},{init:function(t){this.mergeConfig(t),this.container.css({position:"relative"}),this.container.append('<div class="searchBox"><input class="inputBox" type="text" style="color: rgb(0, 0, 0);"></div><div class="tipBoxs"></div>')},filterArray:function(o,t){var n=[];return s.map(t,function(t,e){(s.includes(s.toLower(t.name),s.toLower(o))||s.includes(s.toLower(t.adcode),s.toLower(o))||s.includes(s.toLower(t.parent),s.toLower(o)))&&n.push(t),""===o&&(n=[])}),n},eventEmit:function(e,t){var o=!1,n=this,i=void 0;this._data&&0<this._data.length&&(s.map(this._data,function(t){t.name===e&&(o=!0,i=t)}),o?n.emit("search-input-changed",i):n.emit("search-input-changed",{name:e}),t.interval.cb&&""!=t.interval.cb&&i&&n.emit("global_var",t.interval.cb,i[t.interval.cb]))},render:function(e,t){var o=this;e=this.data(e);var n=this.mergeConfig(t),t=this.container.find(".searchBox"),i=this.container.find(".inputBox"),r=this.container.find(".tipBoxs");t.css({width:n.inputStyle.width+"px",height:n.inputStyle.height+"px",left:n.inputStyle.left+"px",top:n.inputStyle.top+"px",position:"absolute",background:n.inputStyle.backgroundColor,"box-sizing":"border-box"}),i.css({color:n.inputStyle.color||"#000",background:n.inputStyle.backgroundColor,minwidth:"50px",outline:"none","text-shadow":"none","font-style":"normal","font-weight":n.inputStyle.fontWeight,padding:"1em","font-size":n.inputStyle.fontSize+"px",width:"100%",height:"100%",border:n.inputStyle.border.size+"px "+n.inputStyle.border.line+" "+n.inputStyle.border.color,"box-sizing":"border-box"}).attr({placeholder:n.inputStyle.placeholder||""}),r.css({background:n.resultStyle.backgroundColor,position:"absolute","margin-top":n.resultStyle.margin+"px",top:n.inputStyle.top+38+"px",left:n.inputStyle.left+"px",width:n.resultStyle.width+"px","max-height":n.resultStyle.maxHeight+"px","box-sizing":"border-box",border:"0px solid "+n.resultStyle.outBorderColor,overflow:"auto","font-size":n.resultStyle.fontSize+"px",color:n.resultStyle.color}),i.off("input propertychange keydown"),i.on("input propertychange",function(){r.empty();var t=o.filterArray(i.val(),e);t&&0<t.length?(s.map(t,function(t,e){r.append(u({name:t.name,key:t[n.interval.cb],adcode:t.adcode,value:null===t.parent?t.name:t.parent+" | "+t.name}))}),r.off("click mouseenter mouseleave"),r.on("click","a",function(){var t=a(this).children("div").attr("tName");o.inputValue=t,i.val(t),r.empty(),r.css({border:"0px solid "+n.resultStyle.outBorderColor}),o.eventEmit(t,n)}),r.on("mouseenter","a",function(){a(this).css({color:n.resultStyle.hoverStyle.color,"border-bottom":"1px solid "+n.resultStyle.hoverStyle.borderColor,"font-size":n.resultStyle.hoverStyle.fontSize+"px","font-weight":"bold"})}),r.on("mouseleave","a",function(){a(this).css({color:n.resultStyle.color,"font-size":n.resultStyle.fontSize+"px","font-weight":"normal","border-bottom":"1px solid "+n.resultStyle.borderColor})}),r.css({border:"1px solid "+n.resultStyle.outBorderColor}),r.find(".result").css({"pointer-event":"auto",cursor:"pointer",display:"block",overflow:"hidden",padding:"8px 1em","font-weight":"400","line-height":"20px","border-bottom":"1px solid "+n.resultStyle.borderColor,"text-decoration":"none","background-color":"transparent"})):r.css({border:"0px solid "+n.resultStyle.outBorderColor})}),i.on("keydown",function(t){var e=a(this).val();o.inputValue=e,13==t.keyCode&&o.eventEmit(e,n)})},getFieldValue:function(){var t=this.data(),t=s.find(t,{name:this.inputValue});if(t)return t},resetField:function(){this.inputValue="",this.container.find(".inputBox").val("")},resize:function(t,e){},data:function(t){return t&&(this._data=t),this._data},mergeConfig:function(t){return t&&(this.config=s.defaultsDeep(t||{},this.config)),this.config},destroy:function(){this._data=null,this.container.empty(),this.off&&this.off()}}),t.exports});