Cube('datav:/com/area-with-counter/2.0.0',['datav:/com/area-with-counter/2.0.0/default.css.js','datav:/npm/bcore/0.0.9/event','datav:/npm/dchart-core/1.2.19/area/area','datav:/com/counter/0.1.0','datav:/npm/lodash/4.6.1','datav:/npm/jquery/2.1.4','datav:/com/maliang-utils/0.0.4'],function(i,r,c,o,p,q){function f(a){return e[a]?e[a]:e[a]=b[a]()}var b={},e={};b['coms/area-with-counter/2.0.0/counter.html']=b['coms/area-with-counter/2.0.0/counter.html']=function(){return function(){return'<div class="counter counter<%= i %>" style="display: inline-block;  margin-right: 1em;"></div>'}},b['coms/area-with-counter/2.0.0/legend.html']=b['coms/area-with-counter/2.0.0/legend.html']=function(){return function(){return'<div class="legend<%= i %> legend-item" style="margin: 0 5px;text-align: center;">\n  <div class="legend-rect" style="display: inline-block;"></div>\n  <div class="legend-label"></div>\n</div>'}},b['coms/area-with-counter/2.0.0/template.html']=b['coms/area-with-counter/2.0.0/template.html']=function(){return function(){return'<div class="legend" style=" display: flex; align-items: center; justify-content: flex-end; line-height: 1.3;margin-right: 20px;"></div>\n<div class="col" style="display: flex;align-items: center; margin-left: 20px;"></div>\n<div class="chart arear-quota"></div>\n'}},c('datav:/com/area-with-counter/2.0.0/default.css.js','');var j=c('datav:/npm/bcore/0.0.9/event'),k=c('datav:/npm/dchart-core/1.2.19/area/area'),h=c('datav:/com/counter/0.1.0'),a=c('datav:/npm/lodash/4.6.1'),l=f('coms/area-with-counter/2.0.0/template.html'),m=a.template(f('coms/area-with-counter/2.0.0/legend.html')()),n=a.template(f('coms/area-with-counter/2.0.0/counter.html')()),g=c('datav:/npm/jquery/2.1.4'),d=c('datav:/com/maliang-utils/0.0.4');return i.exports=j.extend(function a(c,b){this.container=g(c),this.config={theme:{},chart:{size:8,margin:{right:20,top:10,bottom:25,left:45},interpolate:null,xaxis:{color:'#fff',dy:8,show:!1,'font-size':10,type:'category',padding:[.3,0],'inner-padding':.6,'outer-padding':0},yaxis:{color:'#fff','font-size':10,dy:8,ticks:5,tickSize:2,'assist-line':!1,label:'',min:null,max:null,show:!0}},legend:{height:15,right:20,dis:5,show:!0},col:{height:15,left:20,dis:5,show:!0},series:[{'serie-color':'#206cbb',legend:{'font-size':10,color:'#fff',value:'系列1'},quota:{color:'#fff',prefix:{content:'','font-size':20,color:'#fff'},suffix:{content:'人','font-size':20,color:'#fff'},'font-size':20,separate:!1,'letter-spacing':'0','margin-right':'0','background-color':'rgba(1,1,1,0)','text-verti':'center'}},{'serie-color':'#65f5f3',legend:{'font-size':10,color:'#fff',value:'系列2'},quota:{color:'#fff',prefix:{content:'','font-size':20,color:'#fff'},suffix:{content:'人','font-size':20,color:'#fff'},'font-size':20,separate:!1,'letter-spacing':'0','margin-right':'0','background-color':'rgba(1,1,1,0)','text-verti':'center'}}]},this.chart=null,this.apis=b.apis,this._data=[],this.init(b)},{updateLayout:function(){var a=this.config,b=this.container.height()||600,c=a.legend.show?a.legend.height&&b*a.legend.height/100||b*.15:0,d=a.col.show?a.col.height&&b*a.col.height/100||b*.15:0,e=b-c-d;this.colDom.outerHeight(d),this.chartDom.outerHeight(e),this.legendDom.outerHeight(c)},init:function(d){var b=this,c=this.mergeConfig(d);this.container.html(l),this.legendDom=this.container.find('.legend'),this.chartDom=this.container.find('.chart'),this.colDom=this.container.find('.col'),this.updateLayout(),this.chart=new k(this.chartDom[0],c.chart||{}),this.counters=[],a.map(c.series,function(f,a){var c=g(n({i:a}));b.colDom.append(c);var d=m({i:a});b.legendDom.append(d);var e=new h(c[0],f.quota);b.counters[a]=e}),this.updateLegend(),this.updateCol(),this.updateStyle()},updateStyle:function(){var e=this,b=this.config;b.col.show?this.colDom.show():this.colDom.hide();var f=this.legendDom.height();if(this.chart.el.select('.con-svg').style('background','transparent'),a.map(b.series,function(a,b){var g=e.counters[b].container,c=e.legendDom.find('.legend'+b),d=(f-a.legend['font-size'])*.4;g.css('color',a.quota.color),c.find('.legend-rect').css({'background-color':a['serie-color'],height:d+'px',width:d+'px'}),c.find('.legend-label').css({color:a.legend.color,'font-size':a.legend['font-size']+'px'}).html(a.legend.showname),e.chart.svg&&e.chart.svg.selectAll('.serie'+(b+1)).style({fill:a['serie-color'],stroke:'none'})}),this.chart.svg){var c=this.chart.svg.selectAll('.axis1'),d=this.chart.svg.selectAll('.axis2');b.chart.xaxis.show?(c.style('display','block'),c.selectAll('.tick text, .domain').style({stroke:b.chart.xaxis.color}),c.selectAll('.domain').style({display:b.chart.xaxis['assist-line']&&'block'||'none'}),c.selectAll('.tick text').style('font-size',b.chart.xaxis['font-size']+'px')):c.style('display','none'),b.chart.yaxis.show?(d.style('display','block'),d.selectAll('.tick text, .domain').style({stroke:b.chart.yaxis.color}),d.selectAll('.domain').style({display:b.chart.yaxis['assist-line']&&'block'||'none'}),d.selectAll('.tick text').style('font-size',b.chart.yaxis['font-size']+'px')):d.style('display','none')}},createArr:function(e){var c=[],d=this.config.series.length;for(var b=0;b<e;b++)c.push({x:'x'+b,y:a.fill(Array(d),0)});return c},dealData:function(c){c=c||this._data;var e=this.config,d=e.chart.size,b=this.createArr(d);return b=a.concat(b,a.dropRight(c,c.length-d)),a.drop(b,b.length-d)},data:function(a){return a?(this.__data=a,this._data=d.threeD2Two(a,'x','y','s',d.getSeriesValue(this.config.series,'legend.value'))):this._data=d.threeD2Two(this.__data,'x','y','s',d.getSeriesValue(this.config.series,'legend.value')),this._data},isSafeNumber:function(b){return a.isNumber(b)&&!a.isNaN(b)&&a.isFinite(b)?b:null},render:function(c,g){var b=this.mergeConfig(g),d=this;if(c=a.cloneDeep(this.data(c)),c&&c.length){c=this.dealData(c),a.map(b.series,function(e,b){d.counters[b].render([{value:a.last(c).y[b]||''}],e.quota)}),b.chart.height=this.container.height()-this.legendDom.height()-this.colDom.height(),b.chart.xaxis.tickFormat=function(a,c){return c<b.chart.size-d._data.length?'':a},b.chart.xaxis.padding=[b.chart.xaxis['inner-padding'],b.chart.xaxis['outer-padding']];var e=b.chart.yaxis.min!==null?a.toNumber(b.chart.yaxis.min):null,f=b.chart.yaxis.max!==null?a.toNumber(b.chart.yaxis.max):null;b.chart.yaxis.min=this.isSafeNumber(e),b.chart.yaxis.max=this.isSafeNumber(f),this.chart.render(c,b.chart),this.updateStyle()}else this.chart.destroy()},resize:function(a,b){this.updateLayout(),this._data&&this.chart.render(null,{width:a}),this.updateStyle()},setColors:function(){},mergeConfig:function(b){return b?(this.config.theme=a.defaultsDeep(b.theme||{},this.config.theme),this.setColors(),this.config=a.defaultsDeep(b||{},this.config),this.config):this.config},updateLegend:function(a){var c=!0;(!a||a.height===this.config.legend.height&&a.show===this.config.legend.show)&&(c=!1);var b=this.mergeConfig({legend:a});this.legendDom.css('margin-right',b.legend.right+'px'),this.legendDom.find('.legend-item').css('margin','0 '+b.legend.dis+'px'),b.legend.show&&this.legendDom.show()||this.legendDom.hide(),c&&(this.updateLayout(),this.chart.render(null,{width:this.container.width()}),this.updateStyle())},updateCol:function(a){var b=!0;(!a||a.height===this.config.col.height&&a.show===this.config.col.show)&&(b=!1);var c=this.mergeConfig({col:a});this.colDom.css('margin-left',c.col.left+'px'),this.colDom.find('.counter').css('margin','0 '+c.col.dis+'px'),b&&(this.updateLayout(),this.chart.render(null,{width:this.container.width()}),this.updateStyle())},updateSeries:function(b){if(b&&b.length!==this.config.series.length){if(!a.isArray(b)){console.log('config is error');return}a.map(b,function(b){b.quota&&(b.quota=a.defaultsDeep({separate:!1,'letter-spacing':'0','margin-right':'0','background-color':'rgba(1,1,1,0)','text-verti':'center'},b.quota))}),this.config.series=b,this.init(),this.render()}else this.mergeConfig({series:b}),this.updateStyle()}}),i.exports})