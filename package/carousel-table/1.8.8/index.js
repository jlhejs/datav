// env=undefined => env=publish 
Cube("datav:/com/carousel-table/1.8.8/fastdom.min",[],function(s,t,e,n,i,o){function c(t){return(c="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}return function(e){"use strict";function t(){var t=this;t.reads=[],t.writes=[],t.raf=i.bind(e)}function o(t){t.scheduled||(t.scheduled=!0,t.raf(function(t){var e,n=t.writes,i=t.reads;try{i.length,r(i),n.length,r(n)}catch(t){e=t}if(t.scheduled=!1,(i.length||n.length)&&o(t),e){if(e.message,!t.catch)throw e;t.catch(e)}}.bind(null,t)))}function r(t){for(var e;e=t.shift();)e()}function n(t,e){e=t.indexOf(e);return!!~e&&!!t.splice(e,1)}var i=e.requestAnimationFrame||e.webkitRequestAnimationFrame||e.mozRequestAnimationFrame||e.msRequestAnimationFrame||function(t){return setTimeout(t,16)},u=(t.prototype={constructor:t,measure:function(t,e){e=e?t.bind(e):t;return this.reads.push(e),o(this),e},mutate:function(t,e){e=e?t.bind(e):t;return this.writes.push(e),o(this),e},clear:function(t){return n(this.reads,t)||n(this.writes,t)},extend:function(t){if("object"!=c(t))throw new Error("expected object");var e,n=Object.create(this),i=n,o=t;for(e in o)o.hasOwnProperty(e)&&(i[e]=o[e]);return n.fastdom=this,n.initialize&&n.initialize(),n},catch:null},e.fastdom=e.fastdom||new t);"function"==typeof define?define(function(){return u}):"object"==(void 0===s?"undefined":c(s))&&(s.exports=u)}("undefined"!=typeof window?window:void 0),s.exports});;
Cube("datav:/com/carousel-table/1.8.8/utils",["datav:/npm/alibabacloud-datav-tool-gui-utils/1.0.2","datav:/npm/jquery/2.1.4","datav:/npm/lodash/4.6.1"],function(t,e,i,o,n,l){var g=i("datav:/npm/alibabacloud-datav-tool-gui-utils/1.0.2");function r(e,t){var i,o=Object.keys(e);return Object.getOwnPropertySymbols&&(i=Object.getOwnPropertySymbols(e),t&&(i=i.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,i)),o}function s(o){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach(function(t){var e,i;e=o,i=n[t=t],t in e?Object.defineProperty(e,t,{value:i,enumerable:!0,configurable:!0,writable:!0}):e[t]=i}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(n,t))})}return o}var f=i("datav:/npm/jquery/2.1.4"),h=i("datav:/npm/lodash/4.6.1"),i=h.random(1e3,1010),a=h.template('<div class="line header" style="z-index:2; width: 100%; position: absolute; display: flex;align-items: center;background-color: <%= backgroundColor %>;height: <%= height %>px;text-overflow: ellipsis;white-space: nowrap;overflow: hidden;vertical-align: middle;color: <%= color %>;">\n  <% if (hasIndex) {%><div class="index-list" style="display: inline-block;vertical-align: middle;width: <%= idListWidth %>%;height: <%= height %>px;"></div><%}%>\n  <%= column %>\n</div>'),d=h.template('<div class="line row-content" style="height: <%= height %>px;text-overflow: ellipsis;overflow: hidden;vertical-align: middle; display: flex;align-items: center;background-color: <%= bgColor %>;">\n<% if (hasIndex) {%>\n  <div class="index" style="display: inline-block;text-align: center;vertical-align: middle;width: <%= idListWidth %>%;color: <%= idListColor %>;font-size: <%= idListFontSize %>px;">\n    <div class="index-bg" style="background-color: <%= idListBgColor %>; font-family: <%= idListFontFamily %>;font-weight: <%= fontWeight %>; width: <%= bgSize %>px;height: <%= bgSize %>px;line-height: <%= bgSize %>px;vertical-align: middle;margin: auto;border-radius: <%= radius %>px;text-align: center;">\n    </div>\n  </div>\n<%}%>\n</div>'),c=h.template('<div class="<%=className%>" style="width: <%= width %>%;display:inline-block;text-align: <%= textAlign %>;<% if (isBr) {%>word-break:break-all;<%}%><% if (!isBr) {%>white-space: nowrap;<%}%>overflow: hidden;vertical-align: middle;background-color: transparent;font-size: <%= fontSize %>px;color: <%= color %>;font-family: <%= fontFamily %>;font-weight: <%= fontWeight %>;">\n<%= content %>\n<% if (!ifHeader) {%>\n  <div class="marquee-text" style="display: inline-block;">\n    <span style="display: inline-block;" class="marquee-text-span"></span><i class="whiteSpace" style="display:inline-block;width:<%= whiteWidth %>;"></i>\n    <% if (ifRun && !isBr) {%>\n      <span style="display: inline-block;" class="marquee-text-span"></span><i class="whiteSpace" style="display:inline-block;width:<%= whiteWidth %>;"></i>\n    <%}%>\n  </div>\n<%}%>\n</div>');return t.exports={cancelHighLightStyleFn:function(i,t){var e=t.idList,o=e.backgroundColor,e=e.textStyle,n=e.color,l=e.fontSize,r=e.fontWeight,e=e.fontFamily,a=t.series,d=t.row.backgroundColor1,c=t.row.backgroundColor2,g=(i.find(".index-bg").css({backgroundColor:o,backgroundImage:"none",backgroundClip:"initial",textFillColor:"initial",color:n,fontSize:l,fontWeight:r,fontFamily:e}),i.eq(0).attr("highlightnum")%2==0);i.each(function(t,e){var l=f(e).find(".cell-content"),e=(t+1)%2==0,e=g?e?c:d:e?d:c;i.eq(t).css({background:e,border:"none"}),h.forEach(a,function(t,e){var t=t.textStyle,i=t.color,o=t.fontFamily,n=t.fontSize,t=t.fontWeight;l.eq(e).find(".marquee-text-span").css({color:i,fontFamily:o,fontSize:n,fontWeight:t,backgroundImage:"none",backgroundClip:"initial",textFillColor:"initial"})})})},cancelHighLightStyleAll:function(i,t){var e=t.idList,o=e.backgroundColor,e=e.textStyle,n=e.color,l=e.fontSize,r=e.fontWeight,e=e.fontFamily,a=t.series,d=t.row.backgroundColor1,c=t.row.backgroundColor2;i.find(".index-bg").css({backgroundColor:o,backgroundImage:"none",backgroundClip:"initial",textFillColor:"initial",color:n,fontSize:l,fontWeight:r,fontFamily:e}),i.each(function(t,e){var l=f(e).find(".cell-content");i.eq(t).css({background:(t+1)%2==0?c:d,border:"none"}),h.forEach(a,function(t,e){var t=t.textStyle,i=t.color,o=t.fontFamily,n=t.fontSize,t=t.fontWeight;l.eq(e).find(".marquee-text-span").css({color:i,fontFamily:o,fontSize:n,fontWeight:t,backgroundImage:"none",backgroundClip:"initial",textFillColor:"initial"})})})},cancelHighLightStyle:function(t,e,i){var o=t.idList,n=o.backgroundColor,o=o.textStyle,l=o.color,r=o.fontSize,a=o.fontWeight,o=o.fontFamily,d=t.series,c=t.row.backgroundColor1,t=t.row.backgroundColor2,g=i.find(".cell-content");i.css({background:(e+1)%2==0?t:c,border:"none"}),i.find(".index-bg").css({backgroundColor:n,color:l,fontSize:r,fontWeight:a,fontFamily:o}),h.forEach(d,function(t,e){var t=t.textStyle,i=t.color,o=t.fontFamily,n=t.fontSize,t=t.fontWeight;g.eq(e).find(".marquee-text-span").css({color:i,fontFamily:o,fontSize:n,fontWeight:t})})},addHighLightStyle:function(t,e){var t=h.get(t,"global.highLight").hightLightStyle,i=t.textStyle,o=i.fontFamily,n=i.fontSize,l=i.fontWeight,i=i.color,r=t.backgroundColor,t=t.border,a=t.borderWidth,d=t.borderStyle,t=t.borderColor,i=(0,g.getBackgroundStyleFromFill)(i),c=h.includes(i,"linear-gradient"),i={color:c?"unset":i,"background-image":c?i:"none","-webkit-background-clip":c?"text":"unset","-webkit-text-fill-color":c?"transparent":"initial"},c={},c=h.get(t,"value.stops")?{"border-style":d,"border-image":(0,g.getBackgroundStyleFromFill)(t),"border-width":a,"border-image-width":a||"0","border-image-slice":"10"}:{border:"".concat(a,"px ").concat(d," ").concat(h.get(t,"type")?t.value:t)};e.css(s(s({},c),{},{background:(0,g.getBackgroundStyleFromFill)(r)})).find(".marquee-text-span").css(s(s({},i),{},{fontSize:n,fontWeight:l,fontFamily:o})),e.find(".index-bg").css(s(s({background:"none"},i),{},{fontFamily:o,fontSize:n,fontWeight:l}))},defaultOption:{"background-color":"transparent",theme:{},global:{animation:{singleStop:!1},ifRowHidden:!1,textAnimate:{ifRun:!1,animateDur:2,isSpeed:!0,speedRate:.03},ifUpdateImd:!0,highLight:{show:!1,isOrder:!0,hightLightIndex:3,hightLightStyle:{textStyle:{fontFamily:"Microsoft Yahei",fontSize:12,fontWeight:"normal",color:"#f00"},backgroundColor:"yellowGreen",border:{borderWidth:1,borderStyle:"solid",borderColor:"#f00"}}}},idList:{textStyle:{fontFamily:"Microsoft Yahei",fontSize:10,fontWeight:"normal",color:"#ffffff"}},series:[{columnName:"area",displayName:"地区",width:20,dataType:"text",widthPercent:50,margin:{left:0,top:0,bottom:10,right:10},isBr:!1,textStyle:{textAlign:"left",fontSize:12,color:"rgba(255,255,255,0.8)",fontWeight:"normal",fontFamily:"Microsoft Yahei"},backgroundColor:"#ff7900",textAlign:"left"},{columnName:"pv",displayName:"流量(pv)",width:20,dataType:"text",widthPercent:50,margin:{left:0,top:0,bottom:10,right:10},isBr:!1,textStyle:{textAlign:"left",fontSize:12,color:"rgba(255,255,255,0.8)",fontWeight:"normal",fontFamily:"Microsoft Yahei"},backgroundColor:"#ff7900",textAlign:"left"},{columnName:"attribute",displayName:"用户行为特征",width:53,dataType:"text",widthPercent:50,margin:{left:0,top:0,bottom:10,right:10},isBr:!1,textStyle:{textAlign:"left",fontSize:12,color:"rgba(255,255,255,0.8)",fontWeight:"normal",fontFamily:"Microsoft Yahei"},backgroundColor:"#ff7900",textAlign:"left"}]},headerTemplateFn:a,rowTemplateFn:d,cellTemplateFn:c,RANDOM_TIME:i,DURATION_TIME:400,FULL_SCREEN:"top",LINE_BY_LINE_SCROLL:"bottom",BASE64_IMG:"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAABBCAMAAADygeqaAAAABGdBTUEAALGPC/xhBQAAAAFzUkdCAK7OHOkAAAAJcEhZcwAACxIAAAsSAdLdfvwAAADhUExURUdwTADY3BPL1gDZ3ADZ3ATY3ADZ3ADZ3ADZ3ADZ3NTF2ATY3AHW2wXV2gDZ3ADZ3ADZ3ADZ3DCCq0HG1AbZ3ALZ3ADZ3AfS2ADZ3ADZ3ADZ3Me2yRwpcrehwcSzzkNOld/j6G+SpMSsyS9BiD6yxZqNusGuxMrh5iGUtNbA1xSRslxRnKuvyJyFtDSju2xeoADZ3AQvdQEeYw9BiQQpbj2uwDGHrNvn6UBBkSt6pjgseUfN0ws4gRFymwIjVROYrLObuRpKihdZjDE5hnNypzWBiKyMnqG80UnY2VuCrg53iWrCbhYAAAAwdFJOUwAhD3M6kqmI2wj+Y0MaKUx/bO4Fv1vzMlL65/n8G32X7f1O1efzpu2tzHtUPijJ36w5cUEAAAL/SURBVFjD7ZVpc5swEIYFiBtxBDDER2IncdIjaTHGqe/4Ttr//4O6C7ZDZxrSzrj9pGfGFqxgX+0hQQiHw+FwOBzO3/DhrMzNXfvurt1uN7rdxtXJNKLV7BEY4W80ev6WYywaxkf/dIFcpmlvulyuVqvZQaKxMwzj/oTJYs00zXrAtLnebDbdZ2OxWxjG7WFel0Kf2bEkUMIoMalpRaLABMG2LYlFgufRSLIipkdVIp9SIBcZ5qzH4+Gm2zpMCy4NTRdcy75uWq4kOaFgma7lxMwV3TAOVY/Fihw5VRr+NYpAKP1+fzkcTpvj8Xh9eZwWJFtVVTN0VYfEiuVRxbQ92QURk1JZNR3Z8x2FymFltqxlhhp9ZNrroca1eJwVpdiyWRhGokVEymLJij1LYJ5neWYo2qZNqeRQEVJZ3b+jZZodJNIsa44/n3yPCGfQtv1pLpHNe1l6jX1L1SO4RoYZE9UyEto8tn8AMMH2ZtlHk5fBrN/LwP8cspWHYSdHNJ0QBS9okJRwVfx3guKB4g35LQ3xZjJ5mTz1M5CYTw8F9169SYSe4xiUhBON1nJbVMMHABQT38xWOJlMBk9Psx5orIcP+4bTkqQuyyoOIrxfB5kwlmUZRg0GCqHV4NqEcGo2ITEIxhUlCSaDAYqs5s3hsW8t8AnVgmW6YZKco886JEWCa9xxDvoE//WoniQK0WEtQeWxNUCN2ezHdvP1NVwl2GeAaejFBjU118Ssi7mNgX/VxFJ5uIzK3pJB4xEktuXzNpIlT8ayupANgRAYzgUw1BkpbmgRFbaClgdTfWzdDB5H3zvb7W3JKBXFDXDpiblfOqTII0UKIao8RWgDauydTWKCxG7X6TyU9k2t0KB532IgmBRL0XD75LYkKkrt5HfuexvR/9JZwGfjohyGlqMKxQj96QeaJkcWprGwQWF8RdMUvA3Ed3f7vYG0yttGzyG+vr/Ao74YiP6LTcRn/uRIuQWJi3/8aW+d9gP7ey6Mq38tQVoXhMPhcDgcDuc/8xNsRHRmPkNeHAAAAABJRU5ErkJggg==",THREE:3},t.exports});;
Cube("datav:/com/carousel-table/1.8.8",["datav:/npm/bcore/0.0.18/event","datav:/npm/jquery/2.1.4","datav:/npm/lodash/4.6.1","datav:/npm/animejs/3.1.0"],function(t,i,e,n,o,a){function h(i,t){var e,n=Object.keys(i);return Object.getOwnPropertySymbols&&(e=Object.getOwnPropertySymbols(i),t&&(e=e.filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable})),n.push.apply(n,e)),n}function d(i){for(var t=1;t<arguments.length;t++){var e=null!=arguments[t]?arguments[t]:{};t%2?h(Object(e),!0).forEach(function(t){c(i,t,e[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(i,Object.getOwnPropertyDescriptors(e)):h(Object(e)).forEach(function(t){Object.defineProperty(i,t,Object.getOwnPropertyDescriptor(e,t))})}return i}function c(t,i,e){return i in t?Object.defineProperty(t,i,{value:e,enumerable:!0,configurable:!0,writable:!0}):t[i]=e,t}var r=e("datav:/npm/bcore/0.0.18/event"),b=e("datav:/npm/jquery/2.1.4"),p=e("datav:/npm/lodash/4.6.1"),s=e("datav:/com/carousel-table/1.8.8/utils"),f=s.cancelHighLightStyleFn,w=s.cancelHighLightStyle,x=s.cancelHighLightStyleAll,y=s.addHighLightStyle,l=s.defaultOption,g=s.headerTemplateFn,u=s.rowTemplateFn,m=s.cellTemplateFn,S=s.DURATION_TIME,v=s.RANDOM_TIME,T=s.FULL_SCREEN,L=s.LINE_BY_LINE_SCROLL,I=s.THREE,C=s.BASE64_IMG,A=e("datav:/npm/animejs/3.1.0"),F=e("datav:/com/carousel-table/1.8.8/fastdom.min");return t.exports=r.extend(function(t,i){this.container=b(t),this.config=d({width:this.container.width(),height:this.container.height()},l),this._data=null,this.isInit=!0,this.startIndex=0,this.animationAnime={},this.highlightIndex=0,this.highlightTime=null,this.fullScreenIndex=0,this.fullScreenTimer=0,this.isTabFocus=!0,this.marqueePosition={},this.init(p.omit(i,["width","height"]))},{init:function(t){this.mergeConfig(t),this.initInteraction(),this.listenerImgError(),this.observeStyle()},observeStyle:function(){var e=this,i=new MutationObserver(function(t){t.forEach(function(t){var i=p.get(t.target,"style.display");"attributes"==t.type&&i&&("block"===i?(e.isTabFocus=!0,e.render(e._data,e.config)):"none"===i&&(e.isTabFocus=!1,e.clearAllTimer()))})}),t=(i.observe(this.container.parent()[0],{attributes:!0,attributeFilter:["style"]}),this.container.parents(".slider"));t&&0<t.length&&p.map(t,function(t){i.observe(t,{attributes:!0,attributeFilter:["style"]})})},initInteraction:function(){var i=this,t=this.config.global.animation.duration*v;i.container.css("cursor","pointer"),i.container.off("mouseenter").off("mouseleave").on("mouseenter",function(t){i.isTabFocus=!1,i.clearAllTimer()}).on("mouseleave",p.debounce(function(){i.isTabFocus=!0,i.restartTimers()},t))},setHeader:function(t,i){for(var e="",n=0;n<t.length;n++){var o=t[n];e+=m({width:o.width,height:i.height,content:o.displayName,textAlign:i.textStyle.textAlign,whiteWidth:0,className:"column column-title",isBr:i.isBr,ifRun:!1,ifHeader:!0,fontSize:i.textStyle.fontSize,fontFamily:i.textStyle.fontFamily,color:i.textStyle.color,fontWeight:i.textStyle.fontWeight})}var a=d(d({},i),{},{column:e,color:i.textStyle.color,fontSize:i.textStyle.fontSize,fontWeight:i.textStyle.fontWeight}),h=g(a);this.container.append(h),this.container.append('<div class="placeholder" style="height: '.concat(a.height,'px"></div>'))},appendRow:function(t,i){for(var e=this,n=e.config.row.callbackId,o=e.config.row.backgroundColor2,a=0;a<t;a++){var h=b(e.rowStr),r="";a%2==1&&h.css({"background-color":o});for(var s=0;s<i.length;s++){var l=i[s]||{};r+=m({width:l.width,height:l.height,content:"",bgColor:l.backgroundColor,textAlign:l.textAlign,whiteWidth:0,className:"column cell-content",isBr:l.isBr,ifHeader:!1,ifRun:e.config.global.textAnimate.ifRun,fontSize:l.textStyle.fontSize,fontFamily:l.textStyle.fontFamily||e.config.global.fontFamily,color:l.textStyle.color,fontWeight:l.textStyle.fontWeight})}h.append(r),this.rowContainer&&this.rowContainer.append(h)}this.container.off("click",".row-content"),this.container.on("click",".row-content",function(t){var i=b(this).data("data");p.isObject(i)&&p.isNumber(i.index)&&1!==Object.keys(i).length&&e.emit("row-clicked",i),n&&""!==n&&(e.emit("click-rank-dot",i[n]),e.emit("global_var",n,i[n]))})},initRank:function(){this.clearAllTimer();var t=this.config,i=t.global.rowCount,e=t.header,n=t.idList,o=t.series,e=(this.columnNameList=p.map(o,"columnName"),this.dataPool=[],this.container.find(".row-content").off("click"),this.container.empty(),this.container.css({overflow:"hidden","background-color":t["background-color"]}),e.show?(e.hasIndex=n.show,e.idListWidth=n.width,e.height=t.height*(e.heightPercent/100),this.setHeader(o,e)):(e.height=0,this.container.find(".placeholder").css("height",0)),this.container.append('<div class="rows-container" style="height: '.concat(this.container.height()-(e.show?t.height*(e.heightPercent/100):0),'px;width:100%;overflow:hidden"></div>')),this.rowContainer=this.container.find(".rows-container"),{rowCount:i,height:(t.height-e.height)/i,hasIndex:n.show,idListWidth:n.width,idListRadius:n.radius,idListBgColor:n.backgroundColor,idListColor:n.textStyle.color,idListFontSize:n.textStyle.fontSize,idListFontFamily:n.textStyle.fontFamily||t.global.fontFamily,bgColor:t.row.backgroundColor1,fontWeight:n.textStyle.fontWeight});e.bgSize=Math.min(Math.floor(this.container.width()*n.width/100),e.height)*e.idListRadius/100-4,e.radius=e.bgSize/2,this.rowStr=u(e),i=this.config.global.animation.mode===L?i+1:2*i,this.appendRow(i,o,t.defaultCell)},updateData:function(t){t&&(this.dataPool=t)},getAnimationData:function(t,i){var e=this.config.global.animation.mode,n=0,o=p.get(this.config,"global.highLight"),a=o.isOrder,o=o.hightLightIndex,o=(e===L&&(n=a?i+1:o,a=p.filter(this._data,function(t,i){return i+1===n}),this.emit("highLight",{index:n,data:a})),this.getData(t,i,e===L?1:this.config.global.rowCount));return{data:o,index:o[0].index}},getData:function(t,i,e){var n=this.config,o=[],a=p.max([t.length,e]);i>t.length-1&&(n.global.animation.mode===L&&0<t.length?i%=a:i=0);for(var h=0;h<e;h++){var r=h+i,s=(r>t.length-1&&(n.global.animation.mode===L?t.length<e?a-1<=r&&(r-=a-1):r-=t.length:(r-(t.length-1)+t.length%(e/2)>e/2||t.length%(e/2)==0)&&(r%=e/2)),t[r]);s&&void 0!==s?((s=p.cloneDeep(s)).index=r+1,o.push(s)):o.push({index:r+1})}return o},setStartIndex:function(t,i,e){(i+=e)>p.max([t.length,this.config.global.rowCount])-1&&(i=0),this.startIndex=i},calTransform:function(t,i,e){var n=i.find(".marquee-text-span"),o=this.config.series[e].isBr;switch(t){case"left":return 0;case"center":return o?0:i.width()/2-n.width()/2;case"right":return o?0:i.width()-n.width()-1;default:return 0}},fillCell:function(n){for(var o=this,s=this,l=s.config,c=s.columnNameList||[],a=l.row.backgroundColor1,h=l.row.backgroundColor2,g=l.series,d=l.global.animation.mode,t=p.get(l,"global.highLight"),f=t.show,u=t.isOrder,m=t.hightLightIndex,i=(l.global.isLoop&&f&&x(this.$rowContent,this.config),0);i<this.$rowContent.length;i++)!function(t){var i,e,r=n[t],t=o.$rowContent[t];r&&(i=r.index,t=(e=b(t)).find(".cell-content"),e.data({index:i-1,data:r}),1===Object.keys(r).length&&l.global.ifRowHidden?e.css("opacity",0):e.css("opacity",1),t.each(function(t,i){var e=b(this),n=c[t],o=g[t].dataType,a="",h="";"img"===o&&r[n]?(style="width: ".concat(g[t].widthPercent,"px; margin-left: ").concat(p.get(g[t],"margin.left"),"px; margin-top: ").concat(p.get(g[t],"margin.top"),"px; font-size: 0;"),h='<img class="marquee-img" data-retry-num="0" src="'.concat(r[n]||"",'" style="').concat(style,'" />'),F.mutate(function(){e.css("font-size",0)})):h=r[n]||0===Number(r[n])?r[n]:"-",F.mutate(function(){(a=e.find(".marquee-text")).find(".marquee-text-span").html(h),a.find(".whiteSpace").css("width",l.width),"img"!==o&&a.css("transform","translateX(".concat(s.calTransform(g[t].textAlign,e,t),"px)"))})}),e.attr("highLightIndex",i),e.css("background-color",i%2==0?h:a).find(".index-bg").text(i),f&&d===L&&(u?(t=o.container.find(".row-content").eq(0),y(s.config,t),t=null):(t=p.toString(m).split(","),w(o.config,i,e),p.forEach(t,function(t){i==t&&y(o.config,e)}))))}(i)},textLoop:function(){var i=this,a=this,h=a.config;F.mutate(function(){for(var t=0;t<i.$rowContent.length;t++)!function(o){b(i.$rowContent[o]).find(".cell-content").each(function(t,i){var e=b(i).find(".marquee-text"),n=e.find(".whiteSpace");h.series[t].isBr&&n.css("width",0),!h.series[t].isBr&&h.global.textAnimate.ifRun&&e.find(".marquee-text-span").width()>b(i).width()&&(n.css("width",0),a.textRun("".concat(o+1,"-").concat(t),e,t))})}(t)})},textRun:function(t,i,e){var n=this,o=this.config,a=o.global.textAnimate,o=o.series,h=i.outerWidth()/2-i.find(".marquee-text-span").outerWidth(),h=i.outerWidth()/2+h+this.calTransform(o[e].textAlign,i.parent(),e),o=(h/a.speedRate).toFixed(2),r=i.parents(".row-content").attr("highlightindex"),s=a.isSpeed&&o||1e3*a.animateDur,l=A({targets:i[0],translateX:[0,-h],easing:"linear",loop:!0,duration:s,update:function(t){n.marqueePosition=d(d({},n.marqueePosition),{},c({},"".concat(r),{value:t.progress,duration:s}))}});l.pause(),p.mapKeys(n.marqueePosition,function(t,i){"".concat(r)==="".concat(i)&&l.seek(t.duration*(t.value/100))}),l.play(),l=null},animation:function(){var i=this,t=this.config,e=t.global.animation.mode,n=p.get(t,"global.highLight"),o=n.show,n=n.isOrder,a=p.map(this.$rowContent),o=(o&&(e===L?n&&(o=this.container.find(".row-content").eq(0),w(t,0,o),n=this.container.find(".row-content").eq(1),y(t,n)):e===T&&this.container.find(".row-content").eq(0).on("transitionend",this.transFunction())),e===L?(t.height-t.header.height)/t.global.rowCount:t.height-t.header.height);this.animationAnime=A({targets:a,translateY:[0,-o],easing:"linear",changeBegin:function(t){i.isTabFocus||(i.$marqueeText.each(function(){A.remove(b(this)[0])}),i.textLoop())},duration:S})},transFunction:function(){var t=this.config.global.rowCount,t=this.container.find(".row-content").slice(t,2*t);this.clearAllTimer(),this.fullScreenScroll(t)},fullScreenScroll:function(t){var i=this.config,e=p.get(i,"global.highLight.show",!1),i=(this.curScrollDoms=t,i.global.animation.duration*v);this.fullScreenIndex=0,this.removeHighLightTimer(),e&&this.fullScreenScrollTimeout(t,i)},fullScreenScrollTimeout:function(t,i){var e=this,n=this.config.global.rowCount,o=t.eq(this.fullScreenIndex),o=(x(this.$rowContent,this.config),y(this.config,o),this.fullScreenIndex++,this.highlightIndex=Number(o.attr("highlightIndex")),p.filter(this._data,function(t,i){return i+1===e.highlightIndex})),a=this.highlightIndex<=Math.ceil(this._data.length/n)*n,h=this.config.global.animation.mode;this.fullScreenTimer=n===this.fullScreenIndex?i+S:i,p.isNaN(this.highlightIndex)||(this.config.global.ifRowHidden?a&&h&&this.isTabFocus&&this.highlightIndex!==this._data.length+1?(this.highlightTime=setTimeout(this.fullScreenScrollTimeout.bind(this,t,i),this.fullScreenTimer),this.emit("highLight",{index:this.highlightIndex,data:o})):this.config.global.ifRowHidden&&this.isTabFocus&&this.render(this._data,this.config):a&&h&&this.isTabFocus&&(this.highlightTime=setTimeout(this.fullScreenScrollTimeout.bind(this,t,i),this.fullScreenTimer),this.emit("highLight",{index:this.highlightIndex,data:o}))),this.highlightIndex===this._data.length&&this.emit("scrollEnd",{message:"一轮滚动结束",isEnding:!0})},loop:function(){var t,i,e,n,o,a=this.config,h=(this.clearAllTimer(),this.dataPool);h&&(n=this.startIndex,e=a.global.rowCount,t=a.global.animation.mode,i=p.get(a,"global.highLight.show",!1),t===L?e+=o=1:(o=e,e*=2),this.isInit||(e=this.getData(h,this.startIndex,e),this.fillCell(e),this.animation(),this.setStartIndex(h,n,o),this.emit("data-flipped",this.getAnimationData(h,this.startIndex))),t===T&&i&&this.isInit&&(e=this.config.global.rowCount,n=this.container.find(".row-content").slice(0,e),this.fullScreenScroll(n)),this.textLoop(),this.isTabFocus&&(o=a.global.animation.duration*v,h=this.config.global.animation.mode===T&&i?a.global.rowCount*a.global.animation.duration*v:o,this.loopTimer=setTimeout(this.loop.bind(this),h)))},render:function(t,i){var e,n,o,a,h,r=this,s=this,i=this.mergeConfig(i);t=this.data(t),this.$rowContent=this.container.find(".row-content"),this.container.css({fontFamily:'"'.concat(i.global.fontFamily,'"'),transform:"translateZ(0px)"}),this.container.find(".header").css({fontFamily:'"'.concat(i.header.textStyle.fontFamily,'"')}),this.$marqueeText=s.container.find(".marquee-text"),t&&t.length?(this.updateData(t),n=i.global.rowCount,e=this.dataPool,!i.global.isLoop||i.global.animation.singleStop&&t.length<=i.global.rowCount?(this.clearAllTimer(!1),this.isInit=!0,e&&(n=i.global.animation.mode===L?n+1:2*n,t=this.getData(e,0,n),this.fillCell(t)),o=this.container.find(".row-content:first").height(),setTimeout(function(){o?(r.fillCell(r.getData(e,0,n)),r.emit("data-flipped",r.getAnimationData(e,0))):console.log("carousel-table first row height = 0"),r.textLoop()},0)):(t=this.startIndex,h=i.global.animation.mode,a=i.global.animation.duration*v,n=h===L?n+1:2*n,this.isInit&&(this.clearAllTimer(),e&&(h=this.getData(e,t,n),this.fillCell(h)),this.emit("data-flipped",this.getAnimationData(e,t)),this.loop(),this.visibleEventAddLoop||b(document).on("visibilitychange.carousel-table-component",p.debounce(function(){var t=document.visibilityState;"visible"===t?(s.isTabFocus=!0,s.restartTimers()):"hidden"===t&&(s.isTabFocus=!1,s.clearAllTimer())},a)),this.visibleEventAddLoop=!0,this.isInit=!1))):i.global.ifRowHidden&&(this.$rowContent.css("opacity",0),this.container.find(".rows-container").before('<div style="width: 100%; height: 30px; line-height: 30px; color: #fff; text-align: center;">无数据</div>'))},restartLoop:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:void 0,i=this.config,t=p.isUndefined(t)&&i.global.isLoop||t,e=this._data&&this._data.length>i.global.rowCount;!t||i.global.animation.singleStop&&!e||this.loop(),i.global.textAnimate.ifRun&&this.textLoop()},resize:function(t,i){this.render(null,{width:t,height:i})},fullScreenScrollTimeLeft:function(){var t=this.config.global.rowCount,i=Math.ceil(this.highlightIndex/t),e=Math.ceil(this._data.length/t),t=i*t-this.highlightIndex,i=i===e?this._data.length-this.highlightIndex-1:t-1;return p.isNaN(i)?0:i},restartTimers:function(){var t=this,i=this.config.global.highLight.show,e=this.config.global.animation.duration*v;t.config.global.animation.mode===T&&i?(i=t.fullScreenScrollTimeLeft(),t.loopDelayTime=setTimeout(function(){return t.restartLoop()},i*v+e),t.fullScreenScrollTimeout(t.curScrollDoms,e)):t.restartLoop()},data:function(t){return t&&((this.config.global.ifUpdateImd||this.config.global.animation.singleStop&&t.length<=this.config.global.rowCount)&&(this.isInit=!0,this.startIndex=0,this.initRank()),this._data=t),this._data},mergeConfig:function(t){if(!t)return this.config;var i=this.config,e=p.cloneDeep(t),t=p.defaultsDeep(t||{},i);return t.series=e.series||i.series,p.isEqual(i,t)||(this.config=t,this.isInit=!0,this.startIndex=0,this.initRank()),this.config},listenerImgCb:function(t){var t=t.target,i=p.toNumber(t.getAttribute("data-retry-num"));"IMG"!==t.nodeName.toUpperCase()||p.isNull(i)||(I<=i?t.src=C:(t.src=p.get(this.config,"global.defaultImg"),t.setAttribute("data-retry-num",i+=1)))},listenerImgError:function(){this.container[0].addEventListener("error",this.listenerImgCb.bind(this),!0)},startLoop:function(t){t=t.isLoop;this.isInit=!0,this.isTabFocus=!0,this.initInteraction(),this.restartLoop(!!p.isBoolean(t)&&t),this.isInit=!1},stopLoop:function(){this.clearAllTimer(),this.container.off("mouseenter").off("mouseleave")},highlight:function(t){if(p.isEmpty(t))return!1;var n,o=this,i=p.get(t,"hightLightStyle.color"),e=p.get(t,"hightLightStyle.borderColor"),a=p.get(t,"hightLightStyle.borderStyle"),h=p.get(t,"hightLightStyle.borderWidth"),r=p.get(t,"hightLightStyle.backgroundColor"),s=p.get(t,"hightLightStyle.fontSize"),l=p.get(t,"hightLightStyle.fontWeight"),c=p.get(t,"hightLightStyle.fontFamily"),g=p.get(t,"isOrder"),t=p.get(t,"hightLightIndex",""),i=d(d({},this.config),{},{global:d(d({},this.config.global),{},{highLight:d(d({},this.config.global.highLight),{},{show:!0,isOrder:g,hightLightIndex:t,hightLightStyle:d(d({},this.config.global.highLight.hightLightStyle),{},{textStyle:d(d({},this.config.global.highLight.hightLightStyle.textStyle),{},{color:i,fontSize:s,fontFamily:c,fontWeight:l}),backgroundColor:r,border:d(d({},this.config.global.highLight.hightLightStyle.border),{},{borderWidth:h,borderStyle:a,borderColor:e})})})})});g?this.render(this._data,i):(this.config=i,f(this.$rowContent,this.config),n=(t+"").split(","),this.$rowContent.each(function(t,i){for(var e=0;e<n.length;e++)n[e]===b(i).attr("highlightIndex")&&y(o.config,b(i))}))},removeHighLightTimer:function(){this.highlightTime&&clearTimeout(this.highlightTime)},clearAllTimer:function(){this.loopTimer&&clearTimeout(this.loopTimer),this.loopDelayTime&&clearTimeout(this.loopDelayTime),this.removeHighLightTimer(),this.loopTimer=null,this.highlightTime=null,this.loopDelayTime=null,this.animationAnime&&(this.animationAnime=null),this.$marqueeText&&this.$marqueeText.each(function(){A.remove(b(this)[0])})},destroy:function(){this.clearAllTimer(),this.container[0].removeEventListener("error",this.listenerImgCb,!0),this.container.find(".row-content").off("transitionend"),b(document).off("visibilitychange.carousel-table-component"),this.container.find(".row-content").off(),this.container.empty(),this._data=null,this.off&&this.off()},clearAnimate:function(){this.clearAllTimer()},startAnimate:function(){this.isInit=!0,this.restartLoop(),this.isInit=!1}}),t.exports});