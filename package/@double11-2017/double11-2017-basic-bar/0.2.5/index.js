// env=undefined => env=publish 
Cube("datav:/com/@double11-2017/double11-2017-basic-bar/0.2.5",["datav:/npm/bcore/0.0.18/event","datav:/npm/jquery/2.1.4","datav:/npm/lodash/4.17.4"],function(a,b,c){function d(a){return"\n  <div class=\"table-content\" style=\"display:flex; position: relative;\">\n    "+(a.index&&a.index.show&&"<div class=\"table-index\" style=\"flex: none;text-align: center;display:flex;justify-content: center;align-items: center;\"></div>"||"")+"\n    <div class=\"table-line\" style=\"position: relative;display:flex;align-items: center; flex:auto;\">\n      <div class=\"content-bar\" style=\"position: absolute; height: 100%;overflow: hidden;\"></div>\n      <div class=\"content-text\" style=\"position: absolute; white-space:nowrap;display:flex;justify-content: center;padding-left: 1em;\"></div>\n      <div class=\"content-value\" style=\"position: absolute; white-space:nowrap;display:flex;justify-content: center;padding-right: 1em; right: 0;\"></div>\n    </div>\n  </div>"}var e=c("datav:/npm/bcore/0.0.18/event"),f=c("datav:/npm/jquery/2.1.4"),g=c("datav:/npm/lodash/4.17.4");return a.exports=e.extend(function(a,b){this.config={rotate:!0,global:{padding:8,height:36},content:{fontSize:16,fontWeight:"normal",color:"#fff"},bar:{color:"#1371FB"},background:{color:"#1371fb"}},this.container=f(a).css({transform:"translate3d(0,0,0)"}),this.apis=b.apis,this._data=null,this.chart=null,this.isFirst=!0,this.animates=[],this.init(b)},{init:function(a){this.mergeConfig(a);this.lines=this.container.find(".table-line")},render:function(a){var b=this;if(a=this.data(a),a&&a.length&&this.max){var c=this.config,e=this.lines,f=c.global.count.toString()&&0!==c.global.count?c.global.count:a.length;if(f!=e.length){if(f>e.length){for(var h="",j=d(c),k=f-e.length,l=0;l<k;l++)h+=j;this.container.append(h)}else g.takeRight(e,e.length-f).remove();e=this.lines=this.container.find(".table-line"),this.indexs=this.container.find(".table-index"),this.bars=this.lines.find(".content-bar"),this.contents=this.lines.find(".content-text"),this.values=this.lines.find(".content-value")}this.updateStyle(),this.indexs.text(function(a){return a+1}).css({background:function(){return c.index&&c.index.background||"transparent"}}),this.contents.text(function(b){return a[b]&&a[b].content||""}),this.values.text(function(d){return(a[d]&&100*(a[d].value/b.sum)||0).toFixed(c.value.decimal||0)+"%"||""}),this.bars.css({width:function(c){return(a[c]&&100*(a[c].value/b.max)||0)+"%"}})}},updateOptions:function(a){this.mergeConfig(a),this.updateStyle()},updateStyle:function(){var a=this.config,b=this;this.container.css({fontFamily:a.global.fontFamily}),this.lines.css({height:a.global.height+"px",marginBottom:a.global.padding+"px",background:a.background.color,borderRadius:a.background.borderRadius}),a.index&&this.indexs.css(a.index.textarea).css({height:a.global.height+"px"}),this.contents.css(a.content.textarea),this.values.css(a.value.textarea),this.bars.css({background:a.bar.color,borderRadius:a.bar.borderRadius})},resize:function(){this.render()},data:function(a){if(a&&a[0]&&a[0].value){this.config;this._data=g.map(a,function(a){return a.value=g.toNumber(a.value)||0,a}),this.max=g.maxBy(this._data,"value").value,this.sum=g.sumBy(this._data,"value")}return this._data},mergeConfig:function(a){return a?(this.config=g.defaultsDeep(a||{},this.config),this.config):this.config},updateLayout:function(){},destroyTimeout:function(a){a.forEach(function(a){a&&clearTimeout(a)})},destroy:function(){}}),a.exports});