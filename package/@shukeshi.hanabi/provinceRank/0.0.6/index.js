// env=undefined => env=publish 
Cube("datav:/com/@shukeshi.hanabi/provinceRank/0.0.6/provinceRank.css", [], function(m){m.exports=".HANABI_ProvinceSpark{transform-origin:0 0}.HANABI_ProvinceSpark svg{display:inline-block}.HANABI_ProvinceSpark{position:relative;margin:0;padding:0}.HANABI_ProvinceSpark .legend{width:100%;line-height:110px}.HANABI_ProvinceSpark .legend>div{display:inline-block;width:49.5%;text-align:center}.HANABI_ProvinceSpark .legend svg{width:40px}.HANABI_ProvinceSpark .column{width:48%;display:inline-block}.HANABI_ProvinceSpark .column>div{width:100%}.HANABI_ProvinceSpark .column .prov>*{display:block;float:left}.HANABI_ProvinceSpark .column .prov .name{text-align:right;padding-right:5px}.HANABI_ProvinceSpark .column .bar{position:relative}.HANABI_ProvinceSpark .column .bar .valueBar{position:absolute;height:100%;left:0;top:0}.HANABI_ProvinceSpark .column .bar .spark{position:absolute;width:100%;height:100%;left:0;top:0}.HANABI_ProvinceSpark .column .number{text-align:right}";return m.exports});;
Cube("datav:/com/@shukeshi.hanabi/provinceRank/0.0.6/provinceRank.js",["datav:/npm/jquery/2.1.4","datav:/npm/d3/5.5.0"],function(a,b,c){var d=c("datav:/npm/jquery/2.1.4"),e=c("datav:/npm/d3/5.5.0");return c("datav:/com/@shukeshi.hanabi/provinceRank/0.0.6/provinceRank.css",""),a.exports=function(a){this.$container=d(a),this.render=function(a,b){this.destroy();this;b.sparkColor=b.options.chart.sparkColor||"#b3b3b3",b.rankColor=b.theme.color||b.options.chart.rankColor||"#4E62B6",b.barWidth=b.options.chart.barWidth||180,b.barHeight=b.options.chart.barHeight||40,b.barSpan=b.options.chart.barSpan||35;var c=b.options.number.fontLegend,f=b.options.chart.fontProv,g=b.options.chart.fontNumber;b.sparkWords=b.options.number.sparkWords||"\u6BCF\u65E5\u65B0\u589E\u786E\u8BCA\u66F2\u7EBF",b.rankWords=b.options.number.rankWords||"\u5404\u7701\u7D2F\u8BA1\u786E\u8BCA",b.margin=b.margin||10;var h=a.dataLink||"",i=a,j=this.$container;j.html("<div class=\"HANABI_ProvinceSpark\" style=\"margin: "+b.margin+"px;\">            <div class=\"legend\"></div>            <div class=\"left column\"></div>            <div class=\"right column\"></div>          </div>");var k=j.find(".HANABI_ProvinceSpark"),l=k[0],m=840,n=1400,o=Math.min(j.width()/m,j.height()/n);k.css({width:m+"px",height:n+"px",transform:"scale("+o+")"});var p=function(){var a="<svg viewBox=\"0 0 30.01 15.81\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"m.69 15.08 14.29-13.53 6.06 9.23 8.23-9.23\" fill=\"none\" stroke=\""+b.sparkColor+"\" stroke-miterlimit=\"10\" stroke-width=\"2\"/></svg>",d="<svg viewBox=\"0 0 26.33 15.63\" xmlns=\"http://www.w3.org/2000/svg\"><path d=\"m0 0h26.33v15.63h-26.33z\" fill=\""+b.rankColor+"\"/></svg>",e="<div>"+a+" "+b.sparkWords+"</div>",f="<div>"+d+" "+b.rankWords+"</div>";k.find(".legend").html(e+f).css(c)},q=[],r={},s=1,t=function(a,d){var h=e.select("."+d).selectAll(".prov").data(a).enter().append("div").attr("class","prov").style("height",b.barHeight+"px").style("margin-bottom",b.barSpan+"px"),c=h.append("span").attr("class","name").style("color",f.color).style("font-size",f.fontSize+"px").style("line-height",b.barHeight+"px").style("font-weight",f.fontWeight).style("font-family",f.fontFamily).style("width",3.5*f.fontSize+"px").html(function(a){return a.area}),i=h.append("div").attr("class","bar").style("display","inline-block").style("width",b.barWidth+"px").style("height",b.barHeight+"px").style("line-height",b.barHeight+"px").html("&nbsp;"),j=i.append("div").attr("class","valueBar").style("width",function(a){return a.value/s*b.barWidth+"px"}).style("background",b.rankColor).html("&nbsp;"),k=i.append("svg:svg").attr("class","spark").append("svg:path").attr("d",function(a){var c=a.values,f=e.scaleLinear().domain([0,c.length-1]).range([0,b.barWidth]),g=e.scaleLinear().domain([e.max(c),e.min(c)]).range([0,b.barHeight]),d=e.line().x(function(a,b){return f(b)}).y(function(a){return g(a)});return d(c)}).attr("fill","none").attr("stroke",b.sparkColor).attr("stroke-width","3px"),l=h.append("span").attr("class","number").style("line-height",b.barHeight+"px").style("width","calc(100% - "+(3.5*f.fontSize+b.barWidth+10)+"px)").style("margin-left","8px").style("color",g.color).style("font-size",g.fontSize+"px").style("font-weight",g.fontWeight).style("font-family",g.fontFamily).style("text-align","right").html(function(a){return function(a){return a.toString().replace(/(\d)(?=(\d{3})+(?!\d))/g,"$1,")}(a.value)})},u=function(){var a=Object.keys(r),b=q.sort(function(c,a){return a.value-c.value});s=Math.max(e.max(q,function(a){return a.value}),1e-3);var c=b.slice(0,Math.ceil(b.length/2));t(c,"left"),t(b.slice(c.length),"right")};(function(a){var b=function(){r={},q=i.map(function(a){return r[a.area]=a,{area:a.area,values:a.lineValue,value:a.barValue}}),a&&a()};h?d.getJSON(h,function(a){i=a.data,b()}):setTimeout(b)})(function(){p(),u()})},this.destroy=function(){}},a.exports});;
Cube("datav:/com/@shukeshi.hanabi/provinceRank/0.0.6",["datav:/npm/bcore/0.0.18/event","datav:/npm/jquery/2.1.4","datav:/npm/lodash/4.6.1"],function(a,b,c){var d=c("datav:/npm/bcore/0.0.18/event"),e=c("datav:/npm/jquery/2.1.4"),f=c("datav:/npm/lodash/4.6.1"),g=c("datav:/com/@shukeshi.hanabi/provinceRank/0.0.6/provinceRank.js");return a.exports=d.extend(function(a,b){this.config={theme:{}},this.container=e(a),this.apis=b.apis,this._data=null,this.chart=null,this.init(b)},{init:function(a){this.mergeConfig(a),this.updateLayout(),this.chart=new g(this.container[0],this.config),this.updateStyle()},render:function(a,b){a=this.data(a);var c=this.mergeConfig(b);this.chart.render(a,c)},resize:function(){this.data()&&this.chart.render(this.data(),this.config)},setColors:function(){},data:function(a){return a&&(this._data=a),this._data},mergeConfig:function(a){if(!a)return this.config;var b=this.getThemableConfig();return this.config.theme=f.defaultsDeep(a.theme||{},b),this.setColors(),this.config=f.defaultsDeep(a||{},this.config),this.config},updateLayout:function(){},updateStyle:function(){this.data()&&this.chart.render(this.data(),this.config)},getThemableConfig:function(a){return a?{color:a.palette[0]}:null},destroy:function(){this.chart.destroy()}}),a.exports});