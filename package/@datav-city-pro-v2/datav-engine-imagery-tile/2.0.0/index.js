// env=undefined => env=publish 
Cube("datav:/com/@datav-city-pro-v2/datav-engine-imagery-tile/2.0.0/MapLayer",[],function(t,e,r,o,n,i){function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function l(t){return function(t){if(Array.isArray(t))return s(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return s(t,e);var r=Object.prototype.toString.call(t).slice(8,-1);return"Map"===(r="Object"===r&&t.constructor?t.constructor.name:r)||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?s(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}function s(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,o=new Array(e);r<e;r++)o[r]=t[r];return o}function c(e,t){var r,o=Object.keys(e);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(e),t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),o.push.apply(o,r)),o}function u(o){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?c(Object(n),!0).forEach(function(t){var e,r;e=o,r=n[t=t],t in e?Object.defineProperty(e,t,{value:r,enumerable:!0,configurable:!0,writable:!0}):e[t]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(o,Object.getOwnPropertyDescriptors(n)):c(Object(n)).forEach(function(t){Object.defineProperty(o,t,Object.getOwnPropertyDescriptor(n,t))})}return o}function y(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function p(){return(p="undefined"!=typeof Reflect&&Reflect.get?Reflect.get:function(t,e,r){var o=function(t,e){for(;!Object.prototype.hasOwnProperty.call(t,e)&&null!==(t=b(t)););return t}(t,e);if(o)return o=Object.getOwnPropertyDescriptor(o,e),o.get?o.get.call(arguments.length<3?t:r):o.value}).apply(this,arguments)}function f(t,e){return(f=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function h(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=b(r),e=(t=o?(t=b(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function b(t){return(b=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}return t.exports=function(t){var e=t.Utils,r=t.VG,o=t.viewer,t=r.Layer,n=s;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");n.prototype=Object.create(t&&t.prototype,{constructor:{value:n,writable:!0,configurable:!0}}),Object.defineProperty(n,"prototype",{writable:!1}),t&&f(n,t);var i,a=h(s);function s(t){var e;if(this instanceof s)return(e=a.call(this)).options=t,e.classNameAlias="MapLayer",e.needsWait=!1,e;throw new TypeError("Cannot call a class as a function")}return n=s,(t=[{key:"addTo",value:function(t){t=p(b(s.prototype),"addTo",this).call(this,t);return this.init(),t}},{key:"init",value:function(){this.initMapLayer()}},{key:"initMapLayer",value:function(){var t,e;!this.layer&&0<(null==(t=this.data)?void 0:t.length)&&(t=u(u({},this.data[0]),{},{order:this.options.options.data.order,opacity:this.options.options.style.opacity,hsb:{h:this.options.options.style.hsb.h,s:this.options.options.style.hsb.s,b:this.options.options.style.hsb.b}}),(e=o.getLayer("rasterLayer"))||(e=new r.RasterLayer("global"),o.addLayer("rasterLayer",e)),e=e.addTileMapLayer(t),this.layer=e,this.visible?this.show():this.hide())}},{key:"removeMapLayer",value:function(){this.layer&&(o.surface.surfaceLayer.removeMapLayer(this.layer),o.surface.surfaceLayer.refresh(),this.layer=null)}},{key:"setData",value:function(t){e.deepDiff(this.data,t)||(this.data=l(t),this.removeMapLayer(),this.initMapLayer())}},{key:"updateOptions",value:function(){var t=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};(this.layer&&this.options.options.data.order!==t.options.data.order||!e.deepDiff(this.options.options.style,t.options.style))&&(this.layer.updateOptions({order:t.options.data.order,opacity:t.options.style.opacity,hsb:{h:t.options.style.hsb.h,s:t.options.style.hsb.s,b:t.options.style.hsb.b}}),this.options=e.mergeOptions(this.options,t||{}))}},{key:"updateSceneId",value:function(){this.group.layers.enableAll()}},{key:"remove",value:function(){p(b(s.prototype),"remove",this).call(this),this.removeMapLayer(),this.layer=null}},{key:"show",value:function(){this.visible=!0,this.layer&&this.layer.show()}},{key:"hide",value:function(){this.visible=!1,this.layer&&this.layer.hide()}}])&&y(n.prototype,t),i&&y(n,i),Object.defineProperty(n,"prototype",{writable:!1}),s},t.exports});;
Cube("datav:/com/@datav-city-pro-v2/datav-engine-imagery-tile/2.0.0",["datav:/npm/eventemitter3/3.0.0"],function(t,e,r,o,n,i){function a(t){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(t)}function c(t,e){for(var r=0;r<e.length;r++){var o=e[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function u(t,e){return(u=Object.setPrototypeOf||function(t,e){return t.__proto__=e,t})(t,e)}function y(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(t){return!1}}();return function(){var t,e=l(r),e=(t=o?(t=l(this).constructor,Reflect.construct(e,arguments,t)):e.apply(this,arguments),this);if(t&&("object"===a(t)||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==e)return e;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function l(t){return(l=Object.setPrototypeOf?Object.getPrototypeOf:function(t){return t.__proto__||Object.getPrototypeOf(t)})(t)}var s=r("datav:/npm/eventemitter3/3.0.0"),f=r("datav:/com/@datav-city-pro-v2/datav-engine-imagery-tile/2.0.0/MapLayer"),r=function(){var t=n,e=s;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&u(t,e);var r,o=y(n);function n(t,e){var r;if(this instanceof n)return(r=o.call(this)).options=e,r.visible=!0,r.comId="",r.type="ImageryTilelayer",r;throw new TypeError("Cannot call a class as a function")}return t=n,(e=[{key:"addTo",value:function(t,e){return this.cityproCore=t,this.comId=e,this.initLayer()}},{key:"initLayer",value:function(){var t=f(this.cityproCore);this.layer=new t(this.options),this.cityproCore.viewer.addLayer(this.comId,this.layer),this.visible?this.layer.show():this.layer.hide()}},{key:"setData",value:function(t){this.layer&&this.layer.setData(t)}},{key:"updateOptions",value:function(t){this.layer&&this.layer.updateOptions(t)}},{key:"show",value:function(){this.visible=!0,this.layer&&this.layer.show()}},{key:"hide",value:function(){this.visible=!1,this.layer&&this.layer.hide()}},{key:"destroy",value:function(){this.layer&&(this.layer.remove(),this.layer=null)}}])&&c(t.prototype,e),r&&c(t,r),Object.defineProperty(t,"prototype",{writable:!1}),n}();return t.exports=r,t.exports});