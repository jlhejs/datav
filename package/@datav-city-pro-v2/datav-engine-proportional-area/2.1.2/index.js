// env=undefined => env=publish 
Cube("datav:/com/@datav-city-pro-v2/datav-engine-proportional-area/2.1.2/shader/inner.frag.glsl",[],function(n,e,t,i,a,r){return n.exports="#define GLSLIFY 1\n#define STANDARD\n#ifdef PHYSICAL\n\t#define REFLECTIVITY\n\t// #define CLEARCOAT\n\t// #define TRANSMISSION\n#endif\n\n// original in meshphysical_frag.glsl\nuniform vec3 diffuse;\nuniform vec3 emissive;\nuniform float roughness;\nuniform float metalness;\nuniform float opacity;\n\n// #ifdef TRANSMISSION\n// \tuniform float transmission;\n// #endif\n#ifdef REFLECTIVITY\n\tuniform float reflectivity;\n#endif\n// #ifdef CLEARCOAT\n// \tuniform float clearcoat;\n// \tuniform float clearcoatRoughness;\n// #endif\n#ifdef USE_SHEEN\n\tuniform vec3 sheen;\n#endif\n\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n\n#include <common>\n#include <packing>\n#include <dithering_pars_fragment>\n#include <color_pars_fragment>\n#include <uv_pars_fragment>\n#include <uv2_pars_fragment>\n#include <map_pars_fragment>\n#include <alphamap_pars_fragment>\n#include <aomap_pars_fragment>\n#include <lightmap_pars_fragment>\n#include <emissivemap_pars_fragment>\n// #include <transmissionmap_pars_fragment>\n#include <bsdfs>\n#include <cube_uv_reflection_fragment>\n#include <envmap_common_pars_fragment>\n#include <envmap_physical_pars_fragment>\n#include <fog_pars_fragment>\n#include <lights_pars_begin>\n#include <lights_physical_pars_fragment>\n#include <shadowmap_pars_fragment>\n#include <bumpmap_pars_fragment>\n#include <normalmap_pars_fragment>\n// #include <clearcoat_pars_fragment>\n#include <roughnessmap_pars_fragment>\n#include <metalnessmap_pars_fragment>\n#include <logdepthbuf_pars_fragment>\n#include <clipping_planes_pars_fragment>\n \n// uniform float u_brightBandWidth;\n// uniform float u_time;\n// uniform vec4 u_color; \nuniform vec4 u_sideTexture_color; //侧面纹理颜色\nuniform vec2 u_uvScale;\nuniform float u_uvDelta;\nuniform sampler2D u_side_texture;\n\nvarying float v_faceType;\nvarying float v_id;\nvarying vec3 v_normal;\nvarying vec2 vUv;\n \n\nvoid main() {\n\n\t#include <clipping_planes_fragment>\n \n\t// 后期渲染模块会统一做gamma校正，\n    // 为了图元渲染颜色和配置项设置颜色保持一致，需要做以下处理以抵消\n\tvec4 gamaCorrectDiffuse = vec4(pow(diffuse.r, 2.2), pow(diffuse.g, 2.2),pow(diffuse.b, 2.2), opacity);\n    vec4 gamaCorrectSideTextureColor = pow(u_sideTexture_color,vec4(2.2));\n\n    // diffuse主要由在 MeshStandardMaterial 的color 属性决定\n    // vec4 diffuseColor = vec4( gamaCorrectDiffuse, opacity ); \n    vec4 diffuseColor = gamaCorrectDiffuse;  \n\n\tvec3 rawDiffuseColor = diffuseColor.rgb;\n\n\tReflectedLight reflectedLight = ReflectedLight( vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ), vec3( 0.0 ) );\n\tvec3 totalEmissiveRadiance = emissive;\n\n\t// #ifdef TRANSMISSION\n\t// \tfloat totalTransmission = transmission;\n\t// #endif\n\n\t#include <logdepthbuf_fragment>\n\t#include <map_fragment>\n\t#include <color_fragment>\n\t#include <alphamap_fragment>\n\t#include <alphatest_fragment>\n\t#include <roughnessmap_fragment>\n\t#include <metalnessmap_fragment>\n\t#include <normal_fragment_begin>\n\t#include <normal_fragment_maps>\n\t// #include <clearcoat_normal_fragment_begin>\n\t// #include <clearcoat_normal_fragment_maps>\n\t// #include <emissivemap_fragment>\n\t// #include <transmissionmap_fragment>\n\n\t#include <lights_physical_fragment>\n\t#include <lights_fragment_begin>\n\t#include <lights_fragment_maps>\n\t#include <lights_fragment_end>\n\t#include <aomap_fragment>\n\n    if(abs(v_faceType - 2.0) < EPSILON ){\n\t\t// top\n\t\t// vec3 outgoingLight = diffuse + totalEmissiveRadiance + reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t\t  \n\t    vec3 outgoingLight = vec3(gamaCorrectDiffuse) + totalEmissiveRadiance + reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\t\tgl_FragColor = vec4(outgoingLight, opacity); \n\t}else if(abs(v_faceType - 1.0) < EPSILON){\n\t\t// side\n        vec4 sideColor = diffuseColor;\n\n\t\tif(u_uvDelta > -9.9) {\n\t\t\tvec2 scaledUv = vUv * u_uvScale;\n\t\t\tscaledUv.y -= u_uvDelta;\n\n\t\t\tvec4 sideTexColor = texture2D(u_side_texture, scaledUv);\n\t\t\t// sideTexColor = mix(vec4(.0), sideTexColor, sideTexColor.a);\n\n\t\t\tvec4 maskColor = sideTexColor * gamaCorrectSideTextureColor;\n\t\t\t// sideColor = mix(diffuseColor, maskColor, maskColor);\n\t\t\tsideColor += maskColor;\n\t\t}\n\t\t \n\t\tfloat opacityFactor = 1.5;    \n\t\t#ifdef USE_GRADIENT\n\t\t  opacityFactor *= pow(vUv.y, 2.0);\n\t\t#endif\n\t\topacityFactor = min(1.0, opacityFactor);\n\n\t\ttotalEmissiveRadiance = vec3(sideColor.r, sideColor.g, sideColor.b);\n\t\tvec3 outgoingLight = totalEmissiveRadiance + reflectedLight.directDiffuse + reflectedLight.indirectDiffuse + reflectedLight.directSpecular + reflectedLight.indirectSpecular;\n\n\t\tgl_FragColor = vec4( outgoingLight, opacityFactor * opacity  ); \n\n    }else{\n\t\t// bottom\n\t    discard;\n\t}\n\n\t// #include <tonemapping_fragment>\n\t// #include <encodings_fragment>\n\n\t#include <fog_fragment>\n\t#include <premultiplied_alpha_fragment>\n\t#include <dithering_fragment>\n}",n.exports});;
Cube("datav:/com/@datav-city-pro-v2/datav-engine-proportional-area/2.1.2/shader/inner.vert.glsl",[],function(n,e,t,r,i,a){return n.exports="#define GLSLIFY 1\n#define STANDARD\nvarying vec3 vViewPosition;\n\n#ifndef FLAT_SHADED\n\tvarying vec3 vNormal;\n\t#ifdef USE_TANGENT\n\t\tvarying vec3 vTangent;\n\t\tvarying vec3 vBitangent;\n\t#endif\n#endif\n\n#include <common>\n#include <uv_pars_vertex>\n#include <uv2_pars_vertex>\n#include <displacementmap_pars_vertex>\n#include <color_pars_vertex>\n#include <fog_pars_vertex>\n#include <morphtarget_pars_vertex>\n#include <skinning_pars_vertex>\n#include <shadowmap_pars_vertex>\n#include <logdepthbuf_pars_vertex>\n#include <clipping_planes_pars_vertex>\n\nattribute float id;\nattribute float faceType;\nvarying float v_id;\nvarying vec3 v_normal;\nvarying float v_faceType;\nvarying vec2 vUv;\n\n// copied from three/src/renderers/shaders/ShaderLib\nvoid main() {\n\t#include <uv_vertex>\n\t#include <uv2_vertex>\n\t#include <color_vertex>\n\n\t#include <beginnormal_vertex>\n\t#include <morphnormal_vertex>\n\t#include <skinbase_vertex>\n\t#include <skinnormal_vertex>\n\t#include <defaultnormal_vertex>\n\n#ifndef FLAT_SHADED\n\tvNormal = normalize( transformedNormal );\n\t#ifdef USE_TANGENT\n\t\tvTangent = normalize( transformedTangent );\n\t\tvBitangent = normalize( cross( vNormal, vTangent ) * tangent.w );\n\t#endif\n#endif\n\n    v_id = id;\n    v_faceType=faceType;\n\tvUv = uv;\n\n    v_normal = normalMatrix * normal;\n\n\tvec3 transformed = vec3( position );\n\t#include <morphtarget_vertex>\n\t#include <skinning_vertex>\n\t#include <displacementmap_vertex>\n\t#include <project_vertex>\n\t#include <logdepthbuf_vertex>\n\t#include <clipping_planes_vertex>\n\tvViewPosition = - mvPosition.xyz;\n\t#include <worldpos_vertex>\n\t#include <shadowmap_vertex>\n\t#include <fog_vertex>\n}",n.exports});;
Cube("datav:/com/@datav-city-pro-v2/datav-engine-proportional-area/2.1.2/proportionalArea",["datav:/npm/@turf/transform-scale/5.1.5"],function(e,t,p,r,a,i){function n(e){return(n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(t,e){var r,a=Object.keys(t);return Object.getOwnPropertySymbols&&(r=Object.getOwnPropertySymbols(t),e&&(r=r.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),a.push.apply(a,r)),a}function l(a){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{};e%2?o(Object(i),!0).forEach(function(e){var t,r;t=a,r=i[e=e],e in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r}):Object.getOwnPropertyDescriptors?Object.defineProperties(a,Object.getOwnPropertyDescriptors(i)):o(Object(i)).forEach(function(e){Object.defineProperty(a,e,Object.getOwnPropertyDescriptor(i,e))})}return a}function f(e,t){for(var r=0;r<t.length;r++){var a=t[r];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}function c(){return(c="undefined"!=typeof Reflect&&Reflect.get?Reflect.get.bind():function(e,t,r){var a=function(e,t){for(;!Object.prototype.hasOwnProperty.call(e,t)&&null!==(e=y(e)););return e}(e,t);if(a)return(a=Object.getOwnPropertyDescriptor(a,t)).get?a.get.call(arguments.length<3?e:r):a.value}).apply(this,arguments)}function h(e,t){return(h=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function d(r){var a=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=a?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===n(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var D=p("datav:/npm/@turf/transform-scale/5.1.5");function m(e,t){var r;e&&((r=e.getAttribute("position")).array.length=0,r.array=t,r.needsUpdate=!0,e.computeBoundingSphere(),e.computeBoundingBox())}return e.exports=function(b){var O=b.THREE,u=b.Utils,r=b.VG,e=r.Layer,t=b.FormatTransformer,w=b.coordHelper,a=(new O.TextureLoader).setCrossOrigin("*"),i=s;if("function"!=typeof e&&null!==e)throw new TypeError("Super expression must either be null or a function");i.prototype=Object.create(e&&e.prototype,{constructor:{value:i,writable:!0,configurable:!0}}),Object.defineProperty(i,"prototype",{writable:!1}),e&&h(i,e);var n,o=d(s);function s(e){var t;if(this instanceof s)return(t=o.call(this)).classNameAlias="ProportionalAreaLayer",t.layerName=t.classNameAlias,t.renderQueue=r.Transparent,t.needsAutoUpdate=!0,t.options=Object.assign({},e||{}),t.needsWait=!0,t.innerScaledGeoData=[],t.enableInteractive=!1,t.innerMaterialMap=new Map,t.outerMaterialMap=new Map,t;throw new TypeError("Cannot call a class as a function")}return i=s,(e=[{key:"addTo",value:function(e){c(y(s.prototype),"addTo",this).call(this,e),this.formatTransformer=new t,this.animEnabled=!1,this.currentId=null,this.innerMap=new Map,this.outerMap=new Map,this.innerOk=!1,this.outerOk=!1}},{key:"setData",value:function(e){if(this.clear(),this.data=null,!e)return this.emit("rendered"),console.error("".concat(this.classNameAlias,": no data."));if(Array.isArray(e))this.data=this.formatTransformer.datav2geojson(e);else{if(!e.features&&!Array.isArray(e.features))return this.emit("rendered"),console.error("".concat(this.classNameAlias,": invalid data, ").concat(e,"."));this.data=e}if(!this.data.features.length)return this.emit("rendered"),console.error("".concat(this.classNameAlias,": the length of data is 0, ").concat(e,"."));this.processing()}},{key:"processing",value:function(){var f,c=this,e=this.options.options.animate.animateOpts,t=e.sideTextureUrl,r=e.uvScale,e=e.sideTextureColor,t=(this.sideMap=a.load(t),this.sideMap.wrapS=O.RepeatWrapping,this.sideMap.wrapT=O.RepeatWrapping,u.Chroma(e).gl()),e=(this.uniforms={u_uvDelta:{value:0},uvScale:{value:new O.Vector2(r.x,r.y)},u_sideTexture_color:{value:new O.Vector4(t[0],t[1],t[2],t[3])},u_side_texture:{value:this.sideMap}},this.options.options),r=e.general,t=e.graph,h=r.defaultBase,d=t.defaultScale,y=t.defaultHeight,m=t.defaultHeightRatio,v=t.defaultInnerColor,g=t.defaultOuterColor,M=[];this.data.features.forEach(function(e,t){void 0!==(f=e.properties||{}).innerColor&&(v=f.innerColor),void 0!==f.outerColor&&(g=f.outerColor),void 0!==f.base&&(h=f.base),void 0!==f.scale&&(d=f.scale),void 0!==f.height&&(y=f.height),void 0!==f.heightRatio&&(m=f.heightRatio),void 0===f.id&&(f.id=t),e.properties=e.properties||f;var r,i,n,a,s,u,p,l=c.innerMaterialMap.get(v),o=(l||(l=c.initMaterial(v,"inner"),c.innerMaterialMap.set(v,l)),c.outerMaterialMap.get(g)),t=(o||(o=c.initMaterial(g,"outer"),c.outerMaterialMap.set(g,o)),r=h,i=e,n=y,new Promise(function(a){var e={standard:!0,isCenter:!0,attr1:function(e){return e.properties.id},attr2:n,projType:w.crs,top:r+n,base:r,withBottom:!0,withTop:!0};b.superWorker.executeAsPromise("GEOJSON-EXTRUDE",[{type:"FeatureCollection",features:[i]},e]).then(function(e){var t=e.attrs1[0],r=c.genGeometry(e).geometry,r=new O.Mesh(r,o);r.position.fromArray(e.center),c.add(r),c.outerMap.set(t,r),c.animationById(c.currentId),a()})})),t=(M.push(t),D({type:"FeatureCollection",features:[e]},d)),e=(c.innerScaledGeoData.push(t),a=h,s=t,u=y,p=m,new Promise(function(o){var e={standard:!0,isCenter:!0,projType:w.crs,top:a+u*p,attr1:function(e){return e.properties.id},attr2:u,attr3:p,base:a,withBottom:!0,withTop:!0};b.superWorker.executeAsPromise("GEOJSON-EXTRUDE",[s,e]).then(function(e){var t=e.attrs1[0],r=e.attrs3[0],a=e.positions,i=e.center,e=c.genGeometry(e).geometry,e=new O.Mesh(e,l),n=(e.position.fromArray(i),e.userData.innerMeshGeoDataMap);n?n.clear():(n=new Map,e.userData.innerMeshGeoDataMap=n),n.set(r,{positions:a,center:i}),c.add(e),c.innerMap.set(t,e),c.animationById(c.currentId),o()})}));M.push(e)}),Promise.all(M).then(function(){c.emit("rendered"),c.needsWait=!1})}},{key:"dataErrorHandler",value:function(){this.emit("rendered"),this.needsWait=!1}},{key:"genGeometry",value:function(e){var t=e.positions,r=e.uvs,a=e.normals,i=e.attrs1,e=e.faceType,n=new O.BufferGeometry;return n.setAttribute("position",new O.BufferAttribute(t,3)),n.setAttribute("normal",new O.BufferAttribute(a,3)),n.setAttribute("uv",new O.BufferAttribute(r,2)),n.setAttribute("id",new O.BufferAttribute(i,1)),n.setAttribute("faceType",new O.BufferAttribute(e,1)),n.computeBoundingSphere(),n.computeBoundingBox(),{geometry:n}}},{key:"initMaterial",value:function(e,t){var r,a=u.Chroma(e).gl(),i=this.options.options.general,n=i.depthTest,o=i.depthWrite,i=i.blendingType,s=null;return"inner"===t?(r={u_side_texture:this.uniforms.u_side_texture,u_sideTexture_color:this.uniforms.u_sideTexture_color,u_uvScale:this.uniforms.uvScale,u_uvDelta:this.uniforms.u_uvDelta},t=u.Chroma(e).hex()||"#ffffffff",(s=new O.MeshStandardMaterial({color:7<t.length?t.slice(0,7):t,opacity:a[3],transparent:!0,blending:O[i],side:O.FrontSide,depthTest:n,depthWrite:o,defines:{USE_GRADIENT:!0}})).onBeforeCompile=function(e){e.uniforms=l(l({},e.uniforms),r),e.vertexShader=p("datav:/com/@datav-city-pro-v2/datav-engine-proportional-area/2.1.2/shader/inner.vert.glsl"),e.fragmentShader=p("datav:/com/@datav-city-pro-v2/datav-engine-proportional-area/2.1.2/shader/inner.frag.glsl")}):s=new O.MeshLambertMaterial({color:new O.Color(a[0],a[1],a[2]),transparent:!0,opacity:a[3],side:O.FrontSide,depthTest:n,depthWrite:o}),s}},{key:"checkVisible",value:function(){this.options.visible?this.show():this.hide()}},{key:"show",value:function(){c(y(s.prototype),"show",this).call(this)}},{key:"hide",value:function(){c(y(s.prototype),"hide",this).call(this)}},{key:"updateDefaultInnerColor",value:function(e,t){var r,a;this.innerMaterialMap&&!u.easyDiff(e,t)&&(r=this.innerMaterialMap.get(e))&&(a=7<(a=u.Chroma(t).hex()||"#ffffffff").length?a.slice(0,7):a,r.color=new O.Color(a),a=u.Chroma(t).gl()[3],r.opacity=a,this.innerMaterialMap.delete(e),this.innerMaterialMap.set(t,r))}},{key:"updateDefaultOuterColor",value:function(e,t){var r;this.outerMaterialMap&&!u.easyDiff(e,t)&&(r=this.outerMaterialMap.get(e))&&(this.outerMaterialMap.delete(e),this.outerMaterialMap.set(t,r),e=u.Chroma(t).gl(),(t=r.color).r=e[0],t.g=e[1],t.b=e[2],r.opacity=e[3],r.needsUpdate=!0)}},{key:"updateMaterialDepth",value:function(){var e=this.options.options.general,t=e.depthTest,r=e.depthWrite;this.innerMap.forEach(function(e){e=e.material;e.depthTest=t,e.depthWrite=r}),this.outerMap.forEach(function(e){e=e.material;e.depthTest=t,e.depthWrite=r})}},{key:"defaultHeightRatio",set:function(o){var s=this;if(this.innerScaledGeoData)for(var e=this.options.options,t=e.general,e=e.graph,u=t.defaultBase,p=e.defaultHeight,r=0,a=this.innerScaledGeoData.length;r<a;r++)(function(e){var t=s.data.features[e];if(t.properties&&t.properties.heightRatio)return;t.properties&&t.properties.height&&(p=t.properties.height),void 0!==t.properties.base&&(u=t.properties.base);var r,a,i=s.innerMap.get(t.properties.id),t=null,n=null;i.userData.innerMeshGeoDataMap.has(o)&&(t=(r=i.userData.innerMeshGeoDataMap.get(o)).positions,n=r.center),t&&n?i.geometry&&(m(i.geometry,t),i.position.fromArray(n)):(r=s.innerScaledGeoData[e],t=u,n=p,a=o,n={standard:!0,isCenter:!0,projType:w.crs,top:t+n*a,attr1:function(e){return e.properties.id},attr2:n,attr3:a,base:t,withBottom:!0,withTop:!0},b.superWorker.executeAsPromise("GEOJSON-EXTRUDE",[r,n]).then(function(e){var t=e.positions,e=e.center;i.position.fromArray(e),i.userData.innerMeshGeoDataMap.set(a,{positions:t,center:e}),i.geometry&&m(i.geometry,t)}))})(r)}},{key:"animate",value:function(){var e=(t=this.options.options.animate).enableSideAnimate,t=t.animateOpts.uvSpeed,r=(this.uniforms||{}).u_uvDelta;r&&(e?r.value<=10&&-1<r.value?r.value+=t:r.value=0:r.value=-100)}},{key:"autoUpdate",value:function(){this.animate()}},{key:"animationById",value:function(t){null!=t&&(this.innerMap.forEach(function(e){e=e.material;e.uniforms.u_anim_enable.value=1,e.uniforms.u_anim_index.value=0,e.uniforms.u_anim_id.value=t}),this.outerMap.forEach(function(e){e=e.material;e.uniforms.u_anim_enable.value=1,e.uniforms.u_anim_index.value=0,e.uniforms.u_anim_id.value=t}),this.animEnabled=!0,this.currentId=t)}},{key:"cancelAnimation",value:function(){this.currentId=null,this.innerMap.forEach(function(e){e.material.uniforms.u_anim_enable.value=0}),this.outerMap.forEach(function(e){e.material.uniforms.u_anim_enable.value=0})}},{key:"sideTextureUrlHandler",value:function(e){this.uniforms&&(this.sideMap&&this.sideMap.dispose&&this.sideMap.dispose(),this.sideMap=a.load(e),this.sideMap.wrapS=O.RepeatWrapping,this.sideMap.wrapT=O.RepeatWrapping,this.uniforms.u_side_texture.value=this.sideMap)}},{key:"sideTextureColorHandler",value:function(e){this.uniforms&&(e=u.Chroma(e).gl(),this.uniforms.u_sideTexture_color.value=new O.Vector4(e[0],e[1],e[2],e[3]))}},{key:"updateOptions",value:function(t){var e=u.deepClone(this.options);if(this.options=u.mergeOptions(this.options,t||{}),u.easyDiff(e.options.graph.defaultInnerColor,t.options.graph.defaultInnerColor)||this.updateDefaultInnerColor(e.options.graph.defaultInnerColor,t.options.graph.defaultInnerColor),u.easyDiff(e.options.graph.defaultOuterColor,t.options.graph.defaultOuterColor)||this.updateDefaultOuterColor(e.options.graph.defaultOuterColor,t.options.graph.defaultOuterColor),u.easyDiff(e.options.general.blendingType,t.options.general.blendingType)||this.innerMaterialMap&&this.innerMaterialMap.forEach(function(e){return e.blending=O[t.options.general.blendingType]}),u.easyDiff(e.options.general.depthWrite,t.options.general.depthWrite)&&u.easyDiff(e.options.general.depthTest,t.options.general.depthTest)||this.updateMaterialDepth(),(!u.easyDiff(e.options.general.defaultBase,t.options.general.defaultBase)||!u.easyDiff(e.options.graph.defaultScale,t.options.graph.defaultScale)||!u.easyDiff(e.options.graph.defaultHeight,t.options.graph.defaultHeight))&&this.data)for(var r,a=!1,i=0,n=this.data.features.length;i<n;i++)if(void 0===(r=this.data.features[i]).properties.base&&(a=!0),void 0===r.properties.scale&&(a=!0),void 0===r.properties.height&&(a=!0),a=void 0===r.properties.heightRatio?!0:a){this.setData(this.data);break}u.easyDiff(e.options.graph.defaultHeightRatio,t.options.graph.defaultHeightRatio)||(this.defaultHeightRatio=t.options.graph.defaultHeightRatio),u.easyDiff(e.sceneId.length,t.sceneId.length)&&u.deepDiff(e.sceneId,t.sceneId)||this.updateSceneId(),u.easyDiff(e.options.animate.animateOpts.uvScale,t.options.animate.animateOpts.uvScale)||(e=t.options.animate.animateOpts.uvScale,this.uniforms&&(this.uniforms.uvScale.value=new O.Vector2(e.x,e.y)))}},{key:"clear",value:function(){this.innerMap&&this.innerMap.forEach(function(e){e.userData.innerMeshGeoDataMap&&e.userData.innerMeshGeoDataMap.clear(),e.children[0]&&e.children[0].dispose&&e.children[0].dispose()}),c(y(s.prototype),"clear",this).call(this),this.innerMap&&this.innerMap.clear(),this.outerMap&&this.outerMap.clear(),this.innerMaterialMap&&this.innerMaterialMap.clear(),this.outerMaterialMap&&this.outerMaterialMap.clear(),this.innerOk=!1,this.outerOk=!1,this.innerScaledGeoData.length=0}},{key:"destroy",value:function(){this.clear(),c(y(s.prototype),"destroy",this).call(this)}}])&&f(i.prototype,e),n&&f(i,n),Object.defineProperty(i,"prototype",{writable:!1}),s},e.exports});;
Cube("datav:/com/@datav-city-pro-v2/datav-engine-proportional-area/2.1.2",["datav:/npm/eventemitter3/3.0.0"],function(e,t,r,o,n,i){function a(e){return(a="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function l(e,t){for(var r=0;r<t.length;r++){var o=t[r];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}function u(e,t){return(u=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function c(r){var o=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){})),!0}catch(e){return!1}}();return function(){var e,t=y(r),t=(e=o?(e=y(this).constructor,Reflect.construct(t,arguments,e)):t.apply(this,arguments),this);if(e&&("object"===a(e)||"function"==typeof e))return e;if(void 0!==e)throw new TypeError("Derived constructors may only return object or undefined");if(void 0!==t)return t;throw new ReferenceError("this hasn't been initialised - super() hasn't been called")}}function y(e){return(y=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var s=r("datav:/npm/eventemitter3/3.0.0"),f=r("datav:/com/@datav-city-pro-v2/datav-engine-proportional-area/2.1.2/proportionalArea"),r=function(){var e=n,t=s;if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&u(e,t);var r,o=c(n);function n(e,t){var r;if(this instanceof n)return(r=o.call(this)).options=t,r.comId="",r.type="ProportionalArea",r;throw new TypeError("Cannot call a class as a function")}return e=n,(t=[{key:"addTo",value:function(e,t){this.cityproCore=e,this.comId=t,this.initLayer()}},{key:"initLayer",value:function(){var e=f(this.cityproCore);this.layer=new e(this.options),this.cityproCore.viewer.addLayer(this.comId,this.layer)}},{key:"setData",value:function(e){this.layer&&this.layer.setData(e)}},{key:"errorRender",value:function(){console.log("区域柱状图组件数据错误"),this.layer&&this.layer.dataErrorHandler()}},{key:"setOpacity",value:function(e){this.layer&&this.layer.setOpacity(e)}},{key:"updateOptions",value:function(e){this.layer&&this.layer.updateOptions&&this.layer.updateOptions(e)}},{key:"sideTextureUrlHandler",value:function(e){this.layer.sideTextureUrlHandler(e)}},{key:"sideTextureColorHandler",value:function(e){this.layer.sideTextureColorHandler(e)}},{key:"animationById",value:function(e){this.layer&&this.layer.animationById(e)}},{key:"show",value:function(){this.layer&&this.layer.show&&this.layer.show()}},{key:"hide",value:function(){this.layer&&this.layer.hide&&this.layer.hide()}},{key:"remove",value:function(){console.log("remove is duplicate, please use clear instead.",this),this.clear()}},{key:"clear",value:function(){this.layer&&this.layer.clear&&this.layer.clear()}},{key:"destroy",value:function(){this.layer&&(this.layer.destroy&&this.layer.destroy(),this.layer=null)}}])&&l(e.prototype,t),r&&l(e,r),Object.defineProperty(e,"prototype",{writable:!1}),n}();return e.exports=r,e.exports});